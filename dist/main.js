!function(e){var t={};function i(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(r,o,function(t){return e[t]}.bind(null,o));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=9)}([function(e,t,i){var r;e.exports=function e(t,i,o){function s(a,l){if(!i[a]){if(!t[a]){if(!l&&"function"==typeof r&&r)return r(a,!0);if(n)return n(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var h=i[a]={exports:{}};t[a][0].call(h.exports,(function(e){return s(t[a][1][e]||e)}),h,h.exports,e,t,i,o)}return i[a].exports}for(var n="function"==typeof r&&r,a=0;a<o.length;a++)s(o[a]);return s}({1:[function(e,t,i){"use strict";var r=e("./zlib/deflate"),o=e("./utils/common"),s=e("./utils/strings"),n=e("./zlib/messages"),a=e("./zlib/zstream"),l=Object.prototype.toString,c=0,h=-1,d=0,u=8;function p(e){if(!(this instanceof p))return new p(e);this.options=o.assign({level:h,method:u,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;var i=r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(i!==c)throw new Error(n[i]);if(t.header&&r.deflateSetHeader(this.strm,t.header),t.dictionary){var m;if(m="string"==typeof t.dictionary?s.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(i=r.deflateSetDictionary(this.strm,m))!==c)throw new Error(n[i]);this._dict_set=!0}}function m(e,t){var i=new p(t);if(i.push(e,!0),i.err)throw i.msg||n[i.err];return i.result}p.prototype.push=function(e,t){var i,n,a=this.strm,h=this.options.chunkSize;if(this.ended)return!1;n=t===~~t?t:!0===t?4:0,"string"==typeof e?a.input=s.string2buf(e):"[object ArrayBuffer]"===l.call(e)?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;do{if(0===a.avail_out&&(a.output=new o.Buf8(h),a.next_out=0,a.avail_out=h),1!==(i=r.deflate(a,n))&&i!==c)return this.onEnd(i),this.ended=!0,!1;0!==a.avail_out&&(0!==a.avail_in||4!==n&&2!==n)||("string"===this.options.to?this.onData(s.buf2binstring(o.shrinkBuf(a.output,a.next_out))):this.onData(o.shrinkBuf(a.output,a.next_out)))}while((a.avail_in>0||0===a.avail_out)&&1!==i);return 4===n?(i=r.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===c):2!==n||(this.onEnd(c),a.avail_out=0,!0)},p.prototype.onData=function(e){this.chunks.push(e)},p.prototype.onEnd=function(e){e===c&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},i.Deflate=p,i.deflate=m,i.deflateRaw=function(e,t){return(t=t||{}).raw=!0,m(e,t)},i.gzip=function(e,t){return(t=t||{}).gzip=!0,m(e,t)}},{"./utils/common":3,"./utils/strings":4,"./zlib/deflate":8,"./zlib/messages":13,"./zlib/zstream":15}],2:[function(e,t,i){"use strict";var r=e("./zlib/inflate"),o=e("./utils/common"),s=e("./utils/strings"),n=e("./zlib/constants"),a=e("./zlib/messages"),l=e("./zlib/zstream"),c=e("./zlib/gzheader"),h=Object.prototype.toString;function d(e){if(!(this instanceof d))return new d(e);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var i=r.inflateInit2(this.strm,t.windowBits);if(i!==n.Z_OK)throw new Error(a[i]);if(this.header=new c,r.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=s.string2buf(t.dictionary):"[object ArrayBuffer]"===h.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(i=r.inflateSetDictionary(this.strm,t.dictionary))!==n.Z_OK))throw new Error(a[i])}function u(e,t){var i=new d(t);if(i.push(e,!0),i.err)throw i.msg||a[i.err];return i.result}d.prototype.push=function(e,t){var i,a,l,c,d,u=this.strm,p=this.options.chunkSize,m=this.options.dictionary,f=!1;if(this.ended)return!1;a=t===~~t?t:!0===t?n.Z_FINISH:n.Z_NO_FLUSH,"string"==typeof e?u.input=s.binstring2buf(e):"[object ArrayBuffer]"===h.call(e)?u.input=new Uint8Array(e):u.input=e,u.next_in=0,u.avail_in=u.input.length;do{if(0===u.avail_out&&(u.output=new o.Buf8(p),u.next_out=0,u.avail_out=p),(i=r.inflate(u,n.Z_NO_FLUSH))===n.Z_NEED_DICT&&m&&(i=r.inflateSetDictionary(this.strm,m)),i===n.Z_BUF_ERROR&&!0===f&&(i=n.Z_OK,f=!1),i!==n.Z_STREAM_END&&i!==n.Z_OK)return this.onEnd(i),this.ended=!0,!1;u.next_out&&(0!==u.avail_out&&i!==n.Z_STREAM_END&&(0!==u.avail_in||a!==n.Z_FINISH&&a!==n.Z_SYNC_FLUSH)||("string"===this.options.to?(l=s.utf8border(u.output,u.next_out),c=u.next_out-l,d=s.buf2string(u.output,l),u.next_out=c,u.avail_out=p-c,c&&o.arraySet(u.output,u.output,l,c,0),this.onData(d)):this.onData(o.shrinkBuf(u.output,u.next_out)))),0===u.avail_in&&0===u.avail_out&&(f=!0)}while((u.avail_in>0||0===u.avail_out)&&i!==n.Z_STREAM_END);return i===n.Z_STREAM_END&&(a=n.Z_FINISH),a===n.Z_FINISH?(i=r.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===n.Z_OK):a!==n.Z_SYNC_FLUSH||(this.onEnd(n.Z_OK),u.avail_out=0,!0)},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){e===n.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},i.Inflate=d,i.inflate=u,i.inflateRaw=function(e,t){return(t=t||{}).raw=!0,u(e,t)},i.ungzip=u},{"./utils/common":3,"./utils/strings":4,"./zlib/constants":6,"./zlib/gzheader":9,"./zlib/inflate":11,"./zlib/messages":13,"./zlib/zstream":15}],3:[function(e,t,i){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function o(e,t){return Object.prototype.hasOwnProperty.call(e,t)}i.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var i=t.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var r in i)o(i,r)&&(e[r]=i[r])}}return e},i.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var s={arraySet:function(e,t,i,r,o){if(t.subarray&&e.subarray)e.set(t.subarray(i,i+r),o);else for(var s=0;s<r;s++)e[o+s]=t[i+s]},flattenChunks:function(e){var t,i,r,o,s,n;for(r=0,t=0,i=e.length;t<i;t++)r+=e[t].length;for(n=new Uint8Array(r),o=0,t=0,i=e.length;t<i;t++)s=e[t],n.set(s,o),o+=s.length;return n}},n={arraySet:function(e,t,i,r,o){for(var s=0;s<r;s++)e[o+s]=t[i+s]},flattenChunks:function(e){return[].concat.apply([],e)}};i.setTyped=function(e){e?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,s)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,n))},i.setTyped(r)},{}],4:[function(e,t,i){"use strict";var r=e("./common"),o=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(e){o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){s=!1}for(var n=new r.Buf8(256),a=0;a<256;a++)n[a]=a>=252?6:a>=248?5:a>=240?4:a>=224?3:a>=192?2:1;function l(e,t){if(t<65534&&(e.subarray&&s||!e.subarray&&o))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var i="",n=0;n<t;n++)i+=String.fromCharCode(e[n]);return i}n[254]=n[254]=1,i.string2buf=function(e){var t,i,o,s,n,a=e.length,l=0;for(s=0;s<a;s++)55296==(64512&(i=e.charCodeAt(s)))&&s+1<a&&56320==(64512&(o=e.charCodeAt(s+1)))&&(i=65536+(i-55296<<10)+(o-56320),s++),l+=i<128?1:i<2048?2:i<65536?3:4;for(t=new r.Buf8(l),n=0,s=0;n<l;s++)55296==(64512&(i=e.charCodeAt(s)))&&s+1<a&&56320==(64512&(o=e.charCodeAt(s+1)))&&(i=65536+(i-55296<<10)+(o-56320),s++),i<128?t[n++]=i:i<2048?(t[n++]=192|i>>>6,t[n++]=128|63&i):i<65536?(t[n++]=224|i>>>12,t[n++]=128|i>>>6&63,t[n++]=128|63&i):(t[n++]=240|i>>>18,t[n++]=128|i>>>12&63,t[n++]=128|i>>>6&63,t[n++]=128|63&i);return t},i.buf2binstring=function(e){return l(e,e.length)},i.binstring2buf=function(e){for(var t=new r.Buf8(e.length),i=0,o=t.length;i<o;i++)t[i]=e.charCodeAt(i);return t},i.buf2string=function(e,t){var i,r,o,s,a=t||e.length,c=new Array(2*a);for(r=0,i=0;i<a;)if((o=e[i++])<128)c[r++]=o;else if((s=n[o])>4)c[r++]=65533,i+=s-1;else{for(o&=2===s?31:3===s?15:7;s>1&&i<a;)o=o<<6|63&e[i++],s--;s>1?c[r++]=65533:o<65536?c[r++]=o:(o-=65536,c[r++]=55296|o>>10&1023,c[r++]=56320|1023&o)}return l(c,r)},i.utf8border=function(e,t){var i;for((t=t||e.length)>e.length&&(t=e.length),i=t-1;i>=0&&128==(192&e[i]);)i--;return i<0?t:0===i?t:i+n[e[i]]>t?i:t}},{"./common":3}],5:[function(e,t,i){"use strict";t.exports=function(e,t,i,r){for(var o=65535&e|0,s=e>>>16&65535|0,n=0;0!==i;){i-=n=i>2e3?2e3:i;do{s=s+(o=o+t[r++]|0)|0}while(--n);o%=65521,s%=65521}return o|s<<16|0}},{}],6:[function(e,t,i){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],7:[function(e,t,i){"use strict";var r=function(){for(var e,t=[],i=0;i<256;i++){e=i;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t}();t.exports=function(e,t,i,o){var s=r,n=o+i;e^=-1;for(var a=o;a<n;a++)e=e>>>8^s[255&(e^t[a])];return-1^e}},{}],8:[function(e,t,i){"use strict";var r,o=e("../utils/common"),s=e("./trees"),n=e("./adler32"),a=e("./crc32"),l=e("./messages"),c=0,h=1,d=3,u=4,p=5,m=0,f=1,g=-2,b=-3,_=-5,v=-1,x=1,y=2,w=3,M=4,k=0,P=2,E=8,A=9,C=15,T=8,D=286,S=30,L=19,R=2*D+1,I=15,N=3,F=258,B=F+N+1,O=32,j=42,z=69,V=73,U=91,H=103,G=113,W=666,q=1,X=2,Y=3,K=4,$=3;function Q(e,t){return e.msg=l[t],t}function Z(e){return(e<<1)-(e>4?9:0)}function J(e){for(var t=e.length;--t>=0;)e[t]=0}function ee(e){var t=e.state,i=t.pending;i>e.avail_out&&(i=e.avail_out),0!==i&&(o.arraySet(e.output,t.pending_buf,t.pending_out,i,e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,0===t.pending&&(t.pending_out=0))}function te(e,t){s._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,ee(e.strm)}function ie(e,t){e.pending_buf[e.pending++]=t}function re(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function oe(e,t){var i,r,o=e.max_chain_length,s=e.strstart,n=e.prev_length,a=e.nice_match,l=e.strstart>e.w_size-B?e.strstart-(e.w_size-B):0,c=e.window,h=e.w_mask,d=e.prev,u=e.strstart+F,p=c[s+n-1],m=c[s+n];e.prev_length>=e.good_match&&(o>>=2),a>e.lookahead&&(a=e.lookahead);do{if(c[(i=t)+n]===m&&c[i+n-1]===p&&c[i]===c[s]&&c[++i]===c[s+1]){s+=2,i++;do{}while(c[++s]===c[++i]&&c[++s]===c[++i]&&c[++s]===c[++i]&&c[++s]===c[++i]&&c[++s]===c[++i]&&c[++s]===c[++i]&&c[++s]===c[++i]&&c[++s]===c[++i]&&s<u);if(r=F-(u-s),s=u-F,r>n){if(e.match_start=t,n=r,r>=a)break;p=c[s+n-1],m=c[s+n]}}}while((t=d[t&h])>l&&0!=--o);return n<=e.lookahead?n:e.lookahead}function se(e){var t,i,r,s,l,c,h,d,u,p,m=e.w_size;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=m+(m-B)){o.arraySet(e.window,e.window,m,m,0),e.match_start-=m,e.strstart-=m,e.block_start-=m,t=i=e.hash_size;do{r=e.head[--t],e.head[t]=r>=m?r-m:0}while(--i);t=i=m;do{r=e.prev[--t],e.prev[t]=r>=m?r-m:0}while(--i);s+=m}if(0===e.strm.avail_in)break;if(c=e.strm,h=e.window,d=e.strstart+e.lookahead,u=s,p=void 0,(p=c.avail_in)>u&&(p=u),i=0===p?0:(c.avail_in-=p,o.arraySet(h,c.input,c.next_in,p,d),1===c.state.wrap?c.adler=n(c.adler,h,p,d):2===c.state.wrap&&(c.adler=a(c.adler,h,p,d)),c.next_in+=p,c.total_in+=p,p),e.lookahead+=i,e.lookahead+e.insert>=N)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+N-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<N)););}while(e.lookahead<B&&0!==e.strm.avail_in)}function ne(e,t){for(var i,r;;){if(e.lookahead<B){if(se(e),e.lookahead<B&&t===c)return q;if(0===e.lookahead)break}if(i=0,e.lookahead>=N&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+N-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==i&&e.strstart-i<=e.w_size-B&&(e.match_length=oe(e,i)),e.match_length>=N)if(r=s._tr_tally(e,e.strstart-e.match_start,e.match_length-N),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=N){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+N-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(te(e,!1),0===e.strm.avail_out))return q}return e.insert=e.strstart<N-1?e.strstart:N-1,t===u?(te(e,!0),0===e.strm.avail_out?Y:K):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?q:X}function ae(e,t){for(var i,r,o;;){if(e.lookahead<B){if(se(e),e.lookahead<B&&t===c)return q;if(0===e.lookahead)break}if(i=0,e.lookahead>=N&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+N-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=N-1,0!==i&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-B&&(e.match_length=oe(e,i),e.match_length<=5&&(e.strategy===x||e.match_length===N&&e.strstart-e.match_start>4096)&&(e.match_length=N-1)),e.prev_length>=N&&e.match_length<=e.prev_length){o=e.strstart+e.lookahead-N,r=s._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-N),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=o&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+N-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=N-1,e.strstart++,r&&(te(e,!1),0===e.strm.avail_out))return q}else if(e.match_available){if((r=s._tr_tally(e,0,e.window[e.strstart-1]))&&te(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return q}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=s._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<N-1?e.strstart:N-1,t===u?(te(e,!0),0===e.strm.avail_out?Y:K):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?q:X}function le(e,t,i,r,o){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=r,this.func=o}function ce(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=E,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*R),this.dyn_dtree=new o.Buf16(2*(2*S+1)),this.bl_tree=new o.Buf16(2*(2*L+1)),J(this.dyn_ltree),J(this.dyn_dtree),J(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(I+1),this.heap=new o.Buf16(2*D+1),J(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*D+1),J(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function he(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=P,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?j:G,e.adler=2===t.wrap?0:1,t.last_flush=c,s._tr_init(t),m):Q(e,g)}function de(e){var t,i=he(e);return i===m&&((t=e.state).window_size=2*t.w_size,J(t.head),t.max_lazy_match=r[t.level].max_lazy,t.good_match=r[t.level].good_length,t.nice_match=r[t.level].nice_length,t.max_chain_length=r[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=N-1,t.match_available=0,t.ins_h=0),i}function ue(e,t,i,r,s,n){if(!e)return g;var a=1;if(t===v&&(t=6),r<0?(a=0,r=-r):r>15&&(a=2,r-=16),s<1||s>A||i!==E||r<8||r>15||t<0||t>9||n<0||n>M)return Q(e,g);8===r&&(r=9);var l=new ce;return e.state=l,l.strm=e,l.wrap=a,l.gzhead=null,l.w_bits=r,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=s+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+N-1)/N),l.window=new o.Buf8(2*l.w_size),l.head=new o.Buf16(l.hash_size),l.prev=new o.Buf16(l.w_size),l.lit_bufsize=1<<s+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new o.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=n,l.method=i,de(e)}r=[new le(0,0,0,0,(function(e,t){var i=65535;for(i>e.pending_buf_size-5&&(i=e.pending_buf_size-5);;){if(e.lookahead<=1){if(se(e),0===e.lookahead&&t===c)return q;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+i;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,te(e,!1),0===e.strm.avail_out))return q;if(e.strstart-e.block_start>=e.w_size-B&&(te(e,!1),0===e.strm.avail_out))return q}return e.insert=0,t===u?(te(e,!0),0===e.strm.avail_out?Y:K):(e.strstart>e.block_start&&(te(e,!1),e.strm.avail_out),q)})),new le(4,4,8,4,ne),new le(4,5,16,8,ne),new le(4,6,32,32,ne),new le(4,4,16,16,ae),new le(8,16,32,32,ae),new le(8,16,128,128,ae),new le(8,32,128,256,ae),new le(32,128,258,1024,ae),new le(32,258,258,4096,ae)],i.deflateInit=function(e,t){return ue(e,t,E,C,T,k)},i.deflateInit2=ue,i.deflateReset=de,i.deflateResetKeep=he,i.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?g:(e.state.gzhead=t,m):g},i.deflate=function(e,t){var i,o,n,l;if(!e||!e.state||t>p||t<0)return e?Q(e,g):g;if(o=e.state,!e.output||!e.input&&0!==e.avail_in||o.status===W&&t!==u)return Q(e,0===e.avail_out?_:g);if(o.strm=e,i=o.last_flush,o.last_flush=t,o.status===j)if(2===o.wrap)e.adler=0,ie(o,31),ie(o,139),ie(o,8),o.gzhead?(ie(o,(o.gzhead.text?1:0)+(o.gzhead.hcrc?2:0)+(o.gzhead.extra?4:0)+(o.gzhead.name?8:0)+(o.gzhead.comment?16:0)),ie(o,255&o.gzhead.time),ie(o,o.gzhead.time>>8&255),ie(o,o.gzhead.time>>16&255),ie(o,o.gzhead.time>>24&255),ie(o,9===o.level?2:o.strategy>=y||o.level<2?4:0),ie(o,255&o.gzhead.os),o.gzhead.extra&&o.gzhead.extra.length&&(ie(o,255&o.gzhead.extra.length),ie(o,o.gzhead.extra.length>>8&255)),o.gzhead.hcrc&&(e.adler=a(e.adler,o.pending_buf,o.pending,0)),o.gzindex=0,o.status=z):(ie(o,0),ie(o,0),ie(o,0),ie(o,0),ie(o,0),ie(o,9===o.level?2:o.strategy>=y||o.level<2?4:0),ie(o,$),o.status=G);else{var b=E+(o.w_bits-8<<4)<<8;b|=(o.strategy>=y||o.level<2?0:o.level<6?1:6===o.level?2:3)<<6,0!==o.strstart&&(b|=O),b+=31-b%31,o.status=G,re(o,b),0!==o.strstart&&(re(o,e.adler>>>16),re(o,65535&e.adler)),e.adler=1}if(o.status===z)if(o.gzhead.extra){for(n=o.pending;o.gzindex<(65535&o.gzhead.extra.length)&&(o.pending!==o.pending_buf_size||(o.gzhead.hcrc&&o.pending>n&&(e.adler=a(e.adler,o.pending_buf,o.pending-n,n)),ee(e),n=o.pending,o.pending!==o.pending_buf_size));)ie(o,255&o.gzhead.extra[o.gzindex]),o.gzindex++;o.gzhead.hcrc&&o.pending>n&&(e.adler=a(e.adler,o.pending_buf,o.pending-n,n)),o.gzindex===o.gzhead.extra.length&&(o.gzindex=0,o.status=V)}else o.status=V;if(o.status===V)if(o.gzhead.name){n=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>n&&(e.adler=a(e.adler,o.pending_buf,o.pending-n,n)),ee(e),n=o.pending,o.pending===o.pending_buf_size)){l=1;break}l=o.gzindex<o.gzhead.name.length?255&o.gzhead.name.charCodeAt(o.gzindex++):0,ie(o,l)}while(0!==l);o.gzhead.hcrc&&o.pending>n&&(e.adler=a(e.adler,o.pending_buf,o.pending-n,n)),0===l&&(o.gzindex=0,o.status=U)}else o.status=U;if(o.status===U)if(o.gzhead.comment){n=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>n&&(e.adler=a(e.adler,o.pending_buf,o.pending-n,n)),ee(e),n=o.pending,o.pending===o.pending_buf_size)){l=1;break}l=o.gzindex<o.gzhead.comment.length?255&o.gzhead.comment.charCodeAt(o.gzindex++):0,ie(o,l)}while(0!==l);o.gzhead.hcrc&&o.pending>n&&(e.adler=a(e.adler,o.pending_buf,o.pending-n,n)),0===l&&(o.status=H)}else o.status=H;if(o.status===H&&(o.gzhead.hcrc?(o.pending+2>o.pending_buf_size&&ee(e),o.pending+2<=o.pending_buf_size&&(ie(o,255&e.adler),ie(o,e.adler>>8&255),e.adler=0,o.status=G)):o.status=G),0!==o.pending){if(ee(e),0===e.avail_out)return o.last_flush=-1,m}else if(0===e.avail_in&&Z(t)<=Z(i)&&t!==u)return Q(e,_);if(o.status===W&&0!==e.avail_in)return Q(e,_);if(0!==e.avail_in||0!==o.lookahead||t!==c&&o.status!==W){var v=o.strategy===y?function(e,t){for(var i;;){if(0===e.lookahead&&(se(e),0===e.lookahead)){if(t===c)return q;break}if(e.match_length=0,i=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(te(e,!1),0===e.strm.avail_out))return q}return e.insert=0,t===u?(te(e,!0),0===e.strm.avail_out?Y:K):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?q:X}(o,t):o.strategy===w?function(e,t){for(var i,r,o,n,a=e.window;;){if(e.lookahead<=F){if(se(e),e.lookahead<=F&&t===c)return q;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=N&&e.strstart>0&&(r=a[o=e.strstart-1])===a[++o]&&r===a[++o]&&r===a[++o]){n=e.strstart+F;do{}while(r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&o<n);e.match_length=F-(n-o),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=N?(i=s._tr_tally(e,1,e.match_length-N),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(te(e,!1),0===e.strm.avail_out))return q}return e.insert=0,t===u?(te(e,!0),0===e.strm.avail_out?Y:K):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?q:X}(o,t):r[o.level].func(o,t);if(v!==Y&&v!==K||(o.status=W),v===q||v===Y)return 0===e.avail_out&&(o.last_flush=-1),m;if(v===X&&(t===h?s._tr_align(o):t!==p&&(s._tr_stored_block(o,0,0,!1),t===d&&(J(o.head),0===o.lookahead&&(o.strstart=0,o.block_start=0,o.insert=0))),ee(e),0===e.avail_out))return o.last_flush=-1,m}return t!==u?m:o.wrap<=0?f:(2===o.wrap?(ie(o,255&e.adler),ie(o,e.adler>>8&255),ie(o,e.adler>>16&255),ie(o,e.adler>>24&255),ie(o,255&e.total_in),ie(o,e.total_in>>8&255),ie(o,e.total_in>>16&255),ie(o,e.total_in>>24&255)):(re(o,e.adler>>>16),re(o,65535&e.adler)),ee(e),o.wrap>0&&(o.wrap=-o.wrap),0!==o.pending?m:f)},i.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==j&&t!==z&&t!==V&&t!==U&&t!==H&&t!==G&&t!==W?Q(e,g):(e.state=null,t===G?Q(e,b):m):g},i.deflateSetDictionary=function(e,t){var i,r,s,a,l,c,h,d,u=t.length;if(!e||!e.state)return g;if(2===(a=(i=e.state).wrap)||1===a&&i.status!==j||i.lookahead)return g;for(1===a&&(e.adler=n(e.adler,t,u,0)),i.wrap=0,u>=i.w_size&&(0===a&&(J(i.head),i.strstart=0,i.block_start=0,i.insert=0),d=new o.Buf8(i.w_size),o.arraySet(d,t,u-i.w_size,i.w_size,0),t=d,u=i.w_size),l=e.avail_in,c=e.next_in,h=e.input,e.avail_in=u,e.next_in=0,e.input=t,se(i);i.lookahead>=N;){r=i.strstart,s=i.lookahead-(N-1);do{i.ins_h=(i.ins_h<<i.hash_shift^i.window[r+N-1])&i.hash_mask,i.prev[r&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=r,r++}while(--s);i.strstart=r,i.lookahead=N-1,se(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=N-1,i.match_available=0,e.next_in=c,e.input=h,e.avail_in=l,i.wrap=a,m},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./messages":13,"./trees":14}],9:[function(e,t,i){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],10:[function(e,t,i){"use strict";t.exports=function(e,t){var i,r,o,s,n,a,l,c,h,d,u,p,m,f,g,b,_,v,x,y,w,M,k,P,E;i=e.state,r=e.next_in,P=e.input,o=r+(e.avail_in-5),s=e.next_out,E=e.output,n=s-(t-e.avail_out),a=s+(e.avail_out-257),l=i.dmax,c=i.wsize,h=i.whave,d=i.wnext,u=i.window,p=i.hold,m=i.bits,f=i.lencode,g=i.distcode,b=(1<<i.lenbits)-1,_=(1<<i.distbits)-1;e:do{m<15&&(p+=P[r++]<<m,m+=8,p+=P[r++]<<m,m+=8),v=f[p&b];t:for(;;){if(p>>>=x=v>>>24,m-=x,0==(x=v>>>16&255))E[s++]=65535&v;else{if(!(16&x)){if(0==(64&x)){v=f[(65535&v)+(p&(1<<x)-1)];continue t}if(32&x){i.mode=12;break e}e.msg="invalid literal/length code",i.mode=30;break e}y=65535&v,(x&=15)&&(m<x&&(p+=P[r++]<<m,m+=8),y+=p&(1<<x)-1,p>>>=x,m-=x),m<15&&(p+=P[r++]<<m,m+=8,p+=P[r++]<<m,m+=8),v=g[p&_];i:for(;;){if(p>>>=x=v>>>24,m-=x,!(16&(x=v>>>16&255))){if(0==(64&x)){v=g[(65535&v)+(p&(1<<x)-1)];continue i}e.msg="invalid distance code",i.mode=30;break e}if(w=65535&v,m<(x&=15)&&(p+=P[r++]<<m,(m+=8)<x&&(p+=P[r++]<<m,m+=8)),(w+=p&(1<<x)-1)>l){e.msg="invalid distance too far back",i.mode=30;break e}if(p>>>=x,m-=x,w>(x=s-n)){if((x=w-x)>h&&i.sane){e.msg="invalid distance too far back",i.mode=30;break e}if(M=0,k=u,0===d){if(M+=c-x,x<y){y-=x;do{E[s++]=u[M++]}while(--x);M=s-w,k=E}}else if(d<x){if(M+=c+d-x,(x-=d)<y){y-=x;do{E[s++]=u[M++]}while(--x);if(M=0,d<y){y-=x=d;do{E[s++]=u[M++]}while(--x);M=s-w,k=E}}}else if(M+=d-x,x<y){y-=x;do{E[s++]=u[M++]}while(--x);M=s-w,k=E}for(;y>2;)E[s++]=k[M++],E[s++]=k[M++],E[s++]=k[M++],y-=3;y&&(E[s++]=k[M++],y>1&&(E[s++]=k[M++]))}else{M=s-w;do{E[s++]=E[M++],E[s++]=E[M++],E[s++]=E[M++],y-=3}while(y>2);y&&(E[s++]=E[M++],y>1&&(E[s++]=E[M++]))}break}}break}}while(r<o&&s<a);r-=y=m>>3,p&=(1<<(m-=y<<3))-1,e.next_in=r,e.next_out=s,e.avail_in=r<o?o-r+5:5-(r-o),e.avail_out=s<a?a-s+257:257-(s-a),i.hold=p,i.bits=m}},{}],11:[function(e,t,i){"use strict";var r=e("../utils/common"),o=e("./adler32"),s=e("./crc32"),n=e("./inffast"),a=e("./inftrees"),l=0,c=1,h=2,d=4,u=5,p=6,m=0,f=1,g=2,b=-2,_=-3,v=-4,x=-5,y=8,w=1,M=2,k=3,P=4,E=5,A=6,C=7,T=8,D=9,S=10,L=11,R=12,I=13,N=14,F=15,B=16,O=17,j=18,z=19,V=20,U=21,H=22,G=23,W=24,q=25,X=26,Y=27,K=28,$=29,Q=30,Z=31,J=32,ee=852,te=592,ie=15;function re(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function oe(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function se(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=w,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new r.Buf32(ee),t.distcode=t.distdyn=new r.Buf32(te),t.sane=1,t.back=-1,m):b}function ne(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,se(e)):b}function ae(e,t){var i,r;return e&&e.state?(r=e.state,t<0?(i=0,t=-t):(i=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?b:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=i,r.wbits=t,ne(e))):b}function le(e,t){var i,r;return e?(r=new oe,e.state=r,r.window=null,(i=ae(e,t))!==m&&(e.state=null),i):b}var ce,he,de=!0;function ue(e){if(de){var t;for(ce=new r.Buf32(512),he=new r.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(a(c,e.lens,0,288,ce,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;a(h,e.lens,0,32,he,0,e.work,{bits:5}),de=!1}e.lencode=ce,e.lenbits=9,e.distcode=he,e.distbits=5}function pe(e,t,i,o){var s,n=e.state;return null===n.window&&(n.wsize=1<<n.wbits,n.wnext=0,n.whave=0,n.window=new r.Buf8(n.wsize)),o>=n.wsize?(r.arraySet(n.window,t,i-n.wsize,n.wsize,0),n.wnext=0,n.whave=n.wsize):((s=n.wsize-n.wnext)>o&&(s=o),r.arraySet(n.window,t,i-o,s,n.wnext),(o-=s)?(r.arraySet(n.window,t,i-o,o,0),n.wnext=o,n.whave=n.wsize):(n.wnext+=s,n.wnext===n.wsize&&(n.wnext=0),n.whave<n.wsize&&(n.whave+=s))),0}i.inflateReset=ne,i.inflateReset2=ae,i.inflateResetKeep=se,i.inflateInit=function(e){return le(e,ie)},i.inflateInit2=le,i.inflate=function(e,t){var i,ee,te,ie,oe,se,ne,ae,le,ce,he,de,me,fe,ge,be,_e,ve,xe,ye,we,Me,ke,Pe,Ee=0,Ae=new r.Buf8(4),Ce=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return b;(i=e.state).mode===R&&(i.mode=I),oe=e.next_out,te=e.output,ne=e.avail_out,ie=e.next_in,ee=e.input,se=e.avail_in,ae=i.hold,le=i.bits,ce=se,he=ne,Me=m;e:for(;;)switch(i.mode){case w:if(0===i.wrap){i.mode=I;break}for(;le<16;){if(0===se)break e;se--,ae+=ee[ie++]<<le,le+=8}if(2&i.wrap&&35615===ae){i.check=0,Ae[0]=255&ae,Ae[1]=ae>>>8&255,i.check=s(i.check,Ae,2,0),ae=0,le=0,i.mode=M;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&ae)<<8)+(ae>>8))%31){e.msg="incorrect header check",i.mode=Q;break}if((15&ae)!==y){e.msg="unknown compression method",i.mode=Q;break}if(le-=4,we=8+(15&(ae>>>=4)),0===i.wbits)i.wbits=we;else if(we>i.wbits){e.msg="invalid window size",i.mode=Q;break}i.dmax=1<<we,e.adler=i.check=1,i.mode=512&ae?S:R,ae=0,le=0;break;case M:for(;le<16;){if(0===se)break e;se--,ae+=ee[ie++]<<le,le+=8}if(i.flags=ae,(255&i.flags)!==y){e.msg="unknown compression method",i.mode=Q;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=Q;break}i.head&&(i.head.text=ae>>8&1),512&i.flags&&(Ae[0]=255&ae,Ae[1]=ae>>>8&255,i.check=s(i.check,Ae,2,0)),ae=0,le=0,i.mode=k;case k:for(;le<32;){if(0===se)break e;se--,ae+=ee[ie++]<<le,le+=8}i.head&&(i.head.time=ae),512&i.flags&&(Ae[0]=255&ae,Ae[1]=ae>>>8&255,Ae[2]=ae>>>16&255,Ae[3]=ae>>>24&255,i.check=s(i.check,Ae,4,0)),ae=0,le=0,i.mode=P;case P:for(;le<16;){if(0===se)break e;se--,ae+=ee[ie++]<<le,le+=8}i.head&&(i.head.xflags=255&ae,i.head.os=ae>>8),512&i.flags&&(Ae[0]=255&ae,Ae[1]=ae>>>8&255,i.check=s(i.check,Ae,2,0)),ae=0,le=0,i.mode=E;case E:if(1024&i.flags){for(;le<16;){if(0===se)break e;se--,ae+=ee[ie++]<<le,le+=8}i.length=ae,i.head&&(i.head.extra_len=ae),512&i.flags&&(Ae[0]=255&ae,Ae[1]=ae>>>8&255,i.check=s(i.check,Ae,2,0)),ae=0,le=0}else i.head&&(i.head.extra=null);i.mode=A;case A:if(1024&i.flags&&((de=i.length)>se&&(de=se),de&&(i.head&&(we=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),r.arraySet(i.head.extra,ee,ie,de,we)),512&i.flags&&(i.check=s(i.check,ee,de,ie)),se-=de,ie+=de,i.length-=de),i.length))break e;i.length=0,i.mode=C;case C:if(2048&i.flags){if(0===se)break e;de=0;do{we=ee[ie+de++],i.head&&we&&i.length<65536&&(i.head.name+=String.fromCharCode(we))}while(we&&de<se);if(512&i.flags&&(i.check=s(i.check,ee,de,ie)),se-=de,ie+=de,we)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=T;case T:if(4096&i.flags){if(0===se)break e;de=0;do{we=ee[ie+de++],i.head&&we&&i.length<65536&&(i.head.comment+=String.fromCharCode(we))}while(we&&de<se);if(512&i.flags&&(i.check=s(i.check,ee,de,ie)),se-=de,ie+=de,we)break e}else i.head&&(i.head.comment=null);i.mode=D;case D:if(512&i.flags){for(;le<16;){if(0===se)break e;se--,ae+=ee[ie++]<<le,le+=8}if(ae!==(65535&i.check)){e.msg="header crc mismatch",i.mode=Q;break}ae=0,le=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=R;break;case S:for(;le<32;){if(0===se)break e;se--,ae+=ee[ie++]<<le,le+=8}e.adler=i.check=re(ae),ae=0,le=0,i.mode=L;case L:if(0===i.havedict)return e.next_out=oe,e.avail_out=ne,e.next_in=ie,e.avail_in=se,i.hold=ae,i.bits=le,g;e.adler=i.check=1,i.mode=R;case R:if(t===u||t===p)break e;case I:if(i.last){ae>>>=7&le,le-=7&le,i.mode=Y;break}for(;le<3;){if(0===se)break e;se--,ae+=ee[ie++]<<le,le+=8}switch(i.last=1&ae,le-=1,3&(ae>>>=1)){case 0:i.mode=N;break;case 1:if(ue(i),i.mode=V,t===p){ae>>>=2,le-=2;break e}break;case 2:i.mode=O;break;case 3:e.msg="invalid block type",i.mode=Q}ae>>>=2,le-=2;break;case N:for(ae>>>=7&le,le-=7&le;le<32;){if(0===se)break e;se--,ae+=ee[ie++]<<le,le+=8}if((65535&ae)!=(ae>>>16^65535)){e.msg="invalid stored block lengths",i.mode=Q;break}if(i.length=65535&ae,ae=0,le=0,i.mode=F,t===p)break e;case F:i.mode=B;case B:if(de=i.length){if(de>se&&(de=se),de>ne&&(de=ne),0===de)break e;r.arraySet(te,ee,ie,de,oe),se-=de,ie+=de,ne-=de,oe+=de,i.length-=de;break}i.mode=R;break;case O:for(;le<14;){if(0===se)break e;se--,ae+=ee[ie++]<<le,le+=8}if(i.nlen=257+(31&ae),ae>>>=5,le-=5,i.ndist=1+(31&ae),ae>>>=5,le-=5,i.ncode=4+(15&ae),ae>>>=4,le-=4,i.nlen>286||i.ndist>30){e.msg="too many length or distance symbols",i.mode=Q;break}i.have=0,i.mode=j;case j:for(;i.have<i.ncode;){for(;le<3;){if(0===se)break e;se--,ae+=ee[ie++]<<le,le+=8}i.lens[Ce[i.have++]]=7&ae,ae>>>=3,le-=3}for(;i.have<19;)i.lens[Ce[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,ke={bits:i.lenbits},Me=a(l,i.lens,0,19,i.lencode,0,i.work,ke),i.lenbits=ke.bits,Me){e.msg="invalid code lengths set",i.mode=Q;break}i.have=0,i.mode=z;case z:for(;i.have<i.nlen+i.ndist;){for(;be=(Ee=i.lencode[ae&(1<<i.lenbits)-1])>>>16&255,_e=65535&Ee,!((ge=Ee>>>24)<=le);){if(0===se)break e;se--,ae+=ee[ie++]<<le,le+=8}if(_e<16)ae>>>=ge,le-=ge,i.lens[i.have++]=_e;else{if(16===_e){for(Pe=ge+2;le<Pe;){if(0===se)break e;se--,ae+=ee[ie++]<<le,le+=8}if(ae>>>=ge,le-=ge,0===i.have){e.msg="invalid bit length repeat",i.mode=Q;break}we=i.lens[i.have-1],de=3+(3&ae),ae>>>=2,le-=2}else if(17===_e){for(Pe=ge+3;le<Pe;){if(0===se)break e;se--,ae+=ee[ie++]<<le,le+=8}le-=ge,we=0,de=3+(7&(ae>>>=ge)),ae>>>=3,le-=3}else{for(Pe=ge+7;le<Pe;){if(0===se)break e;se--,ae+=ee[ie++]<<le,le+=8}le-=ge,we=0,de=11+(127&(ae>>>=ge)),ae>>>=7,le-=7}if(i.have+de>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=Q;break}for(;de--;)i.lens[i.have++]=we}}if(i.mode===Q)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=Q;break}if(i.lenbits=9,ke={bits:i.lenbits},Me=a(c,i.lens,0,i.nlen,i.lencode,0,i.work,ke),i.lenbits=ke.bits,Me){e.msg="invalid literal/lengths set",i.mode=Q;break}if(i.distbits=6,i.distcode=i.distdyn,ke={bits:i.distbits},Me=a(h,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,ke),i.distbits=ke.bits,Me){e.msg="invalid distances set",i.mode=Q;break}if(i.mode=V,t===p)break e;case V:i.mode=U;case U:if(se>=6&&ne>=258){e.next_out=oe,e.avail_out=ne,e.next_in=ie,e.avail_in=se,i.hold=ae,i.bits=le,n(e,he),oe=e.next_out,te=e.output,ne=e.avail_out,ie=e.next_in,ee=e.input,se=e.avail_in,ae=i.hold,le=i.bits,i.mode===R&&(i.back=-1);break}for(i.back=0;be=(Ee=i.lencode[ae&(1<<i.lenbits)-1])>>>16&255,_e=65535&Ee,!((ge=Ee>>>24)<=le);){if(0===se)break e;se--,ae+=ee[ie++]<<le,le+=8}if(be&&0==(240&be)){for(ve=ge,xe=be,ye=_e;be=(Ee=i.lencode[ye+((ae&(1<<ve+xe)-1)>>ve)])>>>16&255,_e=65535&Ee,!(ve+(ge=Ee>>>24)<=le);){if(0===se)break e;se--,ae+=ee[ie++]<<le,le+=8}ae>>>=ve,le-=ve,i.back+=ve}if(ae>>>=ge,le-=ge,i.back+=ge,i.length=_e,0===be){i.mode=X;break}if(32&be){i.back=-1,i.mode=R;break}if(64&be){e.msg="invalid literal/length code",i.mode=Q;break}i.extra=15&be,i.mode=H;case H:if(i.extra){for(Pe=i.extra;le<Pe;){if(0===se)break e;se--,ae+=ee[ie++]<<le,le+=8}i.length+=ae&(1<<i.extra)-1,ae>>>=i.extra,le-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=G;case G:for(;be=(Ee=i.distcode[ae&(1<<i.distbits)-1])>>>16&255,_e=65535&Ee,!((ge=Ee>>>24)<=le);){if(0===se)break e;se--,ae+=ee[ie++]<<le,le+=8}if(0==(240&be)){for(ve=ge,xe=be,ye=_e;be=(Ee=i.distcode[ye+((ae&(1<<ve+xe)-1)>>ve)])>>>16&255,_e=65535&Ee,!(ve+(ge=Ee>>>24)<=le);){if(0===se)break e;se--,ae+=ee[ie++]<<le,le+=8}ae>>>=ve,le-=ve,i.back+=ve}if(ae>>>=ge,le-=ge,i.back+=ge,64&be){e.msg="invalid distance code",i.mode=Q;break}i.offset=_e,i.extra=15&be,i.mode=W;case W:if(i.extra){for(Pe=i.extra;le<Pe;){if(0===se)break e;se--,ae+=ee[ie++]<<le,le+=8}i.offset+=ae&(1<<i.extra)-1,ae>>>=i.extra,le-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=Q;break}i.mode=q;case q:if(0===ne)break e;if(de=he-ne,i.offset>de){if((de=i.offset-de)>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=Q;break}de>i.wnext?(de-=i.wnext,me=i.wsize-de):me=i.wnext-de,de>i.length&&(de=i.length),fe=i.window}else fe=te,me=oe-i.offset,de=i.length;de>ne&&(de=ne),ne-=de,i.length-=de;do{te[oe++]=fe[me++]}while(--de);0===i.length&&(i.mode=U);break;case X:if(0===ne)break e;te[oe++]=i.length,ne--,i.mode=U;break;case Y:if(i.wrap){for(;le<32;){if(0===se)break e;se--,ae|=ee[ie++]<<le,le+=8}if(he-=ne,e.total_out+=he,i.total+=he,he&&(e.adler=i.check=i.flags?s(i.check,te,he,oe-he):o(i.check,te,he,oe-he)),he=ne,(i.flags?ae:re(ae))!==i.check){e.msg="incorrect data check",i.mode=Q;break}ae=0,le=0}i.mode=K;case K:if(i.wrap&&i.flags){for(;le<32;){if(0===se)break e;se--,ae+=ee[ie++]<<le,le+=8}if(ae!==(4294967295&i.total)){e.msg="incorrect length check",i.mode=Q;break}ae=0,le=0}i.mode=$;case $:Me=f;break e;case Q:Me=_;break e;case Z:return v;case J:default:return b}return e.next_out=oe,e.avail_out=ne,e.next_in=ie,e.avail_in=se,i.hold=ae,i.bits=le,(i.wsize||he!==e.avail_out&&i.mode<Q&&(i.mode<Y||t!==d))&&pe(e,e.output,e.next_out,he-e.avail_out)?(i.mode=Z,v):(ce-=e.avail_in,he-=e.avail_out,e.total_in+=ce,e.total_out+=he,i.total+=he,i.wrap&&he&&(e.adler=i.check=i.flags?s(i.check,te,he,e.next_out-he):o(i.check,te,he,e.next_out-he)),e.data_type=i.bits+(i.last?64:0)+(i.mode===R?128:0)+(i.mode===V||i.mode===F?256:0),(0===ce&&0===he||t===d)&&Me===m&&(Me=x),Me)},i.inflateEnd=function(e){if(!e||!e.state)return b;var t=e.state;return t.window&&(t.window=null),e.state=null,m},i.inflateGetHeader=function(e,t){var i;return e&&e.state?0==(2&(i=e.state).wrap)?b:(i.head=t,t.done=!1,m):b},i.inflateSetDictionary=function(e,t){var i,r=t.length;return e&&e.state?0!==(i=e.state).wrap&&i.mode!==L?b:i.mode===L&&o(1,t,r,0)!==i.check?_:pe(e,t,r,r)?(i.mode=Z,v):(i.havedict=1,m):b},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./inffast":10,"./inftrees":12}],12:[function(e,t,i){"use strict";var r=e("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],n=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,i,l,c,h,d,u){var p,m,f,g,b,_,v,x,y,w=u.bits,M=0,k=0,P=0,E=0,A=0,C=0,T=0,D=0,S=0,L=0,R=null,I=0,N=new r.Buf16(16),F=new r.Buf16(16),B=null,O=0;for(M=0;M<=15;M++)N[M]=0;for(k=0;k<l;k++)N[t[i+k]]++;for(A=w,E=15;E>=1&&0===N[E];E--);if(A>E&&(A=E),0===E)return c[h++]=20971520,c[h++]=20971520,u.bits=1,0;for(P=1;P<E&&0===N[P];P++);for(A<P&&(A=P),D=1,M=1;M<=15;M++)if(D<<=1,(D-=N[M])<0)return-1;if(D>0&&(0===e||1!==E))return-1;for(F[1]=0,M=1;M<15;M++)F[M+1]=F[M]+N[M];for(k=0;k<l;k++)0!==t[i+k]&&(d[F[t[i+k]]++]=k);if(0===e?(R=B=d,_=19):1===e?(R=o,I-=257,B=s,O-=257,_=256):(R=n,B=a,_=-1),L=0,k=0,M=P,b=h,C=A,T=0,f=-1,g=(S=1<<A)-1,1===e&&S>852||2===e&&S>592)return 1;for(;;){v=M-T,d[k]<_?(x=0,y=d[k]):d[k]>_?(x=B[O+d[k]],y=R[I+d[k]]):(x=96,y=0),p=1<<M-T,P=m=1<<C;do{c[b+(L>>T)+(m-=p)]=v<<24|x<<16|y|0}while(0!==m);for(p=1<<M-1;L&p;)p>>=1;if(0!==p?(L&=p-1,L+=p):L=0,k++,0==--N[M]){if(M===E)break;M=t[i+d[k]]}if(M>A&&(L&g)!==f){for(0===T&&(T=A),b+=P,D=1<<(C=M-T);C+T<E&&!((D-=N[C+T])<=0);)C++,D<<=1;if(S+=1<<C,1===e&&S>852||2===e&&S>592)return 1;c[f=L&g]=A<<24|C<<16|b-h|0}}return 0!==L&&(c[b+L]=M-T<<24|64<<16|0),u.bits=A,0}},{"../utils/common":3}],13:[function(e,t,i){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],14:[function(e,t,i){"use strict";var r=e("../utils/common"),o=4,s=0,n=1,a=2;function l(e){for(var t=e.length;--t>=0;)e[t]=0}var c=0,h=1,d=2,u=29,p=256,m=p+1+u,f=30,g=19,b=2*m+1,_=15,v=16,x=7,y=256,w=16,M=17,k=18,P=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],E=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],C=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],T=new Array(2*(m+2));l(T);var D=new Array(2*f);l(D);var S=new Array(512);l(S);var L=new Array(256);l(L);var R=new Array(u);l(R);var I,N,F,B=new Array(f);function O(e,t,i,r,o){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=r,this.max_length=o,this.has_stree=e&&e.length}function j(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function z(e){return e<256?S[e]:S[256+(e>>>7)]}function V(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function U(e,t,i){e.bi_valid>v-i?(e.bi_buf|=t<<e.bi_valid&65535,V(e,e.bi_buf),e.bi_buf=t>>v-e.bi_valid,e.bi_valid+=i-v):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=i)}function H(e,t,i){U(e,i[2*t],i[2*t+1])}function G(e,t){var i=0;do{i|=1&e,e>>>=1,i<<=1}while(--t>0);return i>>>1}function W(e,t,i){var r,o,s=new Array(_+1),n=0;for(r=1;r<=_;r++)s[r]=n=n+i[r-1]<<1;for(o=0;o<=t;o++){var a=e[2*o+1];0!==a&&(e[2*o]=G(s[a]++,a))}}function q(e){var t;for(t=0;t<m;t++)e.dyn_ltree[2*t]=0;for(t=0;t<f;t++)e.dyn_dtree[2*t]=0;for(t=0;t<g;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*y]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function X(e){e.bi_valid>8?V(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function Y(e,t,i,r){var o=2*t,s=2*i;return e[o]<e[s]||e[o]===e[s]&&r[t]<=r[i]}function K(e,t,i){for(var r=e.heap[i],o=i<<1;o<=e.heap_len&&(o<e.heap_len&&Y(t,e.heap[o+1],e.heap[o],e.depth)&&o++,!Y(t,r,e.heap[o],e.depth));)e.heap[i]=e.heap[o],i=o,o<<=1;e.heap[i]=r}function $(e,t,i){var r,o,s,n,a=0;if(0!==e.last_lit)do{r=e.pending_buf[e.d_buf+2*a]<<8|e.pending_buf[e.d_buf+2*a+1],o=e.pending_buf[e.l_buf+a],a++,0===r?H(e,o,t):(H(e,(s=L[o])+p+1,t),0!==(n=P[s])&&U(e,o-=R[s],n),H(e,s=z(--r),i),0!==(n=E[s])&&U(e,r-=B[s],n))}while(a<e.last_lit);H(e,y,t)}function Q(e,t){var i,r,o,s=t.dyn_tree,n=t.stat_desc.static_tree,a=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=b,i=0;i<l;i++)0!==s[2*i]?(e.heap[++e.heap_len]=c=i,e.depth[i]=0):s[2*i+1]=0;for(;e.heap_len<2;)s[2*(o=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[o]=0,e.opt_len--,a&&(e.static_len-=n[2*o+1]);for(t.max_code=c,i=e.heap_len>>1;i>=1;i--)K(e,s,i);o=l;do{i=e.heap[1],e.heap[1]=e.heap[e.heap_len--],K(e,s,1),r=e.heap[1],e.heap[--e.heap_max]=i,e.heap[--e.heap_max]=r,s[2*o]=s[2*i]+s[2*r],e.depth[o]=(e.depth[i]>=e.depth[r]?e.depth[i]:e.depth[r])+1,s[2*i+1]=s[2*r+1]=o,e.heap[1]=o++,K(e,s,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var i,r,o,s,n,a,l=t.dyn_tree,c=t.max_code,h=t.stat_desc.static_tree,d=t.stat_desc.has_stree,u=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,m=t.stat_desc.max_length,f=0;for(s=0;s<=_;s++)e.bl_count[s]=0;for(l[2*e.heap[e.heap_max]+1]=0,i=e.heap_max+1;i<b;i++)(s=l[2*l[2*(r=e.heap[i])+1]+1]+1)>m&&(s=m,f++),l[2*r+1]=s,r>c||(e.bl_count[s]++,n=0,r>=p&&(n=u[r-p]),a=l[2*r],e.opt_len+=a*(s+n),d&&(e.static_len+=a*(h[2*r+1]+n)));if(0!==f){do{for(s=m-1;0===e.bl_count[s];)s--;e.bl_count[s]--,e.bl_count[s+1]+=2,e.bl_count[m]--,f-=2}while(f>0);for(s=m;0!==s;s--)for(r=e.bl_count[s];0!==r;)(o=e.heap[--i])>c||(l[2*o+1]!==s&&(e.opt_len+=(s-l[2*o+1])*l[2*o],l[2*o+1]=s),r--)}}(e,t),W(s,c,e.bl_count)}function Z(e,t,i){var r,o,s=-1,n=t[1],a=0,l=7,c=4;for(0===n&&(l=138,c=3),t[2*(i+1)+1]=65535,r=0;r<=i;r++)o=n,n=t[2*(r+1)+1],++a<l&&o===n||(a<c?e.bl_tree[2*o]+=a:0!==o?(o!==s&&e.bl_tree[2*o]++,e.bl_tree[2*w]++):a<=10?e.bl_tree[2*M]++:e.bl_tree[2*k]++,a=0,s=o,0===n?(l=138,c=3):o===n?(l=6,c=3):(l=7,c=4))}function J(e,t,i){var r,o,s=-1,n=t[1],a=0,l=7,c=4;for(0===n&&(l=138,c=3),r=0;r<=i;r++)if(o=n,n=t[2*(r+1)+1],!(++a<l&&o===n)){if(a<c)do{H(e,o,e.bl_tree)}while(0!=--a);else 0!==o?(o!==s&&(H(e,o,e.bl_tree),a--),H(e,w,e.bl_tree),U(e,a-3,2)):a<=10?(H(e,M,e.bl_tree),U(e,a-3,3)):(H(e,k,e.bl_tree),U(e,a-11,7));a=0,s=o,0===n?(l=138,c=3):o===n?(l=6,c=3):(l=7,c=4)}}l(B);var ee=!1;function te(e,t,i,o){U(e,(c<<1)+(o?1:0),3),function(e,t,i,o){X(e),o&&(V(e,i),V(e,~i)),r.arraySet(e.pending_buf,e.window,t,i,e.pending),e.pending+=i}(e,t,i,!0)}i._tr_init=function(e){ee||(function(){var e,t,i,r,o,s=new Array(_+1);for(i=0,r=0;r<u-1;r++)for(R[r]=i,e=0;e<1<<P[r];e++)L[i++]=r;for(L[i-1]=r,o=0,r=0;r<16;r++)for(B[r]=o,e=0;e<1<<E[r];e++)S[o++]=r;for(o>>=7;r<f;r++)for(B[r]=o<<7,e=0;e<1<<E[r]-7;e++)S[256+o++]=r;for(t=0;t<=_;t++)s[t]=0;for(e=0;e<=143;)T[2*e+1]=8,e++,s[8]++;for(;e<=255;)T[2*e+1]=9,e++,s[9]++;for(;e<=279;)T[2*e+1]=7,e++,s[7]++;for(;e<=287;)T[2*e+1]=8,e++,s[8]++;for(W(T,m+1,s),e=0;e<f;e++)D[2*e+1]=5,D[2*e]=G(e,5);I=new O(T,P,p+1,m,_),N=new O(D,E,0,f,_),F=new O(new Array(0),A,0,g,x)}(),ee=!0),e.l_desc=new j(e.dyn_ltree,I),e.d_desc=new j(e.dyn_dtree,N),e.bl_desc=new j(e.bl_tree,F),e.bi_buf=0,e.bi_valid=0,q(e)},i._tr_stored_block=te,i._tr_flush_block=function(e,t,i,r){var l,c,u=0;e.level>0?(e.strm.data_type===a&&(e.strm.data_type=function(e){var t,i=4093624447;for(t=0;t<=31;t++,i>>>=1)if(1&i&&0!==e.dyn_ltree[2*t])return s;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return n;for(t=32;t<p;t++)if(0!==e.dyn_ltree[2*t])return n;return s}(e)),Q(e,e.l_desc),Q(e,e.d_desc),u=function(e){var t;for(Z(e,e.dyn_ltree,e.l_desc.max_code),Z(e,e.dyn_dtree,e.d_desc.max_code),Q(e,e.bl_desc),t=g-1;t>=3&&0===e.bl_tree[2*C[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),l=e.opt_len+3+7>>>3,(c=e.static_len+3+7>>>3)<=l&&(l=c)):l=c=i+5,i+4<=l&&-1!==t?te(e,t,i,r):e.strategy===o||c===l?(U(e,(h<<1)+(r?1:0),3),$(e,T,D)):(U(e,(d<<1)+(r?1:0),3),function(e,t,i,r){var o;for(U(e,t-257,5),U(e,i-1,5),U(e,r-4,4),o=0;o<r;o++)U(e,e.bl_tree[2*C[o]+1],3);J(e,e.dyn_ltree,t-1),J(e,e.dyn_dtree,i-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,u+1),$(e,e.dyn_ltree,e.dyn_dtree)),q(e),r&&X(e)},i._tr_tally=function(e,t,i){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&i,e.last_lit++,0===t?e.dyn_ltree[2*i]++:(e.matches++,t--,e.dyn_ltree[2*(L[i]+p+1)]++,e.dyn_dtree[2*z(t)]++),e.last_lit===e.lit_bufsize-1},i._tr_align=function(e){U(e,h<<1,3),H(e,y,T),function(e){16===e.bi_valid?(V(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":3}],15:[function(e,t,i){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],"/":[function(e,t,i){"use strict";var r={};(0,e("./lib/utils/common").assign)(r,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=r},{"./lib/deflate":1,"./lib/inflate":2,"./lib/utils/common":3,"./lib/zlib/constants":6}]},{},[])("/")},function(e,t,i){
/*!
  * Bootstrap v4.3.1 (https://getbootstrap.com/)
  * Copyright 2011-2019 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
  */
!function(e,t,i){"use strict";function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,i){return t&&r(e.prototype,t),i&&r(e,i),e}function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function n(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},r=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),r.forEach((function(t){s(e,t,i[t])}))}return e}t=t&&t.hasOwnProperty("default")?t.default:t,i=i&&i.hasOwnProperty("default")?i.default:i;var a="transitionend";function l(e){var i=this,r=!1;return t(this).one(c.TRANSITION_END,(function(){r=!0})),setTimeout((function(){r||c.triggerTransitionEnd(i)}),e),this}var c={TRANSITION_END:"bsTransitionEnd",getUID:function(e){do{e+=~~(1e6*Math.random())}while(document.getElementById(e));return e},getSelectorFromElement:function(e){var t=e.getAttribute("data-target");if(!t||"#"===t){var i=e.getAttribute("href");t=i&&"#"!==i?i.trim():""}try{return document.querySelector(t)?t:null}catch(e){return null}},getTransitionDurationFromElement:function(e){if(!e)return 0;var i=t(e).css("transition-duration"),r=t(e).css("transition-delay"),o=parseFloat(i),s=parseFloat(r);return o||s?(i=i.split(",")[0],r=r.split(",")[0],1e3*(parseFloat(i)+parseFloat(r))):0},reflow:function(e){return e.offsetHeight},triggerTransitionEnd:function(e){t(e).trigger(a)},supportsTransitionEnd:function(){return Boolean(a)},isElement:function(e){return(e[0]||e).nodeType},typeCheckConfig:function(e,t,i){for(var r in i)if(Object.prototype.hasOwnProperty.call(i,r)){var o=i[r],s=t[r],n=s&&c.isElement(s)?"element":(a=s,{}.toString.call(a).match(/\s([a-z]+)/i)[1].toLowerCase());if(!new RegExp(o).test(n))throw new Error(e.toUpperCase()+': Option "'+r+'" provided type "'+n+'" but expected type "'+o+'".')}var a},findShadowRoot:function(e){if(!document.documentElement.attachShadow)return null;if("function"==typeof e.getRootNode){var t=e.getRootNode();return t instanceof ShadowRoot?t:null}return e instanceof ShadowRoot?e:e.parentNode?c.findShadowRoot(e.parentNode):null}};t.fn.emulateTransitionEnd=l,t.event.special[c.TRANSITION_END]={bindType:a,delegateType:a,handle:function(e){if(t(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}};var h=t.fn.alert,d={CLOSE:"close.bs.alert",CLOSED:"closed.bs.alert",CLICK_DATA_API:"click.bs.alert.data-api"},u="alert",p="fade",m="show",f=function(){function e(e){this._element=e}var i=e.prototype;return i.close=function(e){var t=this._element;e&&(t=this._getRootElement(e)),this._triggerCloseEvent(t).isDefaultPrevented()||this._removeElement(t)},i.dispose=function(){t.removeData(this._element,"bs.alert"),this._element=null},i._getRootElement=function(e){var i=c.getSelectorFromElement(e),r=!1;return i&&(r=document.querySelector(i)),r||(r=t(e).closest("."+u)[0]),r},i._triggerCloseEvent=function(e){var i=t.Event(d.CLOSE);return t(e).trigger(i),i},i._removeElement=function(e){var i=this;if(t(e).removeClass(m),t(e).hasClass(p)){var r=c.getTransitionDurationFromElement(e);t(e).one(c.TRANSITION_END,(function(t){return i._destroyElement(e,t)})).emulateTransitionEnd(r)}else this._destroyElement(e)},i._destroyElement=function(e){t(e).detach().trigger(d.CLOSED).remove()},e._jQueryInterface=function(i){return this.each((function(){var r=t(this),o=r.data("bs.alert");o||(o=new e(this),r.data("bs.alert",o)),"close"===i&&o[i](this)}))},e._handleDismiss=function(e){return function(t){t&&t.preventDefault(),e.close(this)}},o(e,null,[{key:"VERSION",get:function(){return"4.3.1"}}]),e}();t(document).on(d.CLICK_DATA_API,'[data-dismiss="alert"]',f._handleDismiss(new f)),t.fn.alert=f._jQueryInterface,t.fn.alert.Constructor=f,t.fn.alert.noConflict=function(){return t.fn.alert=h,f._jQueryInterface};var g=t.fn.button,b="active",_="btn",v="focus",x='[data-toggle^="button"]',y='[data-toggle="buttons"]',w='input:not([type="hidden"])',M=".active",k=".btn",P={CLICK_DATA_API:"click.bs.button.data-api",FOCUS_BLUR_DATA_API:"focus.bs.button.data-api blur.bs.button.data-api"},E=function(){function e(e){this._element=e}var i=e.prototype;return i.toggle=function(){var e=!0,i=!0,r=t(this._element).closest(y)[0];if(r){var o=this._element.querySelector(w);if(o){if("radio"===o.type)if(o.checked&&this._element.classList.contains(b))e=!1;else{var s=r.querySelector(M);s&&t(s).removeClass(b)}if(e){if(o.hasAttribute("disabled")||r.hasAttribute("disabled")||o.classList.contains("disabled")||r.classList.contains("disabled"))return;o.checked=!this._element.classList.contains(b),t(o).trigger("change")}o.focus(),i=!1}}i&&this._element.setAttribute("aria-pressed",!this._element.classList.contains(b)),e&&t(this._element).toggleClass(b)},i.dispose=function(){t.removeData(this._element,"bs.button"),this._element=null},e._jQueryInterface=function(i){return this.each((function(){var r=t(this).data("bs.button");r||(r=new e(this),t(this).data("bs.button",r)),"toggle"===i&&r[i]()}))},o(e,null,[{key:"VERSION",get:function(){return"4.3.1"}}]),e}();t(document).on(P.CLICK_DATA_API,x,(function(e){e.preventDefault();var i=e.target;t(i).hasClass(_)||(i=t(i).closest(k)),E._jQueryInterface.call(t(i),"toggle")})).on(P.FOCUS_BLUR_DATA_API,x,(function(e){var i=t(e.target).closest(k)[0];t(i).toggleClass(v,/^focus(in)?$/.test(e.type))})),t.fn.button=E._jQueryInterface,t.fn.button.Constructor=E,t.fn.button.noConflict=function(){return t.fn.button=g,E._jQueryInterface};var A="carousel",C=".bs.carousel",T=t.fn[A],D={interval:5e3,keyboard:!0,slide:!1,pause:"hover",wrap:!0,touch:!0},S={interval:"(number|boolean)",keyboard:"boolean",slide:"(boolean|string)",pause:"(string|boolean)",wrap:"boolean",touch:"boolean"},L="next",R="prev",I="left",N="right",F={SLIDE:"slide.bs.carousel",SLID:"slid.bs.carousel",KEYDOWN:"keydown.bs.carousel",MOUSEENTER:"mouseenter.bs.carousel",MOUSELEAVE:"mouseleave.bs.carousel",TOUCHSTART:"touchstart.bs.carousel",TOUCHMOVE:"touchmove.bs.carousel",TOUCHEND:"touchend.bs.carousel",POINTERDOWN:"pointerdown.bs.carousel",POINTERUP:"pointerup.bs.carousel",DRAG_START:"dragstart.bs.carousel",LOAD_DATA_API:"load.bs.carousel.data-api",CLICK_DATA_API:"click.bs.carousel.data-api"},B="carousel",O="active",j="slide",z="carousel-item-right",V="carousel-item-left",U="carousel-item-next",H="carousel-item-prev",G="pointer-event",W={ACTIVE:".active",ACTIVE_ITEM:".active.carousel-item",ITEM:".carousel-item",ITEM_IMG:".carousel-item img",NEXT_PREV:".carousel-item-next, .carousel-item-prev",INDICATORS:".carousel-indicators",DATA_SLIDE:"[data-slide], [data-slide-to]",DATA_RIDE:'[data-ride="carousel"]'},q={TOUCH:"touch",PEN:"pen"},X=function(){function e(e,t){this._items=null,this._interval=null,this._activeElement=null,this._isPaused=!1,this._isSliding=!1,this.touchTimeout=null,this.touchStartX=0,this.touchDeltaX=0,this._config=this._getConfig(t),this._element=e,this._indicatorsElement=this._element.querySelector(W.INDICATORS),this._touchSupported="ontouchstart"in document.documentElement||navigator.maxTouchPoints>0,this._pointerEvent=Boolean(window.PointerEvent||window.MSPointerEvent),this._addEventListeners()}var i=e.prototype;return i.next=function(){this._isSliding||this._slide(L)},i.nextWhenVisible=function(){!document.hidden&&t(this._element).is(":visible")&&"hidden"!==t(this._element).css("visibility")&&this.next()},i.prev=function(){this._isSliding||this._slide(R)},i.pause=function(e){e||(this._isPaused=!0),this._element.querySelector(W.NEXT_PREV)&&(c.triggerTransitionEnd(this._element),this.cycle(!0)),clearInterval(this._interval),this._interval=null},i.cycle=function(e){e||(this._isPaused=!1),this._interval&&(clearInterval(this._interval),this._interval=null),this._config.interval&&!this._isPaused&&(this._interval=setInterval((document.visibilityState?this.nextWhenVisible:this.next).bind(this),this._config.interval))},i.to=function(e){var i=this;this._activeElement=this._element.querySelector(W.ACTIVE_ITEM);var r=this._getItemIndex(this._activeElement);if(!(e>this._items.length-1||e<0))if(this._isSliding)t(this._element).one(F.SLID,(function(){return i.to(e)}));else{if(r===e)return this.pause(),void this.cycle();var o=e>r?L:R;this._slide(o,this._items[e])}},i.dispose=function(){t(this._element).off(C),t.removeData(this._element,"bs.carousel"),this._items=null,this._config=null,this._element=null,this._interval=null,this._isPaused=null,this._isSliding=null,this._activeElement=null,this._indicatorsElement=null},i._getConfig=function(e){return e=n({},D,e),c.typeCheckConfig(A,e,S),e},i._handleSwipe=function(){var e=Math.abs(this.touchDeltaX);if(!(e<=40)){var t=e/this.touchDeltaX;t>0&&this.prev(),t<0&&this.next()}},i._addEventListeners=function(){var e=this;this._config.keyboard&&t(this._element).on(F.KEYDOWN,(function(t){return e._keydown(t)})),"hover"===this._config.pause&&t(this._element).on(F.MOUSEENTER,(function(t){return e.pause(t)})).on(F.MOUSELEAVE,(function(t){return e.cycle(t)})),this._config.touch&&this._addTouchEventListeners()},i._addTouchEventListeners=function(){var e=this;if(this._touchSupported){var i=function(t){e._pointerEvent&&q[t.originalEvent.pointerType.toUpperCase()]?e.touchStartX=t.originalEvent.clientX:e._pointerEvent||(e.touchStartX=t.originalEvent.touches[0].clientX)},r=function(t){e._pointerEvent&&q[t.originalEvent.pointerType.toUpperCase()]&&(e.touchDeltaX=t.originalEvent.clientX-e.touchStartX),e._handleSwipe(),"hover"===e._config.pause&&(e.pause(),e.touchTimeout&&clearTimeout(e.touchTimeout),e.touchTimeout=setTimeout((function(t){return e.cycle(t)}),500+e._config.interval))};t(this._element.querySelectorAll(W.ITEM_IMG)).on(F.DRAG_START,(function(e){return e.preventDefault()})),this._pointerEvent?(t(this._element).on(F.POINTERDOWN,(function(e){return i(e)})),t(this._element).on(F.POINTERUP,(function(e){return r(e)})),this._element.classList.add(G)):(t(this._element).on(F.TOUCHSTART,(function(e){return i(e)})),t(this._element).on(F.TOUCHMOVE,(function(t){return function(t){t.originalEvent.touches&&t.originalEvent.touches.length>1?e.touchDeltaX=0:e.touchDeltaX=t.originalEvent.touches[0].clientX-e.touchStartX}(t)})),t(this._element).on(F.TOUCHEND,(function(e){return r(e)})))}},i._keydown=function(e){if(!/input|textarea/i.test(e.target.tagName))switch(e.which){case 37:e.preventDefault(),this.prev();break;case 39:e.preventDefault(),this.next()}},i._getItemIndex=function(e){return this._items=e&&e.parentNode?[].slice.call(e.parentNode.querySelectorAll(W.ITEM)):[],this._items.indexOf(e)},i._getItemByDirection=function(e,t){var i=e===L,r=e===R,o=this._getItemIndex(t),s=this._items.length-1;if((r&&0===o||i&&o===s)&&!this._config.wrap)return t;var n=(o+(e===R?-1:1))%this._items.length;return-1===n?this._items[this._items.length-1]:this._items[n]},i._triggerSlideEvent=function(e,i){var r=this._getItemIndex(e),o=this._getItemIndex(this._element.querySelector(W.ACTIVE_ITEM)),s=t.Event(F.SLIDE,{relatedTarget:e,direction:i,from:o,to:r});return t(this._element).trigger(s),s},i._setActiveIndicatorElement=function(e){if(this._indicatorsElement){var i=[].slice.call(this._indicatorsElement.querySelectorAll(W.ACTIVE));t(i).removeClass(O);var r=this._indicatorsElement.children[this._getItemIndex(e)];r&&t(r).addClass(O)}},i._slide=function(e,i){var r,o,s,n=this,a=this._element.querySelector(W.ACTIVE_ITEM),l=this._getItemIndex(a),h=i||a&&this._getItemByDirection(e,a),d=this._getItemIndex(h),u=Boolean(this._interval);if(e===L?(r=V,o=U,s=I):(r=z,o=H,s=N),h&&t(h).hasClass(O))this._isSliding=!1;else if(!this._triggerSlideEvent(h,s).isDefaultPrevented()&&a&&h){this._isSliding=!0,u&&this.pause(),this._setActiveIndicatorElement(h);var p=t.Event(F.SLID,{relatedTarget:h,direction:s,from:l,to:d});if(t(this._element).hasClass(j)){t(h).addClass(o),c.reflow(h),t(a).addClass(r),t(h).addClass(r);var m=parseInt(h.getAttribute("data-interval"),10);m?(this._config.defaultInterval=this._config.defaultInterval||this._config.interval,this._config.interval=m):this._config.interval=this._config.defaultInterval||this._config.interval;var f=c.getTransitionDurationFromElement(a);t(a).one(c.TRANSITION_END,(function(){t(h).removeClass(r+" "+o).addClass(O),t(a).removeClass(O+" "+o+" "+r),n._isSliding=!1,setTimeout((function(){return t(n._element).trigger(p)}),0)})).emulateTransitionEnd(f)}else t(a).removeClass(O),t(h).addClass(O),this._isSliding=!1,t(this._element).trigger(p);u&&this.cycle()}},e._jQueryInterface=function(i){return this.each((function(){var r=t(this).data("bs.carousel"),o=n({},D,t(this).data());"object"==typeof i&&(o=n({},o,i));var s="string"==typeof i?i:o.slide;if(r||(r=new e(this,o),t(this).data("bs.carousel",r)),"number"==typeof i)r.to(i);else if("string"==typeof s){if(void 0===r[s])throw new TypeError('No method named "'+s+'"');r[s]()}else o.interval&&o.ride&&(r.pause(),r.cycle())}))},e._dataApiClickHandler=function(i){var r=c.getSelectorFromElement(this);if(r){var o=t(r)[0];if(o&&t(o).hasClass(B)){var s=n({},t(o).data(),t(this).data()),a=this.getAttribute("data-slide-to");a&&(s.interval=!1),e._jQueryInterface.call(t(o),s),a&&t(o).data("bs.carousel").to(a),i.preventDefault()}}},o(e,null,[{key:"VERSION",get:function(){return"4.3.1"}},{key:"Default",get:function(){return D}}]),e}();t(document).on(F.CLICK_DATA_API,W.DATA_SLIDE,X._dataApiClickHandler),t(window).on(F.LOAD_DATA_API,(function(){for(var e=[].slice.call(document.querySelectorAll(W.DATA_RIDE)),i=0,r=e.length;i<r;i++){var o=t(e[i]);X._jQueryInterface.call(o,o.data())}})),t.fn[A]=X._jQueryInterface,t.fn[A].Constructor=X,t.fn[A].noConflict=function(){return t.fn[A]=T,X._jQueryInterface};var Y="collapse",K=t.fn[Y],$={toggle:!0,parent:""},Q={toggle:"boolean",parent:"(string|element)"},Z={SHOW:"show.bs.collapse",SHOWN:"shown.bs.collapse",HIDE:"hide.bs.collapse",HIDDEN:"hidden.bs.collapse",CLICK_DATA_API:"click.bs.collapse.data-api"},J="show",ee="collapse",te="collapsing",ie="collapsed",re="width",oe="height",se={ACTIVES:".show, .collapsing",DATA_TOGGLE:'[data-toggle="collapse"]'},ne=function(){function e(e,t){this._isTransitioning=!1,this._element=e,this._config=this._getConfig(t),this._triggerArray=[].slice.call(document.querySelectorAll('[data-toggle="collapse"][href="#'+e.id+'"],[data-toggle="collapse"][data-target="#'+e.id+'"]'));for(var i=[].slice.call(document.querySelectorAll(se.DATA_TOGGLE)),r=0,o=i.length;r<o;r++){var s=i[r],n=c.getSelectorFromElement(s),a=[].slice.call(document.querySelectorAll(n)).filter((function(t){return t===e}));null!==n&&a.length>0&&(this._selector=n,this._triggerArray.push(s))}this._parent=this._config.parent?this._getParent():null,this._config.parent||this._addAriaAndCollapsedClass(this._element,this._triggerArray),this._config.toggle&&this.toggle()}var i=e.prototype;return i.toggle=function(){t(this._element).hasClass(J)?this.hide():this.show()},i.show=function(){var i,r,o=this;if(!(this._isTransitioning||t(this._element).hasClass(J)||(this._parent&&0===(i=[].slice.call(this._parent.querySelectorAll(se.ACTIVES)).filter((function(e){return"string"==typeof o._config.parent?e.getAttribute("data-parent")===o._config.parent:e.classList.contains(ee)}))).length&&(i=null),i&&(r=t(i).not(this._selector).data("bs.collapse"))&&r._isTransitioning))){var s=t.Event(Z.SHOW);if(t(this._element).trigger(s),!s.isDefaultPrevented()){i&&(e._jQueryInterface.call(t(i).not(this._selector),"hide"),r||t(i).data("bs.collapse",null));var n=this._getDimension();t(this._element).removeClass(ee).addClass(te),this._element.style[n]=0,this._triggerArray.length&&t(this._triggerArray).removeClass(ie).attr("aria-expanded",!0),this.setTransitioning(!0);var a="scroll"+(n[0].toUpperCase()+n.slice(1)),l=c.getTransitionDurationFromElement(this._element);t(this._element).one(c.TRANSITION_END,(function(){t(o._element).removeClass(te).addClass(ee).addClass(J),o._element.style[n]="",o.setTransitioning(!1),t(o._element).trigger(Z.SHOWN)})).emulateTransitionEnd(l),this._element.style[n]=this._element[a]+"px"}}},i.hide=function(){var e=this;if(!this._isTransitioning&&t(this._element).hasClass(J)){var i=t.Event(Z.HIDE);if(t(this._element).trigger(i),!i.isDefaultPrevented()){var r=this._getDimension();this._element.style[r]=this._element.getBoundingClientRect()[r]+"px",c.reflow(this._element),t(this._element).addClass(te).removeClass(ee).removeClass(J);var o=this._triggerArray.length;if(o>0)for(var s=0;s<o;s++){var n=this._triggerArray[s],a=c.getSelectorFromElement(n);null!==a&&(t([].slice.call(document.querySelectorAll(a))).hasClass(J)||t(n).addClass(ie).attr("aria-expanded",!1))}this.setTransitioning(!0),this._element.style[r]="";var l=c.getTransitionDurationFromElement(this._element);t(this._element).one(c.TRANSITION_END,(function(){e.setTransitioning(!1),t(e._element).removeClass(te).addClass(ee).trigger(Z.HIDDEN)})).emulateTransitionEnd(l)}}},i.setTransitioning=function(e){this._isTransitioning=e},i.dispose=function(){t.removeData(this._element,"bs.collapse"),this._config=null,this._parent=null,this._element=null,this._triggerArray=null,this._isTransitioning=null},i._getConfig=function(e){return(e=n({},$,e)).toggle=Boolean(e.toggle),c.typeCheckConfig(Y,e,Q),e},i._getDimension=function(){return t(this._element).hasClass(re)?re:oe},i._getParent=function(){var i,r=this;c.isElement(this._config.parent)?(i=this._config.parent,void 0!==this._config.parent.jquery&&(i=this._config.parent[0])):i=document.querySelector(this._config.parent);var o='[data-toggle="collapse"][data-parent="'+this._config.parent+'"]',s=[].slice.call(i.querySelectorAll(o));return t(s).each((function(t,i){r._addAriaAndCollapsedClass(e._getTargetFromElement(i),[i])})),i},i._addAriaAndCollapsedClass=function(e,i){var r=t(e).hasClass(J);i.length&&t(i).toggleClass(ie,!r).attr("aria-expanded",r)},e._getTargetFromElement=function(e){var t=c.getSelectorFromElement(e);return t?document.querySelector(t):null},e._jQueryInterface=function(i){return this.each((function(){var r=t(this),o=r.data("bs.collapse"),s=n({},$,r.data(),"object"==typeof i&&i?i:{});if(!o&&s.toggle&&/show|hide/.test(i)&&(s.toggle=!1),o||(o=new e(this,s),r.data("bs.collapse",o)),"string"==typeof i){if(void 0===o[i])throw new TypeError('No method named "'+i+'"');o[i]()}}))},o(e,null,[{key:"VERSION",get:function(){return"4.3.1"}},{key:"Default",get:function(){return $}}]),e}();t(document).on(Z.CLICK_DATA_API,se.DATA_TOGGLE,(function(e){"A"===e.currentTarget.tagName&&e.preventDefault();var i=t(this),r=c.getSelectorFromElement(this),o=[].slice.call(document.querySelectorAll(r));t(o).each((function(){var e=t(this),r=e.data("bs.collapse")?"toggle":i.data();ne._jQueryInterface.call(e,r)}))})),t.fn[Y]=ne._jQueryInterface,t.fn[Y].Constructor=ne,t.fn[Y].noConflict=function(){return t.fn[Y]=K,ne._jQueryInterface};var ae="dropdown",le=t.fn[ae],ce=new RegExp("38|40|27"),he={HIDE:"hide.bs.dropdown",HIDDEN:"hidden.bs.dropdown",SHOW:"show.bs.dropdown",SHOWN:"shown.bs.dropdown",CLICK:"click.bs.dropdown",CLICK_DATA_API:"click.bs.dropdown.data-api",KEYDOWN_DATA_API:"keydown.bs.dropdown.data-api",KEYUP_DATA_API:"keyup.bs.dropdown.data-api"},de="disabled",ue="show",pe="dropup",me="dropright",fe="dropleft",ge="dropdown-menu-right",be="position-static",_e='[data-toggle="dropdown"]',ve=".dropdown form",xe=".dropdown-menu",ye=".navbar-nav",we=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",Me="top-start",ke="top-end",Pe="bottom-start",Ee="bottom-end",Ae="right-start",Ce="left-start",Te={offset:0,flip:!0,boundary:"scrollParent",reference:"toggle",display:"dynamic"},De={offset:"(number|string|function)",flip:"boolean",boundary:"(string|element)",reference:"(string|element)",display:"string"},Se=function(){function e(e,t){this._element=e,this._popper=null,this._config=this._getConfig(t),this._menu=this._getMenuElement(),this._inNavbar=this._detectNavbar(),this._addEventListeners()}var r=e.prototype;return r.toggle=function(){if(!this._element.disabled&&!t(this._element).hasClass(de)){var r=e._getParentFromElement(this._element),o=t(this._menu).hasClass(ue);if(e._clearMenus(),!o){var s={relatedTarget:this._element},n=t.Event(he.SHOW,s);if(t(r).trigger(n),!n.isDefaultPrevented()){if(!this._inNavbar){if(void 0===i)throw new TypeError("Bootstrap's dropdowns require Popper.js (https://popper.js.org/)");var a=this._element;"parent"===this._config.reference?a=r:c.isElement(this._config.reference)&&(a=this._config.reference,void 0!==this._config.reference.jquery&&(a=this._config.reference[0])),"scrollParent"!==this._config.boundary&&t(r).addClass(be),this._popper=new i(a,this._menu,this._getPopperConfig())}"ontouchstart"in document.documentElement&&0===t(r).closest(ye).length&&t(document.body).children().on("mouseover",null,t.noop),this._element.focus(),this._element.setAttribute("aria-expanded",!0),t(this._menu).toggleClass(ue),t(r).toggleClass(ue).trigger(t.Event(he.SHOWN,s))}}}},r.show=function(){if(!(this._element.disabled||t(this._element).hasClass(de)||t(this._menu).hasClass(ue))){var i={relatedTarget:this._element},r=t.Event(he.SHOW,i),o=e._getParentFromElement(this._element);t(o).trigger(r),r.isDefaultPrevented()||(t(this._menu).toggleClass(ue),t(o).toggleClass(ue).trigger(t.Event(he.SHOWN,i)))}},r.hide=function(){if(!this._element.disabled&&!t(this._element).hasClass(de)&&t(this._menu).hasClass(ue)){var i={relatedTarget:this._element},r=t.Event(he.HIDE,i),o=e._getParentFromElement(this._element);t(o).trigger(r),r.isDefaultPrevented()||(t(this._menu).toggleClass(ue),t(o).toggleClass(ue).trigger(t.Event(he.HIDDEN,i)))}},r.dispose=function(){t.removeData(this._element,"bs.dropdown"),t(this._element).off(".bs.dropdown"),this._element=null,this._menu=null,null!==this._popper&&(this._popper.destroy(),this._popper=null)},r.update=function(){this._inNavbar=this._detectNavbar(),null!==this._popper&&this._popper.scheduleUpdate()},r._addEventListeners=function(){var e=this;t(this._element).on(he.CLICK,(function(t){t.preventDefault(),t.stopPropagation(),e.toggle()}))},r._getConfig=function(e){return e=n({},this.constructor.Default,t(this._element).data(),e),c.typeCheckConfig(ae,e,this.constructor.DefaultType),e},r._getMenuElement=function(){if(!this._menu){var t=e._getParentFromElement(this._element);t&&(this._menu=t.querySelector(xe))}return this._menu},r._getPlacement=function(){var e=t(this._element.parentNode),i=Pe;return e.hasClass(pe)?(i=Me,t(this._menu).hasClass(ge)&&(i=ke)):e.hasClass(me)?i=Ae:e.hasClass(fe)?i=Ce:t(this._menu).hasClass(ge)&&(i=Ee),i},r._detectNavbar=function(){return t(this._element).closest(".navbar").length>0},r._getOffset=function(){var e=this,t={};return"function"==typeof this._config.offset?t.fn=function(t){return t.offsets=n({},t.offsets,e._config.offset(t.offsets,e._element)||{}),t}:t.offset=this._config.offset,t},r._getPopperConfig=function(){var e={placement:this._getPlacement(),modifiers:{offset:this._getOffset(),flip:{enabled:this._config.flip},preventOverflow:{boundariesElement:this._config.boundary}}};return"static"===this._config.display&&(e.modifiers.applyStyle={enabled:!1}),e},e._jQueryInterface=function(i){return this.each((function(){var r=t(this).data("bs.dropdown");if(r||(r=new e(this,"object"==typeof i?i:null),t(this).data("bs.dropdown",r)),"string"==typeof i){if(void 0===r[i])throw new TypeError('No method named "'+i+'"');r[i]()}}))},e._clearMenus=function(i){if(!i||3!==i.which&&("keyup"!==i.type||9===i.which))for(var r=[].slice.call(document.querySelectorAll(_e)),o=0,s=r.length;o<s;o++){var n=e._getParentFromElement(r[o]),a=t(r[o]).data("bs.dropdown"),l={relatedTarget:r[o]};if(i&&"click"===i.type&&(l.clickEvent=i),a){var c=a._menu;if(t(n).hasClass(ue)&&!(i&&("click"===i.type&&/input|textarea/i.test(i.target.tagName)||"keyup"===i.type&&9===i.which)&&t.contains(n,i.target))){var h=t.Event(he.HIDE,l);t(n).trigger(h),h.isDefaultPrevented()||("ontouchstart"in document.documentElement&&t(document.body).children().off("mouseover",null,t.noop),r[o].setAttribute("aria-expanded","false"),t(c).removeClass(ue),t(n).removeClass(ue).trigger(t.Event(he.HIDDEN,l)))}}}},e._getParentFromElement=function(e){var t,i=c.getSelectorFromElement(e);return i&&(t=document.querySelector(i)),t||e.parentNode},e._dataApiKeydownHandler=function(i){if((/input|textarea/i.test(i.target.tagName)?!(32===i.which||27!==i.which&&(40!==i.which&&38!==i.which||t(i.target).closest(xe).length)):ce.test(i.which))&&(i.preventDefault(),i.stopPropagation(),!this.disabled&&!t(this).hasClass(de))){var r=e._getParentFromElement(this),o=t(r).hasClass(ue);if(o&&(!o||27!==i.which&&32!==i.which)){var s=[].slice.call(r.querySelectorAll(we));if(0!==s.length){var n=s.indexOf(i.target);38===i.which&&n>0&&n--,40===i.which&&n<s.length-1&&n++,n<0&&(n=0),s[n].focus()}}else{if(27===i.which){var a=r.querySelector(_e);t(a).trigger("focus")}t(this).trigger("click")}}},o(e,null,[{key:"VERSION",get:function(){return"4.3.1"}},{key:"Default",get:function(){return Te}},{key:"DefaultType",get:function(){return De}}]),e}();t(document).on(he.KEYDOWN_DATA_API,_e,Se._dataApiKeydownHandler).on(he.KEYDOWN_DATA_API,xe,Se._dataApiKeydownHandler).on(he.CLICK_DATA_API+" "+he.KEYUP_DATA_API,Se._clearMenus).on(he.CLICK_DATA_API,_e,(function(e){e.preventDefault(),e.stopPropagation(),Se._jQueryInterface.call(t(this),"toggle")})).on(he.CLICK_DATA_API,ve,(function(e){e.stopPropagation()})),t.fn[ae]=Se._jQueryInterface,t.fn[ae].Constructor=Se,t.fn[ae].noConflict=function(){return t.fn[ae]=le,Se._jQueryInterface};var Le=t.fn.modal,Re={backdrop:!0,keyboard:!0,focus:!0,show:!0},Ie={backdrop:"(boolean|string)",keyboard:"boolean",focus:"boolean",show:"boolean"},Ne={HIDE:"hide.bs.modal",HIDDEN:"hidden.bs.modal",SHOW:"show.bs.modal",SHOWN:"shown.bs.modal",FOCUSIN:"focusin.bs.modal",RESIZE:"resize.bs.modal",CLICK_DISMISS:"click.dismiss.bs.modal",KEYDOWN_DISMISS:"keydown.dismiss.bs.modal",MOUSEUP_DISMISS:"mouseup.dismiss.bs.modal",MOUSEDOWN_DISMISS:"mousedown.dismiss.bs.modal",CLICK_DATA_API:"click.bs.modal.data-api"},Fe="modal-dialog-scrollable",Be="modal-scrollbar-measure",Oe="modal-backdrop",je="modal-open",ze="fade",Ve="show",Ue={DIALOG:".modal-dialog",MODAL_BODY:".modal-body",DATA_TOGGLE:'[data-toggle="modal"]',DATA_DISMISS:'[data-dismiss="modal"]',FIXED_CONTENT:".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",STICKY_CONTENT:".sticky-top"},He=function(){function e(e,t){this._config=this._getConfig(t),this._element=e,this._dialog=e.querySelector(Ue.DIALOG),this._backdrop=null,this._isShown=!1,this._isBodyOverflowing=!1,this._ignoreBackdropClick=!1,this._isTransitioning=!1,this._scrollbarWidth=0}var i=e.prototype;return i.toggle=function(e){return this._isShown?this.hide():this.show(e)},i.show=function(e){var i=this;if(!this._isShown&&!this._isTransitioning){t(this._element).hasClass(ze)&&(this._isTransitioning=!0);var r=t.Event(Ne.SHOW,{relatedTarget:e});t(this._element).trigger(r),this._isShown||r.isDefaultPrevented()||(this._isShown=!0,this._checkScrollbar(),this._setScrollbar(),this._adjustDialog(),this._setEscapeEvent(),this._setResizeEvent(),t(this._element).on(Ne.CLICK_DISMISS,Ue.DATA_DISMISS,(function(e){return i.hide(e)})),t(this._dialog).on(Ne.MOUSEDOWN_DISMISS,(function(){t(i._element).one(Ne.MOUSEUP_DISMISS,(function(e){t(e.target).is(i._element)&&(i._ignoreBackdropClick=!0)}))})),this._showBackdrop((function(){return i._showElement(e)})))}},i.hide=function(e){var i=this;if(e&&e.preventDefault(),this._isShown&&!this._isTransitioning){var r=t.Event(Ne.HIDE);if(t(this._element).trigger(r),this._isShown&&!r.isDefaultPrevented()){this._isShown=!1;var o=t(this._element).hasClass(ze);if(o&&(this._isTransitioning=!0),this._setEscapeEvent(),this._setResizeEvent(),t(document).off(Ne.FOCUSIN),t(this._element).removeClass(Ve),t(this._element).off(Ne.CLICK_DISMISS),t(this._dialog).off(Ne.MOUSEDOWN_DISMISS),o){var s=c.getTransitionDurationFromElement(this._element);t(this._element).one(c.TRANSITION_END,(function(e){return i._hideModal(e)})).emulateTransitionEnd(s)}else this._hideModal()}}},i.dispose=function(){[window,this._element,this._dialog].forEach((function(e){return t(e).off(".bs.modal")})),t(document).off(Ne.FOCUSIN),t.removeData(this._element,"bs.modal"),this._config=null,this._element=null,this._dialog=null,this._backdrop=null,this._isShown=null,this._isBodyOverflowing=null,this._ignoreBackdropClick=null,this._isTransitioning=null,this._scrollbarWidth=null},i.handleUpdate=function(){this._adjustDialog()},i._getConfig=function(e){return e=n({},Re,e),c.typeCheckConfig("modal",e,Ie),e},i._showElement=function(e){var i=this,r=t(this._element).hasClass(ze);this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE||document.body.appendChild(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),t(this._dialog).hasClass(Fe)?this._dialog.querySelector(Ue.MODAL_BODY).scrollTop=0:this._element.scrollTop=0,r&&c.reflow(this._element),t(this._element).addClass(Ve),this._config.focus&&this._enforceFocus();var o=t.Event(Ne.SHOWN,{relatedTarget:e}),s=function(){i._config.focus&&i._element.focus(),i._isTransitioning=!1,t(i._element).trigger(o)};if(r){var n=c.getTransitionDurationFromElement(this._dialog);t(this._dialog).one(c.TRANSITION_END,s).emulateTransitionEnd(n)}else s()},i._enforceFocus=function(){var e=this;t(document).off(Ne.FOCUSIN).on(Ne.FOCUSIN,(function(i){document!==i.target&&e._element!==i.target&&0===t(e._element).has(i.target).length&&e._element.focus()}))},i._setEscapeEvent=function(){var e=this;this._isShown&&this._config.keyboard?t(this._element).on(Ne.KEYDOWN_DISMISS,(function(t){27===t.which&&(t.preventDefault(),e.hide())})):this._isShown||t(this._element).off(Ne.KEYDOWN_DISMISS)},i._setResizeEvent=function(){var e=this;this._isShown?t(window).on(Ne.RESIZE,(function(t){return e.handleUpdate(t)})):t(window).off(Ne.RESIZE)},i._hideModal=function(){var e=this;this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._isTransitioning=!1,this._showBackdrop((function(){t(document.body).removeClass(je),e._resetAdjustments(),e._resetScrollbar(),t(e._element).trigger(Ne.HIDDEN)}))},i._removeBackdrop=function(){this._backdrop&&(t(this._backdrop).remove(),this._backdrop=null)},i._showBackdrop=function(e){var i=this,r=t(this._element).hasClass(ze)?ze:"";if(this._isShown&&this._config.backdrop){if(this._backdrop=document.createElement("div"),this._backdrop.className=Oe,r&&this._backdrop.classList.add(r),t(this._backdrop).appendTo(document.body),t(this._element).on(Ne.CLICK_DISMISS,(function(e){i._ignoreBackdropClick?i._ignoreBackdropClick=!1:e.target===e.currentTarget&&("static"===i._config.backdrop?i._element.focus():i.hide())})),r&&c.reflow(this._backdrop),t(this._backdrop).addClass(Ve),!e)return;if(!r)return void e();var o=c.getTransitionDurationFromElement(this._backdrop);t(this._backdrop).one(c.TRANSITION_END,e).emulateTransitionEnd(o)}else if(!this._isShown&&this._backdrop){t(this._backdrop).removeClass(Ve);var s=function(){i._removeBackdrop(),e&&e()};if(t(this._element).hasClass(ze)){var n=c.getTransitionDurationFromElement(this._backdrop);t(this._backdrop).one(c.TRANSITION_END,s).emulateTransitionEnd(n)}else s()}else e&&e()},i._adjustDialog=function(){var e=this._element.scrollHeight>document.documentElement.clientHeight;!this._isBodyOverflowing&&e&&(this._element.style.paddingLeft=this._scrollbarWidth+"px"),this._isBodyOverflowing&&!e&&(this._element.style.paddingRight=this._scrollbarWidth+"px")},i._resetAdjustments=function(){this._element.style.paddingLeft="",this._element.style.paddingRight=""},i._checkScrollbar=function(){var e=document.body.getBoundingClientRect();this._isBodyOverflowing=e.left+e.right<window.innerWidth,this._scrollbarWidth=this._getScrollbarWidth()},i._setScrollbar=function(){var e=this;if(this._isBodyOverflowing){var i=[].slice.call(document.querySelectorAll(Ue.FIXED_CONTENT)),r=[].slice.call(document.querySelectorAll(Ue.STICKY_CONTENT));t(i).each((function(i,r){var o=r.style.paddingRight,s=t(r).css("padding-right");t(r).data("padding-right",o).css("padding-right",parseFloat(s)+e._scrollbarWidth+"px")})),t(r).each((function(i,r){var o=r.style.marginRight,s=t(r).css("margin-right");t(r).data("margin-right",o).css("margin-right",parseFloat(s)-e._scrollbarWidth+"px")}));var o=document.body.style.paddingRight,s=t(document.body).css("padding-right");t(document.body).data("padding-right",o).css("padding-right",parseFloat(s)+this._scrollbarWidth+"px")}t(document.body).addClass(je)},i._resetScrollbar=function(){var e=[].slice.call(document.querySelectorAll(Ue.FIXED_CONTENT));t(e).each((function(e,i){var r=t(i).data("padding-right");t(i).removeData("padding-right"),i.style.paddingRight=r||""}));var i=[].slice.call(document.querySelectorAll(""+Ue.STICKY_CONTENT));t(i).each((function(e,i){var r=t(i).data("margin-right");void 0!==r&&t(i).css("margin-right",r).removeData("margin-right")}));var r=t(document.body).data("padding-right");t(document.body).removeData("padding-right"),document.body.style.paddingRight=r||""},i._getScrollbarWidth=function(){var e=document.createElement("div");e.className=Be,document.body.appendChild(e);var t=e.getBoundingClientRect().width-e.clientWidth;return document.body.removeChild(e),t},e._jQueryInterface=function(i,r){return this.each((function(){var o=t(this).data("bs.modal"),s=n({},Re,t(this).data(),"object"==typeof i&&i?i:{});if(o||(o=new e(this,s),t(this).data("bs.modal",o)),"string"==typeof i){if(void 0===o[i])throw new TypeError('No method named "'+i+'"');o[i](r)}else s.show&&o.show(r)}))},o(e,null,[{key:"VERSION",get:function(){return"4.3.1"}},{key:"Default",get:function(){return Re}}]),e}();t(document).on(Ne.CLICK_DATA_API,Ue.DATA_TOGGLE,(function(e){var i,r=this,o=c.getSelectorFromElement(this);o&&(i=document.querySelector(o));var s=t(i).data("bs.modal")?"toggle":n({},t(i).data(),t(this).data());"A"!==this.tagName&&"AREA"!==this.tagName||e.preventDefault();var a=t(i).one(Ne.SHOW,(function(e){e.isDefaultPrevented()||a.one(Ne.HIDDEN,(function(){t(r).is(":visible")&&r.focus()}))}));He._jQueryInterface.call(t(i),s,this)})),t.fn.modal=He._jQueryInterface,t.fn.modal.Constructor=He,t.fn.modal.noConflict=function(){return t.fn.modal=Le,He._jQueryInterface};var Ge=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"],We={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},qe=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,Xe=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+/]+=*$/i;function Ye(e,t,i){if(0===e.length)return e;if(i&&"function"==typeof i)return i(e);for(var r=(new window.DOMParser).parseFromString(e,"text/html"),o=Object.keys(t),s=[].slice.call(r.body.querySelectorAll("*")),n=function(e,i){var r=s[e],n=r.nodeName.toLowerCase();if(-1===o.indexOf(r.nodeName.toLowerCase()))return r.parentNode.removeChild(r),"continue";var a=[].slice.call(r.attributes),l=[].concat(t["*"]||[],t[n]||[]);a.forEach((function(e){(function(e,t){var i=e.nodeName.toLowerCase();if(-1!==t.indexOf(i))return-1===Ge.indexOf(i)||Boolean(e.nodeValue.match(qe)||e.nodeValue.match(Xe));for(var r=t.filter((function(e){return e instanceof RegExp})),o=0,s=r.length;o<s;o++)if(i.match(r[o]))return!0;return!1})(e,l)||r.removeAttribute(e.nodeName)}))},a=0,l=s.length;a<l;a++)n(a);return r.body.innerHTML}var Ke="tooltip",$e=t.fn.tooltip,Qe=new RegExp("(^|\\s)bs-tooltip\\S+","g"),Ze=["sanitize","whiteList","sanitizeFn"],Je={animation:"boolean",template:"string",title:"(string|element|function)",trigger:"string",delay:"(number|object)",html:"boolean",selector:"(string|boolean)",placement:"(string|function)",offset:"(number|string|function)",container:"(string|element|boolean)",fallbackPlacement:"(string|array)",boundary:"(string|element)",sanitize:"boolean",sanitizeFn:"(null|function)",whiteList:"object"},et={AUTO:"auto",TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left"},tt={animation:!0,template:'<div class="tooltip" role="tooltip"><div class="arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,selector:!1,placement:"top",offset:0,container:!1,fallbackPlacement:"flip",boundary:"scrollParent",sanitize:!0,sanitizeFn:null,whiteList:We},it="show",rt="out",ot={HIDE:"hide.bs.tooltip",HIDDEN:"hidden.bs.tooltip",SHOW:"show.bs.tooltip",SHOWN:"shown.bs.tooltip",INSERTED:"inserted.bs.tooltip",CLICK:"click.bs.tooltip",FOCUSIN:"focusin.bs.tooltip",FOCUSOUT:"focusout.bs.tooltip",MOUSEENTER:"mouseenter.bs.tooltip",MOUSELEAVE:"mouseleave.bs.tooltip"},st="fade",nt="show",at=".tooltip-inner",lt=".arrow",ct="hover",ht="focus",dt="click",ut="manual",pt=function(){function e(e,t){if(void 0===i)throw new TypeError("Bootstrap's tooltips require Popper.js (https://popper.js.org/)");this._isEnabled=!0,this._timeout=0,this._hoverState="",this._activeTrigger={},this._popper=null,this.element=e,this.config=this._getConfig(t),this.tip=null,this._setListeners()}var r=e.prototype;return r.enable=function(){this._isEnabled=!0},r.disable=function(){this._isEnabled=!1},r.toggleEnabled=function(){this._isEnabled=!this._isEnabled},r.toggle=function(e){if(this._isEnabled)if(e){var i=this.constructor.DATA_KEY,r=t(e.currentTarget).data(i);r||(r=new this.constructor(e.currentTarget,this._getDelegateConfig()),t(e.currentTarget).data(i,r)),r._activeTrigger.click=!r._activeTrigger.click,r._isWithActiveTrigger()?r._enter(null,r):r._leave(null,r)}else{if(t(this.getTipElement()).hasClass(nt))return void this._leave(null,this);this._enter(null,this)}},r.dispose=function(){clearTimeout(this._timeout),t.removeData(this.element,this.constructor.DATA_KEY),t(this.element).off(this.constructor.EVENT_KEY),t(this.element).closest(".modal").off("hide.bs.modal"),this.tip&&t(this.tip).remove(),this._isEnabled=null,this._timeout=null,this._hoverState=null,this._activeTrigger=null,null!==this._popper&&this._popper.destroy(),this._popper=null,this.element=null,this.config=null,this.tip=null},r.show=function(){var e=this;if("none"===t(this.element).css("display"))throw new Error("Please use show on visible elements");var r=t.Event(this.constructor.Event.SHOW);if(this.isWithContent()&&this._isEnabled){t(this.element).trigger(r);var o=c.findShadowRoot(this.element),s=t.contains(null!==o?o:this.element.ownerDocument.documentElement,this.element);if(r.isDefaultPrevented()||!s)return;var n=this.getTipElement(),a=c.getUID(this.constructor.NAME);n.setAttribute("id",a),this.element.setAttribute("aria-describedby",a),this.setContent(),this.config.animation&&t(n).addClass(st);var l="function"==typeof this.config.placement?this.config.placement.call(this,n,this.element):this.config.placement,h=this._getAttachment(l);this.addAttachmentClass(h);var d=this._getContainer();t(n).data(this.constructor.DATA_KEY,this),t.contains(this.element.ownerDocument.documentElement,this.tip)||t(n).appendTo(d),t(this.element).trigger(this.constructor.Event.INSERTED),this._popper=new i(this.element,n,{placement:h,modifiers:{offset:this._getOffset(),flip:{behavior:this.config.fallbackPlacement},arrow:{element:lt},preventOverflow:{boundariesElement:this.config.boundary}},onCreate:function(t){t.originalPlacement!==t.placement&&e._handlePopperPlacementChange(t)},onUpdate:function(t){return e._handlePopperPlacementChange(t)}}),t(n).addClass(nt),"ontouchstart"in document.documentElement&&t(document.body).children().on("mouseover",null,t.noop);var u=function(){e.config.animation&&e._fixTransition();var i=e._hoverState;e._hoverState=null,t(e.element).trigger(e.constructor.Event.SHOWN),i===rt&&e._leave(null,e)};if(t(this.tip).hasClass(st)){var p=c.getTransitionDurationFromElement(this.tip);t(this.tip).one(c.TRANSITION_END,u).emulateTransitionEnd(p)}else u()}},r.hide=function(e){var i=this,r=this.getTipElement(),o=t.Event(this.constructor.Event.HIDE),s=function(){i._hoverState!==it&&r.parentNode&&r.parentNode.removeChild(r),i._cleanTipClass(),i.element.removeAttribute("aria-describedby"),t(i.element).trigger(i.constructor.Event.HIDDEN),null!==i._popper&&i._popper.destroy(),e&&e()};if(t(this.element).trigger(o),!o.isDefaultPrevented()){if(t(r).removeClass(nt),"ontouchstart"in document.documentElement&&t(document.body).children().off("mouseover",null,t.noop),this._activeTrigger[dt]=!1,this._activeTrigger[ht]=!1,this._activeTrigger[ct]=!1,t(this.tip).hasClass(st)){var n=c.getTransitionDurationFromElement(r);t(r).one(c.TRANSITION_END,s).emulateTransitionEnd(n)}else s();this._hoverState=""}},r.update=function(){null!==this._popper&&this._popper.scheduleUpdate()},r.isWithContent=function(){return Boolean(this.getTitle())},r.addAttachmentClass=function(e){t(this.getTipElement()).addClass("bs-tooltip-"+e)},r.getTipElement=function(){return this.tip=this.tip||t(this.config.template)[0],this.tip},r.setContent=function(){var e=this.getTipElement();this.setElementContent(t(e.querySelectorAll(at)),this.getTitle()),t(e).removeClass(st+" "+nt)},r.setElementContent=function(e,i){"object"!=typeof i||!i.nodeType&&!i.jquery?this.config.html?(this.config.sanitize&&(i=Ye(i,this.config.whiteList,this.config.sanitizeFn)),e.html(i)):e.text(i):this.config.html?t(i).parent().is(e)||e.empty().append(i):e.text(t(i).text())},r.getTitle=function(){var e=this.element.getAttribute("data-original-title");return e||(e="function"==typeof this.config.title?this.config.title.call(this.element):this.config.title),e},r._getOffset=function(){var e=this,t={};return"function"==typeof this.config.offset?t.fn=function(t){return t.offsets=n({},t.offsets,e.config.offset(t.offsets,e.element)||{}),t}:t.offset=this.config.offset,t},r._getContainer=function(){return!1===this.config.container?document.body:c.isElement(this.config.container)?t(this.config.container):t(document).find(this.config.container)},r._getAttachment=function(e){return et[e.toUpperCase()]},r._setListeners=function(){var e=this;this.config.trigger.split(" ").forEach((function(i){if("click"===i)t(e.element).on(e.constructor.Event.CLICK,e.config.selector,(function(t){return e.toggle(t)}));else if(i!==ut){var r=i===ct?e.constructor.Event.MOUSEENTER:e.constructor.Event.FOCUSIN,o=i===ct?e.constructor.Event.MOUSELEAVE:e.constructor.Event.FOCUSOUT;t(e.element).on(r,e.config.selector,(function(t){return e._enter(t)})).on(o,e.config.selector,(function(t){return e._leave(t)}))}})),t(this.element).closest(".modal").on("hide.bs.modal",(function(){e.element&&e.hide()})),this.config.selector?this.config=n({},this.config,{trigger:"manual",selector:""}):this._fixTitle()},r._fixTitle=function(){var e=typeof this.element.getAttribute("data-original-title");(this.element.getAttribute("title")||"string"!==e)&&(this.element.setAttribute("data-original-title",this.element.getAttribute("title")||""),this.element.setAttribute("title",""))},r._enter=function(e,i){var r=this.constructor.DATA_KEY;(i=i||t(e.currentTarget).data(r))||(i=new this.constructor(e.currentTarget,this._getDelegateConfig()),t(e.currentTarget).data(r,i)),e&&(i._activeTrigger["focusin"===e.type?ht:ct]=!0),t(i.getTipElement()).hasClass(nt)||i._hoverState===it?i._hoverState=it:(clearTimeout(i._timeout),i._hoverState=it,i.config.delay&&i.config.delay.show?i._timeout=setTimeout((function(){i._hoverState===it&&i.show()}),i.config.delay.show):i.show())},r._leave=function(e,i){var r=this.constructor.DATA_KEY;(i=i||t(e.currentTarget).data(r))||(i=new this.constructor(e.currentTarget,this._getDelegateConfig()),t(e.currentTarget).data(r,i)),e&&(i._activeTrigger["focusout"===e.type?ht:ct]=!1),i._isWithActiveTrigger()||(clearTimeout(i._timeout),i._hoverState=rt,i.config.delay&&i.config.delay.hide?i._timeout=setTimeout((function(){i._hoverState===rt&&i.hide()}),i.config.delay.hide):i.hide())},r._isWithActiveTrigger=function(){for(var e in this._activeTrigger)if(this._activeTrigger[e])return!0;return!1},r._getConfig=function(e){var i=t(this.element).data();return Object.keys(i).forEach((function(e){-1!==Ze.indexOf(e)&&delete i[e]})),"number"==typeof(e=n({},this.constructor.Default,i,"object"==typeof e&&e?e:{})).delay&&(e.delay={show:e.delay,hide:e.delay}),"number"==typeof e.title&&(e.title=e.title.toString()),"number"==typeof e.content&&(e.content=e.content.toString()),c.typeCheckConfig(Ke,e,this.constructor.DefaultType),e.sanitize&&(e.template=Ye(e.template,e.whiteList,e.sanitizeFn)),e},r._getDelegateConfig=function(){var e={};if(this.config)for(var t in this.config)this.constructor.Default[t]!==this.config[t]&&(e[t]=this.config[t]);return e},r._cleanTipClass=function(){var e=t(this.getTipElement()),i=e.attr("class").match(Qe);null!==i&&i.length&&e.removeClass(i.join(""))},r._handlePopperPlacementChange=function(e){var t=e.instance;this.tip=t.popper,this._cleanTipClass(),this.addAttachmentClass(this._getAttachment(e.placement))},r._fixTransition=function(){var e=this.getTipElement(),i=this.config.animation;null===e.getAttribute("x-placement")&&(t(e).removeClass(st),this.config.animation=!1,this.hide(),this.show(),this.config.animation=i)},e._jQueryInterface=function(i){return this.each((function(){var r=t(this).data("bs.tooltip"),o="object"==typeof i&&i;if((r||!/dispose|hide/.test(i))&&(r||(r=new e(this,o),t(this).data("bs.tooltip",r)),"string"==typeof i)){if(void 0===r[i])throw new TypeError('No method named "'+i+'"');r[i]()}}))},o(e,null,[{key:"VERSION",get:function(){return"4.3.1"}},{key:"Default",get:function(){return tt}},{key:"NAME",get:function(){return Ke}},{key:"DATA_KEY",get:function(){return"bs.tooltip"}},{key:"Event",get:function(){return ot}},{key:"EVENT_KEY",get:function(){return".bs.tooltip"}},{key:"DefaultType",get:function(){return Je}}]),e}();t.fn.tooltip=pt._jQueryInterface,t.fn.tooltip.Constructor=pt,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=$e,pt._jQueryInterface};var mt="popover",ft=t.fn.popover,gt=new RegExp("(^|\\s)bs-popover\\S+","g"),bt=n({},pt.Default,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'}),_t=n({},pt.DefaultType,{content:"(string|element|function)"}),vt="fade",xt="show",yt=".popover-header",wt=".popover-body",Mt={HIDE:"hide.bs.popover",HIDDEN:"hidden.bs.popover",SHOW:"show.bs.popover",SHOWN:"shown.bs.popover",INSERTED:"inserted.bs.popover",CLICK:"click.bs.popover",FOCUSIN:"focusin.bs.popover",FOCUSOUT:"focusout.bs.popover",MOUSEENTER:"mouseenter.bs.popover",MOUSELEAVE:"mouseleave.bs.popover"},kt=function(e){var i,r;function s(){return e.apply(this,arguments)||this}r=e,(i=s).prototype=Object.create(r.prototype),i.prototype.constructor=i,i.__proto__=r;var n=s.prototype;return n.isWithContent=function(){return this.getTitle()||this._getContent()},n.addAttachmentClass=function(e){t(this.getTipElement()).addClass("bs-popover-"+e)},n.getTipElement=function(){return this.tip=this.tip||t(this.config.template)[0],this.tip},n.setContent=function(){var e=t(this.getTipElement());this.setElementContent(e.find(yt),this.getTitle());var i=this._getContent();"function"==typeof i&&(i=i.call(this.element)),this.setElementContent(e.find(wt),i),e.removeClass(vt+" "+xt)},n._getContent=function(){return this.element.getAttribute("data-content")||this.config.content},n._cleanTipClass=function(){var e=t(this.getTipElement()),i=e.attr("class").match(gt);null!==i&&i.length>0&&e.removeClass(i.join(""))},s._jQueryInterface=function(e){return this.each((function(){var i=t(this).data("bs.popover"),r="object"==typeof e?e:null;if((i||!/dispose|hide/.test(e))&&(i||(i=new s(this,r),t(this).data("bs.popover",i)),"string"==typeof e)){if(void 0===i[e])throw new TypeError('No method named "'+e+'"');i[e]()}}))},o(s,null,[{key:"VERSION",get:function(){return"4.3.1"}},{key:"Default",get:function(){return bt}},{key:"NAME",get:function(){return mt}},{key:"DATA_KEY",get:function(){return"bs.popover"}},{key:"Event",get:function(){return Mt}},{key:"EVENT_KEY",get:function(){return".bs.popover"}},{key:"DefaultType",get:function(){return _t}}]),s}(pt);t.fn.popover=kt._jQueryInterface,t.fn.popover.Constructor=kt,t.fn.popover.noConflict=function(){return t.fn.popover=ft,kt._jQueryInterface};var Pt="scrollspy",Et=t.fn[Pt],At={offset:10,method:"auto",target:""},Ct={offset:"number",method:"string",target:"(string|element)"},Tt={ACTIVATE:"activate.bs.scrollspy",SCROLL:"scroll.bs.scrollspy",LOAD_DATA_API:"load.bs.scrollspy.data-api"},Dt="dropdown-item",St="active",Lt={DATA_SPY:'[data-spy="scroll"]',ACTIVE:".active",NAV_LIST_GROUP:".nav, .list-group",NAV_LINKS:".nav-link",NAV_ITEMS:".nav-item",LIST_ITEMS:".list-group-item",DROPDOWN:".dropdown",DROPDOWN_ITEMS:".dropdown-item",DROPDOWN_TOGGLE:".dropdown-toggle"},Rt="offset",It="position",Nt=function(){function e(e,i){var r=this;this._element=e,this._scrollElement="BODY"===e.tagName?window:e,this._config=this._getConfig(i),this._selector=this._config.target+" "+Lt.NAV_LINKS+","+this._config.target+" "+Lt.LIST_ITEMS+","+this._config.target+" "+Lt.DROPDOWN_ITEMS,this._offsets=[],this._targets=[],this._activeTarget=null,this._scrollHeight=0,t(this._scrollElement).on(Tt.SCROLL,(function(e){return r._process(e)})),this.refresh(),this._process()}var i=e.prototype;return i.refresh=function(){var e=this,i=this._scrollElement===this._scrollElement.window?Rt:It,r="auto"===this._config.method?i:this._config.method,o=r===It?this._getScrollTop():0;this._offsets=[],this._targets=[],this._scrollHeight=this._getScrollHeight(),[].slice.call(document.querySelectorAll(this._selector)).map((function(e){var i,s=c.getSelectorFromElement(e);if(s&&(i=document.querySelector(s)),i){var n=i.getBoundingClientRect();if(n.width||n.height)return[t(i)[r]().top+o,s]}return null})).filter((function(e){return e})).sort((function(e,t){return e[0]-t[0]})).forEach((function(t){e._offsets.push(t[0]),e._targets.push(t[1])}))},i.dispose=function(){t.removeData(this._element,"bs.scrollspy"),t(this._scrollElement).off(".bs.scrollspy"),this._element=null,this._scrollElement=null,this._config=null,this._selector=null,this._offsets=null,this._targets=null,this._activeTarget=null,this._scrollHeight=null},i._getConfig=function(e){if("string"!=typeof(e=n({},At,"object"==typeof e&&e?e:{})).target){var i=t(e.target).attr("id");i||(i=c.getUID(Pt),t(e.target).attr("id",i)),e.target="#"+i}return c.typeCheckConfig(Pt,e,Ct),e},i._getScrollTop=function(){return this._scrollElement===window?this._scrollElement.pageYOffset:this._scrollElement.scrollTop},i._getScrollHeight=function(){return this._scrollElement.scrollHeight||Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)},i._getOffsetHeight=function(){return this._scrollElement===window?window.innerHeight:this._scrollElement.getBoundingClientRect().height},i._process=function(){var e=this._getScrollTop()+this._config.offset,t=this._getScrollHeight(),i=this._config.offset+t-this._getOffsetHeight();if(this._scrollHeight!==t&&this.refresh(),e>=i){var r=this._targets[this._targets.length-1];this._activeTarget!==r&&this._activate(r)}else{if(this._activeTarget&&e<this._offsets[0]&&this._offsets[0]>0)return this._activeTarget=null,void this._clear();for(var o=this._offsets.length;o--;)this._activeTarget!==this._targets[o]&&e>=this._offsets[o]&&(void 0===this._offsets[o+1]||e<this._offsets[o+1])&&this._activate(this._targets[o])}},i._activate=function(e){this._activeTarget=e,this._clear();var i=this._selector.split(",").map((function(t){return t+'[data-target="'+e+'"],'+t+'[href="'+e+'"]'})),r=t([].slice.call(document.querySelectorAll(i.join(","))));r.hasClass(Dt)?(r.closest(Lt.DROPDOWN).find(Lt.DROPDOWN_TOGGLE).addClass(St),r.addClass(St)):(r.addClass(St),r.parents(Lt.NAV_LIST_GROUP).prev(Lt.NAV_LINKS+", "+Lt.LIST_ITEMS).addClass(St),r.parents(Lt.NAV_LIST_GROUP).prev(Lt.NAV_ITEMS).children(Lt.NAV_LINKS).addClass(St)),t(this._scrollElement).trigger(Tt.ACTIVATE,{relatedTarget:e})},i._clear=function(){[].slice.call(document.querySelectorAll(this._selector)).filter((function(e){return e.classList.contains(St)})).forEach((function(e){return e.classList.remove(St)}))},e._jQueryInterface=function(i){return this.each((function(){var r=t(this).data("bs.scrollspy");if(r||(r=new e(this,"object"==typeof i&&i),t(this).data("bs.scrollspy",r)),"string"==typeof i){if(void 0===r[i])throw new TypeError('No method named "'+i+'"');r[i]()}}))},o(e,null,[{key:"VERSION",get:function(){return"4.3.1"}},{key:"Default",get:function(){return At}}]),e}();t(window).on(Tt.LOAD_DATA_API,(function(){for(var e=[].slice.call(document.querySelectorAll(Lt.DATA_SPY)),i=e.length;i--;){var r=t(e[i]);Nt._jQueryInterface.call(r,r.data())}})),t.fn[Pt]=Nt._jQueryInterface,t.fn[Pt].Constructor=Nt,t.fn[Pt].noConflict=function(){return t.fn[Pt]=Et,Nt._jQueryInterface};var Ft=t.fn.tab,Bt={HIDE:"hide.bs.tab",HIDDEN:"hidden.bs.tab",SHOW:"show.bs.tab",SHOWN:"shown.bs.tab",CLICK_DATA_API:"click.bs.tab.data-api"},Ot="dropdown-menu",jt="active",zt="disabled",Vt="fade",Ut="show",Ht=".dropdown",Gt=".nav, .list-group",Wt=".active",qt="> li > .active",Xt='[data-toggle="tab"], [data-toggle="pill"], [data-toggle="list"]',Yt=".dropdown-toggle",Kt="> .dropdown-menu .active",$t=function(){function e(e){this._element=e}var i=e.prototype;return i.show=function(){var e=this;if(!(this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE&&t(this._element).hasClass(jt)||t(this._element).hasClass(zt))){var i,r,o=t(this._element).closest(Gt)[0],s=c.getSelectorFromElement(this._element);if(o){var n="UL"===o.nodeName||"OL"===o.nodeName?qt:Wt;r=(r=t.makeArray(t(o).find(n)))[r.length-1]}var a=t.Event(Bt.HIDE,{relatedTarget:this._element}),l=t.Event(Bt.SHOW,{relatedTarget:r});if(r&&t(r).trigger(a),t(this._element).trigger(l),!l.isDefaultPrevented()&&!a.isDefaultPrevented()){s&&(i=document.querySelector(s)),this._activate(this._element,o);var h=function(){var i=t.Event(Bt.HIDDEN,{relatedTarget:e._element}),o=t.Event(Bt.SHOWN,{relatedTarget:r});t(r).trigger(i),t(e._element).trigger(o)};i?this._activate(i,i.parentNode,h):h()}}},i.dispose=function(){t.removeData(this._element,"bs.tab"),this._element=null},i._activate=function(e,i,r){var o=this,s=(!i||"UL"!==i.nodeName&&"OL"!==i.nodeName?t(i).children(Wt):t(i).find(qt))[0],n=r&&s&&t(s).hasClass(Vt),a=function(){return o._transitionComplete(e,s,r)};if(s&&n){var l=c.getTransitionDurationFromElement(s);t(s).removeClass(Ut).one(c.TRANSITION_END,a).emulateTransitionEnd(l)}else a()},i._transitionComplete=function(e,i,r){if(i){t(i).removeClass(jt);var o=t(i.parentNode).find(Kt)[0];o&&t(o).removeClass(jt),"tab"===i.getAttribute("role")&&i.setAttribute("aria-selected",!1)}if(t(e).addClass(jt),"tab"===e.getAttribute("role")&&e.setAttribute("aria-selected",!0),c.reflow(e),e.classList.contains(Vt)&&e.classList.add(Ut),e.parentNode&&t(e.parentNode).hasClass(Ot)){var s=t(e).closest(Ht)[0];if(s){var n=[].slice.call(s.querySelectorAll(Yt));t(n).addClass(jt)}e.setAttribute("aria-expanded",!0)}r&&r()},e._jQueryInterface=function(i){return this.each((function(){var r=t(this),o=r.data("bs.tab");if(o||(o=new e(this),r.data("bs.tab",o)),"string"==typeof i){if(void 0===o[i])throw new TypeError('No method named "'+i+'"');o[i]()}}))},o(e,null,[{key:"VERSION",get:function(){return"4.3.1"}}]),e}();t(document).on(Bt.CLICK_DATA_API,Xt,(function(e){e.preventDefault(),$t._jQueryInterface.call(t(this),"show")})),t.fn.tab=$t._jQueryInterface,t.fn.tab.Constructor=$t,t.fn.tab.noConflict=function(){return t.fn.tab=Ft,$t._jQueryInterface};var Qt=t.fn.toast,Zt={CLICK_DISMISS:"click.dismiss.bs.toast",HIDE:"hide.bs.toast",HIDDEN:"hidden.bs.toast",SHOW:"show.bs.toast",SHOWN:"shown.bs.toast"},Jt="fade",ei="hide",ti="show",ii="showing",ri={animation:"boolean",autohide:"boolean",delay:"number"},oi={animation:!0,autohide:!0,delay:500},si='[data-dismiss="toast"]',ni=function(){function e(e,t){this._element=e,this._config=this._getConfig(t),this._timeout=null,this._setListeners()}var i=e.prototype;return i.show=function(){var e=this;t(this._element).trigger(Zt.SHOW),this._config.animation&&this._element.classList.add(Jt);var i=function(){e._element.classList.remove(ii),e._element.classList.add(ti),t(e._element).trigger(Zt.SHOWN),e._config.autohide&&e.hide()};if(this._element.classList.remove(ei),this._element.classList.add(ii),this._config.animation){var r=c.getTransitionDurationFromElement(this._element);t(this._element).one(c.TRANSITION_END,i).emulateTransitionEnd(r)}else i()},i.hide=function(e){var i=this;this._element.classList.contains(ti)&&(t(this._element).trigger(Zt.HIDE),e?this._close():this._timeout=setTimeout((function(){i._close()}),this._config.delay))},i.dispose=function(){clearTimeout(this._timeout),this._timeout=null,this._element.classList.contains(ti)&&this._element.classList.remove(ti),t(this._element).off(Zt.CLICK_DISMISS),t.removeData(this._element,"bs.toast"),this._element=null,this._config=null},i._getConfig=function(e){return e=n({},oi,t(this._element).data(),"object"==typeof e&&e?e:{}),c.typeCheckConfig("toast",e,this.constructor.DefaultType),e},i._setListeners=function(){var e=this;t(this._element).on(Zt.CLICK_DISMISS,si,(function(){return e.hide(!0)}))},i._close=function(){var e=this,i=function(){e._element.classList.add(ei),t(e._element).trigger(Zt.HIDDEN)};if(this._element.classList.remove(ti),this._config.animation){var r=c.getTransitionDurationFromElement(this._element);t(this._element).one(c.TRANSITION_END,i).emulateTransitionEnd(r)}else i()},e._jQueryInterface=function(i){return this.each((function(){var r=t(this),o=r.data("bs.toast");if(o||(o=new e(this,"object"==typeof i&&i),r.data("bs.toast",o)),"string"==typeof i){if(void 0===o[i])throw new TypeError('No method named "'+i+'"');o[i](this)}}))},o(e,null,[{key:"VERSION",get:function(){return"4.3.1"}},{key:"DefaultType",get:function(){return ri}},{key:"Default",get:function(){return oi}}]),e}();t.fn.toast=ni._jQueryInterface,t.fn.toast.Constructor=ni,t.fn.toast.noConflict=function(){return t.fn.toast=Qt,ni._jQueryInterface},function(){if(void 0===t)throw new TypeError("Bootstrap's JavaScript requires jQuery. jQuery must be included before Bootstrap's JavaScript.");var e=t.fn.jquery.split(" ")[0].split(".");if(e[0]<2&&e[1]<9||1===e[0]&&9===e[1]&&e[2]<1||e[0]>=4)throw new Error("Bootstrap's JavaScript requires at least jQuery v1.9.1 but less than v4.0.0")}(),e.Util=c,e.Alert=f,e.Button=E,e.Carousel=X,e.Collapse=ne,e.Dropdown=Se,e.Modal=He,e.Popover=kt,e.Scrollspy=Nt,e.Tab=$t,e.Toast=ni,e.Tooltip=pt,Object.defineProperty(e,"__esModule",{value:!0})}(t,i(2),i(3))},function(e,t,i){var r;
/*!
 * jQuery JavaScript Library v3.4.1
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2019-05-01T21:04Z
 */!function(t,i){"use strict";"object"==typeof e.exports?e.exports=t.document?i(t,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return i(e)}:i(t)}("undefined"!=typeof window?window:this,(function(i,o){"use strict";var s=[],n=i.document,a=Object.getPrototypeOf,l=s.slice,c=s.concat,h=s.push,d=s.indexOf,u={},p=u.toString,m=u.hasOwnProperty,f=m.toString,g=f.call(Object),b={},_=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},v=function(e){return null!=e&&e===e.window},x={type:!0,src:!0,nonce:!0,noModule:!0};function y(e,t,i){var r,o,s=(i=i||n).createElement("script");if(s.text=e,t)for(r in x)(o=t[r]||t.getAttribute&&t.getAttribute(r))&&s.setAttribute(r,o);i.head.appendChild(s).parentNode.removeChild(s)}function w(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?u[p.call(e)]||"object":typeof e}var M=function(e,t){return new M.fn.init(e,t)},k=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function P(e){var t=!!e&&"length"in e&&e.length,i=w(e);return!_(e)&&!v(e)&&("array"===i||0===t||"number"==typeof t&&t>0&&t-1 in e)}M.fn=M.prototype={jquery:"3.4.1",constructor:M,length:0,toArray:function(){return l.call(this)},get:function(e){return null==e?l.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=M.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return M.each(this,e)},map:function(e){return this.pushStack(M.map(this,(function(t,i){return e.call(t,i,t)})))},slice:function(){return this.pushStack(l.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(e<0?t:0);return this.pushStack(i>=0&&i<t?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:h,sort:s.sort,splice:s.splice},M.extend=M.fn.extend=function(){var e,t,i,r,o,s,n=arguments[0]||{},a=1,l=arguments.length,c=!1;for("boolean"==typeof n&&(c=n,n=arguments[a]||{},a++),"object"==typeof n||_(n)||(n={}),a===l&&(n=this,a--);a<l;a++)if(null!=(e=arguments[a]))for(t in e)r=e[t],"__proto__"!==t&&n!==r&&(c&&r&&(M.isPlainObject(r)||(o=Array.isArray(r)))?(i=n[t],s=o&&!Array.isArray(i)?[]:o||M.isPlainObject(i)?i:{},o=!1,n[t]=M.extend(c,s,r)):void 0!==r&&(n[t]=r));return n},M.extend({expando:"jQuery"+("3.4.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,i;return!(!e||"[object Object]"!==p.call(e))&&(!(t=a(e))||"function"==typeof(i=m.call(t,"constructor")&&t.constructor)&&f.call(i)===g)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t){y(e,{nonce:t&&t.nonce})},each:function(e,t){var i,r=0;if(P(e))for(i=e.length;r<i&&!1!==t.call(e[r],r,e[r]);r++);else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},trim:function(e){return null==e?"":(e+"").replace(k,"")},makeArray:function(e,t){var i=t||[];return null!=e&&(P(Object(e))?M.merge(i,"string"==typeof e?[e]:e):h.call(i,e)),i},inArray:function(e,t,i){return null==t?-1:d.call(t,e,i)},merge:function(e,t){for(var i=+t.length,r=0,o=e.length;r<i;r++)e[o++]=t[r];return e.length=o,e},grep:function(e,t,i){for(var r=[],o=0,s=e.length,n=!i;o<s;o++)!t(e[o],o)!==n&&r.push(e[o]);return r},map:function(e,t,i){var r,o,s=0,n=[];if(P(e))for(r=e.length;s<r;s++)null!=(o=t(e[s],s,i))&&n.push(o);else for(s in e)null!=(o=t(e[s],s,i))&&n.push(o);return c.apply([],n)},guid:1,support:b}),"function"==typeof Symbol&&(M.fn[Symbol.iterator]=s[Symbol.iterator]),M.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(e,t){u["[object "+t+"]"]=t.toLowerCase()}));var E=
/*!
 * Sizzle CSS Selector Engine v2.3.4
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://js.foundation/
 *
 * Date: 2019-04-08
 */
function(e){var t,i,r,o,s,n,a,l,c,h,d,u,p,m,f,g,b,_,v,x="sizzle"+1*new Date,y=e.document,w=0,M=0,k=le(),P=le(),E=le(),A=le(),C=function(e,t){return e===t&&(d=!0),0},T={}.hasOwnProperty,D=[],S=D.pop,L=D.push,R=D.push,I=D.slice,N=function(e,t){for(var i=0,r=e.length;i<r;i++)if(e[i]===t)return i;return-1},F="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",B="[\\x20\\t\\r\\n\\f]",O="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",j="\\["+B+"*("+O+")(?:"+B+"*([*^$|!~]?=)"+B+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+O+"))|)"+B+"*\\]",z=":("+O+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+j+")*)|.*)\\)|)",V=new RegExp(B+"+","g"),U=new RegExp("^"+B+"+|((?:^|[^\\\\])(?:\\\\.)*)"+B+"+$","g"),H=new RegExp("^"+B+"*,"+B+"*"),G=new RegExp("^"+B+"*([>+~]|"+B+")"+B+"*"),W=new RegExp(B+"|>"),q=new RegExp(z),X=new RegExp("^"+O+"$"),Y={ID:new RegExp("^#("+O+")"),CLASS:new RegExp("^\\.("+O+")"),TAG:new RegExp("^("+O+"|[*])"),ATTR:new RegExp("^"+j),PSEUDO:new RegExp("^"+z),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+B+"*(even|odd|(([+-]|)(\\d*)n|)"+B+"*(?:([+-]|)"+B+"*(\\d+)|))"+B+"*\\)|)","i"),bool:new RegExp("^(?:"+F+")$","i"),needsContext:new RegExp("^"+B+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+B+"*((?:-\\d)?\\d*)"+B+"*\\)|)(?=[^-]|$)","i")},K=/HTML$/i,$=/^(?:input|select|textarea|button)$/i,Q=/^h\d$/i,Z=/^[^{]+\{\s*\[native \w/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp("\\\\([\\da-f]{1,6}"+B+"?|("+B+")|.)","ig"),ie=function(e,t,i){var r="0x"+t-65536;return r!=r||i?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)},re=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,oe=function(e,t){return t?"\0"===e?"":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},se=function(){u()},ne=xe((function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{R.apply(D=I.call(y.childNodes),y.childNodes),D[y.childNodes.length].nodeType}catch(e){R={apply:D.length?function(e,t){L.apply(e,I.call(t))}:function(e,t){for(var i=e.length,r=0;e[i++]=t[r++];);e.length=i-1}}}function ae(e,t,r,o){var s,a,c,h,d,m,b,_=t&&t.ownerDocument,w=t?t.nodeType:9;if(r=r||[],"string"!=typeof e||!e||1!==w&&9!==w&&11!==w)return r;if(!o&&((t?t.ownerDocument||t:y)!==p&&u(t),t=t||p,f)){if(11!==w&&(d=J.exec(e)))if(s=d[1]){if(9===w){if(!(c=t.getElementById(s)))return r;if(c.id===s)return r.push(c),r}else if(_&&(c=_.getElementById(s))&&v(t,c)&&c.id===s)return r.push(c),r}else{if(d[2])return R.apply(r,t.getElementsByTagName(e)),r;if((s=d[3])&&i.getElementsByClassName&&t.getElementsByClassName)return R.apply(r,t.getElementsByClassName(s)),r}if(i.qsa&&!A[e+" "]&&(!g||!g.test(e))&&(1!==w||"object"!==t.nodeName.toLowerCase())){if(b=e,_=t,1===w&&W.test(e)){for((h=t.getAttribute("id"))?h=h.replace(re,oe):t.setAttribute("id",h=x),a=(m=n(e)).length;a--;)m[a]="#"+h+" "+ve(m[a]);b=m.join(","),_=ee.test(e)&&be(t.parentNode)||t}try{return R.apply(r,_.querySelectorAll(b)),r}catch(t){A(e,!0)}finally{h===x&&t.removeAttribute("id")}}}return l(e.replace(U,"$1"),t,r,o)}function le(){var e=[];return function t(i,o){return e.push(i+" ")>r.cacheLength&&delete t[e.shift()],t[i+" "]=o}}function ce(e){return e[x]=!0,e}function he(e){var t=p.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function de(e,t){for(var i=e.split("|"),o=i.length;o--;)r.attrHandle[i[o]]=t}function ue(e,t){var i=t&&e,r=i&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function pe(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function me(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function fe(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&ne(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function ge(e){return ce((function(t){return t=+t,ce((function(i,r){for(var o,s=e([],i.length,t),n=s.length;n--;)i[o=s[n]]&&(i[o]=!(r[o]=i[o]))}))}))}function be(e){return e&&void 0!==e.getElementsByTagName&&e}for(t in i=ae.support={},s=ae.isXML=function(e){var t=e.namespaceURI,i=(e.ownerDocument||e).documentElement;return!K.test(t||i&&i.nodeName||"HTML")},u=ae.setDocument=function(e){var t,o,n=e?e.ownerDocument||e:y;return n!==p&&9===n.nodeType&&n.documentElement?(m=(p=n).documentElement,f=!s(p),y!==p&&(o=p.defaultView)&&o.top!==o&&(o.addEventListener?o.addEventListener("unload",se,!1):o.attachEvent&&o.attachEvent("onunload",se)),i.attributes=he((function(e){return e.className="i",!e.getAttribute("className")})),i.getElementsByTagName=he((function(e){return e.appendChild(p.createComment("")),!e.getElementsByTagName("*").length})),i.getElementsByClassName=Z.test(p.getElementsByClassName),i.getById=he((function(e){return m.appendChild(e).id=x,!p.getElementsByName||!p.getElementsByName(x).length})),i.getById?(r.filter.ID=function(e){var t=e.replace(te,ie);return function(e){return e.getAttribute("id")===t}},r.find.ID=function(e,t){if(void 0!==t.getElementById&&f){var i=t.getElementById(e);return i?[i]:[]}}):(r.filter.ID=function(e){var t=e.replace(te,ie);return function(e){var i=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return i&&i.value===t}},r.find.ID=function(e,t){if(void 0!==t.getElementById&&f){var i,r,o,s=t.getElementById(e);if(s){if((i=s.getAttributeNode("id"))&&i.value===e)return[s];for(o=t.getElementsByName(e),r=0;s=o[r++];)if((i=s.getAttributeNode("id"))&&i.value===e)return[s]}return[]}}),r.find.TAG=i.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):i.qsa?t.querySelectorAll(e):void 0}:function(e,t){var i,r=[],o=0,s=t.getElementsByTagName(e);if("*"===e){for(;i=s[o++];)1===i.nodeType&&r.push(i);return r}return s},r.find.CLASS=i.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&f)return t.getElementsByClassName(e)},b=[],g=[],(i.qsa=Z.test(p.querySelectorAll))&&(he((function(e){m.appendChild(e).innerHTML="<a id='"+x+"'></a><select id='"+x+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&g.push("[*^$]="+B+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||g.push("\\["+B+"*(?:value|"+F+")"),e.querySelectorAll("[id~="+x+"-]").length||g.push("~="),e.querySelectorAll(":checked").length||g.push(":checked"),e.querySelectorAll("a#"+x+"+*").length||g.push(".#.+[+~]")})),he((function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=p.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&g.push("name"+B+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&g.push(":enabled",":disabled"),m.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&g.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),g.push(",.*:")}))),(i.matchesSelector=Z.test(_=m.matches||m.webkitMatchesSelector||m.mozMatchesSelector||m.oMatchesSelector||m.msMatchesSelector))&&he((function(e){i.disconnectedMatch=_.call(e,"*"),_.call(e,"[s!='']:x"),b.push("!=",z)})),g=g.length&&new RegExp(g.join("|")),b=b.length&&new RegExp(b.join("|")),t=Z.test(m.compareDocumentPosition),v=t||Z.test(m.contains)?function(e,t){var i=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(i.contains?i.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},C=t?function(e,t){if(e===t)return d=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r||(1&(r=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!i.sortDetached&&t.compareDocumentPosition(e)===r?e===p||e.ownerDocument===y&&v(y,e)?-1:t===p||t.ownerDocument===y&&v(y,t)?1:h?N(h,e)-N(h,t):0:4&r?-1:1)}:function(e,t){if(e===t)return d=!0,0;var i,r=0,o=e.parentNode,s=t.parentNode,n=[e],a=[t];if(!o||!s)return e===p?-1:t===p?1:o?-1:s?1:h?N(h,e)-N(h,t):0;if(o===s)return ue(e,t);for(i=e;i=i.parentNode;)n.unshift(i);for(i=t;i=i.parentNode;)a.unshift(i);for(;n[r]===a[r];)r++;return r?ue(n[r],a[r]):n[r]===y?-1:a[r]===y?1:0},p):p},ae.matches=function(e,t){return ae(e,null,null,t)},ae.matchesSelector=function(e,t){if((e.ownerDocument||e)!==p&&u(e),i.matchesSelector&&f&&!A[t+" "]&&(!b||!b.test(t))&&(!g||!g.test(t)))try{var r=_.call(e,t);if(r||i.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(e){A(t,!0)}return ae(t,p,null,[e]).length>0},ae.contains=function(e,t){return(e.ownerDocument||e)!==p&&u(e),v(e,t)},ae.attr=function(e,t){(e.ownerDocument||e)!==p&&u(e);var o=r.attrHandle[t.toLowerCase()],s=o&&T.call(r.attrHandle,t.toLowerCase())?o(e,t,!f):void 0;return void 0!==s?s:i.attributes||!f?e.getAttribute(t):(s=e.getAttributeNode(t))&&s.specified?s.value:null},ae.escape=function(e){return(e+"").replace(re,oe)},ae.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ae.uniqueSort=function(e){var t,r=[],o=0,s=0;if(d=!i.detectDuplicates,h=!i.sortStable&&e.slice(0),e.sort(C),d){for(;t=e[s++];)t===e[s]&&(o=r.push(s));for(;o--;)e.splice(r[o],1)}return h=null,e},o=ae.getText=function(e){var t,i="",r=0,s=e.nodeType;if(s){if(1===s||9===s||11===s){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=o(e)}else if(3===s||4===s)return e.nodeValue}else for(;t=e[r++];)i+=o(t);return i},(r=ae.selectors={cacheLength:50,createPseudo:ce,match:Y,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,ie),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ie),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ae.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ae.error(e[0]),e},PSEUDO:function(e){var t,i=!e[6]&&e[2];return Y.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":i&&q.test(i)&&(t=n(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,ie).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=k[e+" "];return t||(t=new RegExp("(^|"+B+")"+e+"("+B+"|$)"))&&k(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,t,i){return function(r){var o=ae.attr(r,e);return null==o?"!="===t:!t||(o+="","="===t?o===i:"!="===t?o!==i:"^="===t?i&&0===o.indexOf(i):"*="===t?i&&o.indexOf(i)>-1:"$="===t?i&&o.slice(-i.length)===i:"~="===t?(" "+o.replace(V," ")+" ").indexOf(i)>-1:"|="===t&&(o===i||o.slice(0,i.length+1)===i+"-"))}},CHILD:function(e,t,i,r,o){var s="nth"!==e.slice(0,3),n="last"!==e.slice(-4),a="of-type"===t;return 1===r&&0===o?function(e){return!!e.parentNode}:function(t,i,l){var c,h,d,u,p,m,f=s!==n?"nextSibling":"previousSibling",g=t.parentNode,b=a&&t.nodeName.toLowerCase(),_=!l&&!a,v=!1;if(g){if(s){for(;f;){for(u=t;u=u[f];)if(a?u.nodeName.toLowerCase()===b:1===u.nodeType)return!1;m=f="only"===e&&!m&&"nextSibling"}return!0}if(m=[n?g.firstChild:g.lastChild],n&&_){for(v=(p=(c=(h=(d=(u=g)[x]||(u[x]={}))[u.uniqueID]||(d[u.uniqueID]={}))[e]||[])[0]===w&&c[1])&&c[2],u=p&&g.childNodes[p];u=++p&&u&&u[f]||(v=p=0)||m.pop();)if(1===u.nodeType&&++v&&u===t){h[e]=[w,p,v];break}}else if(_&&(v=p=(c=(h=(d=(u=t)[x]||(u[x]={}))[u.uniqueID]||(d[u.uniqueID]={}))[e]||[])[0]===w&&c[1]),!1===v)for(;(u=++p&&u&&u[f]||(v=p=0)||m.pop())&&((a?u.nodeName.toLowerCase()!==b:1!==u.nodeType)||!++v||(_&&((h=(d=u[x]||(u[x]={}))[u.uniqueID]||(d[u.uniqueID]={}))[e]=[w,v]),u!==t)););return(v-=o)===r||v%r==0&&v/r>=0}}},PSEUDO:function(e,t){var i,o=r.pseudos[e]||r.setFilters[e.toLowerCase()]||ae.error("unsupported pseudo: "+e);return o[x]?o(t):o.length>1?(i=[e,e,"",t],r.setFilters.hasOwnProperty(e.toLowerCase())?ce((function(e,i){for(var r,s=o(e,t),n=s.length;n--;)e[r=N(e,s[n])]=!(i[r]=s[n])})):function(e){return o(e,0,i)}):o}},pseudos:{not:ce((function(e){var t=[],i=[],r=a(e.replace(U,"$1"));return r[x]?ce((function(e,t,i,o){for(var s,n=r(e,null,o,[]),a=e.length;a--;)(s=n[a])&&(e[a]=!(t[a]=s))})):function(e,o,s){return t[0]=e,r(t,null,s,i),t[0]=null,!i.pop()}})),has:ce((function(e){return function(t){return ae(e,t).length>0}})),contains:ce((function(e){return e=e.replace(te,ie),function(t){return(t.textContent||o(t)).indexOf(e)>-1}})),lang:ce((function(e){return X.test(e||"")||ae.error("unsupported lang: "+e),e=e.replace(te,ie).toLowerCase(),function(t){var i;do{if(i=f?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(i=i.toLowerCase())===e||0===i.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===m},focus:function(e){return e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:fe(!1),disabled:fe(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!r.pseudos.empty(e)},header:function(e){return Q.test(e.nodeName)},input:function(e){return $.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:ge((function(){return[0]})),last:ge((function(e,t){return[t-1]})),eq:ge((function(e,t,i){return[i<0?i+t:i]})),even:ge((function(e,t){for(var i=0;i<t;i+=2)e.push(i);return e})),odd:ge((function(e,t){for(var i=1;i<t;i+=2)e.push(i);return e})),lt:ge((function(e,t,i){for(var r=i<0?i+t:i>t?t:i;--r>=0;)e.push(r);return e})),gt:ge((function(e,t,i){for(var r=i<0?i+t:i;++r<t;)e.push(r);return e}))}}).pseudos.nth=r.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[t]=pe(t);for(t in{submit:!0,reset:!0})r.pseudos[t]=me(t);function _e(){}function ve(e){for(var t=0,i=e.length,r="";t<i;t++)r+=e[t].value;return r}function xe(e,t,i){var r=t.dir,o=t.next,s=o||r,n=i&&"parentNode"===s,a=M++;return t.first?function(t,i,o){for(;t=t[r];)if(1===t.nodeType||n)return e(t,i,o);return!1}:function(t,i,l){var c,h,d,u=[w,a];if(l){for(;t=t[r];)if((1===t.nodeType||n)&&e(t,i,l))return!0}else for(;t=t[r];)if(1===t.nodeType||n)if(h=(d=t[x]||(t[x]={}))[t.uniqueID]||(d[t.uniqueID]={}),o&&o===t.nodeName.toLowerCase())t=t[r]||t;else{if((c=h[s])&&c[0]===w&&c[1]===a)return u[2]=c[2];if(h[s]=u,u[2]=e(t,i,l))return!0}return!1}}function ye(e){return e.length>1?function(t,i,r){for(var o=e.length;o--;)if(!e[o](t,i,r))return!1;return!0}:e[0]}function we(e,t,i,r,o){for(var s,n=[],a=0,l=e.length,c=null!=t;a<l;a++)(s=e[a])&&(i&&!i(s,r,o)||(n.push(s),c&&t.push(a)));return n}function Me(e,t,i,r,o,s){return r&&!r[x]&&(r=Me(r)),o&&!o[x]&&(o=Me(o,s)),ce((function(s,n,a,l){var c,h,d,u=[],p=[],m=n.length,f=s||function(e,t,i){for(var r=0,o=t.length;r<o;r++)ae(e,t[r],i);return i}(t||"*",a.nodeType?[a]:a,[]),g=!e||!s&&t?f:we(f,u,e,a,l),b=i?o||(s?e:m||r)?[]:n:g;if(i&&i(g,b,a,l),r)for(c=we(b,p),r(c,[],a,l),h=c.length;h--;)(d=c[h])&&(b[p[h]]=!(g[p[h]]=d));if(s){if(o||e){if(o){for(c=[],h=b.length;h--;)(d=b[h])&&c.push(g[h]=d);o(null,b=[],c,l)}for(h=b.length;h--;)(d=b[h])&&(c=o?N(s,d):u[h])>-1&&(s[c]=!(n[c]=d))}}else b=we(b===n?b.splice(m,b.length):b),o?o(null,n,b,l):R.apply(n,b)}))}function ke(e){for(var t,i,o,s=e.length,n=r.relative[e[0].type],a=n||r.relative[" "],l=n?1:0,h=xe((function(e){return e===t}),a,!0),d=xe((function(e){return N(t,e)>-1}),a,!0),u=[function(e,i,r){var o=!n&&(r||i!==c)||((t=i).nodeType?h(e,i,r):d(e,i,r));return t=null,o}];l<s;l++)if(i=r.relative[e[l].type])u=[xe(ye(u),i)];else{if((i=r.filter[e[l].type].apply(null,e[l].matches))[x]){for(o=++l;o<s&&!r.relative[e[o].type];o++);return Me(l>1&&ye(u),l>1&&ve(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(U,"$1"),i,l<o&&ke(e.slice(l,o)),o<s&&ke(e=e.slice(o)),o<s&&ve(e))}u.push(i)}return ye(u)}return _e.prototype=r.filters=r.pseudos,r.setFilters=new _e,n=ae.tokenize=function(e,t){var i,o,s,n,a,l,c,h=P[e+" "];if(h)return t?0:h.slice(0);for(a=e,l=[],c=r.preFilter;a;){for(n in i&&!(o=H.exec(a))||(o&&(a=a.slice(o[0].length)||a),l.push(s=[])),i=!1,(o=G.exec(a))&&(i=o.shift(),s.push({value:i,type:o[0].replace(U," ")}),a=a.slice(i.length)),r.filter)!(o=Y[n].exec(a))||c[n]&&!(o=c[n](o))||(i=o.shift(),s.push({value:i,type:n,matches:o}),a=a.slice(i.length));if(!i)break}return t?a.length:a?ae.error(e):P(e,l).slice(0)},a=ae.compile=function(e,t){var i,o=[],s=[],a=E[e+" "];if(!a){for(t||(t=n(e)),i=t.length;i--;)(a=ke(t[i]))[x]?o.push(a):s.push(a);(a=E(e,function(e,t){var i=t.length>0,o=e.length>0,s=function(s,n,a,l,h){var d,m,g,b=0,_="0",v=s&&[],x=[],y=c,M=s||o&&r.find.TAG("*",h),k=w+=null==y?1:Math.random()||.1,P=M.length;for(h&&(c=n===p||n||h);_!==P&&null!=(d=M[_]);_++){if(o&&d){for(m=0,n||d.ownerDocument===p||(u(d),a=!f);g=e[m++];)if(g(d,n||p,a)){l.push(d);break}h&&(w=k)}i&&((d=!g&&d)&&b--,s&&v.push(d))}if(b+=_,i&&_!==b){for(m=0;g=t[m++];)g(v,x,n,a);if(s){if(b>0)for(;_--;)v[_]||x[_]||(x[_]=S.call(l));x=we(x)}R.apply(l,x),h&&!s&&x.length>0&&b+t.length>1&&ae.uniqueSort(l)}return h&&(w=k,c=y),v};return i?ce(s):s}(s,o))).selector=e}return a},l=ae.select=function(e,t,i,o){var s,l,c,h,d,u="function"==typeof e&&e,p=!o&&n(e=u.selector||e);if(i=i||[],1===p.length){if((l=p[0]=p[0].slice(0)).length>2&&"ID"===(c=l[0]).type&&9===t.nodeType&&f&&r.relative[l[1].type]){if(!(t=(r.find.ID(c.matches[0].replace(te,ie),t)||[])[0]))return i;u&&(t=t.parentNode),e=e.slice(l.shift().value.length)}for(s=Y.needsContext.test(e)?0:l.length;s--&&(c=l[s],!r.relative[h=c.type]);)if((d=r.find[h])&&(o=d(c.matches[0].replace(te,ie),ee.test(l[0].type)&&be(t.parentNode)||t))){if(l.splice(s,1),!(e=o.length&&ve(l)))return R.apply(i,o),i;break}}return(u||a(e,p))(o,t,!f,i,!t||ee.test(e)&&be(t.parentNode)||t),i},i.sortStable=x.split("").sort(C).join("")===x,i.detectDuplicates=!!d,u(),i.sortDetached=he((function(e){return 1&e.compareDocumentPosition(p.createElement("fieldset"))})),he((function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")}))||de("type|href|height|width",(function(e,t,i){if(!i)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)})),i.attributes&&he((function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")}))||de("value",(function(e,t,i){if(!i&&"input"===e.nodeName.toLowerCase())return e.defaultValue})),he((function(e){return null==e.getAttribute("disabled")}))||de(F,(function(e,t,i){var r;if(!i)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null})),ae}(i);M.find=E,M.expr=E.selectors,M.expr[":"]=M.expr.pseudos,M.uniqueSort=M.unique=E.uniqueSort,M.text=E.getText,M.isXMLDoc=E.isXML,M.contains=E.contains,M.escapeSelector=E.escape;var A=function(e,t,i){for(var r=[],o=void 0!==i;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(o&&M(e).is(i))break;r.push(e)}return r},C=function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i},T=M.expr.match.needsContext;function D(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var S=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function L(e,t,i){return _(t)?M.grep(e,(function(e,r){return!!t.call(e,r,e)!==i})):t.nodeType?M.grep(e,(function(e){return e===t!==i})):"string"!=typeof t?M.grep(e,(function(e){return d.call(t,e)>-1!==i})):M.filter(t,e,i)}M.filter=function(e,t,i){var r=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?M.find.matchesSelector(r,e)?[r]:[]:M.find.matches(e,M.grep(t,(function(e){return 1===e.nodeType})))},M.fn.extend({find:function(e){var t,i,r=this.length,o=this;if("string"!=typeof e)return this.pushStack(M(e).filter((function(){for(t=0;t<r;t++)if(M.contains(o[t],this))return!0})));for(i=this.pushStack([]),t=0;t<r;t++)M.find(e,o[t],i);return r>1?M.uniqueSort(i):i},filter:function(e){return this.pushStack(L(this,e||[],!1))},not:function(e){return this.pushStack(L(this,e||[],!0))},is:function(e){return!!L(this,"string"==typeof e&&T.test(e)?M(e):e||[],!1).length}});var R,I=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(M.fn.init=function(e,t,i){var r,o;if(!e)return this;if(i=i||R,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:I.exec(e))||!r[1]&&t)return!t||t.jquery?(t||i).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof M?t[0]:t,M.merge(this,M.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:n,!0)),S.test(r[1])&&M.isPlainObject(t))for(r in t)_(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(o=n.getElementById(r[2]))&&(this[0]=o,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):_(e)?void 0!==i.ready?i.ready(e):e(M):M.makeArray(e,this)}).prototype=M.fn,R=M(n);var N=/^(?:parents|prev(?:Until|All))/,F={children:!0,contents:!0,next:!0,prev:!0};function B(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}M.fn.extend({has:function(e){var t=M(e,this),i=t.length;return this.filter((function(){for(var e=0;e<i;e++)if(M.contains(this,t[e]))return!0}))},closest:function(e,t){var i,r=0,o=this.length,s=[],n="string"!=typeof e&&M(e);if(!T.test(e))for(;r<o;r++)for(i=this[r];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(n?n.index(i)>-1:1===i.nodeType&&M.find.matchesSelector(i,e))){s.push(i);break}return this.pushStack(s.length>1?M.uniqueSort(s):s)},index:function(e){return e?"string"==typeof e?d.call(M(e),this[0]):d.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(M.uniqueSort(M.merge(this.get(),M(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),M.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return A(e,"parentNode")},parentsUntil:function(e,t,i){return A(e,"parentNode",i)},next:function(e){return B(e,"nextSibling")},prev:function(e){return B(e,"previousSibling")},nextAll:function(e){return A(e,"nextSibling")},prevAll:function(e){return A(e,"previousSibling")},nextUntil:function(e,t,i){return A(e,"nextSibling",i)},prevUntil:function(e,t,i){return A(e,"previousSibling",i)},siblings:function(e){return C((e.parentNode||{}).firstChild,e)},children:function(e){return C(e.firstChild)},contents:function(e){return void 0!==e.contentDocument?e.contentDocument:(D(e,"template")&&(e=e.content||e),M.merge([],e.childNodes))}},(function(e,t){M.fn[e]=function(i,r){var o=M.map(this,t,i);return"Until"!==e.slice(-5)&&(r=i),r&&"string"==typeof r&&(o=M.filter(r,o)),this.length>1&&(F[e]||M.uniqueSort(o),N.test(e)&&o.reverse()),this.pushStack(o)}}));var O=/[^\x20\t\r\n\f]+/g;function j(e){return e}function z(e){throw e}function V(e,t,i,r){var o;try{e&&_(o=e.promise)?o.call(e).done(t).fail(i):e&&_(o=e.then)?o.call(e,t,i):t.apply(void 0,[e].slice(r))}catch(e){i.apply(void 0,[e])}}M.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return M.each(e.match(O)||[],(function(e,i){t[i]=!0})),t}(e):M.extend({},e);var t,i,r,o,s=[],n=[],a=-1,l=function(){for(o=o||e.once,r=t=!0;n.length;a=-1)for(i=n.shift();++a<s.length;)!1===s[a].apply(i[0],i[1])&&e.stopOnFalse&&(a=s.length,i=!1);e.memory||(i=!1),t=!1,o&&(s=i?[]:"")},c={add:function(){return s&&(i&&!t&&(a=s.length-1,n.push(i)),function t(i){M.each(i,(function(i,r){_(r)?e.unique&&c.has(r)||s.push(r):r&&r.length&&"string"!==w(r)&&t(r)}))}(arguments),i&&!t&&l()),this},remove:function(){return M.each(arguments,(function(e,t){for(var i;(i=M.inArray(t,s,i))>-1;)s.splice(i,1),i<=a&&a--})),this},has:function(e){return e?M.inArray(e,s)>-1:s.length>0},empty:function(){return s&&(s=[]),this},disable:function(){return o=n=[],s=i="",this},disabled:function(){return!s},lock:function(){return o=n=[],i||t||(s=i=""),this},locked:function(){return!!o},fireWith:function(e,i){return o||(i=[e,(i=i||[]).slice?i.slice():i],n.push(i),t||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!r}};return c},M.extend({Deferred:function(e){var t=[["notify","progress",M.Callbacks("memory"),M.Callbacks("memory"),2],["resolve","done",M.Callbacks("once memory"),M.Callbacks("once memory"),0,"resolved"],["reject","fail",M.Callbacks("once memory"),M.Callbacks("once memory"),1,"rejected"]],r="pending",o={state:function(){return r},always:function(){return s.done(arguments).fail(arguments),this},catch:function(e){return o.then(null,e)},pipe:function(){var e=arguments;return M.Deferred((function(i){M.each(t,(function(t,r){var o=_(e[r[4]])&&e[r[4]];s[r[1]]((function(){var e=o&&o.apply(this,arguments);e&&_(e.promise)?e.promise().progress(i.notify).done(i.resolve).fail(i.reject):i[r[0]+"With"](this,o?[e]:arguments)}))})),e=null})).promise()},then:function(e,r,o){var s=0;function n(e,t,r,o){return function(){var a=this,l=arguments,c=function(){var i,c;if(!(e<s)){if((i=r.apply(a,l))===t.promise())throw new TypeError("Thenable self-resolution");c=i&&("object"==typeof i||"function"==typeof i)&&i.then,_(c)?o?c.call(i,n(s,t,j,o),n(s,t,z,o)):(s++,c.call(i,n(s,t,j,o),n(s,t,z,o),n(s,t,j,t.notifyWith))):(r!==j&&(a=void 0,l=[i]),(o||t.resolveWith)(a,l))}},h=o?c:function(){try{c()}catch(i){M.Deferred.exceptionHook&&M.Deferred.exceptionHook(i,h.stackTrace),e+1>=s&&(r!==z&&(a=void 0,l=[i]),t.rejectWith(a,l))}};e?h():(M.Deferred.getStackHook&&(h.stackTrace=M.Deferred.getStackHook()),i.setTimeout(h))}}return M.Deferred((function(i){t[0][3].add(n(0,i,_(o)?o:j,i.notifyWith)),t[1][3].add(n(0,i,_(e)?e:j)),t[2][3].add(n(0,i,_(r)?r:z))})).promise()},promise:function(e){return null!=e?M.extend(e,o):o}},s={};return M.each(t,(function(e,i){var n=i[2],a=i[5];o[i[1]]=n.add,a&&n.add((function(){r=a}),t[3-e][2].disable,t[3-e][3].disable,t[0][2].lock,t[0][3].lock),n.add(i[3].fire),s[i[0]]=function(){return s[i[0]+"With"](this===s?void 0:this,arguments),this},s[i[0]+"With"]=n.fireWith})),o.promise(s),e&&e.call(s,s),s},when:function(e){var t=arguments.length,i=t,r=Array(i),o=l.call(arguments),s=M.Deferred(),n=function(e){return function(i){r[e]=this,o[e]=arguments.length>1?l.call(arguments):i,--t||s.resolveWith(r,o)}};if(t<=1&&(V(e,s.done(n(i)).resolve,s.reject,!t),"pending"===s.state()||_(o[i]&&o[i].then)))return s.then();for(;i--;)V(o[i],n(i),s.reject);return s.promise()}});var U=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;M.Deferred.exceptionHook=function(e,t){i.console&&i.console.warn&&e&&U.test(e.name)&&i.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},M.readyException=function(e){i.setTimeout((function(){throw e}))};var H=M.Deferred();function G(){n.removeEventListener("DOMContentLoaded",G),i.removeEventListener("load",G),M.ready()}M.fn.ready=function(e){return H.then(e).catch((function(e){M.readyException(e)})),this},M.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--M.readyWait:M.isReady)||(M.isReady=!0,!0!==e&&--M.readyWait>0||H.resolveWith(n,[M]))}}),M.ready.then=H.then,"complete"===n.readyState||"loading"!==n.readyState&&!n.documentElement.doScroll?i.setTimeout(M.ready):(n.addEventListener("DOMContentLoaded",G),i.addEventListener("load",G));var W=function(e,t,i,r,o,s,n){var a=0,l=e.length,c=null==i;if("object"===w(i))for(a in o=!0,i)W(e,t,a,i[a],!0,s,n);else if(void 0!==r&&(o=!0,_(r)||(n=!0),c&&(n?(t.call(e,r),t=null):(c=t,t=function(e,t,i){return c.call(M(e),i)})),t))for(;a<l;a++)t(e[a],i,n?r:r.call(e[a],a,t(e[a],i)));return o?e:c?t.call(e):l?t(e[0],i):s},q=/^-ms-/,X=/-([a-z])/g;function Y(e,t){return t.toUpperCase()}function K(e){return e.replace(q,"ms-").replace(X,Y)}var $=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function Q(){this.expando=M.expando+Q.uid++}Q.uid=1,Q.prototype={cache:function(e){var t=e[this.expando];return t||(t={},$(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,i){var r,o=this.cache(e);if("string"==typeof t)o[K(t)]=i;else for(r in t)o[K(r)]=t[r];return o},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][K(t)]},access:function(e,t,i){return void 0===t||t&&"string"==typeof t&&void 0===i?this.get(e,t):(this.set(e,t,i),void 0!==i?i:t)},remove:function(e,t){var i,r=e[this.expando];if(void 0!==r){if(void 0!==t){i=(t=Array.isArray(t)?t.map(K):(t=K(t))in r?[t]:t.match(O)||[]).length;for(;i--;)delete r[t[i]]}(void 0===t||M.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!M.isEmptyObject(t)}};var Z=new Q,J=new Q,ee=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,te=/[A-Z]/g;function ie(e,t,i){var r;if(void 0===i&&1===e.nodeType)if(r="data-"+t.replace(te,"-$&").toLowerCase(),"string"==typeof(i=e.getAttribute(r))){try{i=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:ee.test(e)?JSON.parse(e):e)}(i)}catch(e){}J.set(e,t,i)}else i=void 0;return i}M.extend({hasData:function(e){return J.hasData(e)||Z.hasData(e)},data:function(e,t,i){return J.access(e,t,i)},removeData:function(e,t){J.remove(e,t)},_data:function(e,t,i){return Z.access(e,t,i)},_removeData:function(e,t){Z.remove(e,t)}}),M.fn.extend({data:function(e,t){var i,r,o,s=this[0],n=s&&s.attributes;if(void 0===e){if(this.length&&(o=J.get(s),1===s.nodeType&&!Z.get(s,"hasDataAttrs"))){for(i=n.length;i--;)n[i]&&0===(r=n[i].name).indexOf("data-")&&(r=K(r.slice(5)),ie(s,r,o[r]));Z.set(s,"hasDataAttrs",!0)}return o}return"object"==typeof e?this.each((function(){J.set(this,e)})):W(this,(function(t){var i;if(s&&void 0===t)return void 0!==(i=J.get(s,e))?i:void 0!==(i=ie(s,e))?i:void 0;this.each((function(){J.set(this,e,t)}))}),null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each((function(){J.remove(this,e)}))}}),M.extend({queue:function(e,t,i){var r;if(e)return t=(t||"fx")+"queue",r=Z.get(e,t),i&&(!r||Array.isArray(i)?r=Z.access(e,t,M.makeArray(i)):r.push(i)),r||[]},dequeue:function(e,t){t=t||"fx";var i=M.queue(e,t),r=i.length,o=i.shift(),s=M._queueHooks(e,t);"inprogress"===o&&(o=i.shift(),r--),o&&("fx"===t&&i.unshift("inprogress"),delete s.stop,o.call(e,(function(){M.dequeue(e,t)}),s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return Z.get(e,i)||Z.access(e,i,{empty:M.Callbacks("once memory").add((function(){Z.remove(e,[t+"queue",i])}))})}}),M.fn.extend({queue:function(e,t){var i=2;return"string"!=typeof e&&(t=e,e="fx",i--),arguments.length<i?M.queue(this[0],e):void 0===t?this:this.each((function(){var i=M.queue(this,e,t);M._queueHooks(this,e),"fx"===e&&"inprogress"!==i[0]&&M.dequeue(this,e)}))},dequeue:function(e){return this.each((function(){M.dequeue(this,e)}))},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var i,r=1,o=M.Deferred(),s=this,n=this.length,a=function(){--r||o.resolveWith(s,[s])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";n--;)(i=Z.get(s[n],e+"queueHooks"))&&i.empty&&(r++,i.empty.add(a));return a(),o.promise(t)}});var re=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,oe=new RegExp("^(?:([+-])=|)("+re+")([a-z%]*)$","i"),se=["Top","Right","Bottom","Left"],ne=n.documentElement,ae=function(e){return M.contains(e.ownerDocument,e)},le={composed:!0};ne.getRootNode&&(ae=function(e){return M.contains(e.ownerDocument,e)||e.getRootNode(le)===e.ownerDocument});var ce=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&ae(e)&&"none"===M.css(e,"display")},he=function(e,t,i,r){var o,s,n={};for(s in t)n[s]=e.style[s],e.style[s]=t[s];for(s in o=i.apply(e,r||[]),t)e.style[s]=n[s];return o};function de(e,t,i,r){var o,s,n=20,a=r?function(){return r.cur()}:function(){return M.css(e,t,"")},l=a(),c=i&&i[3]||(M.cssNumber[t]?"":"px"),h=e.nodeType&&(M.cssNumber[t]||"px"!==c&&+l)&&oe.exec(M.css(e,t));if(h&&h[3]!==c){for(l/=2,c=c||h[3],h=+l||1;n--;)M.style(e,t,h+c),(1-s)*(1-(s=a()/l||.5))<=0&&(n=0),h/=s;h*=2,M.style(e,t,h+c),i=i||[]}return i&&(h=+h||+l||0,o=i[1]?h+(i[1]+1)*i[2]:+i[2],r&&(r.unit=c,r.start=h,r.end=o)),o}var ue={};function pe(e){var t,i=e.ownerDocument,r=e.nodeName,o=ue[r];return o||(t=i.body.appendChild(i.createElement(r)),o=M.css(t,"display"),t.parentNode.removeChild(t),"none"===o&&(o="block"),ue[r]=o,o)}function me(e,t){for(var i,r,o=[],s=0,n=e.length;s<n;s++)(r=e[s]).style&&(i=r.style.display,t?("none"===i&&(o[s]=Z.get(r,"display")||null,o[s]||(r.style.display="")),""===r.style.display&&ce(r)&&(o[s]=pe(r))):"none"!==i&&(o[s]="none",Z.set(r,"display",i)));for(s=0;s<n;s++)null!=o[s]&&(e[s].style.display=o[s]);return e}M.fn.extend({show:function(){return me(this,!0)},hide:function(){return me(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each((function(){ce(this)?M(this).show():M(this).hide()}))}});var fe=/^(?:checkbox|radio)$/i,ge=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,be=/^$|^module$|\/(?:java|ecma)script/i,_e={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ve(e,t){var i;return i=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&D(e,t)?M.merge([e],i):i}function xe(e,t){for(var i=0,r=e.length;i<r;i++)Z.set(e[i],"globalEval",!t||Z.get(t[i],"globalEval"))}_e.optgroup=_e.option,_e.tbody=_e.tfoot=_e.colgroup=_e.caption=_e.thead,_e.th=_e.td;var ye,we,Me=/<|&#?\w+;/;function ke(e,t,i,r,o){for(var s,n,a,l,c,h,d=t.createDocumentFragment(),u=[],p=0,m=e.length;p<m;p++)if((s=e[p])||0===s)if("object"===w(s))M.merge(u,s.nodeType?[s]:s);else if(Me.test(s)){for(n=n||d.appendChild(t.createElement("div")),a=(ge.exec(s)||["",""])[1].toLowerCase(),l=_e[a]||_e._default,n.innerHTML=l[1]+M.htmlPrefilter(s)+l[2],h=l[0];h--;)n=n.lastChild;M.merge(u,n.childNodes),(n=d.firstChild).textContent=""}else u.push(t.createTextNode(s));for(d.textContent="",p=0;s=u[p++];)if(r&&M.inArray(s,r)>-1)o&&o.push(s);else if(c=ae(s),n=ve(d.appendChild(s),"script"),c&&xe(n),i)for(h=0;s=n[h++];)be.test(s.type||"")&&i.push(s);return d}ye=n.createDocumentFragment().appendChild(n.createElement("div")),(we=n.createElement("input")).setAttribute("type","radio"),we.setAttribute("checked","checked"),we.setAttribute("name","t"),ye.appendChild(we),b.checkClone=ye.cloneNode(!0).cloneNode(!0).lastChild.checked,ye.innerHTML="<textarea>x</textarea>",b.noCloneChecked=!!ye.cloneNode(!0).lastChild.defaultValue;var Pe=/^key/,Ee=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Ae=/^([^.]*)(?:\.(.+)|)/;function Ce(){return!0}function Te(){return!1}function De(e,t){return e===function(){try{return n.activeElement}catch(e){}}()==("focus"===t)}function Se(e,t,i,r,o,s){var n,a;if("object"==typeof t){for(a in"string"!=typeof i&&(r=r||i,i=void 0),t)Se(e,a,i,r,t[a],s);return e}if(null==r&&null==o?(o=i,r=i=void 0):null==o&&("string"==typeof i?(o=r,r=void 0):(o=r,r=i,i=void 0)),!1===o)o=Te;else if(!o)return e;return 1===s&&(n=o,(o=function(e){return M().off(e),n.apply(this,arguments)}).guid=n.guid||(n.guid=M.guid++)),e.each((function(){M.event.add(this,t,o,r,i)}))}function Le(e,t,i){i?(Z.set(e,t,!1),M.event.add(e,t,{namespace:!1,handler:function(e){var r,o,s=Z.get(this,t);if(1&e.isTrigger&&this[t]){if(s.length)(M.event.special[t]||{}).delegateType&&e.stopPropagation();else if(s=l.call(arguments),Z.set(this,t,s),r=i(this,t),this[t](),s!==(o=Z.get(this,t))||r?Z.set(this,t,!1):o={},s!==o)return e.stopImmediatePropagation(),e.preventDefault(),o.value}else s.length&&(Z.set(this,t,{value:M.event.trigger(M.extend(s[0],M.Event.prototype),s.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===Z.get(e,t)&&M.event.add(e,t,Ce)}M.event={global:{},add:function(e,t,i,r,o){var s,n,a,l,c,h,d,u,p,m,f,g=Z.get(e);if(g)for(i.handler&&(i=(s=i).handler,o=s.selector),o&&M.find.matchesSelector(ne,o),i.guid||(i.guid=M.guid++),(l=g.events)||(l=g.events={}),(n=g.handle)||(n=g.handle=function(t){return void 0!==M&&M.event.triggered!==t.type?M.event.dispatch.apply(e,arguments):void 0}),c=(t=(t||"").match(O)||[""]).length;c--;)p=f=(a=Ae.exec(t[c])||[])[1],m=(a[2]||"").split(".").sort(),p&&(d=M.event.special[p]||{},p=(o?d.delegateType:d.bindType)||p,d=M.event.special[p]||{},h=M.extend({type:p,origType:f,data:r,handler:i,guid:i.guid,selector:o,needsContext:o&&M.expr.match.needsContext.test(o),namespace:m.join(".")},s),(u=l[p])||((u=l[p]=[]).delegateCount=0,d.setup&&!1!==d.setup.call(e,r,m,n)||e.addEventListener&&e.addEventListener(p,n)),d.add&&(d.add.call(e,h),h.handler.guid||(h.handler.guid=i.guid)),o?u.splice(u.delegateCount++,0,h):u.push(h),M.event.global[p]=!0)},remove:function(e,t,i,r,o){var s,n,a,l,c,h,d,u,p,m,f,g=Z.hasData(e)&&Z.get(e);if(g&&(l=g.events)){for(c=(t=(t||"").match(O)||[""]).length;c--;)if(p=f=(a=Ae.exec(t[c])||[])[1],m=(a[2]||"").split(".").sort(),p){for(d=M.event.special[p]||{},u=l[p=(r?d.delegateType:d.bindType)||p]||[],a=a[2]&&new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"),n=s=u.length;s--;)h=u[s],!o&&f!==h.origType||i&&i.guid!==h.guid||a&&!a.test(h.namespace)||r&&r!==h.selector&&("**"!==r||!h.selector)||(u.splice(s,1),h.selector&&u.delegateCount--,d.remove&&d.remove.call(e,h));n&&!u.length&&(d.teardown&&!1!==d.teardown.call(e,m,g.handle)||M.removeEvent(e,p,g.handle),delete l[p])}else for(p in l)M.event.remove(e,p+t[c],i,r,!0);M.isEmptyObject(l)&&Z.remove(e,"handle events")}},dispatch:function(e){var t,i,r,o,s,n,a=M.event.fix(e),l=new Array(arguments.length),c=(Z.get(this,"events")||{})[a.type]||[],h=M.event.special[a.type]||{};for(l[0]=a,t=1;t<arguments.length;t++)l[t]=arguments[t];if(a.delegateTarget=this,!h.preDispatch||!1!==h.preDispatch.call(this,a)){for(n=M.event.handlers.call(this,a,c),t=0;(o=n[t++])&&!a.isPropagationStopped();)for(a.currentTarget=o.elem,i=0;(s=o.handlers[i++])&&!a.isImmediatePropagationStopped();)a.rnamespace&&!1!==s.namespace&&!a.rnamespace.test(s.namespace)||(a.handleObj=s,a.data=s.data,void 0!==(r=((M.event.special[s.origType]||{}).handle||s.handler).apply(o.elem,l))&&!1===(a.result=r)&&(a.preventDefault(),a.stopPropagation()));return h.postDispatch&&h.postDispatch.call(this,a),a.result}},handlers:function(e,t){var i,r,o,s,n,a=[],l=t.delegateCount,c=e.target;if(l&&c.nodeType&&!("click"===e.type&&e.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==e.type||!0!==c.disabled)){for(s=[],n={},i=0;i<l;i++)void 0===n[o=(r=t[i]).selector+" "]&&(n[o]=r.needsContext?M(o,this).index(c)>-1:M.find(o,this,null,[c]).length),n[o]&&s.push(r);s.length&&a.push({elem:c,handlers:s})}return c=this,l<t.length&&a.push({elem:c,handlers:t.slice(l)}),a},addProp:function(e,t){Object.defineProperty(M.Event.prototype,e,{enumerable:!0,configurable:!0,get:_(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[M.expando]?e:new M.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return fe.test(t.type)&&t.click&&D(t,"input")&&Le(t,"click",Ce),!1},trigger:function(e){var t=this||e;return fe.test(t.type)&&t.click&&D(t,"input")&&Le(t,"click"),!0},_default:function(e){var t=e.target;return fe.test(t.type)&&t.click&&D(t,"input")&&Z.get(t,"click")||D(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},M.removeEvent=function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i)},M.Event=function(e,t){if(!(this instanceof M.Event))return new M.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Ce:Te,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&M.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[M.expando]=!0},M.Event.prototype={constructor:M.Event,isDefaultPrevented:Te,isPropagationStopped:Te,isImmediatePropagationStopped:Te,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Ce,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Ce,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Ce,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},M.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&Pe.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&Ee.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},M.event.addProp),M.each({focus:"focusin",blur:"focusout"},(function(e,t){M.event.special[e]={setup:function(){return Le(this,e,De),!1},trigger:function(){return Le(this,e),!0},delegateType:t}})),M.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(e,t){M.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,r=this,o=e.relatedTarget,s=e.handleObj;return o&&(o===r||M.contains(r,o))||(e.type=s.origType,i=s.handler.apply(this,arguments),e.type=t),i}}})),M.fn.extend({on:function(e,t,i,r){return Se(this,e,t,i,r)},one:function(e,t,i,r){return Se(this,e,t,i,r,1)},off:function(e,t,i){var r,o;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,M(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(o in e)this.off(o,t,e[o]);return this}return!1!==t&&"function"!=typeof t||(i=t,t=void 0),!1===i&&(i=Te),this.each((function(){M.event.remove(this,e,i,t)}))}});var Re=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,Ie=/<script|<style|<link/i,Ne=/checked\s*(?:[^=]|=\s*.checked.)/i,Fe=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Be(e,t){return D(e,"table")&&D(11!==t.nodeType?t:t.firstChild,"tr")&&M(e).children("tbody")[0]||e}function Oe(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function je(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function ze(e,t){var i,r,o,s,n,a,l,c;if(1===t.nodeType){if(Z.hasData(e)&&(s=Z.access(e),n=Z.set(t,s),c=s.events))for(o in delete n.handle,n.events={},c)for(i=0,r=c[o].length;i<r;i++)M.event.add(t,o,c[o][i]);J.hasData(e)&&(a=J.access(e),l=M.extend({},a),J.set(t,l))}}function Ve(e,t){var i=t.nodeName.toLowerCase();"input"===i&&fe.test(e.type)?t.checked=e.checked:"input"!==i&&"textarea"!==i||(t.defaultValue=e.defaultValue)}function Ue(e,t,i,r){t=c.apply([],t);var o,s,n,a,l,h,d=0,u=e.length,p=u-1,m=t[0],f=_(m);if(f||u>1&&"string"==typeof m&&!b.checkClone&&Ne.test(m))return e.each((function(o){var s=e.eq(o);f&&(t[0]=m.call(this,o,s.html())),Ue(s,t,i,r)}));if(u&&(s=(o=ke(t,e[0].ownerDocument,!1,e,r)).firstChild,1===o.childNodes.length&&(o=s),s||r)){for(a=(n=M.map(ve(o,"script"),Oe)).length;d<u;d++)l=o,d!==p&&(l=M.clone(l,!0,!0),a&&M.merge(n,ve(l,"script"))),i.call(e[d],l,d);if(a)for(h=n[n.length-1].ownerDocument,M.map(n,je),d=0;d<a;d++)l=n[d],be.test(l.type||"")&&!Z.access(l,"globalEval")&&M.contains(h,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?M._evalUrl&&!l.noModule&&M._evalUrl(l.src,{nonce:l.nonce||l.getAttribute("nonce")}):y(l.textContent.replace(Fe,""),l,h))}return e}function He(e,t,i){for(var r,o=t?M.filter(t,e):e,s=0;null!=(r=o[s]);s++)i||1!==r.nodeType||M.cleanData(ve(r)),r.parentNode&&(i&&ae(r)&&xe(ve(r,"script")),r.parentNode.removeChild(r));return e}M.extend({htmlPrefilter:function(e){return e.replace(Re,"<$1></$2>")},clone:function(e,t,i){var r,o,s,n,a=e.cloneNode(!0),l=ae(e);if(!(b.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||M.isXMLDoc(e)))for(n=ve(a),r=0,o=(s=ve(e)).length;r<o;r++)Ve(s[r],n[r]);if(t)if(i)for(s=s||ve(e),n=n||ve(a),r=0,o=s.length;r<o;r++)ze(s[r],n[r]);else ze(e,a);return(n=ve(a,"script")).length>0&&xe(n,!l&&ve(e,"script")),a},cleanData:function(e){for(var t,i,r,o=M.event.special,s=0;void 0!==(i=e[s]);s++)if($(i)){if(t=i[Z.expando]){if(t.events)for(r in t.events)o[r]?M.event.remove(i,r):M.removeEvent(i,r,t.handle);i[Z.expando]=void 0}i[J.expando]&&(i[J.expando]=void 0)}}}),M.fn.extend({detach:function(e){return He(this,e,!0)},remove:function(e){return He(this,e)},text:function(e){return W(this,(function(e){return void 0===e?M.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)}))}),null,e,arguments.length)},append:function(){return Ue(this,arguments,(function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Be(this,e).appendChild(e)}))},prepend:function(){return Ue(this,arguments,(function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Be(this,e);t.insertBefore(e,t.firstChild)}}))},before:function(){return Ue(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this)}))},after:function(){return Ue(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)}))},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(M.cleanData(ve(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map((function(){return M.clone(this,e,t)}))},html:function(e){return W(this,(function(e){var t=this[0]||{},i=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Ie.test(e)&&!_e[(ge.exec(e)||["",""])[1].toLowerCase()]){e=M.htmlPrefilter(e);try{for(;i<r;i++)1===(t=this[i]||{}).nodeType&&(M.cleanData(ve(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)}),null,e,arguments.length)},replaceWith:function(){var e=[];return Ue(this,arguments,(function(t){var i=this.parentNode;M.inArray(this,e)<0&&(M.cleanData(ve(this)),i&&i.replaceChild(t,this))}),e)}}),M.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(e,t){M.fn[e]=function(e){for(var i,r=[],o=M(e),s=o.length-1,n=0;n<=s;n++)i=n===s?this:this.clone(!0),M(o[n])[t](i),h.apply(r,i.get());return this.pushStack(r)}}));var Ge=new RegExp("^("+re+")(?!px)[a-z%]+$","i"),We=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=i),t.getComputedStyle(e)},qe=new RegExp(se.join("|"),"i");function Xe(e,t,i){var r,o,s,n,a=e.style;return(i=i||We(e))&&(""!==(n=i.getPropertyValue(t)||i[t])||ae(e)||(n=M.style(e,t)),!b.pixelBoxStyles()&&Ge.test(n)&&qe.test(t)&&(r=a.width,o=a.minWidth,s=a.maxWidth,a.minWidth=a.maxWidth=a.width=n,n=i.width,a.width=r,a.minWidth=o,a.maxWidth=s)),void 0!==n?n+"":n}function Ye(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(h){c.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",h.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ne.appendChild(c).appendChild(h);var e=i.getComputedStyle(h);r="1%"!==e.top,l=12===t(e.marginLeft),h.style.right="60%",a=36===t(e.right),o=36===t(e.width),h.style.position="absolute",s=12===t(h.offsetWidth/3),ne.removeChild(c),h=null}}function t(e){return Math.round(parseFloat(e))}var r,o,s,a,l,c=n.createElement("div"),h=n.createElement("div");h.style&&(h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",b.clearCloneStyle="content-box"===h.style.backgroundClip,M.extend(b,{boxSizingReliable:function(){return e(),o},pixelBoxStyles:function(){return e(),a},pixelPosition:function(){return e(),r},reliableMarginLeft:function(){return e(),l},scrollboxSize:function(){return e(),s}}))}();var Ke=["Webkit","Moz","ms"],$e=n.createElement("div").style,Qe={};function Ze(e){var t=M.cssProps[e]||Qe[e];return t||(e in $e?e:Qe[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),i=Ke.length;i--;)if((e=Ke[i]+t)in $e)return e}(e)||e)}var Je=/^(none|table(?!-c[ea]).+)/,et=/^--/,tt={position:"absolute",visibility:"hidden",display:"block"},it={letterSpacing:"0",fontWeight:"400"};function rt(e,t,i){var r=oe.exec(t);return r?Math.max(0,r[2]-(i||0))+(r[3]||"px"):t}function ot(e,t,i,r,o,s){var n="width"===t?1:0,a=0,l=0;if(i===(r?"border":"content"))return 0;for(;n<4;n+=2)"margin"===i&&(l+=M.css(e,i+se[n],!0,o)),r?("content"===i&&(l-=M.css(e,"padding"+se[n],!0,o)),"margin"!==i&&(l-=M.css(e,"border"+se[n]+"Width",!0,o))):(l+=M.css(e,"padding"+se[n],!0,o),"padding"!==i?l+=M.css(e,"border"+se[n]+"Width",!0,o):a+=M.css(e,"border"+se[n]+"Width",!0,o));return!r&&s>=0&&(l+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-s-l-a-.5))||0),l}function st(e,t,i){var r=We(e),o=(!b.boxSizingReliable()||i)&&"border-box"===M.css(e,"boxSizing",!1,r),s=o,n=Xe(e,t,r),a="offset"+t[0].toUpperCase()+t.slice(1);if(Ge.test(n)){if(!i)return n;n="auto"}return(!b.boxSizingReliable()&&o||"auto"===n||!parseFloat(n)&&"inline"===M.css(e,"display",!1,r))&&e.getClientRects().length&&(o="border-box"===M.css(e,"boxSizing",!1,r),(s=a in e)&&(n=e[a])),(n=parseFloat(n)||0)+ot(e,t,i||(o?"border":"content"),s,r,n)+"px"}function nt(e,t,i,r,o){return new nt.prototype.init(e,t,i,r,o)}M.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=Xe(e,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,i,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,s,n,a=K(t),l=et.test(t),c=e.style;if(l||(t=Ze(a)),n=M.cssHooks[t]||M.cssHooks[a],void 0===i)return n&&"get"in n&&void 0!==(o=n.get(e,!1,r))?o:c[t];"string"===(s=typeof i)&&(o=oe.exec(i))&&o[1]&&(i=de(e,t,o),s="number"),null!=i&&i==i&&("number"!==s||l||(i+=o&&o[3]||(M.cssNumber[a]?"":"px")),b.clearCloneStyle||""!==i||0!==t.indexOf("background")||(c[t]="inherit"),n&&"set"in n&&void 0===(i=n.set(e,i,r))||(l?c.setProperty(t,i):c[t]=i))}},css:function(e,t,i,r){var o,s,n,a=K(t);return et.test(t)||(t=Ze(a)),(n=M.cssHooks[t]||M.cssHooks[a])&&"get"in n&&(o=n.get(e,!0,i)),void 0===o&&(o=Xe(e,t,r)),"normal"===o&&t in it&&(o=it[t]),""===i||i?(s=parseFloat(o),!0===i||isFinite(s)?s||0:o):o}}),M.each(["height","width"],(function(e,t){M.cssHooks[t]={get:function(e,i,r){if(i)return!Je.test(M.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?st(e,t,r):he(e,tt,(function(){return st(e,t,r)}))},set:function(e,i,r){var o,s=We(e),n=!b.scrollboxSize()&&"absolute"===s.position,a=(n||r)&&"border-box"===M.css(e,"boxSizing",!1,s),l=r?ot(e,t,r,a,s):0;return a&&n&&(l-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(s[t])-ot(e,t,"border",!1,s)-.5)),l&&(o=oe.exec(i))&&"px"!==(o[3]||"px")&&(e.style[t]=i,i=M.css(e,t)),rt(0,i,l)}}})),M.cssHooks.marginLeft=Ye(b.reliableMarginLeft,(function(e,t){if(t)return(parseFloat(Xe(e,"marginLeft"))||e.getBoundingClientRect().left-he(e,{marginLeft:0},(function(){return e.getBoundingClientRect().left})))+"px"})),M.each({margin:"",padding:"",border:"Width"},(function(e,t){M.cssHooks[e+t]={expand:function(i){for(var r=0,o={},s="string"==typeof i?i.split(" "):[i];r<4;r++)o[e+se[r]+t]=s[r]||s[r-2]||s[0];return o}},"margin"!==e&&(M.cssHooks[e+t].set=rt)})),M.fn.extend({css:function(e,t){return W(this,(function(e,t,i){var r,o,s={},n=0;if(Array.isArray(t)){for(r=We(e),o=t.length;n<o;n++)s[t[n]]=M.css(e,t[n],!1,r);return s}return void 0!==i?M.style(e,t,i):M.css(e,t)}),e,t,arguments.length>1)}}),M.Tween=nt,nt.prototype={constructor:nt,init:function(e,t,i,r,o,s){this.elem=e,this.prop=i,this.easing=o||M.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(M.cssNumber[i]?"":"px")},cur:function(){var e=nt.propHooks[this.prop];return e&&e.get?e.get(this):nt.propHooks._default.get(this)},run:function(e){var t,i=nt.propHooks[this.prop];return this.options.duration?this.pos=t=M.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):nt.propHooks._default.set(this),this}},nt.prototype.init.prototype=nt.prototype,nt.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=M.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){M.fx.step[e.prop]?M.fx.step[e.prop](e):1!==e.elem.nodeType||!M.cssHooks[e.prop]&&null==e.elem.style[Ze(e.prop)]?e.elem[e.prop]=e.now:M.style(e.elem,e.prop,e.now+e.unit)}}},nt.propHooks.scrollTop=nt.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},M.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},M.fx=nt.prototype.init,M.fx.step={};var at,lt,ct=/^(?:toggle|show|hide)$/,ht=/queueHooks$/;function dt(){lt&&(!1===n.hidden&&i.requestAnimationFrame?i.requestAnimationFrame(dt):i.setTimeout(dt,M.fx.interval),M.fx.tick())}function ut(){return i.setTimeout((function(){at=void 0})),at=Date.now()}function pt(e,t){var i,r=0,o={height:e};for(t=t?1:0;r<4;r+=2-t)o["margin"+(i=se[r])]=o["padding"+i]=e;return t&&(o.opacity=o.width=e),o}function mt(e,t,i){for(var r,o=(ft.tweeners[t]||[]).concat(ft.tweeners["*"]),s=0,n=o.length;s<n;s++)if(r=o[s].call(i,t,e))return r}function ft(e,t,i){var r,o,s=0,n=ft.prefilters.length,a=M.Deferred().always((function(){delete l.elem})),l=function(){if(o)return!1;for(var t=at||ut(),i=Math.max(0,c.startTime+c.duration-t),r=1-(i/c.duration||0),s=0,n=c.tweens.length;s<n;s++)c.tweens[s].run(r);return a.notifyWith(e,[c,r,i]),r<1&&n?i:(n||a.notifyWith(e,[c,1,0]),a.resolveWith(e,[c]),!1)},c=a.promise({elem:e,props:M.extend({},t),opts:M.extend(!0,{specialEasing:{},easing:M.easing._default},i),originalProperties:t,originalOptions:i,startTime:at||ut(),duration:i.duration,tweens:[],createTween:function(t,i){var r=M.Tween(e,c.opts,t,i,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(r),r},stop:function(t){var i=0,r=t?c.tweens.length:0;if(o)return this;for(o=!0;i<r;i++)c.tweens[i].run(1);return t?(a.notifyWith(e,[c,1,0]),a.resolveWith(e,[c,t])):a.rejectWith(e,[c,t]),this}}),h=c.props;for(!function(e,t){var i,r,o,s,n;for(i in e)if(o=t[r=K(i)],s=e[i],Array.isArray(s)&&(o=s[1],s=e[i]=s[0]),i!==r&&(e[r]=s,delete e[i]),(n=M.cssHooks[r])&&"expand"in n)for(i in s=n.expand(s),delete e[r],s)i in e||(e[i]=s[i],t[i]=o);else t[r]=o}(h,c.opts.specialEasing);s<n;s++)if(r=ft.prefilters[s].call(c,e,h,c.opts))return _(r.stop)&&(M._queueHooks(c.elem,c.opts.queue).stop=r.stop.bind(r)),r;return M.map(h,mt,c),_(c.opts.start)&&c.opts.start.call(e,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),M.fx.timer(M.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c}M.Animation=M.extend(ft,{tweeners:{"*":[function(e,t){var i=this.createTween(e,t);return de(i.elem,e,oe.exec(t),i),i}]},tweener:function(e,t){_(e)?(t=e,e=["*"]):e=e.match(O);for(var i,r=0,o=e.length;r<o;r++)i=e[r],ft.tweeners[i]=ft.tweeners[i]||[],ft.tweeners[i].unshift(t)},prefilters:[function(e,t,i){var r,o,s,n,a,l,c,h,d="width"in t||"height"in t,u=this,p={},m=e.style,f=e.nodeType&&ce(e),g=Z.get(e,"fxshow");for(r in i.queue||(null==(n=M._queueHooks(e,"fx")).unqueued&&(n.unqueued=0,a=n.empty.fire,n.empty.fire=function(){n.unqueued||a()}),n.unqueued++,u.always((function(){u.always((function(){n.unqueued--,M.queue(e,"fx").length||n.empty.fire()}))}))),t)if(o=t[r],ct.test(o)){if(delete t[r],s=s||"toggle"===o,o===(f?"hide":"show")){if("show"!==o||!g||void 0===g[r])continue;f=!0}p[r]=g&&g[r]||M.style(e,r)}if((l=!M.isEmptyObject(t))||!M.isEmptyObject(p))for(r in d&&1===e.nodeType&&(i.overflow=[m.overflow,m.overflowX,m.overflowY],null==(c=g&&g.display)&&(c=Z.get(e,"display")),"none"===(h=M.css(e,"display"))&&(c?h=c:(me([e],!0),c=e.style.display||c,h=M.css(e,"display"),me([e]))),("inline"===h||"inline-block"===h&&null!=c)&&"none"===M.css(e,"float")&&(l||(u.done((function(){m.display=c})),null==c&&(h=m.display,c="none"===h?"":h)),m.display="inline-block")),i.overflow&&(m.overflow="hidden",u.always((function(){m.overflow=i.overflow[0],m.overflowX=i.overflow[1],m.overflowY=i.overflow[2]}))),l=!1,p)l||(g?"hidden"in g&&(f=g.hidden):g=Z.access(e,"fxshow",{display:c}),s&&(g.hidden=!f),f&&me([e],!0),u.done((function(){for(r in f||me([e]),Z.remove(e,"fxshow"),p)M.style(e,r,p[r])}))),l=mt(f?g[r]:0,r,u),r in g||(g[r]=l.start,f&&(l.end=l.start,l.start=0))}],prefilter:function(e,t){t?ft.prefilters.unshift(e):ft.prefilters.push(e)}}),M.speed=function(e,t,i){var r=e&&"object"==typeof e?M.extend({},e):{complete:i||!i&&t||_(e)&&e,duration:e,easing:i&&t||t&&!_(t)&&t};return M.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in M.fx.speeds?r.duration=M.fx.speeds[r.duration]:r.duration=M.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){_(r.old)&&r.old.call(this),r.queue&&M.dequeue(this,r.queue)},r},M.fn.extend({fadeTo:function(e,t,i,r){return this.filter(ce).css("opacity",0).show().end().animate({opacity:t},e,i,r)},animate:function(e,t,i,r){var o=M.isEmptyObject(e),s=M.speed(t,i,r),n=function(){var t=ft(this,M.extend({},e),s);(o||Z.get(this,"finish"))&&t.stop(!0)};return n.finish=n,o||!1===s.queue?this.each(n):this.queue(s.queue,n)},stop:function(e,t,i){var r=function(e){var t=e.stop;delete e.stop,t(i)};return"string"!=typeof e&&(i=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each((function(){var t=!0,o=null!=e&&e+"queueHooks",s=M.timers,n=Z.get(this);if(o)n[o]&&n[o].stop&&r(n[o]);else for(o in n)n[o]&&n[o].stop&&ht.test(o)&&r(n[o]);for(o=s.length;o--;)s[o].elem!==this||null!=e&&s[o].queue!==e||(s[o].anim.stop(i),t=!1,s.splice(o,1));!t&&i||M.dequeue(this,e)}))},finish:function(e){return!1!==e&&(e=e||"fx"),this.each((function(){var t,i=Z.get(this),r=i[e+"queue"],o=i[e+"queueHooks"],s=M.timers,n=r?r.length:0;for(i.finish=!0,M.queue(this,e,[]),o&&o.stop&&o.stop.call(this,!0),t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;t<n;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete i.finish}))}}),M.each(["toggle","show","hide"],(function(e,t){var i=M.fn[t];M.fn[t]=function(e,r,o){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(pt(t,!0),e,r,o)}})),M.each({slideDown:pt("show"),slideUp:pt("hide"),slideToggle:pt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(e,t){M.fn[e]=function(e,i,r){return this.animate(t,e,i,r)}})),M.timers=[],M.fx.tick=function(){var e,t=0,i=M.timers;for(at=Date.now();t<i.length;t++)(e=i[t])()||i[t]!==e||i.splice(t--,1);i.length||M.fx.stop(),at=void 0},M.fx.timer=function(e){M.timers.push(e),M.fx.start()},M.fx.interval=13,M.fx.start=function(){lt||(lt=!0,dt())},M.fx.stop=function(){lt=null},M.fx.speeds={slow:600,fast:200,_default:400},M.fn.delay=function(e,t){return e=M.fx&&M.fx.speeds[e]||e,t=t||"fx",this.queue(t,(function(t,r){var o=i.setTimeout(t,e);r.stop=function(){i.clearTimeout(o)}}))},function(){var e=n.createElement("input"),t=n.createElement("select").appendChild(n.createElement("option"));e.type="checkbox",b.checkOn=""!==e.value,b.optSelected=t.selected,(e=n.createElement("input")).value="t",e.type="radio",b.radioValue="t"===e.value}();var gt,bt=M.expr.attrHandle;M.fn.extend({attr:function(e,t){return W(this,M.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each((function(){M.removeAttr(this,e)}))}}),M.extend({attr:function(e,t,i){var r,o,s=e.nodeType;if(3!==s&&8!==s&&2!==s)return void 0===e.getAttribute?M.prop(e,t,i):(1===s&&M.isXMLDoc(e)||(o=M.attrHooks[t.toLowerCase()]||(M.expr.match.bool.test(t)?gt:void 0)),void 0!==i?null===i?void M.removeAttr(e,t):o&&"set"in o&&void 0!==(r=o.set(e,i,t))?r:(e.setAttribute(t,i+""),i):o&&"get"in o&&null!==(r=o.get(e,t))?r:null==(r=M.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!b.radioValue&&"radio"===t&&D(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}},removeAttr:function(e,t){var i,r=0,o=t&&t.match(O);if(o&&1===e.nodeType)for(;i=o[r++];)e.removeAttribute(i)}}),gt={set:function(e,t,i){return!1===t?M.removeAttr(e,i):e.setAttribute(i,i),i}},M.each(M.expr.match.bool.source.match(/\w+/g),(function(e,t){var i=bt[t]||M.find.attr;bt[t]=function(e,t,r){var o,s,n=t.toLowerCase();return r||(s=bt[n],bt[n]=o,o=null!=i(e,t,r)?n:null,bt[n]=s),o}}));var _t=/^(?:input|select|textarea|button)$/i,vt=/^(?:a|area)$/i;function xt(e){return(e.match(O)||[]).join(" ")}function yt(e){return e.getAttribute&&e.getAttribute("class")||""}function wt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(O)||[]}M.fn.extend({prop:function(e,t){return W(this,M.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each((function(){delete this[M.propFix[e]||e]}))}}),M.extend({prop:function(e,t,i){var r,o,s=e.nodeType;if(3!==s&&8!==s&&2!==s)return 1===s&&M.isXMLDoc(e)||(t=M.propFix[t]||t,o=M.propHooks[t]),void 0!==i?o&&"set"in o&&void 0!==(r=o.set(e,i,t))?r:e[t]=i:o&&"get"in o&&null!==(r=o.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=M.find.attr(e,"tabindex");return t?parseInt(t,10):_t.test(e.nodeName)||vt.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),b.optSelected||(M.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),M.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){M.propFix[this.toLowerCase()]=this})),M.fn.extend({addClass:function(e){var t,i,r,o,s,n,a,l=0;if(_(e))return this.each((function(t){M(this).addClass(e.call(this,t,yt(this)))}));if((t=wt(e)).length)for(;i=this[l++];)if(o=yt(i),r=1===i.nodeType&&" "+xt(o)+" "){for(n=0;s=t[n++];)r.indexOf(" "+s+" ")<0&&(r+=s+" ");o!==(a=xt(r))&&i.setAttribute("class",a)}return this},removeClass:function(e){var t,i,r,o,s,n,a,l=0;if(_(e))return this.each((function(t){M(this).removeClass(e.call(this,t,yt(this)))}));if(!arguments.length)return this.attr("class","");if((t=wt(e)).length)for(;i=this[l++];)if(o=yt(i),r=1===i.nodeType&&" "+xt(o)+" "){for(n=0;s=t[n++];)for(;r.indexOf(" "+s+" ")>-1;)r=r.replace(" "+s+" "," ");o!==(a=xt(r))&&i.setAttribute("class",a)}return this},toggleClass:function(e,t){var i=typeof e,r="string"===i||Array.isArray(e);return"boolean"==typeof t&&r?t?this.addClass(e):this.removeClass(e):_(e)?this.each((function(i){M(this).toggleClass(e.call(this,i,yt(this),t),t)})):this.each((function(){var t,o,s,n;if(r)for(o=0,s=M(this),n=wt(e);t=n[o++];)s.hasClass(t)?s.removeClass(t):s.addClass(t);else void 0!==e&&"boolean"!==i||((t=yt(this))&&Z.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":Z.get(this,"__className__")||""))}))},hasClass:function(e){var t,i,r=0;for(t=" "+e+" ";i=this[r++];)if(1===i.nodeType&&(" "+xt(yt(i))+" ").indexOf(t)>-1)return!0;return!1}});var Mt=/\r/g;M.fn.extend({val:function(e){var t,i,r,o=this[0];return arguments.length?(r=_(e),this.each((function(i){var o;1===this.nodeType&&(null==(o=r?e.call(this,i,M(this).val()):e)?o="":"number"==typeof o?o+="":Array.isArray(o)&&(o=M.map(o,(function(e){return null==e?"":e+""}))),(t=M.valHooks[this.type]||M.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,o,"value")||(this.value=o))}))):o?(t=M.valHooks[o.type]||M.valHooks[o.nodeName.toLowerCase()])&&"get"in t&&void 0!==(i=t.get(o,"value"))?i:"string"==typeof(i=o.value)?i.replace(Mt,""):null==i?"":i:void 0}}),M.extend({valHooks:{option:{get:function(e){var t=M.find.attr(e,"value");return null!=t?t:xt(M.text(e))}},select:{get:function(e){var t,i,r,o=e.options,s=e.selectedIndex,n="select-one"===e.type,a=n?null:[],l=n?s+1:o.length;for(r=s<0?l:n?s:0;r<l;r++)if(((i=o[r]).selected||r===s)&&!i.disabled&&(!i.parentNode.disabled||!D(i.parentNode,"optgroup"))){if(t=M(i).val(),n)return t;a.push(t)}return a},set:function(e,t){for(var i,r,o=e.options,s=M.makeArray(t),n=o.length;n--;)((r=o[n]).selected=M.inArray(M.valHooks.option.get(r),s)>-1)&&(i=!0);return i||(e.selectedIndex=-1),s}}}}),M.each(["radio","checkbox"],(function(){M.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=M.inArray(M(e).val(),t)>-1}},b.checkOn||(M.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})})),b.focusin="onfocusin"in i;var kt=/^(?:focusinfocus|focusoutblur)$/,Pt=function(e){e.stopPropagation()};M.extend(M.event,{trigger:function(e,t,r,o){var s,a,l,c,h,d,u,p,f=[r||n],g=m.call(e,"type")?e.type:e,b=m.call(e,"namespace")?e.namespace.split("."):[];if(a=p=l=r=r||n,3!==r.nodeType&&8!==r.nodeType&&!kt.test(g+M.event.triggered)&&(g.indexOf(".")>-1&&(b=g.split("."),g=b.shift(),b.sort()),h=g.indexOf(":")<0&&"on"+g,(e=e[M.expando]?e:new M.Event(g,"object"==typeof e&&e)).isTrigger=o?2:3,e.namespace=b.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=r),t=null==t?[e]:M.makeArray(t,[e]),u=M.event.special[g]||{},o||!u.trigger||!1!==u.trigger.apply(r,t))){if(!o&&!u.noBubble&&!v(r)){for(c=u.delegateType||g,kt.test(c+g)||(a=a.parentNode);a;a=a.parentNode)f.push(a),l=a;l===(r.ownerDocument||n)&&f.push(l.defaultView||l.parentWindow||i)}for(s=0;(a=f[s++])&&!e.isPropagationStopped();)p=a,e.type=s>1?c:u.bindType||g,(d=(Z.get(a,"events")||{})[e.type]&&Z.get(a,"handle"))&&d.apply(a,t),(d=h&&a[h])&&d.apply&&$(a)&&(e.result=d.apply(a,t),!1===e.result&&e.preventDefault());return e.type=g,o||e.isDefaultPrevented()||u._default&&!1!==u._default.apply(f.pop(),t)||!$(r)||h&&_(r[g])&&!v(r)&&((l=r[h])&&(r[h]=null),M.event.triggered=g,e.isPropagationStopped()&&p.addEventListener(g,Pt),r[g](),e.isPropagationStopped()&&p.removeEventListener(g,Pt),M.event.triggered=void 0,l&&(r[h]=l)),e.result}},simulate:function(e,t,i){var r=M.extend(new M.Event,i,{type:e,isSimulated:!0});M.event.trigger(r,null,t)}}),M.fn.extend({trigger:function(e,t){return this.each((function(){M.event.trigger(e,t,this)}))},triggerHandler:function(e,t){var i=this[0];if(i)return M.event.trigger(e,t,i,!0)}}),b.focusin||M.each({focus:"focusin",blur:"focusout"},(function(e,t){var i=function(e){M.event.simulate(t,e.target,M.event.fix(e))};M.event.special[t]={setup:function(){var r=this.ownerDocument||this,o=Z.access(r,t);o||r.addEventListener(e,i,!0),Z.access(r,t,(o||0)+1)},teardown:function(){var r=this.ownerDocument||this,o=Z.access(r,t)-1;o?Z.access(r,t,o):(r.removeEventListener(e,i,!0),Z.remove(r,t))}}}));var Et=i.location,At=Date.now(),Ct=/\?/;M.parseXML=function(e){var t;if(!e||"string"!=typeof e)return null;try{t=(new i.DOMParser).parseFromString(e,"text/xml")}catch(e){t=void 0}return t&&!t.getElementsByTagName("parsererror").length||M.error("Invalid XML: "+e),t};var Tt=/\[\]$/,Dt=/\r?\n/g,St=/^(?:submit|button|image|reset|file)$/i,Lt=/^(?:input|select|textarea|keygen)/i;function Rt(e,t,i,r){var o;if(Array.isArray(t))M.each(t,(function(t,o){i||Tt.test(e)?r(e,o):Rt(e+"["+("object"==typeof o&&null!=o?t:"")+"]",o,i,r)}));else if(i||"object"!==w(t))r(e,t);else for(o in t)Rt(e+"["+o+"]",t[o],i,r)}M.param=function(e,t){var i,r=[],o=function(e,t){var i=_(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==i?"":i)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!M.isPlainObject(e))M.each(e,(function(){o(this.name,this.value)}));else for(i in e)Rt(i,e[i],t,o);return r.join("&")},M.fn.extend({serialize:function(){return M.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var e=M.prop(this,"elements");return e?M.makeArray(e):this})).filter((function(){var e=this.type;return this.name&&!M(this).is(":disabled")&&Lt.test(this.nodeName)&&!St.test(e)&&(this.checked||!fe.test(e))})).map((function(e,t){var i=M(this).val();return null==i?null:Array.isArray(i)?M.map(i,(function(e){return{name:t.name,value:e.replace(Dt,"\r\n")}})):{name:t.name,value:i.replace(Dt,"\r\n")}})).get()}});var It=/%20/g,Nt=/#.*$/,Ft=/([?&])_=[^&]*/,Bt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ot=/^(?:GET|HEAD)$/,jt=/^\/\//,zt={},Vt={},Ut="*/".concat("*"),Ht=n.createElement("a");function Gt(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var r,o=0,s=t.toLowerCase().match(O)||[];if(_(i))for(;r=s[o++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(i)):(e[r]=e[r]||[]).push(i)}}function Wt(e,t,i,r){var o={},s=e===Vt;function n(a){var l;return o[a]=!0,M.each(e[a]||[],(function(e,a){var c=a(t,i,r);return"string"!=typeof c||s||o[c]?s?!(l=c):void 0:(t.dataTypes.unshift(c),n(c),!1)})),l}return n(t.dataTypes[0])||!o["*"]&&n("*")}function qt(e,t){var i,r,o=M.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((o[i]?e:r||(r={}))[i]=t[i]);return r&&M.extend(!0,e,r),e}Ht.href=Et.href,M.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Et.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Et.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ut,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":M.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?qt(qt(e,M.ajaxSettings),t):qt(M.ajaxSettings,e)},ajaxPrefilter:Gt(zt),ajaxTransport:Gt(Vt),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var r,o,s,a,l,c,h,d,u,p,m=M.ajaxSetup({},t),f=m.context||m,g=m.context&&(f.nodeType||f.jquery)?M(f):M.event,b=M.Deferred(),_=M.Callbacks("once memory"),v=m.statusCode||{},x={},y={},w="canceled",k={readyState:0,getResponseHeader:function(e){var t;if(h){if(!a)for(a={};t=Bt.exec(s);)a[t[1].toLowerCase()+" "]=(a[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=a[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return h?s:null},setRequestHeader:function(e,t){return null==h&&(e=y[e.toLowerCase()]=y[e.toLowerCase()]||e,x[e]=t),this},overrideMimeType:function(e){return null==h&&(m.mimeType=e),this},statusCode:function(e){var t;if(e)if(h)k.always(e[k.status]);else for(t in e)v[t]=[v[t],e[t]];return this},abort:function(e){var t=e||w;return r&&r.abort(t),P(0,t),this}};if(b.promise(k),m.url=((e||m.url||Et.href)+"").replace(jt,Et.protocol+"//"),m.type=t.method||t.type||m.method||m.type,m.dataTypes=(m.dataType||"*").toLowerCase().match(O)||[""],null==m.crossDomain){c=n.createElement("a");try{c.href=m.url,c.href=c.href,m.crossDomain=Ht.protocol+"//"+Ht.host!=c.protocol+"//"+c.host}catch(e){m.crossDomain=!0}}if(m.data&&m.processData&&"string"!=typeof m.data&&(m.data=M.param(m.data,m.traditional)),Wt(zt,m,t,k),h)return k;for(u in(d=M.event&&m.global)&&0==M.active++&&M.event.trigger("ajaxStart"),m.type=m.type.toUpperCase(),m.hasContent=!Ot.test(m.type),o=m.url.replace(Nt,""),m.hasContent?m.data&&m.processData&&0===(m.contentType||"").indexOf("application/x-www-form-urlencoded")&&(m.data=m.data.replace(It,"+")):(p=m.url.slice(o.length),m.data&&(m.processData||"string"==typeof m.data)&&(o+=(Ct.test(o)?"&":"?")+m.data,delete m.data),!1===m.cache&&(o=o.replace(Ft,"$1"),p=(Ct.test(o)?"&":"?")+"_="+At+++p),m.url=o+p),m.ifModified&&(M.lastModified[o]&&k.setRequestHeader("If-Modified-Since",M.lastModified[o]),M.etag[o]&&k.setRequestHeader("If-None-Match",M.etag[o])),(m.data&&m.hasContent&&!1!==m.contentType||t.contentType)&&k.setRequestHeader("Content-Type",m.contentType),k.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", "+Ut+"; q=0.01":""):m.accepts["*"]),m.headers)k.setRequestHeader(u,m.headers[u]);if(m.beforeSend&&(!1===m.beforeSend.call(f,k,m)||h))return k.abort();if(w="abort",_.add(m.complete),k.done(m.success),k.fail(m.error),r=Wt(Vt,m,t,k)){if(k.readyState=1,d&&g.trigger("ajaxSend",[k,m]),h)return k;m.async&&m.timeout>0&&(l=i.setTimeout((function(){k.abort("timeout")}),m.timeout));try{h=!1,r.send(x,P)}catch(e){if(h)throw e;P(-1,e)}}else P(-1,"No Transport");function P(e,t,n,a){var c,u,p,x,y,w=t;h||(h=!0,l&&i.clearTimeout(l),r=void 0,s=a||"",k.readyState=e>0?4:0,c=e>=200&&e<300||304===e,n&&(x=function(e,t,i){for(var r,o,s,n,a=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(o in a)if(a[o]&&a[o].test(r)){l.unshift(o);break}if(l[0]in i)s=l[0];else{for(o in i){if(!l[0]||e.converters[o+" "+l[0]]){s=o;break}n||(n=o)}s=s||n}if(s)return s!==l[0]&&l.unshift(s),i[s]}(m,k,n)),x=function(e,t,i,r){var o,s,n,a,l,c={},h=e.dataTypes.slice();if(h[1])for(n in e.converters)c[n.toLowerCase()]=e.converters[n];for(s=h.shift();s;)if(e.responseFields[s]&&(i[e.responseFields[s]]=t),!l&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=s,s=h.shift())if("*"===s)s=l;else if("*"!==l&&l!==s){if(!(n=c[l+" "+s]||c["* "+s]))for(o in c)if((a=o.split(" "))[1]===s&&(n=c[l+" "+a[0]]||c["* "+a[0]])){!0===n?n=c[o]:!0!==c[o]&&(s=a[0],h.unshift(a[1]));break}if(!0!==n)if(n&&e.throws)t=n(t);else try{t=n(t)}catch(e){return{state:"parsererror",error:n?e:"No conversion from "+l+" to "+s}}}return{state:"success",data:t}}(m,x,k,c),c?(m.ifModified&&((y=k.getResponseHeader("Last-Modified"))&&(M.lastModified[o]=y),(y=k.getResponseHeader("etag"))&&(M.etag[o]=y)),204===e||"HEAD"===m.type?w="nocontent":304===e?w="notmodified":(w=x.state,u=x.data,c=!(p=x.error))):(p=w,!e&&w||(w="error",e<0&&(e=0))),k.status=e,k.statusText=(t||w)+"",c?b.resolveWith(f,[u,w,k]):b.rejectWith(f,[k,w,p]),k.statusCode(v),v=void 0,d&&g.trigger(c?"ajaxSuccess":"ajaxError",[k,m,c?u:p]),_.fireWith(f,[k,w]),d&&(g.trigger("ajaxComplete",[k,m]),--M.active||M.event.trigger("ajaxStop")))}return k},getJSON:function(e,t,i){return M.get(e,t,i,"json")},getScript:function(e,t){return M.get(e,void 0,t,"script")}}),M.each(["get","post"],(function(e,t){M[t]=function(e,i,r,o){return _(i)&&(o=o||r,r=i,i=void 0),M.ajax(M.extend({url:e,type:t,dataType:o,data:i,success:r},M.isPlainObject(e)&&e))}})),M._evalUrl=function(e,t){return M.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){M.globalEval(e,t)}})},M.fn.extend({wrapAll:function(e){var t;return this[0]&&(_(e)&&(e=e.call(this[0])),t=M(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map((function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e})).append(this)),this},wrapInner:function(e){return _(e)?this.each((function(t){M(this).wrapInner(e.call(this,t))})):this.each((function(){var t=M(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)}))},wrap:function(e){var t=_(e);return this.each((function(i){M(this).wrapAll(t?e.call(this,i):e)}))},unwrap:function(e){return this.parent(e).not("body").each((function(){M(this).replaceWith(this.childNodes)})),this}}),M.expr.pseudos.hidden=function(e){return!M.expr.pseudos.visible(e)},M.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},M.ajaxSettings.xhr=function(){try{return new i.XMLHttpRequest}catch(e){}};var Xt={0:200,1223:204},Yt=M.ajaxSettings.xhr();b.cors=!!Yt&&"withCredentials"in Yt,b.ajax=Yt=!!Yt,M.ajaxTransport((function(e){var t,r;if(b.cors||Yt&&!e.crossDomain)return{send:function(o,s){var n,a=e.xhr();if(a.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(n in e.xhrFields)a[n]=e.xhrFields[n];for(n in e.mimeType&&a.overrideMimeType&&a.overrideMimeType(e.mimeType),e.crossDomain||o["X-Requested-With"]||(o["X-Requested-With"]="XMLHttpRequest"),o)a.setRequestHeader(n,o[n]);t=function(e){return function(){t&&(t=r=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===e?a.abort():"error"===e?"number"!=typeof a.status?s(0,"error"):s(a.status,a.statusText):s(Xt[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=t(),r=a.onerror=a.ontimeout=t("error"),void 0!==a.onabort?a.onabort=r:a.onreadystatechange=function(){4===a.readyState&&i.setTimeout((function(){t&&r()}))},t=t("abort");try{a.send(e.hasContent&&e.data||null)}catch(e){if(t)throw e}},abort:function(){t&&t()}}})),M.ajaxPrefilter((function(e){e.crossDomain&&(e.contents.script=!1)})),M.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return M.globalEval(e),e}}}),M.ajaxPrefilter("script",(function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")})),M.ajaxTransport("script",(function(e){var t,i;if(e.crossDomain||e.scriptAttrs)return{send:function(r,o){t=M("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",i=function(e){t.remove(),i=null,e&&o("error"===e.type?404:200,e.type)}),n.head.appendChild(t[0])},abort:function(){i&&i()}}}));var Kt,$t=[],Qt=/(=)\?(?=&|$)|\?\?/;M.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=$t.pop()||M.expando+"_"+At++;return this[e]=!0,e}}),M.ajaxPrefilter("json jsonp",(function(e,t,r){var o,s,n,a=!1!==e.jsonp&&(Qt.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Qt.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return o=e.jsonpCallback=_(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Qt,"$1"+o):!1!==e.jsonp&&(e.url+=(Ct.test(e.url)?"&":"?")+e.jsonp+"="+o),e.converters["script json"]=function(){return n||M.error(o+" was not called"),n[0]},e.dataTypes[0]="json",s=i[o],i[o]=function(){n=arguments},r.always((function(){void 0===s?M(i).removeProp(o):i[o]=s,e[o]&&(e.jsonpCallback=t.jsonpCallback,$t.push(o)),n&&_(s)&&s(n[0]),n=s=void 0})),"script"})),b.createHTMLDocument=((Kt=n.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Kt.childNodes.length),M.parseHTML=function(e,t,i){return"string"!=typeof e?[]:("boolean"==typeof t&&(i=t,t=!1),t||(b.createHTMLDocument?((r=(t=n.implementation.createHTMLDocument("")).createElement("base")).href=n.location.href,t.head.appendChild(r)):t=n),s=!i&&[],(o=S.exec(e))?[t.createElement(o[1])]:(o=ke([e],t,s),s&&s.length&&M(s).remove(),M.merge([],o.childNodes)));var r,o,s},M.fn.load=function(e,t,i){var r,o,s,n=this,a=e.indexOf(" ");return a>-1&&(r=xt(e.slice(a)),e=e.slice(0,a)),_(t)?(i=t,t=void 0):t&&"object"==typeof t&&(o="POST"),n.length>0&&M.ajax({url:e,type:o||"GET",dataType:"html",data:t}).done((function(e){s=arguments,n.html(r?M("<div>").append(M.parseHTML(e)).find(r):e)})).always(i&&function(e,t){n.each((function(){i.apply(this,s||[e.responseText,t,e])}))}),this},M.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(e,t){M.fn[t]=function(e){return this.on(t,e)}})),M.expr.pseudos.animated=function(e){return M.grep(M.timers,(function(t){return e===t.elem})).length},M.offset={setOffset:function(e,t,i){var r,o,s,n,a,l,c=M.css(e,"position"),h=M(e),d={};"static"===c&&(e.style.position="relative"),a=h.offset(),s=M.css(e,"top"),l=M.css(e,"left"),("absolute"===c||"fixed"===c)&&(s+l).indexOf("auto")>-1?(n=(r=h.position()).top,o=r.left):(n=parseFloat(s)||0,o=parseFloat(l)||0),_(t)&&(t=t.call(e,i,M.extend({},a))),null!=t.top&&(d.top=t.top-a.top+n),null!=t.left&&(d.left=t.left-a.left+o),"using"in t?t.using.call(e,d):h.css(d)}},M.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each((function(t){M.offset.setOffset(this,e,t)}));var t,i,r=this[0];return r?r.getClientRects().length?(t=r.getBoundingClientRect(),i=r.ownerDocument.defaultView,{top:t.top+i.pageYOffset,left:t.left+i.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,i,r=this[0],o={top:0,left:0};if("fixed"===M.css(r,"position"))t=r.getBoundingClientRect();else{for(t=this.offset(),i=r.ownerDocument,e=r.offsetParent||i.documentElement;e&&(e===i.body||e===i.documentElement)&&"static"===M.css(e,"position");)e=e.parentNode;e&&e!==r&&1===e.nodeType&&((o=M(e).offset()).top+=M.css(e,"borderTopWidth",!0),o.left+=M.css(e,"borderLeftWidth",!0))}return{top:t.top-o.top-M.css(r,"marginTop",!0),left:t.left-o.left-M.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var e=this.offsetParent;e&&"static"===M.css(e,"position");)e=e.offsetParent;return e||ne}))}}),M.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(e,t){var i="pageYOffset"===t;M.fn[e]=function(r){return W(this,(function(e,r,o){var s;if(v(e)?s=e:9===e.nodeType&&(s=e.defaultView),void 0===o)return s?s[t]:e[r];s?s.scrollTo(i?s.pageXOffset:o,i?o:s.pageYOffset):e[r]=o}),e,r,arguments.length)}})),M.each(["top","left"],(function(e,t){M.cssHooks[t]=Ye(b.pixelPosition,(function(e,i){if(i)return i=Xe(e,t),Ge.test(i)?M(e).position()[t]+"px":i}))})),M.each({Height:"height",Width:"width"},(function(e,t){M.each({padding:"inner"+e,content:t,"":"outer"+e},(function(i,r){M.fn[r]=function(o,s){var n=arguments.length&&(i||"boolean"!=typeof o),a=i||(!0===o||!0===s?"margin":"border");return W(this,(function(t,i,o){var s;return v(t)?0===r.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(s=t.documentElement,Math.max(t.body["scroll"+e],s["scroll"+e],t.body["offset"+e],s["offset"+e],s["client"+e])):void 0===o?M.css(t,i,a):M.style(t,i,o,a)}),t,n?o:void 0,n)}}))})),M.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(e,t){M.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}})),M.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),M.fn.extend({bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,r){return this.on(t,e,i,r)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)}}),M.proxy=function(e,t){var i,r,o;if("string"==typeof t&&(i=e[t],t=e,e=i),_(e))return r=l.call(arguments,2),(o=function(){return e.apply(t||this,r.concat(l.call(arguments)))}).guid=e.guid=e.guid||M.guid++,o},M.holdReady=function(e){e?M.readyWait++:M.ready(!0)},M.isArray=Array.isArray,M.parseJSON=JSON.parse,M.nodeName=D,M.isFunction=_,M.isWindow=v,M.camelCase=K,M.type=w,M.now=Date.now,M.isNumeric=function(e){var t=M.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},void 0===(r=function(){return M}.apply(t,[]))||(e.exports=r);var Zt=i.jQuery,Jt=i.$;return M.noConflict=function(e){return i.$===M&&(i.$=Jt),e&&i.jQuery===M&&(i.jQuery=Zt),M},o||(i.jQuery=i.$=M),M}))},function(e,t,i){"use strict";i.r(t),function(e){
/**!
 * @fileOverview Kickass library to create and place poppers near their reference elements.
 * @version 1.16.0
 * @license
 * Copyright (c) 2016 Federico Zivolo and contributors
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
var i="undefined"!=typeof window&&"undefined"!=typeof document&&"undefined"!=typeof navigator,r=function(){for(var e=["Edge","Trident","Firefox"],t=0;t<e.length;t+=1)if(i&&navigator.userAgent.indexOf(e[t])>=0)return 1;return 0}();var o=i&&window.Promise?function(e){var t=!1;return function(){t||(t=!0,window.Promise.resolve().then((function(){t=!1,e()})))}}:function(e){var t=!1;return function(){t||(t=!0,setTimeout((function(){t=!1,e()}),r))}};function s(e){return e&&"[object Function]"==={}.toString.call(e)}function n(e,t){if(1!==e.nodeType)return[];var i=e.ownerDocument.defaultView.getComputedStyle(e,null);return t?i[t]:i}function a(e){return"HTML"===e.nodeName?e:e.parentNode||e.host}function l(e){if(!e)return document.body;switch(e.nodeName){case"HTML":case"BODY":return e.ownerDocument.body;case"#document":return e.body}var t=n(e),i=t.overflow,r=t.overflowX,o=t.overflowY;return/(auto|scroll|overlay)/.test(i+o+r)?e:l(a(e))}function c(e){return e&&e.referenceNode?e.referenceNode:e}var h=i&&!(!window.MSInputMethodContext||!document.documentMode),d=i&&/MSIE 10/.test(navigator.userAgent);function u(e){return 11===e?h:10===e?d:h||d}function p(e){if(!e)return document.documentElement;for(var t=u(10)?document.body:null,i=e.offsetParent||null;i===t&&e.nextElementSibling;)i=(e=e.nextElementSibling).offsetParent;var r=i&&i.nodeName;return r&&"BODY"!==r&&"HTML"!==r?-1!==["TH","TD","TABLE"].indexOf(i.nodeName)&&"static"===n(i,"position")?p(i):i:e?e.ownerDocument.documentElement:document.documentElement}function m(e){return null!==e.parentNode?m(e.parentNode):e}function f(e,t){if(!(e&&e.nodeType&&t&&t.nodeType))return document.documentElement;var i=e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING,r=i?e:t,o=i?t:e,s=document.createRange();s.setStart(r,0),s.setEnd(o,0);var n,a,l=s.commonAncestorContainer;if(e!==l&&t!==l||r.contains(o))return"BODY"===(a=(n=l).nodeName)||"HTML"!==a&&p(n.firstElementChild)!==n?p(l):l;var c=m(e);return c.host?f(c.host,t):f(e,m(t).host)}function g(e){var t="top"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top")?"scrollTop":"scrollLeft",i=e.nodeName;if("BODY"===i||"HTML"===i){var r=e.ownerDocument.documentElement;return(e.ownerDocument.scrollingElement||r)[t]}return e[t]}function b(e,t){var i="x"===t?"Left":"Top",r="Left"===i?"Right":"Bottom";return parseFloat(e["border"+i+"Width"],10)+parseFloat(e["border"+r+"Width"],10)}function _(e,t,i,r){return Math.max(t["offset"+e],t["scroll"+e],i["client"+e],i["offset"+e],i["scroll"+e],u(10)?parseInt(i["offset"+e])+parseInt(r["margin"+("Height"===e?"Top":"Left")])+parseInt(r["margin"+("Height"===e?"Bottom":"Right")]):0)}function v(e){var t=e.body,i=e.documentElement,r=u(10)&&getComputedStyle(i);return{height:_("Height",t,i,r),width:_("Width",t,i,r)}}var x=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},y=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),w=function(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e},M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e};function k(e){return M({},e,{right:e.left+e.width,bottom:e.top+e.height})}function P(e){var t={};try{if(u(10)){t=e.getBoundingClientRect();var i=g(e,"top"),r=g(e,"left");t.top+=i,t.left+=r,t.bottom+=i,t.right+=r}else t=e.getBoundingClientRect()}catch(e){}var o={left:t.left,top:t.top,width:t.right-t.left,height:t.bottom-t.top},s="HTML"===e.nodeName?v(e.ownerDocument):{},a=s.width||e.clientWidth||o.width,l=s.height||e.clientHeight||o.height,c=e.offsetWidth-a,h=e.offsetHeight-l;if(c||h){var d=n(e);c-=b(d,"x"),h-=b(d,"y"),o.width-=c,o.height-=h}return k(o)}function E(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=u(10),o="HTML"===t.nodeName,s=P(e),a=P(t),c=l(e),h=n(t),d=parseFloat(h.borderTopWidth,10),p=parseFloat(h.borderLeftWidth,10);i&&o&&(a.top=Math.max(a.top,0),a.left=Math.max(a.left,0));var m=k({top:s.top-a.top-d,left:s.left-a.left-p,width:s.width,height:s.height});if(m.marginTop=0,m.marginLeft=0,!r&&o){var f=parseFloat(h.marginTop,10),b=parseFloat(h.marginLeft,10);m.top-=d-f,m.bottom-=d-f,m.left-=p-b,m.right-=p-b,m.marginTop=f,m.marginLeft=b}return(r&&!i?t.contains(c):t===c&&"BODY"!==c.nodeName)&&(m=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=g(t,"top"),o=g(t,"left"),s=i?-1:1;return e.top+=r*s,e.bottom+=r*s,e.left+=o*s,e.right+=o*s,e}(m,t)),m}function A(e){if(!e||!e.parentElement||u())return document.documentElement;for(var t=e.parentElement;t&&"none"===n(t,"transform");)t=t.parentElement;return t||document.documentElement}function C(e,t,i,r){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s={top:0,left:0},h=o?A(e):f(e,c(t));if("viewport"===r)s=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e.ownerDocument.documentElement,r=E(e,i),o=Math.max(i.clientWidth,window.innerWidth||0),s=Math.max(i.clientHeight,window.innerHeight||0),n=t?0:g(i),a=t?0:g(i,"left");return k({top:n-r.top+r.marginTop,left:a-r.left+r.marginLeft,width:o,height:s})}(h,o);else{var d=void 0;"scrollParent"===r?"BODY"===(d=l(a(t))).nodeName&&(d=e.ownerDocument.documentElement):d="window"===r?e.ownerDocument.documentElement:r;var u=E(d,h,o);if("HTML"!==d.nodeName||function e(t){var i=t.nodeName;if("BODY"===i||"HTML"===i)return!1;if("fixed"===n(t,"position"))return!0;var r=a(t);return!!r&&e(r)}(h))s=u;else{var p=v(e.ownerDocument),m=p.height,b=p.width;s.top+=u.top-u.marginTop,s.bottom=m+u.top,s.left+=u.left-u.marginLeft,s.right=b+u.left}}var _="number"==typeof(i=i||0);return s.left+=_?i:i.left||0,s.top+=_?i:i.top||0,s.right-=_?i:i.right||0,s.bottom-=_?i:i.bottom||0,s}function T(e,t,i,r,o){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(-1===e.indexOf("auto"))return e;var n=C(i,r,s,o),a={top:{width:n.width,height:t.top-n.top},right:{width:n.right-t.right,height:n.height},bottom:{width:n.width,height:n.bottom-t.bottom},left:{width:t.left-n.left,height:n.height}},l=Object.keys(a).map((function(e){return M({key:e},a[e],{area:(t=a[e],t.width*t.height)});var t})).sort((function(e,t){return t.area-e.area})),c=l.filter((function(e){var t=e.width,r=e.height;return t>=i.clientWidth&&r>=i.clientHeight})),h=c.length>0?c[0].key:l[0].key,d=e.split("-")[1];return h+(d?"-"+d:"")}function D(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return E(i,r?A(t):f(t,c(i)),r)}function S(e){var t=e.ownerDocument.defaultView.getComputedStyle(e),i=parseFloat(t.marginTop||0)+parseFloat(t.marginBottom||0),r=parseFloat(t.marginLeft||0)+parseFloat(t.marginRight||0);return{width:e.offsetWidth+r,height:e.offsetHeight+i}}function L(e){var t={left:"right",right:"left",bottom:"top",top:"bottom"};return e.replace(/left|right|bottom|top/g,(function(e){return t[e]}))}function R(e,t,i){i=i.split("-")[0];var r=S(e),o={width:r.width,height:r.height},s=-1!==["right","left"].indexOf(i),n=s?"top":"left",a=s?"left":"top",l=s?"height":"width",c=s?"width":"height";return o[n]=t[n]+t[l]/2-r[l]/2,o[a]=i===a?t[a]-r[c]:t[L(a)],o}function I(e,t){return Array.prototype.find?e.find(t):e.filter(t)[0]}function N(e,t,i){return(void 0===i?e:e.slice(0,function(e,t,i){if(Array.prototype.findIndex)return e.findIndex((function(e){return e[t]===i}));var r=I(e,(function(e){return e[t]===i}));return e.indexOf(r)}(e,"name",i))).forEach((function(e){e.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var i=e.function||e.fn;e.enabled&&s(i)&&(t.offsets.popper=k(t.offsets.popper),t.offsets.reference=k(t.offsets.reference),t=i(t,e))})),t}function F(){if(!this.state.isDestroyed){var e={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};e.offsets.reference=D(this.state,this.popper,this.reference,this.options.positionFixed),e.placement=T(this.options.placement,e.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),e.originalPlacement=e.placement,e.positionFixed=this.options.positionFixed,e.offsets.popper=R(this.popper,e.offsets.reference,e.placement),e.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",e=N(this.modifiers,e),this.state.isCreated?this.options.onUpdate(e):(this.state.isCreated=!0,this.options.onCreate(e))}}function B(e,t){return e.some((function(e){var i=e.name;return e.enabled&&i===t}))}function O(e){for(var t=[!1,"ms","Webkit","Moz","O"],i=e.charAt(0).toUpperCase()+e.slice(1),r=0;r<t.length;r++){var o=t[r],s=o?""+o+i:e;if(void 0!==document.body.style[s])return s}return null}function j(){return this.state.isDestroyed=!0,B(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[O("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function z(e){var t=e.ownerDocument;return t?t.defaultView:window}function V(e,t,i,r){i.updateBound=r,z(e).addEventListener("resize",i.updateBound,{passive:!0});var o=l(e);return function e(t,i,r,o){var s="BODY"===t.nodeName,n=s?t.ownerDocument.defaultView:t;n.addEventListener(i,r,{passive:!0}),s||e(l(n.parentNode),i,r,o),o.push(n)}(o,"scroll",i.updateBound,i.scrollParents),i.scrollElement=o,i.eventsEnabled=!0,i}function U(){this.state.eventsEnabled||(this.state=V(this.reference,this.options,this.state,this.scheduleUpdate))}function H(){var e,t;this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=(e=this.reference,t=this.state,z(e).removeEventListener("resize",t.updateBound),t.scrollParents.forEach((function(e){e.removeEventListener("scroll",t.updateBound)})),t.updateBound=null,t.scrollParents=[],t.scrollElement=null,t.eventsEnabled=!1,t))}function G(e){return""!==e&&!isNaN(parseFloat(e))&&isFinite(e)}function W(e,t){Object.keys(t).forEach((function(i){var r="";-1!==["width","height","top","right","bottom","left"].indexOf(i)&&G(t[i])&&(r="px"),e.style[i]=t[i]+r}))}var q=i&&/Firefox/i.test(navigator.userAgent);function X(e,t,i){var r=I(e,(function(e){return e.name===t})),o=!!r&&e.some((function(e){return e.name===i&&e.enabled&&e.order<r.order}));if(!o){var s="`"+t+"`",n="`"+i+"`";console.warn(n+" modifier is required by "+s+" modifier in order to work, be sure to include it before "+s+"!")}return o}var Y=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],K=Y.slice(3);function $(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=K.indexOf(e),r=K.slice(i+1).concat(K.slice(0,i));return t?r.reverse():r}var Q={FLIP:"flip",CLOCKWISE:"clockwise",COUNTERCLOCKWISE:"counterclockwise"};function Z(e,t,i,r){var o=[0,0],s=-1!==["right","left"].indexOf(r),n=e.split(/(\+|\-)/).map((function(e){return e.trim()})),a=n.indexOf(I(n,(function(e){return-1!==e.search(/,|\s/)})));n[a]&&-1===n[a].indexOf(",")&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var l=/\s*,\s*|\s+/,c=-1!==a?[n.slice(0,a).concat([n[a].split(l)[0]]),[n[a].split(l)[1]].concat(n.slice(a+1))]:[n];return(c=c.map((function(e,r){var o=(1===r?!s:s)?"height":"width",n=!1;return e.reduce((function(e,t){return""===e[e.length-1]&&-1!==["+","-"].indexOf(t)?(e[e.length-1]=t,n=!0,e):n?(e[e.length-1]+=t,n=!1,e):e.concat(t)}),[]).map((function(e){return function(e,t,i,r){var o=e.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),s=+o[1],n=o[2];if(!s)return e;if(0===n.indexOf("%")){var a=void 0;switch(n){case"%p":a=i;break;case"%":case"%r":default:a=r}return k(a)[t]/100*s}if("vh"===n||"vw"===n){return("vh"===n?Math.max(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0))/100*s}return s}(e,o,t,i)}))}))).forEach((function(e,t){e.forEach((function(i,r){G(i)&&(o[t]+=i*("-"===e[r-1]?-1:1))}))})),o}var J={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:{shift:{order:100,enabled:!0,fn:function(e){var t=e.placement,i=t.split("-")[0],r=t.split("-")[1];if(r){var o=e.offsets,s=o.reference,n=o.popper,a=-1!==["bottom","top"].indexOf(i),l=a?"left":"top",c=a?"width":"height",h={start:w({},l,s[l]),end:w({},l,s[l]+s[c]-n[c])};e.offsets.popper=M({},n,h[r])}return e}},offset:{order:200,enabled:!0,fn:function(e,t){var i=t.offset,r=e.placement,o=e.offsets,s=o.popper,n=o.reference,a=r.split("-")[0],l=void 0;return l=G(+i)?[+i,0]:Z(i,s,n,a),"left"===a?(s.top+=l[0],s.left-=l[1]):"right"===a?(s.top+=l[0],s.left+=l[1]):"top"===a?(s.left+=l[0],s.top-=l[1]):"bottom"===a&&(s.left+=l[0],s.top+=l[1]),e.popper=s,e},offset:0},preventOverflow:{order:300,enabled:!0,fn:function(e,t){var i=t.boundariesElement||p(e.instance.popper);e.instance.reference===i&&(i=p(i));var r=O("transform"),o=e.instance.popper.style,s=o.top,n=o.left,a=o[r];o.top="",o.left="",o[r]="";var l=C(e.instance.popper,e.instance.reference,t.padding,i,e.positionFixed);o.top=s,o.left=n,o[r]=a,t.boundaries=l;var c=t.priority,h=e.offsets.popper,d={primary:function(e){var i=h[e];return h[e]<l[e]&&!t.escapeWithReference&&(i=Math.max(h[e],l[e])),w({},e,i)},secondary:function(e){var i="right"===e?"left":"top",r=h[i];return h[e]>l[e]&&!t.escapeWithReference&&(r=Math.min(h[i],l[e]-("right"===e?h.width:h.height))),w({},i,r)}};return c.forEach((function(e){var t=-1!==["left","top"].indexOf(e)?"primary":"secondary";h=M({},h,d[t](e))})),e.offsets.popper=h,e},priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:function(e){var t=e.offsets,i=t.popper,r=t.reference,o=e.placement.split("-")[0],s=Math.floor,n=-1!==["top","bottom"].indexOf(o),a=n?"right":"bottom",l=n?"left":"top",c=n?"width":"height";return i[a]<s(r[l])&&(e.offsets.popper[l]=s(r[l])-i[c]),i[l]>s(r[a])&&(e.offsets.popper[l]=s(r[a])),e}},arrow:{order:500,enabled:!0,fn:function(e,t){var i;if(!X(e.instance.modifiers,"arrow","keepTogether"))return e;var r=t.element;if("string"==typeof r){if(!(r=e.instance.popper.querySelector(r)))return e}else if(!e.instance.popper.contains(r))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),e;var o=e.placement.split("-")[0],s=e.offsets,a=s.popper,l=s.reference,c=-1!==["left","right"].indexOf(o),h=c?"height":"width",d=c?"Top":"Left",u=d.toLowerCase(),p=c?"left":"top",m=c?"bottom":"right",f=S(r)[h];l[m]-f<a[u]&&(e.offsets.popper[u]-=a[u]-(l[m]-f)),l[u]+f>a[m]&&(e.offsets.popper[u]+=l[u]+f-a[m]),e.offsets.popper=k(e.offsets.popper);var g=l[u]+l[h]/2-f/2,b=n(e.instance.popper),_=parseFloat(b["margin"+d],10),v=parseFloat(b["border"+d+"Width"],10),x=g-e.offsets.popper[u]-_-v;return x=Math.max(Math.min(a[h]-f,x),0),e.arrowElement=r,e.offsets.arrow=(w(i={},u,Math.round(x)),w(i,p,""),i),e},element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:function(e,t){if(B(e.instance.modifiers,"inner"))return e;if(e.flipped&&e.placement===e.originalPlacement)return e;var i=C(e.instance.popper,e.instance.reference,t.padding,t.boundariesElement,e.positionFixed),r=e.placement.split("-")[0],o=L(r),s=e.placement.split("-")[1]||"",n=[];switch(t.behavior){case Q.FLIP:n=[r,o];break;case Q.CLOCKWISE:n=$(r);break;case Q.COUNTERCLOCKWISE:n=$(r,!0);break;default:n=t.behavior}return n.forEach((function(a,l){if(r!==a||n.length===l+1)return e;r=e.placement.split("-")[0],o=L(r);var c=e.offsets.popper,h=e.offsets.reference,d=Math.floor,u="left"===r&&d(c.right)>d(h.left)||"right"===r&&d(c.left)<d(h.right)||"top"===r&&d(c.bottom)>d(h.top)||"bottom"===r&&d(c.top)<d(h.bottom),p=d(c.left)<d(i.left),m=d(c.right)>d(i.right),f=d(c.top)<d(i.top),g=d(c.bottom)>d(i.bottom),b="left"===r&&p||"right"===r&&m||"top"===r&&f||"bottom"===r&&g,_=-1!==["top","bottom"].indexOf(r),v=!!t.flipVariations&&(_&&"start"===s&&p||_&&"end"===s&&m||!_&&"start"===s&&f||!_&&"end"===s&&g),x=!!t.flipVariationsByContent&&(_&&"start"===s&&m||_&&"end"===s&&p||!_&&"start"===s&&g||!_&&"end"===s&&f),y=v||x;(u||b||y)&&(e.flipped=!0,(u||b)&&(r=n[l+1]),y&&(s=function(e){return"end"===e?"start":"start"===e?"end":e}(s)),e.placement=r+(s?"-"+s:""),e.offsets.popper=M({},e.offsets.popper,R(e.instance.popper,e.offsets.reference,e.placement)),e=N(e.instance.modifiers,e,"flip"))})),e},behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:function(e){var t=e.placement,i=t.split("-")[0],r=e.offsets,o=r.popper,s=r.reference,n=-1!==["left","right"].indexOf(i),a=-1===["top","left"].indexOf(i);return o[n?"left":"top"]=s[i]-(a?o[n?"width":"height"]:0),e.placement=L(t),e.offsets.popper=k(o),e}},hide:{order:800,enabled:!0,fn:function(e){if(!X(e.instance.modifiers,"hide","preventOverflow"))return e;var t=e.offsets.reference,i=I(e.instance.modifiers,(function(e){return"preventOverflow"===e.name})).boundaries;if(t.bottom<i.top||t.left>i.right||t.top>i.bottom||t.right<i.left){if(!0===e.hide)return e;e.hide=!0,e.attributes["x-out-of-boundaries"]=""}else{if(!1===e.hide)return e;e.hide=!1,e.attributes["x-out-of-boundaries"]=!1}return e}},computeStyle:{order:850,enabled:!0,fn:function(e,t){var i=t.x,r=t.y,o=e.offsets.popper,s=I(e.instance.modifiers,(function(e){return"applyStyle"===e.name})).gpuAcceleration;void 0!==s&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var n=void 0!==s?s:t.gpuAcceleration,a=p(e.instance.popper),l=P(a),c={position:o.position},h=function(e,t){var i=e.offsets,r=i.popper,o=i.reference,s=Math.round,n=Math.floor,a=function(e){return e},l=s(o.width),c=s(r.width),h=-1!==["left","right"].indexOf(e.placement),d=-1!==e.placement.indexOf("-"),u=t?h||d||l%2==c%2?s:n:a,p=t?s:a;return{left:u(l%2==1&&c%2==1&&!d&&t?r.left-1:r.left),top:p(r.top),bottom:p(r.bottom),right:u(r.right)}}(e,window.devicePixelRatio<2||!q),d="bottom"===i?"top":"bottom",u="right"===r?"left":"right",m=O("transform"),f=void 0,g=void 0;if(g="bottom"===d?"HTML"===a.nodeName?-a.clientHeight+h.bottom:-l.height+h.bottom:h.top,f="right"===u?"HTML"===a.nodeName?-a.clientWidth+h.right:-l.width+h.right:h.left,n&&m)c[m]="translate3d("+f+"px, "+g+"px, 0)",c[d]=0,c[u]=0,c.willChange="transform";else{var b="bottom"===d?-1:1,_="right"===u?-1:1;c[d]=g*b,c[u]=f*_,c.willChange=d+", "+u}var v={"x-placement":e.placement};return e.attributes=M({},v,e.attributes),e.styles=M({},c,e.styles),e.arrowStyles=M({},e.offsets.arrow,e.arrowStyles),e},gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:function(e){var t,i;return W(e.instance.popper,e.styles),t=e.instance.popper,i=e.attributes,Object.keys(i).forEach((function(e){!1!==i[e]?t.setAttribute(e,i[e]):t.removeAttribute(e)})),e.arrowElement&&Object.keys(e.arrowStyles).length&&W(e.arrowElement,e.arrowStyles),e},onLoad:function(e,t,i,r,o){var s=D(o,t,e,i.positionFixed),n=T(i.placement,s,t,e,i.modifiers.flip.boundariesElement,i.modifiers.flip.padding);return t.setAttribute("x-placement",n),W(t,{position:i.positionFixed?"fixed":"absolute"}),i},gpuAcceleration:void 0}}},ee=function(){function e(t,i){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};x(this,e),this.scheduleUpdate=function(){return requestAnimationFrame(r.update)},this.update=o(this.update.bind(this)),this.options=M({},e.Defaults,n),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=t&&t.jquery?t[0]:t,this.popper=i&&i.jquery?i[0]:i,this.options.modifiers={},Object.keys(M({},e.Defaults.modifiers,n.modifiers)).forEach((function(t){r.options.modifiers[t]=M({},e.Defaults.modifiers[t]||{},n.modifiers?n.modifiers[t]:{})})),this.modifiers=Object.keys(this.options.modifiers).map((function(e){return M({name:e},r.options.modifiers[e])})).sort((function(e,t){return e.order-t.order})),this.modifiers.forEach((function(e){e.enabled&&s(e.onLoad)&&e.onLoad(r.reference,r.popper,r.options,e,r.state)})),this.update();var a=this.options.eventsEnabled;a&&this.enableEventListeners(),this.state.eventsEnabled=a}return y(e,[{key:"update",value:function(){return F.call(this)}},{key:"destroy",value:function(){return j.call(this)}},{key:"enableEventListeners",value:function(){return U.call(this)}},{key:"disableEventListeners",value:function(){return H.call(this)}}]),e}();ee.Utils=("undefined"!=typeof window?window:e).PopperUtils,ee.placements=Y,ee.Defaults=J,t.default=ee}.call(this,i(4))},function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof window&&(i=window)}e.exports=i},function(e,t,i){var r=i(6);"string"==typeof r&&(r=[[e.i,r,""]]);var o={insert:"head",singleton:!1};i(8)(r,o);r.locals&&(e.exports=r.locals)},function(e,t,i){(e.exports=i(7)(!1)).push([e.i,'/*!\n * Bootstrap v4.3.1 (https://getbootstrap.com/)\n * Copyright 2011-2019 The Bootstrap Authors\n * Copyright 2011-2019 Twitter, Inc.\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n */:root{--blue: #007bff;--indigo: #6610f2;--purple: #6f42c1;--pink: #e83e8c;--red: #dc3545;--orange: #fd7e14;--yellow: #ffc107;--green: #28a745;--teal: #20c997;--cyan: #17a2b8;--white: #fff;--gray: #6c757d;--gray-dark: #343a40;--primary: #007bff;--secondary: #6c757d;--success: #28a745;--info: #17a2b8;--warning: #ffc107;--danger: #dc3545;--light: #f8f9fa;--dark: #343a40;--breakpoint-xs: 0;--breakpoint-sm: 576px;--breakpoint-md: 768px;--breakpoint-lg: 992px;--breakpoint-xl: 1200px;--font-family-sans-serif: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";--font-family-monospace: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}*,*::before,*::after{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:rgba(0,0,0,0)}article,aside,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff}[tabindex="-1"]:focus{outline:0 !important}hr{box-sizing:content-box;height:0;overflow:visible}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem}p{margin-top:0;margin-bottom:1rem}abbr[title],abbr[data-original-title]{text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;border-bottom:0;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul,dl{margin-top:0;margin-bottom:1rem}ol ol,ul ul,ol ul,ul ol{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:80%}sub,sup{position:relative;font-size:75%;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#007bff;text-decoration:none;background-color:transparent}a:hover{color:#0056b3;text-decoration:underline}a:not([href]):not([tabindex]){color:inherit;text-decoration:none}a:not([href]):not([tabindex]):hover,a:not([href]):not([tabindex]):focus{color:inherit;text-decoration:none}a:not([href]):not([tabindex]):focus{outline:0}pre,code,kbd,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em}pre{margin-top:0;margin-bottom:1rem;overflow:auto}figure{margin:0 0 1rem}img{vertical-align:middle;border-style:none}svg{overflow:hidden;vertical-align:middle}table{border-collapse:collapse}caption{padding-top:.75rem;padding-bottom:.75rem;color:#6c757d;text-align:left;caption-side:bottom}th{text-align:inherit}label{display:inline-block;margin-bottom:.5rem}button{border-radius:0}button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}input,button,select,optgroup,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,input{overflow:visible}button,select{text-transform:none}select{word-wrap:normal}button,[type="button"],[type="reset"],[type="submit"]{-webkit-appearance:button}button:not(:disabled),[type="button"]:not(:disabled),[type="reset"]:not(:disabled),[type="submit"]:not(:disabled){cursor:pointer}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{padding:0;border-style:none}input[type="radio"],input[type="checkbox"]{box-sizing:border-box;padding:0}input[type="date"],input[type="time"],input[type="datetime-local"],input[type="month"]{-webkit-appearance:listbox}textarea{overflow:auto;resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{display:block;width:100%;max-width:100%;padding:0;margin-bottom:.5rem;font-size:1.5rem;line-height:inherit;color:inherit;white-space:normal}progress{vertical-align:baseline}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{height:auto}[type="search"]{outline-offset:-2px;-webkit-appearance:none}[type="search"]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}summary{display:list-item;cursor:pointer}template{display:none}[hidden]{display:none !important}h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6{margin-bottom:.5rem;font-weight:500;line-height:1.2}h1,.h1{font-size:2.5rem}h2,.h2{font-size:2rem}h3,.h3{font-size:1.75rem}h4,.h4{font-size:1.5rem}h5,.h5{font-size:1.25rem}h6,.h6{font-size:1rem}.lead{font-size:1.25rem;font-weight:300}.display-1{font-size:6rem;font-weight:300;line-height:1.2}.display-2{font-size:5.5rem;font-weight:300;line-height:1.2}.display-3{font-size:4.5rem;font-weight:300;line-height:1.2}.display-4{font-size:3.5rem;font-weight:300;line-height:1.2}hr{margin-top:1rem;margin-bottom:1rem;border:0;border-top:1px solid rgba(0,0,0,0.1)}small,.small{font-size:80%;font-weight:400}mark,.mark{padding:.2em;background-color:#fcf8e3}.list-unstyled{padding-left:0;list-style:none}.list-inline{padding-left:0;list-style:none}.list-inline-item{display:inline-block}.list-inline-item:not(:last-child){margin-right:.5rem}.initialism{font-size:90%;text-transform:uppercase}.blockquote{margin-bottom:1rem;font-size:1.25rem}.blockquote-footer{display:block;font-size:80%;color:#6c757d}.blockquote-footer::before{content:"\\2014\\00A0"}.img-fluid{max-width:100%;height:auto}.img-thumbnail{padding:.25rem;background-color:#fff;border:1px solid #dee2e6;border-radius:.25rem;max-width:100%;height:auto}.figure{display:inline-block}.figure-img{margin-bottom:.5rem;line-height:1}.figure-caption{font-size:90%;color:#6c757d}code{font-size:87.5%;color:#e83e8c;word-break:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:87.5%;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:100%;font-weight:700}pre{display:block;font-size:87.5%;color:#212529}pre code{font-size:inherit;color:inherit;word-break:normal}.pre-scrollable{max-height:340px;overflow-y:scroll}.container{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media (min-width: 576px){.container{max-width:540px}}@media (min-width: 768px){.container{max-width:720px}}@media (min-width: 992px){.container{max-width:960px}}@media (min-width: 1200px){.container{max-width:1140px}}.container-fluid{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}.row{display:-webkit-box;display:flex;flex-wrap:wrap;margin-right:-15px;margin-left:-15px}.no-gutters{margin-right:0;margin-left:0}.no-gutters>.col,.no-gutters>[class*="col-"]{padding-right:0;padding-left:0}.col-1,.col-2,.col-3,.col-4,.col-5,.col-6,.col-7,.col-8,.col-9,.col-10,.col-11,.col-12,.col,.col-auto,.col-sm-1,.col-sm-2,.col-sm-3,.col-sm-4,.col-sm-5,.col-sm-6,.col-sm-7,.col-sm-8,.col-sm-9,.col-sm-10,.col-sm-11,.col-sm-12,.col-sm,.col-sm-auto,.col-md-1,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9,.col-md-10,.col-md-11,.col-md-12,.col-md,.col-md-auto,.col-lg-1,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg,.col-lg-auto,.col-xl-1,.col-xl-2,.col-xl-3,.col-xl-4,.col-xl-5,.col-xl-6,.col-xl-7,.col-xl-8,.col-xl-9,.col-xl-10,.col-xl-11,.col-xl-12,.col-xl,.col-xl-auto{position:relative;width:100%;padding-right:15px;padding-left:15px}.col{flex-basis:0;-webkit-box-flex:1;flex-grow:1;max-width:100%}.col-auto{-webkit-box-flex:0;flex:0 0 auto;width:auto;max-width:100%}.col-1{-webkit-box-flex:0;flex:0 0 8.33333%;max-width:8.33333%}.col-2{-webkit-box-flex:0;flex:0 0 16.66667%;max-width:16.66667%}.col-3{-webkit-box-flex:0;flex:0 0 25%;max-width:25%}.col-4{-webkit-box-flex:0;flex:0 0 33.33333%;max-width:33.33333%}.col-5{-webkit-box-flex:0;flex:0 0 41.66667%;max-width:41.66667%}.col-6{-webkit-box-flex:0;flex:0 0 50%;max-width:50%}.col-7{-webkit-box-flex:0;flex:0 0 58.33333%;max-width:58.33333%}.col-8{-webkit-box-flex:0;flex:0 0 66.66667%;max-width:66.66667%}.col-9{-webkit-box-flex:0;flex:0 0 75%;max-width:75%}.col-10{-webkit-box-flex:0;flex:0 0 83.33333%;max-width:83.33333%}.col-11{-webkit-box-flex:0;flex:0 0 91.66667%;max-width:91.66667%}.col-12{-webkit-box-flex:0;flex:0 0 100%;max-width:100%}.order-first{-webkit-box-ordinal-group:0;order:-1}.order-last{-webkit-box-ordinal-group:14;order:13}.order-0{-webkit-box-ordinal-group:1;order:0}.order-1{-webkit-box-ordinal-group:2;order:1}.order-2{-webkit-box-ordinal-group:3;order:2}.order-3{-webkit-box-ordinal-group:4;order:3}.order-4{-webkit-box-ordinal-group:5;order:4}.order-5{-webkit-box-ordinal-group:6;order:5}.order-6{-webkit-box-ordinal-group:7;order:6}.order-7{-webkit-box-ordinal-group:8;order:7}.order-8{-webkit-box-ordinal-group:9;order:8}.order-9{-webkit-box-ordinal-group:10;order:9}.order-10{-webkit-box-ordinal-group:11;order:10}.order-11{-webkit-box-ordinal-group:12;order:11}.order-12{-webkit-box-ordinal-group:13;order:12}.offset-1{margin-left:8.33333%}.offset-2{margin-left:16.66667%}.offset-3{margin-left:25%}.offset-4{margin-left:33.33333%}.offset-5{margin-left:41.66667%}.offset-6{margin-left:50%}.offset-7{margin-left:58.33333%}.offset-8{margin-left:66.66667%}.offset-9{margin-left:75%}.offset-10{margin-left:83.33333%}.offset-11{margin-left:91.66667%}@media (min-width: 576px){.col-sm{flex-basis:0;-webkit-box-flex:1;flex-grow:1;max-width:100%}.col-sm-auto{-webkit-box-flex:0;flex:0 0 auto;width:auto;max-width:100%}.col-sm-1{-webkit-box-flex:0;flex:0 0 8.33333%;max-width:8.33333%}.col-sm-2{-webkit-box-flex:0;flex:0 0 16.66667%;max-width:16.66667%}.col-sm-3{-webkit-box-flex:0;flex:0 0 25%;max-width:25%}.col-sm-4{-webkit-box-flex:0;flex:0 0 33.33333%;max-width:33.33333%}.col-sm-5{-webkit-box-flex:0;flex:0 0 41.66667%;max-width:41.66667%}.col-sm-6{-webkit-box-flex:0;flex:0 0 50%;max-width:50%}.col-sm-7{-webkit-box-flex:0;flex:0 0 58.33333%;max-width:58.33333%}.col-sm-8{-webkit-box-flex:0;flex:0 0 66.66667%;max-width:66.66667%}.col-sm-9{-webkit-box-flex:0;flex:0 0 75%;max-width:75%}.col-sm-10{-webkit-box-flex:0;flex:0 0 83.33333%;max-width:83.33333%}.col-sm-11{-webkit-box-flex:0;flex:0 0 91.66667%;max-width:91.66667%}.col-sm-12{-webkit-box-flex:0;flex:0 0 100%;max-width:100%}.order-sm-first{-webkit-box-ordinal-group:0;order:-1}.order-sm-last{-webkit-box-ordinal-group:14;order:13}.order-sm-0{-webkit-box-ordinal-group:1;order:0}.order-sm-1{-webkit-box-ordinal-group:2;order:1}.order-sm-2{-webkit-box-ordinal-group:3;order:2}.order-sm-3{-webkit-box-ordinal-group:4;order:3}.order-sm-4{-webkit-box-ordinal-group:5;order:4}.order-sm-5{-webkit-box-ordinal-group:6;order:5}.order-sm-6{-webkit-box-ordinal-group:7;order:6}.order-sm-7{-webkit-box-ordinal-group:8;order:7}.order-sm-8{-webkit-box-ordinal-group:9;order:8}.order-sm-9{-webkit-box-ordinal-group:10;order:9}.order-sm-10{-webkit-box-ordinal-group:11;order:10}.order-sm-11{-webkit-box-ordinal-group:12;order:11}.order-sm-12{-webkit-box-ordinal-group:13;order:12}.offset-sm-0{margin-left:0}.offset-sm-1{margin-left:8.33333%}.offset-sm-2{margin-left:16.66667%}.offset-sm-3{margin-left:25%}.offset-sm-4{margin-left:33.33333%}.offset-sm-5{margin-left:41.66667%}.offset-sm-6{margin-left:50%}.offset-sm-7{margin-left:58.33333%}.offset-sm-8{margin-left:66.66667%}.offset-sm-9{margin-left:75%}.offset-sm-10{margin-left:83.33333%}.offset-sm-11{margin-left:91.66667%}}@media (min-width: 768px){.col-md{flex-basis:0;-webkit-box-flex:1;flex-grow:1;max-width:100%}.col-md-auto{-webkit-box-flex:0;flex:0 0 auto;width:auto;max-width:100%}.col-md-1{-webkit-box-flex:0;flex:0 0 8.33333%;max-width:8.33333%}.col-md-2{-webkit-box-flex:0;flex:0 0 16.66667%;max-width:16.66667%}.col-md-3{-webkit-box-flex:0;flex:0 0 25%;max-width:25%}.col-md-4{-webkit-box-flex:0;flex:0 0 33.33333%;max-width:33.33333%}.col-md-5{-webkit-box-flex:0;flex:0 0 41.66667%;max-width:41.66667%}.col-md-6{-webkit-box-flex:0;flex:0 0 50%;max-width:50%}.col-md-7{-webkit-box-flex:0;flex:0 0 58.33333%;max-width:58.33333%}.col-md-8{-webkit-box-flex:0;flex:0 0 66.66667%;max-width:66.66667%}.col-md-9{-webkit-box-flex:0;flex:0 0 75%;max-width:75%}.col-md-10{-webkit-box-flex:0;flex:0 0 83.33333%;max-width:83.33333%}.col-md-11{-webkit-box-flex:0;flex:0 0 91.66667%;max-width:91.66667%}.col-md-12{-webkit-box-flex:0;flex:0 0 100%;max-width:100%}.order-md-first{-webkit-box-ordinal-group:0;order:-1}.order-md-last{-webkit-box-ordinal-group:14;order:13}.order-md-0{-webkit-box-ordinal-group:1;order:0}.order-md-1{-webkit-box-ordinal-group:2;order:1}.order-md-2{-webkit-box-ordinal-group:3;order:2}.order-md-3{-webkit-box-ordinal-group:4;order:3}.order-md-4{-webkit-box-ordinal-group:5;order:4}.order-md-5{-webkit-box-ordinal-group:6;order:5}.order-md-6{-webkit-box-ordinal-group:7;order:6}.order-md-7{-webkit-box-ordinal-group:8;order:7}.order-md-8{-webkit-box-ordinal-group:9;order:8}.order-md-9{-webkit-box-ordinal-group:10;order:9}.order-md-10{-webkit-box-ordinal-group:11;order:10}.order-md-11{-webkit-box-ordinal-group:12;order:11}.order-md-12{-webkit-box-ordinal-group:13;order:12}.offset-md-0{margin-left:0}.offset-md-1{margin-left:8.33333%}.offset-md-2{margin-left:16.66667%}.offset-md-3{margin-left:25%}.offset-md-4{margin-left:33.33333%}.offset-md-5{margin-left:41.66667%}.offset-md-6{margin-left:50%}.offset-md-7{margin-left:58.33333%}.offset-md-8{margin-left:66.66667%}.offset-md-9{margin-left:75%}.offset-md-10{margin-left:83.33333%}.offset-md-11{margin-left:91.66667%}}@media (min-width: 992px){.col-lg{flex-basis:0;-webkit-box-flex:1;flex-grow:1;max-width:100%}.col-lg-auto{-webkit-box-flex:0;flex:0 0 auto;width:auto;max-width:100%}.col-lg-1{-webkit-box-flex:0;flex:0 0 8.33333%;max-width:8.33333%}.col-lg-2{-webkit-box-flex:0;flex:0 0 16.66667%;max-width:16.66667%}.col-lg-3{-webkit-box-flex:0;flex:0 0 25%;max-width:25%}.col-lg-4{-webkit-box-flex:0;flex:0 0 33.33333%;max-width:33.33333%}.col-lg-5{-webkit-box-flex:0;flex:0 0 41.66667%;max-width:41.66667%}.col-lg-6{-webkit-box-flex:0;flex:0 0 50%;max-width:50%}.col-lg-7{-webkit-box-flex:0;flex:0 0 58.33333%;max-width:58.33333%}.col-lg-8{-webkit-box-flex:0;flex:0 0 66.66667%;max-width:66.66667%}.col-lg-9{-webkit-box-flex:0;flex:0 0 75%;max-width:75%}.col-lg-10{-webkit-box-flex:0;flex:0 0 83.33333%;max-width:83.33333%}.col-lg-11{-webkit-box-flex:0;flex:0 0 91.66667%;max-width:91.66667%}.col-lg-12{-webkit-box-flex:0;flex:0 0 100%;max-width:100%}.order-lg-first{-webkit-box-ordinal-group:0;order:-1}.order-lg-last{-webkit-box-ordinal-group:14;order:13}.order-lg-0{-webkit-box-ordinal-group:1;order:0}.order-lg-1{-webkit-box-ordinal-group:2;order:1}.order-lg-2{-webkit-box-ordinal-group:3;order:2}.order-lg-3{-webkit-box-ordinal-group:4;order:3}.order-lg-4{-webkit-box-ordinal-group:5;order:4}.order-lg-5{-webkit-box-ordinal-group:6;order:5}.order-lg-6{-webkit-box-ordinal-group:7;order:6}.order-lg-7{-webkit-box-ordinal-group:8;order:7}.order-lg-8{-webkit-box-ordinal-group:9;order:8}.order-lg-9{-webkit-box-ordinal-group:10;order:9}.order-lg-10{-webkit-box-ordinal-group:11;order:10}.order-lg-11{-webkit-box-ordinal-group:12;order:11}.order-lg-12{-webkit-box-ordinal-group:13;order:12}.offset-lg-0{margin-left:0}.offset-lg-1{margin-left:8.33333%}.offset-lg-2{margin-left:16.66667%}.offset-lg-3{margin-left:25%}.offset-lg-4{margin-left:33.33333%}.offset-lg-5{margin-left:41.66667%}.offset-lg-6{margin-left:50%}.offset-lg-7{margin-left:58.33333%}.offset-lg-8{margin-left:66.66667%}.offset-lg-9{margin-left:75%}.offset-lg-10{margin-left:83.33333%}.offset-lg-11{margin-left:91.66667%}}@media (min-width: 1200px){.col-xl{flex-basis:0;-webkit-box-flex:1;flex-grow:1;max-width:100%}.col-xl-auto{-webkit-box-flex:0;flex:0 0 auto;width:auto;max-width:100%}.col-xl-1{-webkit-box-flex:0;flex:0 0 8.33333%;max-width:8.33333%}.col-xl-2{-webkit-box-flex:0;flex:0 0 16.66667%;max-width:16.66667%}.col-xl-3{-webkit-box-flex:0;flex:0 0 25%;max-width:25%}.col-xl-4{-webkit-box-flex:0;flex:0 0 33.33333%;max-width:33.33333%}.col-xl-5{-webkit-box-flex:0;flex:0 0 41.66667%;max-width:41.66667%}.col-xl-6{-webkit-box-flex:0;flex:0 0 50%;max-width:50%}.col-xl-7{-webkit-box-flex:0;flex:0 0 58.33333%;max-width:58.33333%}.col-xl-8{-webkit-box-flex:0;flex:0 0 66.66667%;max-width:66.66667%}.col-xl-9{-webkit-box-flex:0;flex:0 0 75%;max-width:75%}.col-xl-10{-webkit-box-flex:0;flex:0 0 83.33333%;max-width:83.33333%}.col-xl-11{-webkit-box-flex:0;flex:0 0 91.66667%;max-width:91.66667%}.col-xl-12{-webkit-box-flex:0;flex:0 0 100%;max-width:100%}.order-xl-first{-webkit-box-ordinal-group:0;order:-1}.order-xl-last{-webkit-box-ordinal-group:14;order:13}.order-xl-0{-webkit-box-ordinal-group:1;order:0}.order-xl-1{-webkit-box-ordinal-group:2;order:1}.order-xl-2{-webkit-box-ordinal-group:3;order:2}.order-xl-3{-webkit-box-ordinal-group:4;order:3}.order-xl-4{-webkit-box-ordinal-group:5;order:4}.order-xl-5{-webkit-box-ordinal-group:6;order:5}.order-xl-6{-webkit-box-ordinal-group:7;order:6}.order-xl-7{-webkit-box-ordinal-group:8;order:7}.order-xl-8{-webkit-box-ordinal-group:9;order:8}.order-xl-9{-webkit-box-ordinal-group:10;order:9}.order-xl-10{-webkit-box-ordinal-group:11;order:10}.order-xl-11{-webkit-box-ordinal-group:12;order:11}.order-xl-12{-webkit-box-ordinal-group:13;order:12}.offset-xl-0{margin-left:0}.offset-xl-1{margin-left:8.33333%}.offset-xl-2{margin-left:16.66667%}.offset-xl-3{margin-left:25%}.offset-xl-4{margin-left:33.33333%}.offset-xl-5{margin-left:41.66667%}.offset-xl-6{margin-left:50%}.offset-xl-7{margin-left:58.33333%}.offset-xl-8{margin-left:66.66667%}.offset-xl-9{margin-left:75%}.offset-xl-10{margin-left:83.33333%}.offset-xl-11{margin-left:91.66667%}}.table{width:100%;margin-bottom:1rem;color:#212529}.table th,.table td{padding:.75rem;vertical-align:top;border-top:1px solid #dee2e6}.table thead th{vertical-align:bottom;border-bottom:2px solid #dee2e6}.table tbody+tbody{border-top:2px solid #dee2e6}.table-sm th,.table-sm td{padding:.3rem}.table-bordered{border:1px solid #dee2e6}.table-bordered th,.table-bordered td{border:1px solid #dee2e6}.table-bordered thead th,.table-bordered thead td{border-bottom-width:2px}.table-borderless th,.table-borderless td,.table-borderless thead th,.table-borderless tbody+tbody{border:0}.table-striped tbody tr:nth-of-type(odd){background-color:rgba(0,0,0,0.05)}.table-hover tbody tr:hover{color:#212529;background-color:rgba(0,0,0,0.075)}.table-primary,.table-primary>th,.table-primary>td{background-color:#b8daff}.table-primary th,.table-primary td,.table-primary thead th,.table-primary tbody+tbody{border-color:#7abaff}.table-hover .table-primary:hover{background-color:#9fcdff}.table-hover .table-primary:hover>td,.table-hover .table-primary:hover>th{background-color:#9fcdff}.table-secondary,.table-secondary>th,.table-secondary>td{background-color:#d6d8db}.table-secondary th,.table-secondary td,.table-secondary thead th,.table-secondary tbody+tbody{border-color:#b3b7bb}.table-hover .table-secondary:hover{background-color:#c8cbcf}.table-hover .table-secondary:hover>td,.table-hover .table-secondary:hover>th{background-color:#c8cbcf}.table-success,.table-success>th,.table-success>td{background-color:#c3e6cb}.table-success th,.table-success td,.table-success thead th,.table-success tbody+tbody{border-color:#8fd19e}.table-hover .table-success:hover{background-color:#b1dfbb}.table-hover .table-success:hover>td,.table-hover .table-success:hover>th{background-color:#b1dfbb}.table-info,.table-info>th,.table-info>td{background-color:#bee5eb}.table-info th,.table-info td,.table-info thead th,.table-info tbody+tbody{border-color:#86cfda}.table-hover .table-info:hover{background-color:#abdde5}.table-hover .table-info:hover>td,.table-hover .table-info:hover>th{background-color:#abdde5}.table-warning,.table-warning>th,.table-warning>td{background-color:#ffeeba}.table-warning th,.table-warning td,.table-warning thead th,.table-warning tbody+tbody{border-color:#ffdf7e}.table-hover .table-warning:hover{background-color:#ffe8a1}.table-hover .table-warning:hover>td,.table-hover .table-warning:hover>th{background-color:#ffe8a1}.table-danger,.table-danger>th,.table-danger>td{background-color:#f5c6cb}.table-danger th,.table-danger td,.table-danger thead th,.table-danger tbody+tbody{border-color:#ed969e}.table-hover .table-danger:hover{background-color:#f1b0b7}.table-hover .table-danger:hover>td,.table-hover .table-danger:hover>th{background-color:#f1b0b7}.table-light,.table-light>th,.table-light>td{background-color:#fdfdfe}.table-light th,.table-light td,.table-light thead th,.table-light tbody+tbody{border-color:#fbfcfc}.table-hover .table-light:hover{background-color:#ececf6}.table-hover .table-light:hover>td,.table-hover .table-light:hover>th{background-color:#ececf6}.table-dark,.table-dark>th,.table-dark>td{background-color:#c6c8ca}.table-dark th,.table-dark td,.table-dark thead th,.table-dark tbody+tbody{border-color:#95999c}.table-hover .table-dark:hover{background-color:#b9bbbe}.table-hover .table-dark:hover>td,.table-hover .table-dark:hover>th{background-color:#b9bbbe}.table-active,.table-active>th,.table-active>td{background-color:rgba(0,0,0,0.075)}.table-hover .table-active:hover{background-color:rgba(0,0,0,0.075)}.table-hover .table-active:hover>td,.table-hover .table-active:hover>th{background-color:rgba(0,0,0,0.075)}.table .thead-dark th{color:#fff;background-color:#343a40;border-color:#454d55}.table .thead-light th{color:#495057;background-color:#e9ecef;border-color:#dee2e6}.table-dark{color:#fff;background-color:#343a40}.table-dark th,.table-dark td,.table-dark thead th{border-color:#454d55}.table-dark.table-bordered{border:0}.table-dark.table-striped tbody tr:nth-of-type(odd){background-color:rgba(255,255,255,0.05)}.table-dark.table-hover tbody tr:hover{color:#fff;background-color:rgba(255,255,255,0.075)}@media (max-width: 575.98px){.table-responsive-sm{display:block;width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch}.table-responsive-sm>.table-bordered{border:0}}@media (max-width: 767.98px){.table-responsive-md{display:block;width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch}.table-responsive-md>.table-bordered{border:0}}@media (max-width: 991.98px){.table-responsive-lg{display:block;width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch}.table-responsive-lg>.table-bordered{border:0}}@media (max-width: 1199.98px){.table-responsive-xl{display:block;width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch}.table-responsive-xl>.table-bordered{border:0}}.table-responsive{display:block;width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch}.table-responsive>.table-bordered{border:0}.form-control{display:block;width:100%;height:calc(1.5em + .75rem + 2px);padding:.375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#495057;background-color:#fff;background-clip:padding-box;border:1px solid #ced4da;border-radius:.25rem;-webkit-transition:border-color 0.15s ease-in-out,box-shadow 0.15s ease-in-out;transition:border-color 0.15s ease-in-out,box-shadow 0.15s ease-in-out}@media (prefers-reduced-motion: reduce){.form-control{-webkit-transition:none;transition:none}}.form-control::-ms-expand{background-color:transparent;border:0}.form-control:focus{color:#495057;background-color:#fff;border-color:#80bdff;outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,0.25)}.form-control::-webkit-input-placeholder{color:#6c757d;opacity:1}.form-control::-moz-placeholder{color:#6c757d;opacity:1}.form-control:-ms-input-placeholder{color:#6c757d;opacity:1}.form-control::-ms-input-placeholder{color:#6c757d;opacity:1}.form-control::placeholder{color:#6c757d;opacity:1}.form-control:disabled,.form-control[readonly]{background-color:#e9ecef;opacity:1}select.form-control:focus::-ms-value{color:#495057;background-color:#fff}.form-control-file,.form-control-range{display:block;width:100%}.col-form-label{padding-top:calc(.375rem + 1px);padding-bottom:calc(.375rem + 1px);margin-bottom:0;font-size:inherit;line-height:1.5}.col-form-label-lg{padding-top:calc(.5rem + 1px);padding-bottom:calc(.5rem + 1px);font-size:1.25rem;line-height:1.5}.col-form-label-sm{padding-top:calc(.25rem + 1px);padding-bottom:calc(.25rem + 1px);font-size:.875rem;line-height:1.5}.form-control-plaintext{display:block;width:100%;padding-top:.375rem;padding-bottom:.375rem;margin-bottom:0;line-height:1.5;color:#212529;background-color:transparent;border:solid transparent;border-width:1px 0}.form-control-plaintext.form-control-sm,.form-control-plaintext.form-control-lg{padding-right:0;padding-left:0}.form-control-sm{height:calc(1.5em + .5rem + 2px);padding:.25rem .5rem;font-size:.875rem;line-height:1.5;border-radius:.2rem}.form-control-lg{height:calc(1.5em + 1rem + 2px);padding:.5rem 1rem;font-size:1.25rem;line-height:1.5;border-radius:.3rem}select.form-control[size],select.form-control[multiple]{height:auto}textarea.form-control{height:auto}.form-group{margin-bottom:1rem}.form-text{display:block;margin-top:.25rem}.form-row{display:-webkit-box;display:flex;flex-wrap:wrap;margin-right:-5px;margin-left:-5px}.form-row>.col,.form-row>[class*="col-"]{padding-right:5px;padding-left:5px}.form-check{position:relative;display:block;padding-left:1.25rem}.form-check-input{position:absolute;margin-top:.3rem;margin-left:-1.25rem}.form-check-input:disabled ~ .form-check-label{color:#6c757d}.form-check-label{margin-bottom:0}.form-check-inline{display:-webkit-inline-box;display:inline-flex;-webkit-box-align:center;align-items:center;padding-left:0;margin-right:.75rem}.form-check-inline .form-check-input{position:static;margin-top:0;margin-right:.3125rem;margin-left:0}.valid-feedback{display:none;width:100%;margin-top:.25rem;font-size:80%;color:#28a745}.valid-tooltip{position:absolute;top:100%;z-index:5;display:none;max-width:100%;padding:.25rem .5rem;margin-top:.1rem;font-size:.875rem;line-height:1.5;color:#fff;background-color:rgba(40,167,69,0.9);border-radius:.25rem}.was-validated .form-control:valid,.form-control.is-valid{border-color:#28a745;padding-right:calc(1.5em + .75rem);background-image:url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 8 8\'%3e%3cpath fill=\'%2328a745\' d=\'M2.3 6.73L.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z\'/%3e%3c/svg%3e");background-repeat:no-repeat;background-position:center right calc(.375em + .1875rem);background-size:calc(.75em + .375rem) calc(.75em + .375rem)}.was-validated .form-control:valid:focus,.form-control.is-valid:focus{border-color:#28a745;box-shadow:0 0 0 .2rem rgba(40,167,69,0.25)}.was-validated .form-control:valid ~ .valid-feedback,.was-validated .form-control:valid ~ .valid-tooltip,.form-control.is-valid ~ .valid-feedback,.form-control.is-valid ~ .valid-tooltip{display:block}.was-validated textarea.form-control:valid,textarea.form-control.is-valid{padding-right:calc(1.5em + .75rem);background-position:top calc(.375em + .1875rem) right calc(.375em + .1875rem)}.was-validated .custom-select:valid,.custom-select.is-valid{border-color:#28a745;padding-right:calc((1em + .75rem) * 3 / 4 + 1.75rem);background:url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 4 5\'%3e%3cpath fill=\'%23343a40\' d=\'M2 0L0 2h4zm0 5L0 3h4z\'/%3e%3c/svg%3e") no-repeat right .75rem center/8px 10px,url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 8 8\'%3e%3cpath fill=\'%2328a745\' d=\'M2.3 6.73L.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z\'/%3e%3c/svg%3e") #fff no-repeat center right 1.75rem/calc(.75em + .375rem) calc(.75em + .375rem)}.was-validated .custom-select:valid:focus,.custom-select.is-valid:focus{border-color:#28a745;box-shadow:0 0 0 .2rem rgba(40,167,69,0.25)}.was-validated .custom-select:valid ~ .valid-feedback,.was-validated .custom-select:valid ~ .valid-tooltip,.custom-select.is-valid ~ .valid-feedback,.custom-select.is-valid ~ .valid-tooltip{display:block}.was-validated .form-control-file:valid ~ .valid-feedback,.was-validated .form-control-file:valid ~ .valid-tooltip,.form-control-file.is-valid ~ .valid-feedback,.form-control-file.is-valid ~ .valid-tooltip{display:block}.was-validated .form-check-input:valid ~ .form-check-label,.form-check-input.is-valid ~ .form-check-label{color:#28a745}.was-validated .form-check-input:valid ~ .valid-feedback,.was-validated .form-check-input:valid ~ .valid-tooltip,.form-check-input.is-valid ~ .valid-feedback,.form-check-input.is-valid ~ .valid-tooltip{display:block}.was-validated .custom-control-input:valid ~ .custom-control-label,.custom-control-input.is-valid ~ .custom-control-label{color:#28a745}.was-validated .custom-control-input:valid ~ .custom-control-label::before,.custom-control-input.is-valid ~ .custom-control-label::before{border-color:#28a745}.was-validated .custom-control-input:valid ~ .valid-feedback,.was-validated .custom-control-input:valid ~ .valid-tooltip,.custom-control-input.is-valid ~ .valid-feedback,.custom-control-input.is-valid ~ .valid-tooltip{display:block}.was-validated .custom-control-input:valid:checked ~ .custom-control-label::before,.custom-control-input.is-valid:checked ~ .custom-control-label::before{border-color:#34ce57;background-color:#34ce57}.was-validated .custom-control-input:valid:focus ~ .custom-control-label::before,.custom-control-input.is-valid:focus ~ .custom-control-label::before{box-shadow:0 0 0 .2rem rgba(40,167,69,0.25)}.was-validated .custom-control-input:valid:focus:not(:checked) ~ .custom-control-label::before,.custom-control-input.is-valid:focus:not(:checked) ~ .custom-control-label::before{border-color:#28a745}.was-validated .custom-file-input:valid ~ .custom-file-label,.custom-file-input.is-valid ~ .custom-file-label{border-color:#28a745}.was-validated .custom-file-input:valid ~ .valid-feedback,.was-validated .custom-file-input:valid ~ .valid-tooltip,.custom-file-input.is-valid ~ .valid-feedback,.custom-file-input.is-valid ~ .valid-tooltip{display:block}.was-validated .custom-file-input:valid:focus ~ .custom-file-label,.custom-file-input.is-valid:focus ~ .custom-file-label{border-color:#28a745;box-shadow:0 0 0 .2rem rgba(40,167,69,0.25)}.invalid-feedback{display:none;width:100%;margin-top:.25rem;font-size:80%;color:#dc3545}.invalid-tooltip{position:absolute;top:100%;z-index:5;display:none;max-width:100%;padding:.25rem .5rem;margin-top:.1rem;font-size:.875rem;line-height:1.5;color:#fff;background-color:rgba(220,53,69,0.9);border-radius:.25rem}.was-validated .form-control:invalid,.form-control.is-invalid{border-color:#dc3545;padding-right:calc(1.5em + .75rem);background-image:url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' fill=\'%23dc3545\' viewBox=\'-2 -2 7 7\'%3e%3cpath stroke=\'%23dc3545\' d=\'M0 0l3 3m0-3L0 3\'/%3e%3ccircle r=\'.5\'/%3e%3ccircle cx=\'3\' r=\'.5\'/%3e%3ccircle cy=\'3\' r=\'.5\'/%3e%3ccircle cx=\'3\' cy=\'3\' r=\'.5\'/%3e%3c/svg%3E");background-repeat:no-repeat;background-position:center right calc(.375em + .1875rem);background-size:calc(.75em + .375rem) calc(.75em + .375rem)}.was-validated .form-control:invalid:focus,.form-control.is-invalid:focus{border-color:#dc3545;box-shadow:0 0 0 .2rem rgba(220,53,69,0.25)}.was-validated .form-control:invalid ~ .invalid-feedback,.was-validated .form-control:invalid ~ .invalid-tooltip,.form-control.is-invalid ~ .invalid-feedback,.form-control.is-invalid ~ .invalid-tooltip{display:block}.was-validated textarea.form-control:invalid,textarea.form-control.is-invalid{padding-right:calc(1.5em + .75rem);background-position:top calc(.375em + .1875rem) right calc(.375em + .1875rem)}.was-validated .custom-select:invalid,.custom-select.is-invalid{border-color:#dc3545;padding-right:calc((1em + .75rem) * 3 / 4 + 1.75rem);background:url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 4 5\'%3e%3cpath fill=\'%23343a40\' d=\'M2 0L0 2h4zm0 5L0 3h4z\'/%3e%3c/svg%3e") no-repeat right .75rem center/8px 10px,url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' fill=\'%23dc3545\' viewBox=\'-2 -2 7 7\'%3e%3cpath stroke=\'%23dc3545\' d=\'M0 0l3 3m0-3L0 3\'/%3e%3ccircle r=\'.5\'/%3e%3ccircle cx=\'3\' r=\'.5\'/%3e%3ccircle cy=\'3\' r=\'.5\'/%3e%3ccircle cx=\'3\' cy=\'3\' r=\'.5\'/%3e%3c/svg%3E") #fff no-repeat center right 1.75rem/calc(.75em + .375rem) calc(.75em + .375rem)}.was-validated .custom-select:invalid:focus,.custom-select.is-invalid:focus{border-color:#dc3545;box-shadow:0 0 0 .2rem rgba(220,53,69,0.25)}.was-validated .custom-select:invalid ~ .invalid-feedback,.was-validated .custom-select:invalid ~ .invalid-tooltip,.custom-select.is-invalid ~ .invalid-feedback,.custom-select.is-invalid ~ .invalid-tooltip{display:block}.was-validated .form-control-file:invalid ~ .invalid-feedback,.was-validated .form-control-file:invalid ~ .invalid-tooltip,.form-control-file.is-invalid ~ .invalid-feedback,.form-control-file.is-invalid ~ .invalid-tooltip{display:block}.was-validated .form-check-input:invalid ~ .form-check-label,.form-check-input.is-invalid ~ .form-check-label{color:#dc3545}.was-validated .form-check-input:invalid ~ .invalid-feedback,.was-validated .form-check-input:invalid ~ .invalid-tooltip,.form-check-input.is-invalid ~ .invalid-feedback,.form-check-input.is-invalid ~ .invalid-tooltip{display:block}.was-validated .custom-control-input:invalid ~ .custom-control-label,.custom-control-input.is-invalid ~ .custom-control-label{color:#dc3545}.was-validated .custom-control-input:invalid ~ .custom-control-label::before,.custom-control-input.is-invalid ~ .custom-control-label::before{border-color:#dc3545}.was-validated .custom-control-input:invalid ~ .invalid-feedback,.was-validated .custom-control-input:invalid ~ .invalid-tooltip,.custom-control-input.is-invalid ~ .invalid-feedback,.custom-control-input.is-invalid ~ .invalid-tooltip{display:block}.was-validated .custom-control-input:invalid:checked ~ .custom-control-label::before,.custom-control-input.is-invalid:checked ~ .custom-control-label::before{border-color:#e4606d;background-color:#e4606d}.was-validated .custom-control-input:invalid:focus ~ .custom-control-label::before,.custom-control-input.is-invalid:focus ~ .custom-control-label::before{box-shadow:0 0 0 .2rem rgba(220,53,69,0.25)}.was-validated .custom-control-input:invalid:focus:not(:checked) ~ .custom-control-label::before,.custom-control-input.is-invalid:focus:not(:checked) ~ .custom-control-label::before{border-color:#dc3545}.was-validated .custom-file-input:invalid ~ .custom-file-label,.custom-file-input.is-invalid ~ .custom-file-label{border-color:#dc3545}.was-validated .custom-file-input:invalid ~ .invalid-feedback,.was-validated .custom-file-input:invalid ~ .invalid-tooltip,.custom-file-input.is-invalid ~ .invalid-feedback,.custom-file-input.is-invalid ~ .invalid-tooltip{display:block}.was-validated .custom-file-input:invalid:focus ~ .custom-file-label,.custom-file-input.is-invalid:focus ~ .custom-file-label{border-color:#dc3545;box-shadow:0 0 0 .2rem rgba(220,53,69,0.25)}.form-inline{display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-flow:row wrap;-webkit-box-align:center;align-items:center}.form-inline .form-check{width:100%}@media (min-width: 576px){.form-inline label{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center;margin-bottom:0}.form-inline .form-group{display:-webkit-box;display:flex;-webkit-box-flex:0;flex:0 0 auto;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-flow:row wrap;-webkit-box-align:center;align-items:center;margin-bottom:0}.form-inline .form-control{display:inline-block;width:auto;vertical-align:middle}.form-inline .form-control-plaintext{display:inline-block}.form-inline .input-group,.form-inline .custom-select{width:auto}.form-inline .form-check{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center;width:auto;padding-left:0}.form-inline .form-check-input{position:relative;flex-shrink:0;margin-top:0;margin-right:.25rem;margin-left:0}.form-inline .custom-control{-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center}.form-inline .custom-control-label{margin-bottom:0}}.btn{display:inline-block;font-weight:400;color:#212529;text-align:center;vertical-align:middle;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;padding:.375rem .75rem;font-size:1rem;line-height:1.5;border-radius:.25rem;-webkit-transition:color 0.15s ease-in-out,background-color 0.15s ease-in-out,border-color 0.15s ease-in-out,box-shadow 0.15s ease-in-out;transition:color 0.15s ease-in-out,background-color 0.15s ease-in-out,border-color 0.15s ease-in-out,box-shadow 0.15s ease-in-out}@media (prefers-reduced-motion: reduce){.btn{-webkit-transition:none;transition:none}}.btn:hover{color:#212529;text-decoration:none}.btn:focus,.btn.focus{outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,0.25)}.btn.disabled,.btn:disabled{opacity:.65}a.btn.disabled,fieldset:disabled a.btn{pointer-events:none}.btn-primary{color:#fff;background-color:#007bff;border-color:#007bff}.btn-primary:hover{color:#fff;background-color:#0069d9;border-color:#0062cc}.btn-primary:focus,.btn-primary.focus{box-shadow:0 0 0 .2rem rgba(38,143,255,0.5)}.btn-primary.disabled,.btn-primary:disabled{color:#fff;background-color:#007bff;border-color:#007bff}.btn-primary:not(:disabled):not(.disabled):active,.btn-primary:not(:disabled):not(.disabled).active,.show>.btn-primary.dropdown-toggle{color:#fff;background-color:#0062cc;border-color:#005cbf}.btn-primary:not(:disabled):not(.disabled):active:focus,.btn-primary:not(:disabled):not(.disabled).active:focus,.show>.btn-primary.dropdown-toggle:focus{box-shadow:0 0 0 .2rem rgba(38,143,255,0.5)}.btn-secondary{color:#fff;background-color:#6c757d;border-color:#6c757d}.btn-secondary:hover{color:#fff;background-color:#5a6268;border-color:#545b62}.btn-secondary:focus,.btn-secondary.focus{box-shadow:0 0 0 .2rem rgba(130,138,145,0.5)}.btn-secondary.disabled,.btn-secondary:disabled{color:#fff;background-color:#6c757d;border-color:#6c757d}.btn-secondary:not(:disabled):not(.disabled):active,.btn-secondary:not(:disabled):not(.disabled).active,.show>.btn-secondary.dropdown-toggle{color:#fff;background-color:#545b62;border-color:#4e555b}.btn-secondary:not(:disabled):not(.disabled):active:focus,.btn-secondary:not(:disabled):not(.disabled).active:focus,.show>.btn-secondary.dropdown-toggle:focus{box-shadow:0 0 0 .2rem rgba(130,138,145,0.5)}.btn-success{color:#fff;background-color:#28a745;border-color:#28a745}.btn-success:hover{color:#fff;background-color:#218838;border-color:#1e7e34}.btn-success:focus,.btn-success.focus{box-shadow:0 0 0 .2rem rgba(72,180,97,0.5)}.btn-success.disabled,.btn-success:disabled{color:#fff;background-color:#28a745;border-color:#28a745}.btn-success:not(:disabled):not(.disabled):active,.btn-success:not(:disabled):not(.disabled).active,.show>.btn-success.dropdown-toggle{color:#fff;background-color:#1e7e34;border-color:#1c7430}.btn-success:not(:disabled):not(.disabled):active:focus,.btn-success:not(:disabled):not(.disabled).active:focus,.show>.btn-success.dropdown-toggle:focus{box-shadow:0 0 0 .2rem rgba(72,180,97,0.5)}.btn-info{color:#fff;background-color:#17a2b8;border-color:#17a2b8}.btn-info:hover{color:#fff;background-color:#138496;border-color:#117a8b}.btn-info:focus,.btn-info.focus{box-shadow:0 0 0 .2rem rgba(58,176,195,0.5)}.btn-info.disabled,.btn-info:disabled{color:#fff;background-color:#17a2b8;border-color:#17a2b8}.btn-info:not(:disabled):not(.disabled):active,.btn-info:not(:disabled):not(.disabled).active,.show>.btn-info.dropdown-toggle{color:#fff;background-color:#117a8b;border-color:#10707f}.btn-info:not(:disabled):not(.disabled):active:focus,.btn-info:not(:disabled):not(.disabled).active:focus,.show>.btn-info.dropdown-toggle:focus{box-shadow:0 0 0 .2rem rgba(58,176,195,0.5)}.btn-warning{color:#212529;background-color:#ffc107;border-color:#ffc107}.btn-warning:hover{color:#212529;background-color:#e0a800;border-color:#d39e00}.btn-warning:focus,.btn-warning.focus{box-shadow:0 0 0 .2rem rgba(222,170,12,0.5)}.btn-warning.disabled,.btn-warning:disabled{color:#212529;background-color:#ffc107;border-color:#ffc107}.btn-warning:not(:disabled):not(.disabled):active,.btn-warning:not(:disabled):not(.disabled).active,.show>.btn-warning.dropdown-toggle{color:#212529;background-color:#d39e00;border-color:#c69500}.btn-warning:not(:disabled):not(.disabled):active:focus,.btn-warning:not(:disabled):not(.disabled).active:focus,.show>.btn-warning.dropdown-toggle:focus{box-shadow:0 0 0 .2rem rgba(222,170,12,0.5)}.btn-danger{color:#fff;background-color:#dc3545;border-color:#dc3545}.btn-danger:hover{color:#fff;background-color:#c82333;border-color:#bd2130}.btn-danger:focus,.btn-danger.focus{box-shadow:0 0 0 .2rem rgba(225,83,97,0.5)}.btn-danger.disabled,.btn-danger:disabled{color:#fff;background-color:#dc3545;border-color:#dc3545}.btn-danger:not(:disabled):not(.disabled):active,.btn-danger:not(:disabled):not(.disabled).active,.show>.btn-danger.dropdown-toggle{color:#fff;background-color:#bd2130;border-color:#b21f2d}.btn-danger:not(:disabled):not(.disabled):active:focus,.btn-danger:not(:disabled):not(.disabled).active:focus,.show>.btn-danger.dropdown-toggle:focus{box-shadow:0 0 0 .2rem rgba(225,83,97,0.5)}.btn-light{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-light:hover{color:#212529;background-color:#e2e6ea;border-color:#dae0e5}.btn-light:focus,.btn-light.focus{box-shadow:0 0 0 .2rem rgba(216,217,219,0.5)}.btn-light.disabled,.btn-light:disabled{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-light:not(:disabled):not(.disabled):active,.btn-light:not(:disabled):not(.disabled).active,.show>.btn-light.dropdown-toggle{color:#212529;background-color:#dae0e5;border-color:#d3d9df}.btn-light:not(:disabled):not(.disabled):active:focus,.btn-light:not(:disabled):not(.disabled).active:focus,.show>.btn-light.dropdown-toggle:focus{box-shadow:0 0 0 .2rem rgba(216,217,219,0.5)}.btn-dark{color:#fff;background-color:#343a40;border-color:#343a40}.btn-dark:hover{color:#fff;background-color:#23272b;border-color:#1d2124}.btn-dark:focus,.btn-dark.focus{box-shadow:0 0 0 .2rem rgba(82,88,93,0.5)}.btn-dark.disabled,.btn-dark:disabled{color:#fff;background-color:#343a40;border-color:#343a40}.btn-dark:not(:disabled):not(.disabled):active,.btn-dark:not(:disabled):not(.disabled).active,.show>.btn-dark.dropdown-toggle{color:#fff;background-color:#1d2124;border-color:#171a1d}.btn-dark:not(:disabled):not(.disabled):active:focus,.btn-dark:not(:disabled):not(.disabled).active:focus,.show>.btn-dark.dropdown-toggle:focus{box-shadow:0 0 0 .2rem rgba(82,88,93,0.5)}.btn-outline-primary{color:#007bff;border-color:#007bff}.btn-outline-primary:hover{color:#fff;background-color:#007bff;border-color:#007bff}.btn-outline-primary:focus,.btn-outline-primary.focus{box-shadow:0 0 0 .2rem rgba(0,123,255,0.5)}.btn-outline-primary.disabled,.btn-outline-primary:disabled{color:#007bff;background-color:transparent}.btn-outline-primary:not(:disabled):not(.disabled):active,.btn-outline-primary:not(:disabled):not(.disabled).active,.show>.btn-outline-primary.dropdown-toggle{color:#fff;background-color:#007bff;border-color:#007bff}.btn-outline-primary:not(:disabled):not(.disabled):active:focus,.btn-outline-primary:not(:disabled):not(.disabled).active:focus,.show>.btn-outline-primary.dropdown-toggle:focus{box-shadow:0 0 0 .2rem rgba(0,123,255,0.5)}.btn-outline-secondary{color:#6c757d;border-color:#6c757d}.btn-outline-secondary:hover{color:#fff;background-color:#6c757d;border-color:#6c757d}.btn-outline-secondary:focus,.btn-outline-secondary.focus{box-shadow:0 0 0 .2rem rgba(108,117,125,0.5)}.btn-outline-secondary.disabled,.btn-outline-secondary:disabled{color:#6c757d;background-color:transparent}.btn-outline-secondary:not(:disabled):not(.disabled):active,.btn-outline-secondary:not(:disabled):not(.disabled).active,.show>.btn-outline-secondary.dropdown-toggle{color:#fff;background-color:#6c757d;border-color:#6c757d}.btn-outline-secondary:not(:disabled):not(.disabled):active:focus,.btn-outline-secondary:not(:disabled):not(.disabled).active:focus,.show>.btn-outline-secondary.dropdown-toggle:focus{box-shadow:0 0 0 .2rem rgba(108,117,125,0.5)}.btn-outline-success{color:#28a745;border-color:#28a745}.btn-outline-success:hover{color:#fff;background-color:#28a745;border-color:#28a745}.btn-outline-success:focus,.btn-outline-success.focus{box-shadow:0 0 0 .2rem rgba(40,167,69,0.5)}.btn-outline-success.disabled,.btn-outline-success:disabled{color:#28a745;background-color:transparent}.btn-outline-success:not(:disabled):not(.disabled):active,.btn-outline-success:not(:disabled):not(.disabled).active,.show>.btn-outline-success.dropdown-toggle{color:#fff;background-color:#28a745;border-color:#28a745}.btn-outline-success:not(:disabled):not(.disabled):active:focus,.btn-outline-success:not(:disabled):not(.disabled).active:focus,.show>.btn-outline-success.dropdown-toggle:focus{box-shadow:0 0 0 .2rem rgba(40,167,69,0.5)}.btn-outline-info{color:#17a2b8;border-color:#17a2b8}.btn-outline-info:hover{color:#fff;background-color:#17a2b8;border-color:#17a2b8}.btn-outline-info:focus,.btn-outline-info.focus{box-shadow:0 0 0 .2rem rgba(23,162,184,0.5)}.btn-outline-info.disabled,.btn-outline-info:disabled{color:#17a2b8;background-color:transparent}.btn-outline-info:not(:disabled):not(.disabled):active,.btn-outline-info:not(:disabled):not(.disabled).active,.show>.btn-outline-info.dropdown-toggle{color:#fff;background-color:#17a2b8;border-color:#17a2b8}.btn-outline-info:not(:disabled):not(.disabled):active:focus,.btn-outline-info:not(:disabled):not(.disabled).active:focus,.show>.btn-outline-info.dropdown-toggle:focus{box-shadow:0 0 0 .2rem rgba(23,162,184,0.5)}.btn-outline-warning{color:#ffc107;border-color:#ffc107}.btn-outline-warning:hover{color:#212529;background-color:#ffc107;border-color:#ffc107}.btn-outline-warning:focus,.btn-outline-warning.focus{box-shadow:0 0 0 .2rem rgba(255,193,7,0.5)}.btn-outline-warning.disabled,.btn-outline-warning:disabled{color:#ffc107;background-color:transparent}.btn-outline-warning:not(:disabled):not(.disabled):active,.btn-outline-warning:not(:disabled):not(.disabled).active,.show>.btn-outline-warning.dropdown-toggle{color:#212529;background-color:#ffc107;border-color:#ffc107}.btn-outline-warning:not(:disabled):not(.disabled):active:focus,.btn-outline-warning:not(:disabled):not(.disabled).active:focus,.show>.btn-outline-warning.dropdown-toggle:focus{box-shadow:0 0 0 .2rem rgba(255,193,7,0.5)}.btn-outline-danger{color:#dc3545;border-color:#dc3545}.btn-outline-danger:hover{color:#fff;background-color:#dc3545;border-color:#dc3545}.btn-outline-danger:focus,.btn-outline-danger.focus{box-shadow:0 0 0 .2rem rgba(220,53,69,0.5)}.btn-outline-danger.disabled,.btn-outline-danger:disabled{color:#dc3545;background-color:transparent}.btn-outline-danger:not(:disabled):not(.disabled):active,.btn-outline-danger:not(:disabled):not(.disabled).active,.show>.btn-outline-danger.dropdown-toggle{color:#fff;background-color:#dc3545;border-color:#dc3545}.btn-outline-danger:not(:disabled):not(.disabled):active:focus,.btn-outline-danger:not(:disabled):not(.disabled).active:focus,.show>.btn-outline-danger.dropdown-toggle:focus{box-shadow:0 0 0 .2rem rgba(220,53,69,0.5)}.btn-outline-light{color:#f8f9fa;border-color:#f8f9fa}.btn-outline-light:hover{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-outline-light:focus,.btn-outline-light.focus{box-shadow:0 0 0 .2rem rgba(248,249,250,0.5)}.btn-outline-light.disabled,.btn-outline-light:disabled{color:#f8f9fa;background-color:transparent}.btn-outline-light:not(:disabled):not(.disabled):active,.btn-outline-light:not(:disabled):not(.disabled).active,.show>.btn-outline-light.dropdown-toggle{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-outline-light:not(:disabled):not(.disabled):active:focus,.btn-outline-light:not(:disabled):not(.disabled).active:focus,.show>.btn-outline-light.dropdown-toggle:focus{box-shadow:0 0 0 .2rem rgba(248,249,250,0.5)}.btn-outline-dark{color:#343a40;border-color:#343a40}.btn-outline-dark:hover{color:#fff;background-color:#343a40;border-color:#343a40}.btn-outline-dark:focus,.btn-outline-dark.focus{box-shadow:0 0 0 .2rem rgba(52,58,64,0.5)}.btn-outline-dark.disabled,.btn-outline-dark:disabled{color:#343a40;background-color:transparent}.btn-outline-dark:not(:disabled):not(.disabled):active,.btn-outline-dark:not(:disabled):not(.disabled).active,.show>.btn-outline-dark.dropdown-toggle{color:#fff;background-color:#343a40;border-color:#343a40}.btn-outline-dark:not(:disabled):not(.disabled):active:focus,.btn-outline-dark:not(:disabled):not(.disabled).active:focus,.show>.btn-outline-dark.dropdown-toggle:focus{box-shadow:0 0 0 .2rem rgba(52,58,64,0.5)}.btn-link{font-weight:400;color:#007bff;text-decoration:none}.btn-link:hover{color:#0056b3;text-decoration:underline}.btn-link:focus,.btn-link.focus{text-decoration:underline;box-shadow:none}.btn-link:disabled,.btn-link.disabled{color:#6c757d;pointer-events:none}.btn-lg,.btn-group-lg>.btn{padding:.5rem 1rem;font-size:1.25rem;line-height:1.5;border-radius:.3rem}.btn-sm,.btn-group-sm>.btn{padding:.25rem .5rem;font-size:.875rem;line-height:1.5;border-radius:.2rem}.btn-block{display:block;width:100%}.btn-block+.btn-block{margin-top:.5rem}input[type="submit"].btn-block,input[type="reset"].btn-block,input[type="button"].btn-block{width:100%}.fade{-webkit-transition:opacity 0.15s linear;transition:opacity 0.15s linear}@media (prefers-reduced-motion: reduce){.fade{-webkit-transition:none;transition:none}}.fade:not(.show){opacity:0}.collapse:not(.show){display:none}.collapsing{position:relative;height:0;overflow:hidden;-webkit-transition:height 0.35s ease;transition:height 0.35s ease}@media (prefers-reduced-motion: reduce){.collapsing{-webkit-transition:none;transition:none}}.dropup,.dropright,.dropdown,.dropleft{position:relative}.dropdown-toggle{white-space:nowrap}.dropdown-toggle::after{display:inline-block;margin-left:.255em;vertical-align:.255em;content:"";border-top:.3em solid;border-right:.3em solid transparent;border-bottom:0;border-left:.3em solid transparent}.dropdown-toggle:empty::after{margin-left:0}.dropdown-menu{position:absolute;top:100%;left:0;z-index:1000;display:none;float:left;min-width:10rem;padding:.5rem 0;margin:.125rem 0 0;font-size:1rem;color:#212529;text-align:left;list-style:none;background-color:#fff;background-clip:padding-box;border:1px solid rgba(0,0,0,0.15);border-radius:.25rem}.dropdown-menu-left{right:auto;left:0}.dropdown-menu-right{right:0;left:auto}@media (min-width: 576px){.dropdown-menu-sm-left{right:auto;left:0}.dropdown-menu-sm-right{right:0;left:auto}}@media (min-width: 768px){.dropdown-menu-md-left{right:auto;left:0}.dropdown-menu-md-right{right:0;left:auto}}@media (min-width: 992px){.dropdown-menu-lg-left{right:auto;left:0}.dropdown-menu-lg-right{right:0;left:auto}}@media (min-width: 1200px){.dropdown-menu-xl-left{right:auto;left:0}.dropdown-menu-xl-right{right:0;left:auto}}.dropup .dropdown-menu{top:auto;bottom:100%;margin-top:0;margin-bottom:.125rem}.dropup .dropdown-toggle::after{display:inline-block;margin-left:.255em;vertical-align:.255em;content:"";border-top:0;border-right:.3em solid transparent;border-bottom:.3em solid;border-left:.3em solid transparent}.dropup .dropdown-toggle:empty::after{margin-left:0}.dropright .dropdown-menu{top:0;right:auto;left:100%;margin-top:0;margin-left:.125rem}.dropright .dropdown-toggle::after{display:inline-block;margin-left:.255em;vertical-align:.255em;content:"";border-top:.3em solid transparent;border-right:0;border-bottom:.3em solid transparent;border-left:.3em solid}.dropright .dropdown-toggle:empty::after{margin-left:0}.dropright .dropdown-toggle::after{vertical-align:0}.dropleft .dropdown-menu{top:0;right:100%;left:auto;margin-top:0;margin-right:.125rem}.dropleft .dropdown-toggle::after{display:inline-block;margin-left:.255em;vertical-align:.255em;content:""}.dropleft .dropdown-toggle::after{display:none}.dropleft .dropdown-toggle::before{display:inline-block;margin-right:.255em;vertical-align:.255em;content:"";border-top:.3em solid transparent;border-right:.3em solid;border-bottom:.3em solid transparent}.dropleft .dropdown-toggle:empty::after{margin-left:0}.dropleft .dropdown-toggle::before{vertical-align:0}.dropdown-menu[x-placement^="top"],.dropdown-menu[x-placement^="right"],.dropdown-menu[x-placement^="bottom"],.dropdown-menu[x-placement^="left"]{right:auto;bottom:auto}.dropdown-divider{height:0;margin:.5rem 0;overflow:hidden;border-top:1px solid #e9ecef}.dropdown-item{display:block;width:100%;padding:.25rem 1.5rem;clear:both;font-weight:400;color:#212529;text-align:inherit;white-space:nowrap;background-color:transparent;border:0}.dropdown-item:hover,.dropdown-item:focus{color:#16181b;text-decoration:none;background-color:#f8f9fa}.dropdown-item.active,.dropdown-item:active{color:#fff;text-decoration:none;background-color:#007bff}.dropdown-item.disabled,.dropdown-item:disabled{color:#6c757d;pointer-events:none;background-color:transparent}.dropdown-menu.show{display:block}.dropdown-header{display:block;padding:.5rem 1.5rem;margin-bottom:0;font-size:.875rem;color:#6c757d;white-space:nowrap}.dropdown-item-text{display:block;padding:.25rem 1.5rem;color:#212529}.btn-group,.btn-group-vertical{position:relative;display:-webkit-inline-box;display:inline-flex;vertical-align:middle}.btn-group>.btn,.btn-group-vertical>.btn{position:relative;-webkit-box-flex:1;flex:1 1 auto}.btn-group>.btn:hover,.btn-group-vertical>.btn:hover{z-index:1}.btn-group>.btn:focus,.btn-group>.btn:active,.btn-group>.btn.active,.btn-group-vertical>.btn:focus,.btn-group-vertical>.btn:active,.btn-group-vertical>.btn.active{z-index:1}.btn-toolbar{display:-webkit-box;display:flex;flex-wrap:wrap;-webkit-box-pack:start;justify-content:flex-start}.btn-toolbar .input-group{width:auto}.btn-group>.btn:not(:first-child),.btn-group>.btn-group:not(:first-child){margin-left:-1px}.btn-group>.btn:not(:last-child):not(.dropdown-toggle),.btn-group>.btn-group:not(:last-child)>.btn{border-top-right-radius:0;border-bottom-right-radius:0}.btn-group>.btn:not(:first-child),.btn-group>.btn-group:not(:first-child)>.btn{border-top-left-radius:0;border-bottom-left-radius:0}.dropdown-toggle-split{padding-right:.5625rem;padding-left:.5625rem}.dropdown-toggle-split::after,.dropup .dropdown-toggle-split::after,.dropright .dropdown-toggle-split::after{margin-left:0}.dropleft .dropdown-toggle-split::before{margin-right:0}.btn-sm+.dropdown-toggle-split,.btn-group-sm>.btn+.dropdown-toggle-split{padding-right:.375rem;padding-left:.375rem}.btn-lg+.dropdown-toggle-split,.btn-group-lg>.btn+.dropdown-toggle-split{padding-right:.75rem;padding-left:.75rem}.btn-group-vertical{-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-align:start;align-items:flex-start;-webkit-box-pack:center;justify-content:center}.btn-group-vertical>.btn,.btn-group-vertical>.btn-group{width:100%}.btn-group-vertical>.btn:not(:first-child),.btn-group-vertical>.btn-group:not(:first-child){margin-top:-1px}.btn-group-vertical>.btn:not(:last-child):not(.dropdown-toggle),.btn-group-vertical>.btn-group:not(:last-child)>.btn{border-bottom-right-radius:0;border-bottom-left-radius:0}.btn-group-vertical>.btn:not(:first-child),.btn-group-vertical>.btn-group:not(:first-child)>.btn{border-top-left-radius:0;border-top-right-radius:0}.btn-group-toggle>.btn,.btn-group-toggle>.btn-group>.btn{margin-bottom:0}.btn-group-toggle>.btn input[type="radio"],.btn-group-toggle>.btn input[type="checkbox"],.btn-group-toggle>.btn-group>.btn input[type="radio"],.btn-group-toggle>.btn-group>.btn input[type="checkbox"]{position:absolute;clip:rect(0, 0, 0, 0);pointer-events:none}.input-group{position:relative;display:-webkit-box;display:flex;flex-wrap:wrap;-webkit-box-align:stretch;align-items:stretch;width:100%}.input-group>.form-control,.input-group>.form-control-plaintext,.input-group>.custom-select,.input-group>.custom-file{position:relative;-webkit-box-flex:1;flex:1 1 auto;width:1%;margin-bottom:0}.input-group>.form-control+.form-control,.input-group>.form-control+.custom-select,.input-group>.form-control+.custom-file,.input-group>.form-control-plaintext+.form-control,.input-group>.form-control-plaintext+.custom-select,.input-group>.form-control-plaintext+.custom-file,.input-group>.custom-select+.form-control,.input-group>.custom-select+.custom-select,.input-group>.custom-select+.custom-file,.input-group>.custom-file+.form-control,.input-group>.custom-file+.custom-select,.input-group>.custom-file+.custom-file{margin-left:-1px}.input-group>.form-control:focus,.input-group>.custom-select:focus,.input-group>.custom-file .custom-file-input:focus ~ .custom-file-label{z-index:3}.input-group>.custom-file .custom-file-input:focus{z-index:4}.input-group>.form-control:not(:last-child),.input-group>.custom-select:not(:last-child){border-top-right-radius:0;border-bottom-right-radius:0}.input-group>.form-control:not(:first-child),.input-group>.custom-select:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.input-group>.custom-file{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center}.input-group>.custom-file:not(:last-child) .custom-file-label,.input-group>.custom-file:not(:last-child) .custom-file-label::after{border-top-right-radius:0;border-bottom-right-radius:0}.input-group>.custom-file:not(:first-child) .custom-file-label{border-top-left-radius:0;border-bottom-left-radius:0}.input-group-prepend,.input-group-append{display:-webkit-box;display:flex}.input-group-prepend .btn,.input-group-append .btn{position:relative;z-index:2}.input-group-prepend .btn:focus,.input-group-append .btn:focus{z-index:3}.input-group-prepend .btn+.btn,.input-group-prepend .btn+.input-group-text,.input-group-prepend .input-group-text+.input-group-text,.input-group-prepend .input-group-text+.btn,.input-group-append .btn+.btn,.input-group-append .btn+.input-group-text,.input-group-append .input-group-text+.input-group-text,.input-group-append .input-group-text+.btn{margin-left:-1px}.input-group-prepend{margin-right:-1px}.input-group-append{margin-left:-1px}.input-group-text{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;padding:.375rem .75rem;margin-bottom:0;font-size:1rem;font-weight:400;line-height:1.5;color:#495057;text-align:center;white-space:nowrap;background-color:#e9ecef;border:1px solid #ced4da;border-radius:.25rem}.input-group-text input[type="radio"],.input-group-text input[type="checkbox"]{margin-top:0}.input-group-lg>.form-control:not(textarea),.input-group-lg>.custom-select{height:calc(1.5em + 1rem + 2px)}.input-group-lg>.form-control,.input-group-lg>.custom-select,.input-group-lg>.input-group-prepend>.input-group-text,.input-group-lg>.input-group-append>.input-group-text,.input-group-lg>.input-group-prepend>.btn,.input-group-lg>.input-group-append>.btn{padding:.5rem 1rem;font-size:1.25rem;line-height:1.5;border-radius:.3rem}.input-group-sm>.form-control:not(textarea),.input-group-sm>.custom-select{height:calc(1.5em + .5rem + 2px)}.input-group-sm>.form-control,.input-group-sm>.custom-select,.input-group-sm>.input-group-prepend>.input-group-text,.input-group-sm>.input-group-append>.input-group-text,.input-group-sm>.input-group-prepend>.btn,.input-group-sm>.input-group-append>.btn{padding:.25rem .5rem;font-size:.875rem;line-height:1.5;border-radius:.2rem}.input-group-lg>.custom-select,.input-group-sm>.custom-select{padding-right:1.75rem}.input-group>.input-group-prepend>.btn,.input-group>.input-group-prepend>.input-group-text,.input-group>.input-group-append:not(:last-child)>.btn,.input-group>.input-group-append:not(:last-child)>.input-group-text,.input-group>.input-group-append:last-child>.btn:not(:last-child):not(.dropdown-toggle),.input-group>.input-group-append:last-child>.input-group-text:not(:last-child){border-top-right-radius:0;border-bottom-right-radius:0}.input-group>.input-group-append>.btn,.input-group>.input-group-append>.input-group-text,.input-group>.input-group-prepend:not(:first-child)>.btn,.input-group>.input-group-prepend:not(:first-child)>.input-group-text,.input-group>.input-group-prepend:first-child>.btn:not(:first-child),.input-group>.input-group-prepend:first-child>.input-group-text:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.custom-control{position:relative;display:block;min-height:1.5rem;padding-left:1.5rem}.custom-control-inline{display:-webkit-inline-box;display:inline-flex;margin-right:1rem}.custom-control-input{position:absolute;z-index:-1;opacity:0}.custom-control-input:checked ~ .custom-control-label::before{color:#fff;border-color:#007bff;background-color:#007bff}.custom-control-input:focus ~ .custom-control-label::before{box-shadow:0 0 0 .2rem rgba(0,123,255,0.25)}.custom-control-input:focus:not(:checked) ~ .custom-control-label::before{border-color:#80bdff}.custom-control-input:not(:disabled):active ~ .custom-control-label::before{color:#fff;background-color:#b3d7ff;border-color:#b3d7ff}.custom-control-input:disabled ~ .custom-control-label{color:#6c757d}.custom-control-input:disabled ~ .custom-control-label::before{background-color:#e9ecef}.custom-control-label{position:relative;margin-bottom:0;vertical-align:top}.custom-control-label::before{position:absolute;top:.25rem;left:-1.5rem;display:block;width:1rem;height:1rem;pointer-events:none;content:"";background-color:#fff;border:#adb5bd solid 1px}.custom-control-label::after{position:absolute;top:.25rem;left:-1.5rem;display:block;width:1rem;height:1rem;content:"";background:no-repeat 50% / 50% 50%}.custom-checkbox .custom-control-label::before{border-radius:.25rem}.custom-checkbox .custom-control-input:checked ~ .custom-control-label::after{background-image:url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 8 8\'%3e%3cpath fill=\'%23fff\' d=\'M6.564.75l-3.59 3.612-1.538-1.55L0 4.26 2.974 7.25 8 2.193z\'/%3e%3c/svg%3e")}.custom-checkbox .custom-control-input:indeterminate ~ .custom-control-label::before{border-color:#007bff;background-color:#007bff}.custom-checkbox .custom-control-input:indeterminate ~ .custom-control-label::after{background-image:url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 4 4\'%3e%3cpath stroke=\'%23fff\' d=\'M0 2h4\'/%3e%3c/svg%3e")}.custom-checkbox .custom-control-input:disabled:checked ~ .custom-control-label::before{background-color:rgba(0,123,255,0.5)}.custom-checkbox .custom-control-input:disabled:indeterminate ~ .custom-control-label::before{background-color:rgba(0,123,255,0.5)}.custom-radio .custom-control-label::before{border-radius:50%}.custom-radio .custom-control-input:checked ~ .custom-control-label::after{background-image:url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'-4 -4 8 8\'%3e%3ccircle r=\'3\' fill=\'%23fff\'/%3e%3c/svg%3e")}.custom-radio .custom-control-input:disabled:checked ~ .custom-control-label::before{background-color:rgba(0,123,255,0.5)}.custom-switch{padding-left:2.25rem}.custom-switch .custom-control-label::before{left:-2.25rem;width:1.75rem;pointer-events:all;border-radius:.5rem}.custom-switch .custom-control-label::after{top:calc(.25rem + 2px);left:calc(-2.25rem + 2px);width:calc(1rem - 4px);height:calc(1rem - 4px);background-color:#adb5bd;border-radius:.5rem;-webkit-transition:background-color 0.15s ease-in-out,border-color 0.15s ease-in-out,box-shadow 0.15s ease-in-out,-webkit-transform 0.15s ease-in-out;transition:background-color 0.15s ease-in-out,border-color 0.15s ease-in-out,box-shadow 0.15s ease-in-out,-webkit-transform 0.15s ease-in-out;transition:transform 0.15s ease-in-out,background-color 0.15s ease-in-out,border-color 0.15s ease-in-out,box-shadow 0.15s ease-in-out;transition:transform 0.15s ease-in-out,background-color 0.15s ease-in-out,border-color 0.15s ease-in-out,box-shadow 0.15s ease-in-out,-webkit-transform 0.15s ease-in-out}@media (prefers-reduced-motion: reduce){.custom-switch .custom-control-label::after{-webkit-transition:none;transition:none}}.custom-switch .custom-control-input:checked ~ .custom-control-label::after{background-color:#fff;-webkit-transform:translateX(.75rem);transform:translateX(.75rem)}.custom-switch .custom-control-input:disabled:checked ~ .custom-control-label::before{background-color:rgba(0,123,255,0.5)}.custom-select{display:inline-block;width:100%;height:calc(1.5em + .75rem + 2px);padding:.375rem 1.75rem .375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#495057;vertical-align:middle;background:url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 4 5\'%3e%3cpath fill=\'%23343a40\' d=\'M2 0L0 2h4zm0 5L0 3h4z\'/%3e%3c/svg%3e") no-repeat right .75rem center/8px 10px;background-color:#fff;border:1px solid #ced4da;border-radius:.25rem;-webkit-appearance:none;-moz-appearance:none;appearance:none}.custom-select:focus{border-color:#80bdff;outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,0.25)}.custom-select:focus::-ms-value{color:#495057;background-color:#fff}.custom-select[multiple],.custom-select[size]:not([size="1"]){height:auto;padding-right:.75rem;background-image:none}.custom-select:disabled{color:#6c757d;background-color:#e9ecef}.custom-select::-ms-expand{display:none}.custom-select-sm{height:calc(1.5em + .5rem + 2px);padding-top:.25rem;padding-bottom:.25rem;padding-left:.5rem;font-size:.875rem}.custom-select-lg{height:calc(1.5em + 1rem + 2px);padding-top:.5rem;padding-bottom:.5rem;padding-left:1rem;font-size:1.25rem}.custom-file{position:relative;display:inline-block;width:100%;height:calc(1.5em + .75rem + 2px);margin-bottom:0}.custom-file-input{position:relative;z-index:2;width:100%;height:calc(1.5em + .75rem + 2px);margin:0;opacity:0}.custom-file-input:focus ~ .custom-file-label{border-color:#80bdff;box-shadow:0 0 0 .2rem rgba(0,123,255,0.25)}.custom-file-input:disabled ~ .custom-file-label{background-color:#e9ecef}.custom-file-input:lang(en) ~ .custom-file-label::after{content:"Browse"}.custom-file-input ~ .custom-file-label[data-browse]::after{content:attr(data-browse)}.custom-file-label{position:absolute;top:0;right:0;left:0;z-index:1;height:calc(1.5em + .75rem + 2px);padding:.375rem .75rem;font-weight:400;line-height:1.5;color:#495057;background-color:#fff;border:1px solid #ced4da;border-radius:.25rem}.custom-file-label::after{position:absolute;top:0;right:0;bottom:0;z-index:3;display:block;height:calc(1.5em + .75rem);padding:.375rem .75rem;line-height:1.5;color:#495057;content:"Browse";background-color:#e9ecef;border-left:inherit;border-radius:0 .25rem .25rem 0}.custom-range{width:100%;height:calc(1rem + .4rem);padding:0;background-color:transparent;-webkit-appearance:none;-moz-appearance:none;appearance:none}.custom-range:focus{outline:none}.custom-range:focus::-webkit-slider-thumb{box-shadow:0 0 0 1px #fff,0 0 0 .2rem rgba(0,123,255,0.25)}.custom-range:focus::-moz-range-thumb{box-shadow:0 0 0 1px #fff,0 0 0 .2rem rgba(0,123,255,0.25)}.custom-range:focus::-ms-thumb{box-shadow:0 0 0 1px #fff,0 0 0 .2rem rgba(0,123,255,0.25)}.custom-range::-moz-focus-outer{border:0}.custom-range::-webkit-slider-thumb{width:1rem;height:1rem;margin-top:-.25rem;background-color:#007bff;border:0;border-radius:1rem;-webkit-transition:background-color 0.15s ease-in-out,border-color 0.15s ease-in-out,box-shadow 0.15s ease-in-out;transition:background-color 0.15s ease-in-out,border-color 0.15s ease-in-out,box-shadow 0.15s ease-in-out;-webkit-appearance:none;appearance:none}@media (prefers-reduced-motion: reduce){.custom-range::-webkit-slider-thumb{-webkit-transition:none;transition:none}}.custom-range::-webkit-slider-thumb:active{background-color:#b3d7ff}.custom-range::-webkit-slider-runnable-track{width:100%;height:.5rem;color:transparent;cursor:pointer;background-color:#dee2e6;border-color:transparent;border-radius:1rem}.custom-range::-moz-range-thumb{width:1rem;height:1rem;background-color:#007bff;border:0;border-radius:1rem;-moz-transition:background-color 0.15s ease-in-out,border-color 0.15s ease-in-out,box-shadow 0.15s ease-in-out;transition:background-color 0.15s ease-in-out,border-color 0.15s ease-in-out,box-shadow 0.15s ease-in-out;-moz-appearance:none;appearance:none}@media (prefers-reduced-motion: reduce){.custom-range::-moz-range-thumb{-moz-transition:none;transition:none}}.custom-range::-moz-range-thumb:active{background-color:#b3d7ff}.custom-range::-moz-range-track{width:100%;height:.5rem;color:transparent;cursor:pointer;background-color:#dee2e6;border-color:transparent;border-radius:1rem}.custom-range::-ms-thumb{width:1rem;height:1rem;margin-top:0;margin-right:.2rem;margin-left:.2rem;background-color:#007bff;border:0;border-radius:1rem;-ms-transition:background-color 0.15s ease-in-out,border-color 0.15s ease-in-out,box-shadow 0.15s ease-in-out;transition:background-color 0.15s ease-in-out,border-color 0.15s ease-in-out,box-shadow 0.15s ease-in-out;appearance:none}@media (prefers-reduced-motion: reduce){.custom-range::-ms-thumb{-ms-transition:none;transition:none}}.custom-range::-ms-thumb:active{background-color:#b3d7ff}.custom-range::-ms-track{width:100%;height:.5rem;color:transparent;cursor:pointer;background-color:transparent;border-color:transparent;border-width:.5rem}.custom-range::-ms-fill-lower{background-color:#dee2e6;border-radius:1rem}.custom-range::-ms-fill-upper{margin-right:15px;background-color:#dee2e6;border-radius:1rem}.custom-range:disabled::-webkit-slider-thumb{background-color:#adb5bd}.custom-range:disabled::-webkit-slider-runnable-track{cursor:default}.custom-range:disabled::-moz-range-thumb{background-color:#adb5bd}.custom-range:disabled::-moz-range-track{cursor:default}.custom-range:disabled::-ms-thumb{background-color:#adb5bd}.custom-control-label::before,.custom-file-label,.custom-select{-webkit-transition:background-color 0.15s ease-in-out,border-color 0.15s ease-in-out,box-shadow 0.15s ease-in-out;transition:background-color 0.15s ease-in-out,border-color 0.15s ease-in-out,box-shadow 0.15s ease-in-out}@media (prefers-reduced-motion: reduce){.custom-control-label::before,.custom-file-label,.custom-select{-webkit-transition:none;transition:none}}.nav{display:-webkit-box;display:flex;flex-wrap:wrap;padding-left:0;margin-bottom:0;list-style:none}.nav-link{display:block;padding:.5rem 1rem}.nav-link:hover,.nav-link:focus{text-decoration:none}.nav-link.disabled{color:#6c757d;pointer-events:none;cursor:default}.nav-tabs{border-bottom:1px solid #dee2e6}.nav-tabs .nav-item{margin-bottom:-1px}.nav-tabs .nav-link{border:1px solid transparent;border-top-left-radius:.25rem;border-top-right-radius:.25rem}.nav-tabs .nav-link:hover,.nav-tabs .nav-link:focus{border-color:#e9ecef #e9ecef #dee2e6}.nav-tabs .nav-link.disabled{color:#6c757d;background-color:transparent;border-color:transparent}.nav-tabs .nav-link.active,.nav-tabs .nav-item.show .nav-link{color:#495057;background-color:#fff;border-color:#dee2e6 #dee2e6 #fff}.nav-tabs .dropdown-menu{margin-top:-1px;border-top-left-radius:0;border-top-right-radius:0}.nav-pills .nav-link{border-radius:.25rem}.nav-pills .nav-link.active,.nav-pills .show>.nav-link{color:#fff;background-color:#007bff}.nav-fill .nav-item{-webkit-box-flex:1;flex:1 1 auto;text-align:center}.nav-justified .nav-item{flex-basis:0;-webkit-box-flex:1;flex-grow:1;text-align:center}.tab-content>.tab-pane{display:none}.tab-content>.active{display:block}.navbar{position:relative;display:-webkit-box;display:flex;flex-wrap:wrap;-webkit-box-align:center;align-items:center;-webkit-box-pack:justify;justify-content:space-between;padding:.5rem 1rem}.navbar>.container,.navbar>.container-fluid{display:-webkit-box;display:flex;flex-wrap:wrap;-webkit-box-align:center;align-items:center;-webkit-box-pack:justify;justify-content:space-between}.navbar-brand{display:inline-block;padding-top:.3125rem;padding-bottom:.3125rem;margin-right:1rem;font-size:1.25rem;line-height:inherit;white-space:nowrap}.navbar-brand:hover,.navbar-brand:focus{text-decoration:none}.navbar-nav{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;padding-left:0;margin-bottom:0;list-style:none}.navbar-nav .nav-link{padding-right:0;padding-left:0}.navbar-nav .dropdown-menu{position:static;float:none}.navbar-text{display:inline-block;padding-top:.5rem;padding-bottom:.5rem}.navbar-collapse{flex-basis:100%;-webkit-box-flex:1;flex-grow:1;-webkit-box-align:center;align-items:center}.navbar-toggler{padding:.25rem .75rem;font-size:1.25rem;line-height:1;background-color:transparent;border:1px solid transparent;border-radius:.25rem}.navbar-toggler:hover,.navbar-toggler:focus{text-decoration:none}.navbar-toggler-icon{display:inline-block;width:1.5em;height:1.5em;vertical-align:middle;content:"";background:no-repeat center center;background-size:100% 100%}@media (max-width: 575.98px){.navbar-expand-sm>.container,.navbar-expand-sm>.container-fluid{padding-right:0;padding-left:0}}@media (min-width: 576px){.navbar-expand-sm{-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-flow:row nowrap;-webkit-box-pack:start;justify-content:flex-start}.navbar-expand-sm .navbar-nav{-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row}.navbar-expand-sm .navbar-nav .dropdown-menu{position:absolute}.navbar-expand-sm .navbar-nav .nav-link{padding-right:.5rem;padding-left:.5rem}.navbar-expand-sm>.container,.navbar-expand-sm>.container-fluid{flex-wrap:nowrap}.navbar-expand-sm .navbar-collapse{display:-webkit-box !important;display:flex !important;flex-basis:auto}.navbar-expand-sm .navbar-toggler{display:none}}@media (max-width: 767.98px){.navbar-expand-md>.container,.navbar-expand-md>.container-fluid{padding-right:0;padding-left:0}}@media (min-width: 768px){.navbar-expand-md{-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-flow:row nowrap;-webkit-box-pack:start;justify-content:flex-start}.navbar-expand-md .navbar-nav{-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row}.navbar-expand-md .navbar-nav .dropdown-menu{position:absolute}.navbar-expand-md .navbar-nav .nav-link{padding-right:.5rem;padding-left:.5rem}.navbar-expand-md>.container,.navbar-expand-md>.container-fluid{flex-wrap:nowrap}.navbar-expand-md .navbar-collapse{display:-webkit-box !important;display:flex !important;flex-basis:auto}.navbar-expand-md .navbar-toggler{display:none}}@media (max-width: 991.98px){.navbar-expand-lg>.container,.navbar-expand-lg>.container-fluid{padding-right:0;padding-left:0}}@media (min-width: 992px){.navbar-expand-lg{-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-flow:row nowrap;-webkit-box-pack:start;justify-content:flex-start}.navbar-expand-lg .navbar-nav{-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row}.navbar-expand-lg .navbar-nav .dropdown-menu{position:absolute}.navbar-expand-lg .navbar-nav .nav-link{padding-right:.5rem;padding-left:.5rem}.navbar-expand-lg>.container,.navbar-expand-lg>.container-fluid{flex-wrap:nowrap}.navbar-expand-lg .navbar-collapse{display:-webkit-box !important;display:flex !important;flex-basis:auto}.navbar-expand-lg .navbar-toggler{display:none}}@media (max-width: 1199.98px){.navbar-expand-xl>.container,.navbar-expand-xl>.container-fluid{padding-right:0;padding-left:0}}@media (min-width: 1200px){.navbar-expand-xl{-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-flow:row nowrap;-webkit-box-pack:start;justify-content:flex-start}.navbar-expand-xl .navbar-nav{-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row}.navbar-expand-xl .navbar-nav .dropdown-menu{position:absolute}.navbar-expand-xl .navbar-nav .nav-link{padding-right:.5rem;padding-left:.5rem}.navbar-expand-xl>.container,.navbar-expand-xl>.container-fluid{flex-wrap:nowrap}.navbar-expand-xl .navbar-collapse{display:-webkit-box !important;display:flex !important;flex-basis:auto}.navbar-expand-xl .navbar-toggler{display:none}}.navbar-expand{-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-flow:row nowrap;-webkit-box-pack:start;justify-content:flex-start}.navbar-expand>.container,.navbar-expand>.container-fluid{padding-right:0;padding-left:0}.navbar-expand .navbar-nav{-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row}.navbar-expand .navbar-nav .dropdown-menu{position:absolute}.navbar-expand .navbar-nav .nav-link{padding-right:.5rem;padding-left:.5rem}.navbar-expand>.container,.navbar-expand>.container-fluid{flex-wrap:nowrap}.navbar-expand .navbar-collapse{display:-webkit-box !important;display:flex !important;flex-basis:auto}.navbar-expand .navbar-toggler{display:none}.navbar-light .navbar-brand{color:rgba(0,0,0,0.9)}.navbar-light .navbar-brand:hover,.navbar-light .navbar-brand:focus{color:rgba(0,0,0,0.9)}.navbar-light .navbar-nav .nav-link{color:rgba(0,0,0,0.5)}.navbar-light .navbar-nav .nav-link:hover,.navbar-light .navbar-nav .nav-link:focus{color:rgba(0,0,0,0.7)}.navbar-light .navbar-nav .nav-link.disabled{color:rgba(0,0,0,0.3)}.navbar-light .navbar-nav .show>.nav-link,.navbar-light .navbar-nav .active>.nav-link,.navbar-light .navbar-nav .nav-link.show,.navbar-light .navbar-nav .nav-link.active{color:rgba(0,0,0,0.9)}.navbar-light .navbar-toggler{color:rgba(0,0,0,0.5);border-color:rgba(0,0,0,0.1)}.navbar-light .navbar-toggler-icon{background-image:url("data:image/svg+xml,%3csvg viewBox=\'0 0 30 30\' xmlns=\'http://www.w3.org/2000/svg\'%3e%3cpath stroke=\'rgba(0,0,0,0.5)\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-miterlimit=\'10\' d=\'M4 7h22M4 15h22M4 23h22\'/%3e%3c/svg%3e")}.navbar-light .navbar-text{color:rgba(0,0,0,0.5)}.navbar-light .navbar-text a{color:rgba(0,0,0,0.9)}.navbar-light .navbar-text a:hover,.navbar-light .navbar-text a:focus{color:rgba(0,0,0,0.9)}.navbar-dark .navbar-brand{color:#fff}.navbar-dark .navbar-brand:hover,.navbar-dark .navbar-brand:focus{color:#fff}.navbar-dark .navbar-nav .nav-link{color:rgba(255,255,255,0.5)}.navbar-dark .navbar-nav .nav-link:hover,.navbar-dark .navbar-nav .nav-link:focus{color:rgba(255,255,255,0.75)}.navbar-dark .navbar-nav .nav-link.disabled{color:rgba(255,255,255,0.25)}.navbar-dark .navbar-nav .show>.nav-link,.navbar-dark .navbar-nav .active>.nav-link,.navbar-dark .navbar-nav .nav-link.show,.navbar-dark .navbar-nav .nav-link.active{color:#fff}.navbar-dark .navbar-toggler{color:rgba(255,255,255,0.5);border-color:rgba(255,255,255,0.1)}.navbar-dark .navbar-toggler-icon{background-image:url("data:image/svg+xml,%3csvg viewBox=\'0 0 30 30\' xmlns=\'http://www.w3.org/2000/svg\'%3e%3cpath stroke=\'rgba(255,255,255,0.5)\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-miterlimit=\'10\' d=\'M4 7h22M4 15h22M4 23h22\'/%3e%3c/svg%3e")}.navbar-dark .navbar-text{color:rgba(255,255,255,0.5)}.navbar-dark .navbar-text a{color:#fff}.navbar-dark .navbar-text a:hover,.navbar-dark .navbar-text a:focus{color:#fff}.card{position:relative;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;min-width:0;word-wrap:break-word;background-color:#fff;background-clip:border-box;border:1px solid rgba(0,0,0,0.125);border-radius:.25rem}.card>hr{margin-right:0;margin-left:0}.card>.list-group:first-child .list-group-item:first-child{border-top-left-radius:.25rem;border-top-right-radius:.25rem}.card>.list-group:last-child .list-group-item:last-child{border-bottom-right-radius:.25rem;border-bottom-left-radius:.25rem}.card-body{-webkit-box-flex:1;flex:1 1 auto;padding:1.25rem}.card-title{margin-bottom:.75rem}.card-subtitle{margin-top:-.375rem;margin-bottom:0}.card-text:last-child{margin-bottom:0}.card-link:hover{text-decoration:none}.card-link+.card-link{margin-left:1.25rem}.card-header{padding:.75rem 1.25rem;margin-bottom:0;background-color:rgba(0,0,0,0.03);border-bottom:1px solid rgba(0,0,0,0.125)}.card-header:first-child{border-radius:calc(.25rem - 1px) calc(.25rem - 1px) 0 0}.card-header+.list-group .list-group-item:first-child{border-top:0}.card-footer{padding:.75rem 1.25rem;background-color:rgba(0,0,0,0.03);border-top:1px solid rgba(0,0,0,0.125)}.card-footer:last-child{border-radius:0 0 calc(.25rem - 1px) calc(.25rem - 1px)}.card-header-tabs{margin-right:-.625rem;margin-bottom:-.75rem;margin-left:-.625rem;border-bottom:0}.card-header-pills{margin-right:-.625rem;margin-left:-.625rem}.card-img-overlay{position:absolute;top:0;right:0;bottom:0;left:0;padding:1.25rem}.card-img{width:100%;border-radius:calc(.25rem - 1px)}.card-img-top{width:100%;border-top-left-radius:calc(.25rem - 1px);border-top-right-radius:calc(.25rem - 1px)}.card-img-bottom{width:100%;border-bottom-right-radius:calc(.25rem - 1px);border-bottom-left-radius:calc(.25rem - 1px)}.card-deck{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}.card-deck .card{margin-bottom:15px}@media (min-width: 576px){.card-deck{-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-flow:row wrap;margin-right:-15px;margin-left:-15px}.card-deck .card{display:-webkit-box;display:flex;-webkit-box-flex:1;flex:1 0 0%;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;margin-right:15px;margin-bottom:0;margin-left:15px}}.card-group{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}.card-group>.card{margin-bottom:15px}@media (min-width: 576px){.card-group{-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-flow:row wrap}.card-group>.card{-webkit-box-flex:1;flex:1 0 0%;margin-bottom:0}.card-group>.card+.card{margin-left:0;border-left:0}.card-group>.card:not(:last-child){border-top-right-radius:0;border-bottom-right-radius:0}.card-group>.card:not(:last-child) .card-img-top,.card-group>.card:not(:last-child) .card-header{border-top-right-radius:0}.card-group>.card:not(:last-child) .card-img-bottom,.card-group>.card:not(:last-child) .card-footer{border-bottom-right-radius:0}.card-group>.card:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.card-group>.card:not(:first-child) .card-img-top,.card-group>.card:not(:first-child) .card-header{border-top-left-radius:0}.card-group>.card:not(:first-child) .card-img-bottom,.card-group>.card:not(:first-child) .card-footer{border-bottom-left-radius:0}}.card-columns .card{margin-bottom:.75rem}@media (min-width: 576px){.card-columns{-webkit-column-count:3;-moz-column-count:3;column-count:3;-webkit-column-gap:1.25rem;-moz-column-gap:1.25rem;column-gap:1.25rem;orphans:1;widows:1}.card-columns .card{display:inline-block;width:100%}}.accordion>.card{overflow:hidden}.accordion>.card:not(:first-of-type) .card-header:first-child{border-radius:0}.accordion>.card:not(:first-of-type):not(:last-of-type){border-bottom:0;border-radius:0}.accordion>.card:first-of-type{border-bottom:0;border-bottom-right-radius:0;border-bottom-left-radius:0}.accordion>.card:last-of-type{border-top-left-radius:0;border-top-right-radius:0}.accordion>.card .card-header{margin-bottom:-1px}.breadcrumb{display:-webkit-box;display:flex;flex-wrap:wrap;padding:.75rem 1rem;margin-bottom:1rem;list-style:none;background-color:#e9ecef;border-radius:.25rem}.breadcrumb-item+.breadcrumb-item{padding-left:.5rem}.breadcrumb-item+.breadcrumb-item::before{display:inline-block;padding-right:.5rem;color:#6c757d;content:"/"}.breadcrumb-item+.breadcrumb-item:hover::before{text-decoration:underline}.breadcrumb-item+.breadcrumb-item:hover::before{text-decoration:none}.breadcrumb-item.active{color:#6c757d}.pagination{display:-webkit-box;display:flex;padding-left:0;list-style:none;border-radius:.25rem}.page-link{position:relative;display:block;padding:.5rem .75rem;margin-left:-1px;line-height:1.25;color:#007bff;background-color:#fff;border:1px solid #dee2e6}.page-link:hover{z-index:2;color:#0056b3;text-decoration:none;background-color:#e9ecef;border-color:#dee2e6}.page-link:focus{z-index:2;outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,0.25)}.page-item:first-child .page-link{margin-left:0;border-top-left-radius:.25rem;border-bottom-left-radius:.25rem}.page-item:last-child .page-link{border-top-right-radius:.25rem;border-bottom-right-radius:.25rem}.page-item.active .page-link{z-index:1;color:#fff;background-color:#007bff;border-color:#007bff}.page-item.disabled .page-link{color:#6c757d;pointer-events:none;cursor:auto;background-color:#fff;border-color:#dee2e6}.pagination-lg .page-link{padding:.75rem 1.5rem;font-size:1.25rem;line-height:1.5}.pagination-lg .page-item:first-child .page-link{border-top-left-radius:.3rem;border-bottom-left-radius:.3rem}.pagination-lg .page-item:last-child .page-link{border-top-right-radius:.3rem;border-bottom-right-radius:.3rem}.pagination-sm .page-link{padding:.25rem .5rem;font-size:.875rem;line-height:1.5}.pagination-sm .page-item:first-child .page-link{border-top-left-radius:.2rem;border-bottom-left-radius:.2rem}.pagination-sm .page-item:last-child .page-link{border-top-right-radius:.2rem;border-bottom-right-radius:.2rem}.badge{display:inline-block;padding:.25em .4em;font-size:75%;font-weight:700;line-height:1;text-align:center;white-space:nowrap;vertical-align:baseline;border-radius:.25rem;-webkit-transition:color 0.15s ease-in-out,background-color 0.15s ease-in-out,border-color 0.15s ease-in-out,box-shadow 0.15s ease-in-out;transition:color 0.15s ease-in-out,background-color 0.15s ease-in-out,border-color 0.15s ease-in-out,box-shadow 0.15s ease-in-out}@media (prefers-reduced-motion: reduce){.badge{-webkit-transition:none;transition:none}}a.badge:hover,a.badge:focus{text-decoration:none}.badge:empty{display:none}.btn .badge{position:relative;top:-1px}.badge-pill{padding-right:.6em;padding-left:.6em;border-radius:10rem}.badge-primary{color:#fff;background-color:#007bff}a.badge-primary:hover,a.badge-primary:focus{color:#fff;background-color:#0062cc}a.badge-primary:focus,a.badge-primary.focus{outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,0.5)}.badge-secondary{color:#fff;background-color:#6c757d}a.badge-secondary:hover,a.badge-secondary:focus{color:#fff;background-color:#545b62}a.badge-secondary:focus,a.badge-secondary.focus{outline:0;box-shadow:0 0 0 .2rem rgba(108,117,125,0.5)}.badge-success{color:#fff;background-color:#28a745}a.badge-success:hover,a.badge-success:focus{color:#fff;background-color:#1e7e34}a.badge-success:focus,a.badge-success.focus{outline:0;box-shadow:0 0 0 .2rem rgba(40,167,69,0.5)}.badge-info{color:#fff;background-color:#17a2b8}a.badge-info:hover,a.badge-info:focus{color:#fff;background-color:#117a8b}a.badge-info:focus,a.badge-info.focus{outline:0;box-shadow:0 0 0 .2rem rgba(23,162,184,0.5)}.badge-warning{color:#212529;background-color:#ffc107}a.badge-warning:hover,a.badge-warning:focus{color:#212529;background-color:#d39e00}a.badge-warning:focus,a.badge-warning.focus{outline:0;box-shadow:0 0 0 .2rem rgba(255,193,7,0.5)}.badge-danger{color:#fff;background-color:#dc3545}a.badge-danger:hover,a.badge-danger:focus{color:#fff;background-color:#bd2130}a.badge-danger:focus,a.badge-danger.focus{outline:0;box-shadow:0 0 0 .2rem rgba(220,53,69,0.5)}.badge-light{color:#212529;background-color:#f8f9fa}a.badge-light:hover,a.badge-light:focus{color:#212529;background-color:#dae0e5}a.badge-light:focus,a.badge-light.focus{outline:0;box-shadow:0 0 0 .2rem rgba(248,249,250,0.5)}.badge-dark{color:#fff;background-color:#343a40}a.badge-dark:hover,a.badge-dark:focus{color:#fff;background-color:#1d2124}a.badge-dark:focus,a.badge-dark.focus{outline:0;box-shadow:0 0 0 .2rem rgba(52,58,64,0.5)}.jumbotron{padding:2rem 1rem;margin-bottom:2rem;background-color:#e9ecef;border-radius:.3rem}@media (min-width: 576px){.jumbotron{padding:4rem 2rem}}.jumbotron-fluid{padding-right:0;padding-left:0;border-radius:0}.alert{position:relative;padding:.75rem 1.25rem;margin-bottom:1rem;border:1px solid transparent;border-radius:.25rem}.alert-heading{color:inherit}.alert-link{font-weight:700}.alert-dismissible{padding-right:4rem}.alert-dismissible .close{position:absolute;top:0;right:0;padding:.75rem 1.25rem;color:inherit}.alert-primary{color:#004085;background-color:#cce5ff;border-color:#b8daff}.alert-primary hr{border-top-color:#9fcdff}.alert-primary .alert-link{color:#002752}.alert-secondary{color:#383d41;background-color:#e2e3e5;border-color:#d6d8db}.alert-secondary hr{border-top-color:#c8cbcf}.alert-secondary .alert-link{color:#202326}.alert-success{color:#155724;background-color:#d4edda;border-color:#c3e6cb}.alert-success hr{border-top-color:#b1dfbb}.alert-success .alert-link{color:#0b2e13}.alert-info{color:#0c5460;background-color:#d1ecf1;border-color:#bee5eb}.alert-info hr{border-top-color:#abdde5}.alert-info .alert-link{color:#062c33}.alert-warning{color:#856404;background-color:#fff3cd;border-color:#ffeeba}.alert-warning hr{border-top-color:#ffe8a1}.alert-warning .alert-link{color:#533f03}.alert-danger{color:#721c24;background-color:#f8d7da;border-color:#f5c6cb}.alert-danger hr{border-top-color:#f1b0b7}.alert-danger .alert-link{color:#491217}.alert-light{color:#818182;background-color:#fefefe;border-color:#fdfdfe}.alert-light hr{border-top-color:#ececf6}.alert-light .alert-link{color:#686868}.alert-dark{color:#1b1e21;background-color:#d6d8d9;border-color:#c6c8ca}.alert-dark hr{border-top-color:#b9bbbe}.alert-dark .alert-link{color:#040505}@-webkit-keyframes progress-bar-stripes{from{background-position:1rem 0}to{background-position:0 0}}@keyframes progress-bar-stripes{from{background-position:1rem 0}to{background-position:0 0}}.progress{display:-webkit-box;display:flex;height:1rem;overflow:hidden;font-size:.75rem;background-color:#e9ecef;border-radius:.25rem}.progress-bar{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-pack:center;justify-content:center;color:#fff;text-align:center;white-space:nowrap;background-color:#007bff;-webkit-transition:width 0.6s ease;transition:width 0.6s ease}@media (prefers-reduced-motion: reduce){.progress-bar{-webkit-transition:none;transition:none}}.progress-bar-striped{background-image:linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-size:1rem 1rem}.progress-bar-animated{-webkit-animation:progress-bar-stripes 1s linear infinite;animation:progress-bar-stripes 1s linear infinite}@media (prefers-reduced-motion: reduce){.progress-bar-animated{-webkit-animation:none;animation:none}}.media{display:-webkit-box;display:flex;-webkit-box-align:start;align-items:flex-start}.media-body{-webkit-box-flex:1;flex:1}.list-group{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;padding-left:0;margin-bottom:0}.list-group-item-action{width:100%;color:#495057;text-align:inherit}.list-group-item-action:hover,.list-group-item-action:focus{z-index:1;color:#495057;text-decoration:none;background-color:#f8f9fa}.list-group-item-action:active{color:#212529;background-color:#e9ecef}.list-group-item{position:relative;display:block;padding:.75rem 1.25rem;margin-bottom:-1px;background-color:#fff;border:1px solid rgba(0,0,0,0.125)}.list-group-item:first-child{border-top-left-radius:.25rem;border-top-right-radius:.25rem}.list-group-item:last-child{margin-bottom:0;border-bottom-right-radius:.25rem;border-bottom-left-radius:.25rem}.list-group-item.disabled,.list-group-item:disabled{color:#6c757d;pointer-events:none;background-color:#fff}.list-group-item.active{z-index:2;color:#fff;background-color:#007bff;border-color:#007bff}.list-group-horizontal{-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row}.list-group-horizontal .list-group-item{margin-right:-1px;margin-bottom:0}.list-group-horizontal .list-group-item:first-child{border-top-left-radius:.25rem;border-bottom-left-radius:.25rem;border-top-right-radius:0}.list-group-horizontal .list-group-item:last-child{margin-right:0;border-top-right-radius:.25rem;border-bottom-right-radius:.25rem;border-bottom-left-radius:0}@media (min-width: 576px){.list-group-horizontal-sm{-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row}.list-group-horizontal-sm .list-group-item{margin-right:-1px;margin-bottom:0}.list-group-horizontal-sm .list-group-item:first-child{border-top-left-radius:.25rem;border-bottom-left-radius:.25rem;border-top-right-radius:0}.list-group-horizontal-sm .list-group-item:last-child{margin-right:0;border-top-right-radius:.25rem;border-bottom-right-radius:.25rem;border-bottom-left-radius:0}}@media (min-width: 768px){.list-group-horizontal-md{-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row}.list-group-horizontal-md .list-group-item{margin-right:-1px;margin-bottom:0}.list-group-horizontal-md .list-group-item:first-child{border-top-left-radius:.25rem;border-bottom-left-radius:.25rem;border-top-right-radius:0}.list-group-horizontal-md .list-group-item:last-child{margin-right:0;border-top-right-radius:.25rem;border-bottom-right-radius:.25rem;border-bottom-left-radius:0}}@media (min-width: 992px){.list-group-horizontal-lg{-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row}.list-group-horizontal-lg .list-group-item{margin-right:-1px;margin-bottom:0}.list-group-horizontal-lg .list-group-item:first-child{border-top-left-radius:.25rem;border-bottom-left-radius:.25rem;border-top-right-radius:0}.list-group-horizontal-lg .list-group-item:last-child{margin-right:0;border-top-right-radius:.25rem;border-bottom-right-radius:.25rem;border-bottom-left-radius:0}}@media (min-width: 1200px){.list-group-horizontal-xl{-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row}.list-group-horizontal-xl .list-group-item{margin-right:-1px;margin-bottom:0}.list-group-horizontal-xl .list-group-item:first-child{border-top-left-radius:.25rem;border-bottom-left-radius:.25rem;border-top-right-radius:0}.list-group-horizontal-xl .list-group-item:last-child{margin-right:0;border-top-right-radius:.25rem;border-bottom-right-radius:.25rem;border-bottom-left-radius:0}}.list-group-flush .list-group-item{border-right:0;border-left:0;border-radius:0}.list-group-flush .list-group-item:last-child{margin-bottom:-1px}.list-group-flush:first-child .list-group-item:first-child{border-top:0}.list-group-flush:last-child .list-group-item:last-child{margin-bottom:0;border-bottom:0}.list-group-item-primary{color:#004085;background-color:#b8daff}.list-group-item-primary.list-group-item-action:hover,.list-group-item-primary.list-group-item-action:focus{color:#004085;background-color:#9fcdff}.list-group-item-primary.list-group-item-action.active{color:#fff;background-color:#004085;border-color:#004085}.list-group-item-secondary{color:#383d41;background-color:#d6d8db}.list-group-item-secondary.list-group-item-action:hover,.list-group-item-secondary.list-group-item-action:focus{color:#383d41;background-color:#c8cbcf}.list-group-item-secondary.list-group-item-action.active{color:#fff;background-color:#383d41;border-color:#383d41}.list-group-item-success{color:#155724;background-color:#c3e6cb}.list-group-item-success.list-group-item-action:hover,.list-group-item-success.list-group-item-action:focus{color:#155724;background-color:#b1dfbb}.list-group-item-success.list-group-item-action.active{color:#fff;background-color:#155724;border-color:#155724}.list-group-item-info{color:#0c5460;background-color:#bee5eb}.list-group-item-info.list-group-item-action:hover,.list-group-item-info.list-group-item-action:focus{color:#0c5460;background-color:#abdde5}.list-group-item-info.list-group-item-action.active{color:#fff;background-color:#0c5460;border-color:#0c5460}.list-group-item-warning{color:#856404;background-color:#ffeeba}.list-group-item-warning.list-group-item-action:hover,.list-group-item-warning.list-group-item-action:focus{color:#856404;background-color:#ffe8a1}.list-group-item-warning.list-group-item-action.active{color:#fff;background-color:#856404;border-color:#856404}.list-group-item-danger{color:#721c24;background-color:#f5c6cb}.list-group-item-danger.list-group-item-action:hover,.list-group-item-danger.list-group-item-action:focus{color:#721c24;background-color:#f1b0b7}.list-group-item-danger.list-group-item-action.active{color:#fff;background-color:#721c24;border-color:#721c24}.list-group-item-light{color:#818182;background-color:#fdfdfe}.list-group-item-light.list-group-item-action:hover,.list-group-item-light.list-group-item-action:focus{color:#818182;background-color:#ececf6}.list-group-item-light.list-group-item-action.active{color:#fff;background-color:#818182;border-color:#818182}.list-group-item-dark{color:#1b1e21;background-color:#c6c8ca}.list-group-item-dark.list-group-item-action:hover,.list-group-item-dark.list-group-item-action:focus{color:#1b1e21;background-color:#b9bbbe}.list-group-item-dark.list-group-item-action.active{color:#fff;background-color:#1b1e21;border-color:#1b1e21}.close{float:right;font-size:1.5rem;font-weight:700;line-height:1;color:#000;text-shadow:0 1px 0 #fff;opacity:.5}.close:hover{color:#000;text-decoration:none}.close:not(:disabled):not(.disabled):hover,.close:not(:disabled):not(.disabled):focus{opacity:.75}button.close{padding:0;background-color:transparent;border:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}a.close.disabled{pointer-events:none}.toast{max-width:350px;overflow:hidden;font-size:.875rem;background-color:rgba(255,255,255,0.85);background-clip:padding-box;border:1px solid rgba(0,0,0,0.1);box-shadow:0 0.25rem 0.75rem rgba(0,0,0,0.1);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);opacity:0;border-radius:.25rem}.toast:not(:last-child){margin-bottom:.75rem}.toast.showing{opacity:1}.toast.show{display:block;opacity:1}.toast.hide{display:none}.toast-header{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;padding:.25rem .75rem;color:#6c757d;background-color:rgba(255,255,255,0.85);background-clip:padding-box;border-bottom:1px solid rgba(0,0,0,0.05)}.toast-body{padding:.75rem}.modal-open{overflow:hidden}.modal-open .modal{overflow-x:hidden;overflow-y:auto}.modal{position:fixed;top:0;left:0;z-index:1050;display:none;width:100%;height:100%;overflow:hidden;outline:0}.modal-dialog{position:relative;width:auto;margin:.5rem;pointer-events:none}.modal.fade .modal-dialog{-webkit-transition:-webkit-transform 0.3s ease-out;transition:-webkit-transform 0.3s ease-out;transition:transform 0.3s ease-out;transition:transform 0.3s ease-out, -webkit-transform 0.3s ease-out;-webkit-transform:translate(0, -50px);transform:translate(0, -50px)}@media (prefers-reduced-motion: reduce){.modal.fade .modal-dialog{-webkit-transition:none;transition:none}}.modal.show .modal-dialog{-webkit-transform:none;transform:none}.modal-dialog-scrollable{display:-webkit-box;display:flex;max-height:calc(100% - 1rem)}.modal-dialog-scrollable .modal-content{max-height:calc(100vh - 1rem);overflow:hidden}.modal-dialog-scrollable .modal-header,.modal-dialog-scrollable .modal-footer{flex-shrink:0}.modal-dialog-scrollable .modal-body{overflow-y:auto}.modal-dialog-centered{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;min-height:calc(100% - 1rem)}.modal-dialog-centered::before{display:block;height:calc(100vh - 1rem);content:""}.modal-dialog-centered.modal-dialog-scrollable{-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-pack:center;justify-content:center;height:100%}.modal-dialog-centered.modal-dialog-scrollable .modal-content{max-height:none}.modal-dialog-centered.modal-dialog-scrollable::before{content:none}.modal-content{position:relative;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;width:100%;pointer-events:auto;background-color:#fff;background-clip:padding-box;border:1px solid rgba(0,0,0,0.2);border-radius:.3rem;outline:0}.modal-backdrop{position:fixed;top:0;left:0;z-index:1040;width:100vw;height:100vh;background-color:#000}.modal-backdrop.fade{opacity:0}.modal-backdrop.show{opacity:.5}.modal-header{display:-webkit-box;display:flex;-webkit-box-align:start;align-items:flex-start;-webkit-box-pack:justify;justify-content:space-between;padding:1rem 1rem;border-bottom:1px solid #dee2e6;border-top-left-radius:.3rem;border-top-right-radius:.3rem}.modal-header .close{padding:1rem 1rem;margin:-1rem -1rem -1rem auto}.modal-title{margin-bottom:0;line-height:1.5}.modal-body{position:relative;-webkit-box-flex:1;flex:1 1 auto;padding:1rem}.modal-footer{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:end;justify-content:flex-end;padding:1rem;border-top:1px solid #dee2e6;border-bottom-right-radius:.3rem;border-bottom-left-radius:.3rem}.modal-footer>:not(:first-child){margin-left:.25rem}.modal-footer>:not(:last-child){margin-right:.25rem}.modal-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}@media (min-width: 576px){.modal-dialog{max-width:500px;margin:1.75rem auto}.modal-dialog-scrollable{max-height:calc(100% - 3.5rem)}.modal-dialog-scrollable .modal-content{max-height:calc(100vh - 3.5rem)}.modal-dialog-centered{min-height:calc(100% - 3.5rem)}.modal-dialog-centered::before{height:calc(100vh - 3.5rem)}.modal-sm{max-width:300px}}@media (min-width: 992px){.modal-lg,.modal-xl{max-width:800px}}@media (min-width: 1200px){.modal-xl{max-width:1140px}}.tooltip{position:absolute;z-index:1070;display:block;margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-style:normal;font-weight:400;line-height:1.5;text-align:left;text-align:start;text-decoration:none;text-shadow:none;text-transform:none;letter-spacing:normal;word-break:normal;word-spacing:normal;white-space:normal;line-break:auto;font-size:.875rem;word-wrap:break-word;opacity:0}.tooltip.show{opacity:.9}.tooltip .arrow{position:absolute;display:block;width:.8rem;height:.4rem}.tooltip .arrow::before{position:absolute;content:"";border-color:transparent;border-style:solid}.bs-tooltip-top,.bs-tooltip-auto[x-placement^="top"]{padding:.4rem 0}.bs-tooltip-top .arrow,.bs-tooltip-auto[x-placement^="top"] .arrow{bottom:0}.bs-tooltip-top .arrow::before,.bs-tooltip-auto[x-placement^="top"] .arrow::before{top:0;border-width:.4rem .4rem 0;border-top-color:#000}.bs-tooltip-right,.bs-tooltip-auto[x-placement^="right"]{padding:0 .4rem}.bs-tooltip-right .arrow,.bs-tooltip-auto[x-placement^="right"] .arrow{left:0;width:.4rem;height:.8rem}.bs-tooltip-right .arrow::before,.bs-tooltip-auto[x-placement^="right"] .arrow::before{right:0;border-width:.4rem .4rem .4rem 0;border-right-color:#000}.bs-tooltip-bottom,.bs-tooltip-auto[x-placement^="bottom"]{padding:.4rem 0}.bs-tooltip-bottom .arrow,.bs-tooltip-auto[x-placement^="bottom"] .arrow{top:0}.bs-tooltip-bottom .arrow::before,.bs-tooltip-auto[x-placement^="bottom"] .arrow::before{bottom:0;border-width:0 .4rem .4rem;border-bottom-color:#000}.bs-tooltip-left,.bs-tooltip-auto[x-placement^="left"]{padding:0 .4rem}.bs-tooltip-left .arrow,.bs-tooltip-auto[x-placement^="left"] .arrow{right:0;width:.4rem;height:.8rem}.bs-tooltip-left .arrow::before,.bs-tooltip-auto[x-placement^="left"] .arrow::before{left:0;border-width:.4rem 0 .4rem .4rem;border-left-color:#000}.tooltip-inner{max-width:200px;padding:.25rem .5rem;color:#fff;text-align:center;background-color:#000;border-radius:.25rem}.popover{position:absolute;top:0;left:0;z-index:1060;display:block;max-width:276px;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-style:normal;font-weight:400;line-height:1.5;text-align:left;text-align:start;text-decoration:none;text-shadow:none;text-transform:none;letter-spacing:normal;word-break:normal;word-spacing:normal;white-space:normal;line-break:auto;font-size:.875rem;word-wrap:break-word;background-color:#fff;background-clip:padding-box;border:1px solid rgba(0,0,0,0.2);border-radius:.3rem}.popover .arrow{position:absolute;display:block;width:1rem;height:.5rem;margin:0 .3rem}.popover .arrow::before,.popover .arrow::after{position:absolute;display:block;content:"";border-color:transparent;border-style:solid}.bs-popover-top,.bs-popover-auto[x-placement^="top"]{margin-bottom:.5rem}.bs-popover-top>.arrow,.bs-popover-auto[x-placement^="top"]>.arrow{bottom:calc((.5rem + 1px) * -1)}.bs-popover-top>.arrow::before,.bs-popover-auto[x-placement^="top"]>.arrow::before{bottom:0;border-width:.5rem .5rem 0;border-top-color:rgba(0,0,0,0.25)}.bs-popover-top>.arrow::after,.bs-popover-auto[x-placement^="top"]>.arrow::after{bottom:1px;border-width:.5rem .5rem 0;border-top-color:#fff}.bs-popover-right,.bs-popover-auto[x-placement^="right"]{margin-left:.5rem}.bs-popover-right>.arrow,.bs-popover-auto[x-placement^="right"]>.arrow{left:calc((.5rem + 1px) * -1);width:.5rem;height:1rem;margin:.3rem 0}.bs-popover-right>.arrow::before,.bs-popover-auto[x-placement^="right"]>.arrow::before{left:0;border-width:.5rem .5rem .5rem 0;border-right-color:rgba(0,0,0,0.25)}.bs-popover-right>.arrow::after,.bs-popover-auto[x-placement^="right"]>.arrow::after{left:1px;border-width:.5rem .5rem .5rem 0;border-right-color:#fff}.bs-popover-bottom,.bs-popover-auto[x-placement^="bottom"]{margin-top:.5rem}.bs-popover-bottom>.arrow,.bs-popover-auto[x-placement^="bottom"]>.arrow{top:calc((.5rem + 1px) * -1)}.bs-popover-bottom>.arrow::before,.bs-popover-auto[x-placement^="bottom"]>.arrow::before{top:0;border-width:0 .5rem .5rem .5rem;border-bottom-color:rgba(0,0,0,0.25)}.bs-popover-bottom>.arrow::after,.bs-popover-auto[x-placement^="bottom"]>.arrow::after{top:1px;border-width:0 .5rem .5rem .5rem;border-bottom-color:#fff}.bs-popover-bottom .popover-header::before,.bs-popover-auto[x-placement^="bottom"] .popover-header::before{position:absolute;top:0;left:50%;display:block;width:1rem;margin-left:-.5rem;content:"";border-bottom:1px solid #f7f7f7}.bs-popover-left,.bs-popover-auto[x-placement^="left"]{margin-right:.5rem}.bs-popover-left>.arrow,.bs-popover-auto[x-placement^="left"]>.arrow{right:calc((.5rem + 1px) * -1);width:.5rem;height:1rem;margin:.3rem 0}.bs-popover-left>.arrow::before,.bs-popover-auto[x-placement^="left"]>.arrow::before{right:0;border-width:.5rem 0 .5rem .5rem;border-left-color:rgba(0,0,0,0.25)}.bs-popover-left>.arrow::after,.bs-popover-auto[x-placement^="left"]>.arrow::after{right:1px;border-width:.5rem 0 .5rem .5rem;border-left-color:#fff}.popover-header{padding:.5rem .75rem;margin-bottom:0;font-size:1rem;background-color:#f7f7f7;border-bottom:1px solid #ebebeb;border-top-left-radius:calc(.3rem - 1px);border-top-right-radius:calc(.3rem - 1px)}.popover-header:empty{display:none}.popover-body{padding:.5rem .75rem;color:#212529}.carousel{position:relative}.carousel.pointer-event{touch-action:pan-y}.carousel-inner{position:relative;width:100%;overflow:hidden}.carousel-inner::after{display:block;clear:both;content:""}.carousel-item{position:relative;display:none;float:left;width:100%;margin-right:-100%;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-transition:-webkit-transform .6s ease-in-out;transition:-webkit-transform .6s ease-in-out;transition:transform .6s ease-in-out;transition:transform .6s ease-in-out, -webkit-transform .6s ease-in-out}@media (prefers-reduced-motion: reduce){.carousel-item{-webkit-transition:none;transition:none}}.carousel-item.active,.carousel-item-next,.carousel-item-prev{display:block}.carousel-item-next:not(.carousel-item-left),.active.carousel-item-right{-webkit-transform:translateX(100%);transform:translateX(100%)}.carousel-item-prev:not(.carousel-item-right),.active.carousel-item-left{-webkit-transform:translateX(-100%);transform:translateX(-100%)}.carousel-fade .carousel-item{opacity:0;-webkit-transition-property:opacity;transition-property:opacity;-webkit-transform:none;transform:none}.carousel-fade .carousel-item.active,.carousel-fade .carousel-item-next.carousel-item-left,.carousel-fade .carousel-item-prev.carousel-item-right{z-index:1;opacity:1}.carousel-fade .active.carousel-item-left,.carousel-fade .active.carousel-item-right{z-index:0;opacity:0;-webkit-transition:0s .6s opacity;transition:0s .6s opacity}@media (prefers-reduced-motion: reduce){.carousel-fade .active.carousel-item-left,.carousel-fade .active.carousel-item-right{-webkit-transition:none;transition:none}}.carousel-control-prev,.carousel-control-next{position:absolute;top:0;bottom:0;z-index:1;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center;width:15%;color:#fff;text-align:center;opacity:.5;-webkit-transition:opacity 0.15s ease;transition:opacity 0.15s ease}@media (prefers-reduced-motion: reduce){.carousel-control-prev,.carousel-control-next{-webkit-transition:none;transition:none}}.carousel-control-prev:hover,.carousel-control-prev:focus,.carousel-control-next:hover,.carousel-control-next:focus{color:#fff;text-decoration:none;outline:0;opacity:.9}.carousel-control-prev{left:0}.carousel-control-next{right:0}.carousel-control-prev-icon,.carousel-control-next-icon{display:inline-block;width:20px;height:20px;background:no-repeat 50% / 100% 100%}.carousel-control-prev-icon{background-image:url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' fill=\'%23fff\' viewBox=\'0 0 8 8\'%3e%3cpath d=\'M5.25 0l-4 4 4 4 1.5-1.5-2.5-2.5 2.5-2.5-1.5-1.5z\'/%3e%3c/svg%3e")}.carousel-control-next-icon{background-image:url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' fill=\'%23fff\' viewBox=\'0 0 8 8\'%3e%3cpath d=\'M2.75 0l-1.5 1.5 2.5 2.5-2.5 2.5 1.5 1.5 4-4-4-4z\'/%3e%3c/svg%3e")}.carousel-indicators{position:absolute;right:0;bottom:0;left:0;z-index:15;display:-webkit-box;display:flex;-webkit-box-pack:center;justify-content:center;padding-left:0;margin-right:15%;margin-left:15%;list-style:none}.carousel-indicators li{box-sizing:content-box;-webkit-box-flex:0;flex:0 1 auto;width:30px;height:3px;margin-right:3px;margin-left:3px;text-indent:-999px;cursor:pointer;background-color:#fff;background-clip:padding-box;border-top:10px solid transparent;border-bottom:10px solid transparent;opacity:.5;-webkit-transition:opacity 0.6s ease;transition:opacity 0.6s ease}@media (prefers-reduced-motion: reduce){.carousel-indicators li{-webkit-transition:none;transition:none}}.carousel-indicators .active{opacity:1}.carousel-caption{position:absolute;right:15%;bottom:20px;left:15%;z-index:10;padding-top:20px;padding-bottom:20px;color:#fff;text-align:center}@-webkit-keyframes spinner-border{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-border{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.spinner-border{display:inline-block;width:2rem;height:2rem;vertical-align:text-bottom;border:.25em solid currentColor;border-right-color:transparent;border-radius:50%;-webkit-animation:spinner-border .75s linear infinite;animation:spinner-border .75s linear infinite}.spinner-border-sm{width:1rem;height:1rem;border-width:.2em}@-webkit-keyframes spinner-grow{0%{-webkit-transform:scale(0);transform:scale(0)}50%{opacity:1}}@keyframes spinner-grow{0%{-webkit-transform:scale(0);transform:scale(0)}50%{opacity:1}}.spinner-grow{display:inline-block;width:2rem;height:2rem;vertical-align:text-bottom;background-color:currentColor;border-radius:50%;opacity:0;-webkit-animation:spinner-grow .75s linear infinite;animation:spinner-grow .75s linear infinite}.spinner-grow-sm{width:1rem;height:1rem}.align-baseline{vertical-align:baseline !important}.align-top{vertical-align:top !important}.align-middle{vertical-align:middle !important}.align-bottom{vertical-align:bottom !important}.align-text-bottom{vertical-align:text-bottom !important}.align-text-top{vertical-align:text-top !important}.bg-primary{background-color:#007bff !important}a.bg-primary:hover,a.bg-primary:focus,button.bg-primary:hover,button.bg-primary:focus{background-color:#0062cc !important}.bg-secondary{background-color:#6c757d !important}a.bg-secondary:hover,a.bg-secondary:focus,button.bg-secondary:hover,button.bg-secondary:focus{background-color:#545b62 !important}.bg-success{background-color:#28a745 !important}a.bg-success:hover,a.bg-success:focus,button.bg-success:hover,button.bg-success:focus{background-color:#1e7e34 !important}.bg-info{background-color:#17a2b8 !important}a.bg-info:hover,a.bg-info:focus,button.bg-info:hover,button.bg-info:focus{background-color:#117a8b !important}.bg-warning{background-color:#ffc107 !important}a.bg-warning:hover,a.bg-warning:focus,button.bg-warning:hover,button.bg-warning:focus{background-color:#d39e00 !important}.bg-danger{background-color:#dc3545 !important}a.bg-danger:hover,a.bg-danger:focus,button.bg-danger:hover,button.bg-danger:focus{background-color:#bd2130 !important}.bg-light{background-color:#f8f9fa !important}a.bg-light:hover,a.bg-light:focus,button.bg-light:hover,button.bg-light:focus{background-color:#dae0e5 !important}.bg-dark{background-color:#343a40 !important}a.bg-dark:hover,a.bg-dark:focus,button.bg-dark:hover,button.bg-dark:focus{background-color:#1d2124 !important}.bg-white{background-color:#fff !important}.bg-transparent{background-color:transparent !important}.border{border:1px solid #dee2e6 !important}.border-top{border-top:1px solid #dee2e6 !important}.border-right{border-right:1px solid #dee2e6 !important}.border-bottom{border-bottom:1px solid #dee2e6 !important}.border-left{border-left:1px solid #dee2e6 !important}.border-0{border:0 !important}.border-top-0{border-top:0 !important}.border-right-0{border-right:0 !important}.border-bottom-0{border-bottom:0 !important}.border-left-0{border-left:0 !important}.border-primary{border-color:#007bff !important}.border-secondary{border-color:#6c757d !important}.border-success{border-color:#28a745 !important}.border-info{border-color:#17a2b8 !important}.border-warning{border-color:#ffc107 !important}.border-danger{border-color:#dc3545 !important}.border-light{border-color:#f8f9fa !important}.border-dark{border-color:#343a40 !important}.border-white{border-color:#fff !important}.rounded-sm{border-radius:.2rem !important}.rounded{border-radius:.25rem !important}.rounded-top{border-top-left-radius:.25rem !important;border-top-right-radius:.25rem !important}.rounded-right{border-top-right-radius:.25rem !important;border-bottom-right-radius:.25rem !important}.rounded-bottom{border-bottom-right-radius:.25rem !important;border-bottom-left-radius:.25rem !important}.rounded-left{border-top-left-radius:.25rem !important;border-bottom-left-radius:.25rem !important}.rounded-lg{border-radius:.3rem !important}.rounded-circle{border-radius:50% !important}.rounded-pill{border-radius:50rem !important}.rounded-0{border-radius:0 !important}.clearfix::after{display:block;clear:both;content:""}.d-none{display:none !important}.d-inline{display:inline !important}.d-inline-block{display:inline-block !important}.d-block{display:block !important}.d-table{display:table !important}.d-table-row{display:table-row !important}.d-table-cell{display:table-cell !important}.d-flex{display:-webkit-box !important;display:flex !important}.d-inline-flex{display:-webkit-inline-box !important;display:inline-flex !important}@media (min-width: 576px){.d-sm-none{display:none !important}.d-sm-inline{display:inline !important}.d-sm-inline-block{display:inline-block !important}.d-sm-block{display:block !important}.d-sm-table{display:table !important}.d-sm-table-row{display:table-row !important}.d-sm-table-cell{display:table-cell !important}.d-sm-flex{display:-webkit-box !important;display:flex !important}.d-sm-inline-flex{display:-webkit-inline-box !important;display:inline-flex !important}}@media (min-width: 768px){.d-md-none{display:none !important}.d-md-inline{display:inline !important}.d-md-inline-block{display:inline-block !important}.d-md-block{display:block !important}.d-md-table{display:table !important}.d-md-table-row{display:table-row !important}.d-md-table-cell{display:table-cell !important}.d-md-flex{display:-webkit-box !important;display:flex !important}.d-md-inline-flex{display:-webkit-inline-box !important;display:inline-flex !important}}@media (min-width: 992px){.d-lg-none{display:none !important}.d-lg-inline{display:inline !important}.d-lg-inline-block{display:inline-block !important}.d-lg-block{display:block !important}.d-lg-table{display:table !important}.d-lg-table-row{display:table-row !important}.d-lg-table-cell{display:table-cell !important}.d-lg-flex{display:-webkit-box !important;display:flex !important}.d-lg-inline-flex{display:-webkit-inline-box !important;display:inline-flex !important}}@media (min-width: 1200px){.d-xl-none{display:none !important}.d-xl-inline{display:inline !important}.d-xl-inline-block{display:inline-block !important}.d-xl-block{display:block !important}.d-xl-table{display:table !important}.d-xl-table-row{display:table-row !important}.d-xl-table-cell{display:table-cell !important}.d-xl-flex{display:-webkit-box !important;display:flex !important}.d-xl-inline-flex{display:-webkit-inline-box !important;display:inline-flex !important}}@media print{.d-print-none{display:none !important}.d-print-inline{display:inline !important}.d-print-inline-block{display:inline-block !important}.d-print-block{display:block !important}.d-print-table{display:table !important}.d-print-table-row{display:table-row !important}.d-print-table-cell{display:table-cell !important}.d-print-flex{display:-webkit-box !important;display:flex !important}.d-print-inline-flex{display:-webkit-inline-box !important;display:inline-flex !important}}.embed-responsive{position:relative;display:block;width:100%;padding:0;overflow:hidden}.embed-responsive::before{display:block;content:""}.embed-responsive .embed-responsive-item,.embed-responsive iframe,.embed-responsive embed,.embed-responsive object,.embed-responsive video{position:absolute;top:0;bottom:0;left:0;width:100%;height:100%;border:0}.embed-responsive-21by9::before{padding-top:42.85714%}.embed-responsive-16by9::before{padding-top:56.25%}.embed-responsive-4by3::before{padding-top:75%}.embed-responsive-1by1::before{padding-top:100%}.flex-row{-webkit-box-orient:horizontal !important;-webkit-box-direction:normal !important;flex-direction:row !important}.flex-column{-webkit-box-orient:vertical !important;-webkit-box-direction:normal !important;flex-direction:column !important}.flex-row-reverse{-webkit-box-orient:horizontal !important;-webkit-box-direction:reverse !important;flex-direction:row-reverse !important}.flex-column-reverse{-webkit-box-orient:vertical !important;-webkit-box-direction:reverse !important;flex-direction:column-reverse !important}.flex-wrap{flex-wrap:wrap !important}.flex-nowrap{flex-wrap:nowrap !important}.flex-wrap-reverse{flex-wrap:wrap-reverse !important}.flex-fill{-webkit-box-flex:1 !important;flex:1 1 auto !important}.flex-grow-0{-webkit-box-flex:0 !important;flex-grow:0 !important}.flex-grow-1{-webkit-box-flex:1 !important;flex-grow:1 !important}.flex-shrink-0{flex-shrink:0 !important}.flex-shrink-1{flex-shrink:1 !important}.justify-content-start{-webkit-box-pack:start !important;justify-content:flex-start !important}.justify-content-end{-webkit-box-pack:end !important;justify-content:flex-end !important}.justify-content-center{-webkit-box-pack:center !important;justify-content:center !important}.justify-content-between{-webkit-box-pack:justify !important;justify-content:space-between !important}.justify-content-around{justify-content:space-around !important}.align-items-start{-webkit-box-align:start !important;align-items:flex-start !important}.align-items-end{-webkit-box-align:end !important;align-items:flex-end !important}.align-items-center{-webkit-box-align:center !important;align-items:center !important}.align-items-baseline{-webkit-box-align:baseline !important;align-items:baseline !important}.align-items-stretch{-webkit-box-align:stretch !important;align-items:stretch !important}.align-content-start{align-content:flex-start !important}.align-content-end{align-content:flex-end !important}.align-content-center{align-content:center !important}.align-content-between{align-content:space-between !important}.align-content-around{align-content:space-around !important}.align-content-stretch{align-content:stretch !important}.align-self-auto{align-self:auto !important}.align-self-start{align-self:flex-start !important}.align-self-end{align-self:flex-end !important}.align-self-center{align-self:center !important}.align-self-baseline{align-self:baseline !important}.align-self-stretch{align-self:stretch !important}@media (min-width: 576px){.flex-sm-row{-webkit-box-orient:horizontal !important;-webkit-box-direction:normal !important;flex-direction:row !important}.flex-sm-column{-webkit-box-orient:vertical !important;-webkit-box-direction:normal !important;flex-direction:column !important}.flex-sm-row-reverse{-webkit-box-orient:horizontal !important;-webkit-box-direction:reverse !important;flex-direction:row-reverse !important}.flex-sm-column-reverse{-webkit-box-orient:vertical !important;-webkit-box-direction:reverse !important;flex-direction:column-reverse !important}.flex-sm-wrap{flex-wrap:wrap !important}.flex-sm-nowrap{flex-wrap:nowrap !important}.flex-sm-wrap-reverse{flex-wrap:wrap-reverse !important}.flex-sm-fill{-webkit-box-flex:1 !important;flex:1 1 auto !important}.flex-sm-grow-0{-webkit-box-flex:0 !important;flex-grow:0 !important}.flex-sm-grow-1{-webkit-box-flex:1 !important;flex-grow:1 !important}.flex-sm-shrink-0{flex-shrink:0 !important}.flex-sm-shrink-1{flex-shrink:1 !important}.justify-content-sm-start{-webkit-box-pack:start !important;justify-content:flex-start !important}.justify-content-sm-end{-webkit-box-pack:end !important;justify-content:flex-end !important}.justify-content-sm-center{-webkit-box-pack:center !important;justify-content:center !important}.justify-content-sm-between{-webkit-box-pack:justify !important;justify-content:space-between !important}.justify-content-sm-around{justify-content:space-around !important}.align-items-sm-start{-webkit-box-align:start !important;align-items:flex-start !important}.align-items-sm-end{-webkit-box-align:end !important;align-items:flex-end !important}.align-items-sm-center{-webkit-box-align:center !important;align-items:center !important}.align-items-sm-baseline{-webkit-box-align:baseline !important;align-items:baseline !important}.align-items-sm-stretch{-webkit-box-align:stretch !important;align-items:stretch !important}.align-content-sm-start{align-content:flex-start !important}.align-content-sm-end{align-content:flex-end !important}.align-content-sm-center{align-content:center !important}.align-content-sm-between{align-content:space-between !important}.align-content-sm-around{align-content:space-around !important}.align-content-sm-stretch{align-content:stretch !important}.align-self-sm-auto{align-self:auto !important}.align-self-sm-start{align-self:flex-start !important}.align-self-sm-end{align-self:flex-end !important}.align-self-sm-center{align-self:center !important}.align-self-sm-baseline{align-self:baseline !important}.align-self-sm-stretch{align-self:stretch !important}}@media (min-width: 768px){.flex-md-row{-webkit-box-orient:horizontal !important;-webkit-box-direction:normal !important;flex-direction:row !important}.flex-md-column{-webkit-box-orient:vertical !important;-webkit-box-direction:normal !important;flex-direction:column !important}.flex-md-row-reverse{-webkit-box-orient:horizontal !important;-webkit-box-direction:reverse !important;flex-direction:row-reverse !important}.flex-md-column-reverse{-webkit-box-orient:vertical !important;-webkit-box-direction:reverse !important;flex-direction:column-reverse !important}.flex-md-wrap{flex-wrap:wrap !important}.flex-md-nowrap{flex-wrap:nowrap !important}.flex-md-wrap-reverse{flex-wrap:wrap-reverse !important}.flex-md-fill{-webkit-box-flex:1 !important;flex:1 1 auto !important}.flex-md-grow-0{-webkit-box-flex:0 !important;flex-grow:0 !important}.flex-md-grow-1{-webkit-box-flex:1 !important;flex-grow:1 !important}.flex-md-shrink-0{flex-shrink:0 !important}.flex-md-shrink-1{flex-shrink:1 !important}.justify-content-md-start{-webkit-box-pack:start !important;justify-content:flex-start !important}.justify-content-md-end{-webkit-box-pack:end !important;justify-content:flex-end !important}.justify-content-md-center{-webkit-box-pack:center !important;justify-content:center !important}.justify-content-md-between{-webkit-box-pack:justify !important;justify-content:space-between !important}.justify-content-md-around{justify-content:space-around !important}.align-items-md-start{-webkit-box-align:start !important;align-items:flex-start !important}.align-items-md-end{-webkit-box-align:end !important;align-items:flex-end !important}.align-items-md-center{-webkit-box-align:center !important;align-items:center !important}.align-items-md-baseline{-webkit-box-align:baseline !important;align-items:baseline !important}.align-items-md-stretch{-webkit-box-align:stretch !important;align-items:stretch !important}.align-content-md-start{align-content:flex-start !important}.align-content-md-end{align-content:flex-end !important}.align-content-md-center{align-content:center !important}.align-content-md-between{align-content:space-between !important}.align-content-md-around{align-content:space-around !important}.align-content-md-stretch{align-content:stretch !important}.align-self-md-auto{align-self:auto !important}.align-self-md-start{align-self:flex-start !important}.align-self-md-end{align-self:flex-end !important}.align-self-md-center{align-self:center !important}.align-self-md-baseline{align-self:baseline !important}.align-self-md-stretch{align-self:stretch !important}}@media (min-width: 992px){.flex-lg-row{-webkit-box-orient:horizontal !important;-webkit-box-direction:normal !important;flex-direction:row !important}.flex-lg-column{-webkit-box-orient:vertical !important;-webkit-box-direction:normal !important;flex-direction:column !important}.flex-lg-row-reverse{-webkit-box-orient:horizontal !important;-webkit-box-direction:reverse !important;flex-direction:row-reverse !important}.flex-lg-column-reverse{-webkit-box-orient:vertical !important;-webkit-box-direction:reverse !important;flex-direction:column-reverse !important}.flex-lg-wrap{flex-wrap:wrap !important}.flex-lg-nowrap{flex-wrap:nowrap !important}.flex-lg-wrap-reverse{flex-wrap:wrap-reverse !important}.flex-lg-fill{-webkit-box-flex:1 !important;flex:1 1 auto !important}.flex-lg-grow-0{-webkit-box-flex:0 !important;flex-grow:0 !important}.flex-lg-grow-1{-webkit-box-flex:1 !important;flex-grow:1 !important}.flex-lg-shrink-0{flex-shrink:0 !important}.flex-lg-shrink-1{flex-shrink:1 !important}.justify-content-lg-start{-webkit-box-pack:start !important;justify-content:flex-start !important}.justify-content-lg-end{-webkit-box-pack:end !important;justify-content:flex-end !important}.justify-content-lg-center{-webkit-box-pack:center !important;justify-content:center !important}.justify-content-lg-between{-webkit-box-pack:justify !important;justify-content:space-between !important}.justify-content-lg-around{justify-content:space-around !important}.align-items-lg-start{-webkit-box-align:start !important;align-items:flex-start !important}.align-items-lg-end{-webkit-box-align:end !important;align-items:flex-end !important}.align-items-lg-center{-webkit-box-align:center !important;align-items:center !important}.align-items-lg-baseline{-webkit-box-align:baseline !important;align-items:baseline !important}.align-items-lg-stretch{-webkit-box-align:stretch !important;align-items:stretch !important}.align-content-lg-start{align-content:flex-start !important}.align-content-lg-end{align-content:flex-end !important}.align-content-lg-center{align-content:center !important}.align-content-lg-between{align-content:space-between !important}.align-content-lg-around{align-content:space-around !important}.align-content-lg-stretch{align-content:stretch !important}.align-self-lg-auto{align-self:auto !important}.align-self-lg-start{align-self:flex-start !important}.align-self-lg-end{align-self:flex-end !important}.align-self-lg-center{align-self:center !important}.align-self-lg-baseline{align-self:baseline !important}.align-self-lg-stretch{align-self:stretch !important}}@media (min-width: 1200px){.flex-xl-row{-webkit-box-orient:horizontal !important;-webkit-box-direction:normal !important;flex-direction:row !important}.flex-xl-column{-webkit-box-orient:vertical !important;-webkit-box-direction:normal !important;flex-direction:column !important}.flex-xl-row-reverse{-webkit-box-orient:horizontal !important;-webkit-box-direction:reverse !important;flex-direction:row-reverse !important}.flex-xl-column-reverse{-webkit-box-orient:vertical !important;-webkit-box-direction:reverse !important;flex-direction:column-reverse !important}.flex-xl-wrap{flex-wrap:wrap !important}.flex-xl-nowrap{flex-wrap:nowrap !important}.flex-xl-wrap-reverse{flex-wrap:wrap-reverse !important}.flex-xl-fill{-webkit-box-flex:1 !important;flex:1 1 auto !important}.flex-xl-grow-0{-webkit-box-flex:0 !important;flex-grow:0 !important}.flex-xl-grow-1{-webkit-box-flex:1 !important;flex-grow:1 !important}.flex-xl-shrink-0{flex-shrink:0 !important}.flex-xl-shrink-1{flex-shrink:1 !important}.justify-content-xl-start{-webkit-box-pack:start !important;justify-content:flex-start !important}.justify-content-xl-end{-webkit-box-pack:end !important;justify-content:flex-end !important}.justify-content-xl-center{-webkit-box-pack:center !important;justify-content:center !important}.justify-content-xl-between{-webkit-box-pack:justify !important;justify-content:space-between !important}.justify-content-xl-around{justify-content:space-around !important}.align-items-xl-start{-webkit-box-align:start !important;align-items:flex-start !important}.align-items-xl-end{-webkit-box-align:end !important;align-items:flex-end !important}.align-items-xl-center{-webkit-box-align:center !important;align-items:center !important}.align-items-xl-baseline{-webkit-box-align:baseline !important;align-items:baseline !important}.align-items-xl-stretch{-webkit-box-align:stretch !important;align-items:stretch !important}.align-content-xl-start{align-content:flex-start !important}.align-content-xl-end{align-content:flex-end !important}.align-content-xl-center{align-content:center !important}.align-content-xl-between{align-content:space-between !important}.align-content-xl-around{align-content:space-around !important}.align-content-xl-stretch{align-content:stretch !important}.align-self-xl-auto{align-self:auto !important}.align-self-xl-start{align-self:flex-start !important}.align-self-xl-end{align-self:flex-end !important}.align-self-xl-center{align-self:center !important}.align-self-xl-baseline{align-self:baseline !important}.align-self-xl-stretch{align-self:stretch !important}}.float-left{float:left !important}.float-right{float:right !important}.float-none{float:none !important}@media (min-width: 576px){.float-sm-left{float:left !important}.float-sm-right{float:right !important}.float-sm-none{float:none !important}}@media (min-width: 768px){.float-md-left{float:left !important}.float-md-right{float:right !important}.float-md-none{float:none !important}}@media (min-width: 992px){.float-lg-left{float:left !important}.float-lg-right{float:right !important}.float-lg-none{float:none !important}}@media (min-width: 1200px){.float-xl-left{float:left !important}.float-xl-right{float:right !important}.float-xl-none{float:none !important}}.overflow-auto{overflow:auto !important}.overflow-hidden{overflow:hidden !important}.position-static{position:static !important}.position-relative{position:relative !important}.position-absolute{position:absolute !important}.position-fixed{position:fixed !important}.position-sticky{position:-webkit-sticky !important;position:sticky !important}.fixed-top{position:fixed;top:0;right:0;left:0;z-index:1030}.fixed-bottom{position:fixed;right:0;bottom:0;left:0;z-index:1030}@supports ((position: -webkit-sticky) or (position: sticky)){.sticky-top{position:-webkit-sticky;position:sticky;top:0;z-index:1020}}.sr-only{position:absolute;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0}.sr-only-focusable:active,.sr-only-focusable:focus{position:static;width:auto;height:auto;overflow:visible;clip:auto;white-space:normal}.shadow-sm{box-shadow:0 0.125rem 0.25rem rgba(0,0,0,0.075) !important}.shadow{box-shadow:0 0.5rem 1rem rgba(0,0,0,0.15) !important}.shadow-lg{box-shadow:0 1rem 3rem rgba(0,0,0,0.175) !important}.shadow-none{box-shadow:none !important}.w-25{width:25% !important}.w-50{width:50% !important}.w-75{width:75% !important}.w-100{width:100% !important}.w-auto{width:auto !important}.h-25{height:25% !important}.h-50{height:50% !important}.h-75{height:75% !important}.h-100{height:100% !important}.h-auto{height:auto !important}.mw-100{max-width:100% !important}.mh-100{max-height:100% !important}.min-vw-100{min-width:100vw !important}.min-vh-100{min-height:100vh !important}.vw-100{width:100vw !important}.vh-100{height:100vh !important}.stretched-link::after{position:absolute;top:0;right:0;bottom:0;left:0;z-index:1;pointer-events:auto;content:"";background-color:rgba(0,0,0,0)}.m-0{margin:0 !important}.mt-0,.my-0{margin-top:0 !important}.mr-0,.mx-0{margin-right:0 !important}.mb-0,.my-0{margin-bottom:0 !important}.ml-0,.mx-0{margin-left:0 !important}.m-1{margin:.25rem !important}.mt-1,.my-1{margin-top:.25rem !important}.mr-1,.mx-1{margin-right:.25rem !important}.mb-1,.my-1{margin-bottom:.25rem !important}.ml-1,.mx-1{margin-left:.25rem !important}.m-2{margin:.5rem !important}.mt-2,.my-2{margin-top:.5rem !important}.mr-2,.mx-2{margin-right:.5rem !important}.mb-2,.my-2{margin-bottom:.5rem !important}.ml-2,.mx-2{margin-left:.5rem !important}.m-3{margin:1rem !important}.mt-3,.my-3{margin-top:1rem !important}.mr-3,.mx-3{margin-right:1rem !important}.mb-3,.my-3{margin-bottom:1rem !important}.ml-3,.mx-3{margin-left:1rem !important}.m-4{margin:1.5rem !important}.mt-4,.my-4{margin-top:1.5rem !important}.mr-4,.mx-4{margin-right:1.5rem !important}.mb-4,.my-4{margin-bottom:1.5rem !important}.ml-4,.mx-4{margin-left:1.5rem !important}.m-5{margin:3rem !important}.mt-5,.my-5{margin-top:3rem !important}.mr-5,.mx-5{margin-right:3rem !important}.mb-5,.my-5{margin-bottom:3rem !important}.ml-5,.mx-5{margin-left:3rem !important}.p-0{padding:0 !important}.pt-0,.py-0{padding-top:0 !important}.pr-0,.px-0{padding-right:0 !important}.pb-0,.py-0{padding-bottom:0 !important}.pl-0,.px-0{padding-left:0 !important}.p-1{padding:.25rem !important}.pt-1,.py-1{padding-top:.25rem !important}.pr-1,.px-1{padding-right:.25rem !important}.pb-1,.py-1{padding-bottom:.25rem !important}.pl-1,.px-1{padding-left:.25rem !important}.p-2{padding:.5rem !important}.pt-2,.py-2{padding-top:.5rem !important}.pr-2,.px-2{padding-right:.5rem !important}.pb-2,.py-2{padding-bottom:.5rem !important}.pl-2,.px-2{padding-left:.5rem !important}.p-3{padding:1rem !important}.pt-3,.py-3{padding-top:1rem !important}.pr-3,.px-3{padding-right:1rem !important}.pb-3,.py-3{padding-bottom:1rem !important}.pl-3,.px-3{padding-left:1rem !important}.p-4{padding:1.5rem !important}.pt-4,.py-4{padding-top:1.5rem !important}.pr-4,.px-4{padding-right:1.5rem !important}.pb-4,.py-4{padding-bottom:1.5rem !important}.pl-4,.px-4{padding-left:1.5rem !important}.p-5{padding:3rem !important}.pt-5,.py-5{padding-top:3rem !important}.pr-5,.px-5{padding-right:3rem !important}.pb-5,.py-5{padding-bottom:3rem !important}.pl-5,.px-5{padding-left:3rem !important}.m-n1{margin:-.25rem !important}.mt-n1,.my-n1{margin-top:-.25rem !important}.mr-n1,.mx-n1{margin-right:-.25rem !important}.mb-n1,.my-n1{margin-bottom:-.25rem !important}.ml-n1,.mx-n1{margin-left:-.25rem !important}.m-n2{margin:-.5rem !important}.mt-n2,.my-n2{margin-top:-.5rem !important}.mr-n2,.mx-n2{margin-right:-.5rem !important}.mb-n2,.my-n2{margin-bottom:-.5rem !important}.ml-n2,.mx-n2{margin-left:-.5rem !important}.m-n3{margin:-1rem !important}.mt-n3,.my-n3{margin-top:-1rem !important}.mr-n3,.mx-n3{margin-right:-1rem !important}.mb-n3,.my-n3{margin-bottom:-1rem !important}.ml-n3,.mx-n3{margin-left:-1rem !important}.m-n4{margin:-1.5rem !important}.mt-n4,.my-n4{margin-top:-1.5rem !important}.mr-n4,.mx-n4{margin-right:-1.5rem !important}.mb-n4,.my-n4{margin-bottom:-1.5rem !important}.ml-n4,.mx-n4{margin-left:-1.5rem !important}.m-n5{margin:-3rem !important}.mt-n5,.my-n5{margin-top:-3rem !important}.mr-n5,.mx-n5{margin-right:-3rem !important}.mb-n5,.my-n5{margin-bottom:-3rem !important}.ml-n5,.mx-n5{margin-left:-3rem !important}.m-auto{margin:auto !important}.mt-auto,.my-auto{margin-top:auto !important}.mr-auto,.mx-auto{margin-right:auto !important}.mb-auto,.my-auto{margin-bottom:auto !important}.ml-auto,.mx-auto{margin-left:auto !important}@media (min-width: 576px){.m-sm-0{margin:0 !important}.mt-sm-0,.my-sm-0{margin-top:0 !important}.mr-sm-0,.mx-sm-0{margin-right:0 !important}.mb-sm-0,.my-sm-0{margin-bottom:0 !important}.ml-sm-0,.mx-sm-0{margin-left:0 !important}.m-sm-1{margin:.25rem !important}.mt-sm-1,.my-sm-1{margin-top:.25rem !important}.mr-sm-1,.mx-sm-1{margin-right:.25rem !important}.mb-sm-1,.my-sm-1{margin-bottom:.25rem !important}.ml-sm-1,.mx-sm-1{margin-left:.25rem !important}.m-sm-2{margin:.5rem !important}.mt-sm-2,.my-sm-2{margin-top:.5rem !important}.mr-sm-2,.mx-sm-2{margin-right:.5rem !important}.mb-sm-2,.my-sm-2{margin-bottom:.5rem !important}.ml-sm-2,.mx-sm-2{margin-left:.5rem !important}.m-sm-3{margin:1rem !important}.mt-sm-3,.my-sm-3{margin-top:1rem !important}.mr-sm-3,.mx-sm-3{margin-right:1rem !important}.mb-sm-3,.my-sm-3{margin-bottom:1rem !important}.ml-sm-3,.mx-sm-3{margin-left:1rem !important}.m-sm-4{margin:1.5rem !important}.mt-sm-4,.my-sm-4{margin-top:1.5rem !important}.mr-sm-4,.mx-sm-4{margin-right:1.5rem !important}.mb-sm-4,.my-sm-4{margin-bottom:1.5rem !important}.ml-sm-4,.mx-sm-4{margin-left:1.5rem !important}.m-sm-5{margin:3rem !important}.mt-sm-5,.my-sm-5{margin-top:3rem !important}.mr-sm-5,.mx-sm-5{margin-right:3rem !important}.mb-sm-5,.my-sm-5{margin-bottom:3rem !important}.ml-sm-5,.mx-sm-5{margin-left:3rem !important}.p-sm-0{padding:0 !important}.pt-sm-0,.py-sm-0{padding-top:0 !important}.pr-sm-0,.px-sm-0{padding-right:0 !important}.pb-sm-0,.py-sm-0{padding-bottom:0 !important}.pl-sm-0,.px-sm-0{padding-left:0 !important}.p-sm-1{padding:.25rem !important}.pt-sm-1,.py-sm-1{padding-top:.25rem !important}.pr-sm-1,.px-sm-1{padding-right:.25rem !important}.pb-sm-1,.py-sm-1{padding-bottom:.25rem !important}.pl-sm-1,.px-sm-1{padding-left:.25rem !important}.p-sm-2{padding:.5rem !important}.pt-sm-2,.py-sm-2{padding-top:.5rem !important}.pr-sm-2,.px-sm-2{padding-right:.5rem !important}.pb-sm-2,.py-sm-2{padding-bottom:.5rem !important}.pl-sm-2,.px-sm-2{padding-left:.5rem !important}.p-sm-3{padding:1rem !important}.pt-sm-3,.py-sm-3{padding-top:1rem !important}.pr-sm-3,.px-sm-3{padding-right:1rem !important}.pb-sm-3,.py-sm-3{padding-bottom:1rem !important}.pl-sm-3,.px-sm-3{padding-left:1rem !important}.p-sm-4{padding:1.5rem !important}.pt-sm-4,.py-sm-4{padding-top:1.5rem !important}.pr-sm-4,.px-sm-4{padding-right:1.5rem !important}.pb-sm-4,.py-sm-4{padding-bottom:1.5rem !important}.pl-sm-4,.px-sm-4{padding-left:1.5rem !important}.p-sm-5{padding:3rem !important}.pt-sm-5,.py-sm-5{padding-top:3rem !important}.pr-sm-5,.px-sm-5{padding-right:3rem !important}.pb-sm-5,.py-sm-5{padding-bottom:3rem !important}.pl-sm-5,.px-sm-5{padding-left:3rem !important}.m-sm-n1{margin:-.25rem !important}.mt-sm-n1,.my-sm-n1{margin-top:-.25rem !important}.mr-sm-n1,.mx-sm-n1{margin-right:-.25rem !important}.mb-sm-n1,.my-sm-n1{margin-bottom:-.25rem !important}.ml-sm-n1,.mx-sm-n1{margin-left:-.25rem !important}.m-sm-n2{margin:-.5rem !important}.mt-sm-n2,.my-sm-n2{margin-top:-.5rem !important}.mr-sm-n2,.mx-sm-n2{margin-right:-.5rem !important}.mb-sm-n2,.my-sm-n2{margin-bottom:-.5rem !important}.ml-sm-n2,.mx-sm-n2{margin-left:-.5rem !important}.m-sm-n3{margin:-1rem !important}.mt-sm-n3,.my-sm-n3{margin-top:-1rem !important}.mr-sm-n3,.mx-sm-n3{margin-right:-1rem !important}.mb-sm-n3,.my-sm-n3{margin-bottom:-1rem !important}.ml-sm-n3,.mx-sm-n3{margin-left:-1rem !important}.m-sm-n4{margin:-1.5rem !important}.mt-sm-n4,.my-sm-n4{margin-top:-1.5rem !important}.mr-sm-n4,.mx-sm-n4{margin-right:-1.5rem !important}.mb-sm-n4,.my-sm-n4{margin-bottom:-1.5rem !important}.ml-sm-n4,.mx-sm-n4{margin-left:-1.5rem !important}.m-sm-n5{margin:-3rem !important}.mt-sm-n5,.my-sm-n5{margin-top:-3rem !important}.mr-sm-n5,.mx-sm-n5{margin-right:-3rem !important}.mb-sm-n5,.my-sm-n5{margin-bottom:-3rem !important}.ml-sm-n5,.mx-sm-n5{margin-left:-3rem !important}.m-sm-auto{margin:auto !important}.mt-sm-auto,.my-sm-auto{margin-top:auto !important}.mr-sm-auto,.mx-sm-auto{margin-right:auto !important}.mb-sm-auto,.my-sm-auto{margin-bottom:auto !important}.ml-sm-auto,.mx-sm-auto{margin-left:auto !important}}@media (min-width: 768px){.m-md-0{margin:0 !important}.mt-md-0,.my-md-0{margin-top:0 !important}.mr-md-0,.mx-md-0{margin-right:0 !important}.mb-md-0,.my-md-0{margin-bottom:0 !important}.ml-md-0,.mx-md-0{margin-left:0 !important}.m-md-1{margin:.25rem !important}.mt-md-1,.my-md-1{margin-top:.25rem !important}.mr-md-1,.mx-md-1{margin-right:.25rem !important}.mb-md-1,.my-md-1{margin-bottom:.25rem !important}.ml-md-1,.mx-md-1{margin-left:.25rem !important}.m-md-2{margin:.5rem !important}.mt-md-2,.my-md-2{margin-top:.5rem !important}.mr-md-2,.mx-md-2{margin-right:.5rem !important}.mb-md-2,.my-md-2{margin-bottom:.5rem !important}.ml-md-2,.mx-md-2{margin-left:.5rem !important}.m-md-3{margin:1rem !important}.mt-md-3,.my-md-3{margin-top:1rem !important}.mr-md-3,.mx-md-3{margin-right:1rem !important}.mb-md-3,.my-md-3{margin-bottom:1rem !important}.ml-md-3,.mx-md-3{margin-left:1rem !important}.m-md-4{margin:1.5rem !important}.mt-md-4,.my-md-4{margin-top:1.5rem !important}.mr-md-4,.mx-md-4{margin-right:1.5rem !important}.mb-md-4,.my-md-4{margin-bottom:1.5rem !important}.ml-md-4,.mx-md-4{margin-left:1.5rem !important}.m-md-5{margin:3rem !important}.mt-md-5,.my-md-5{margin-top:3rem !important}.mr-md-5,.mx-md-5{margin-right:3rem !important}.mb-md-5,.my-md-5{margin-bottom:3rem !important}.ml-md-5,.mx-md-5{margin-left:3rem !important}.p-md-0{padding:0 !important}.pt-md-0,.py-md-0{padding-top:0 !important}.pr-md-0,.px-md-0{padding-right:0 !important}.pb-md-0,.py-md-0{padding-bottom:0 !important}.pl-md-0,.px-md-0{padding-left:0 !important}.p-md-1{padding:.25rem !important}.pt-md-1,.py-md-1{padding-top:.25rem !important}.pr-md-1,.px-md-1{padding-right:.25rem !important}.pb-md-1,.py-md-1{padding-bottom:.25rem !important}.pl-md-1,.px-md-1{padding-left:.25rem !important}.p-md-2{padding:.5rem !important}.pt-md-2,.py-md-2{padding-top:.5rem !important}.pr-md-2,.px-md-2{padding-right:.5rem !important}.pb-md-2,.py-md-2{padding-bottom:.5rem !important}.pl-md-2,.px-md-2{padding-left:.5rem !important}.p-md-3{padding:1rem !important}.pt-md-3,.py-md-3{padding-top:1rem !important}.pr-md-3,.px-md-3{padding-right:1rem !important}.pb-md-3,.py-md-3{padding-bottom:1rem !important}.pl-md-3,.px-md-3{padding-left:1rem !important}.p-md-4{padding:1.5rem !important}.pt-md-4,.py-md-4{padding-top:1.5rem !important}.pr-md-4,.px-md-4{padding-right:1.5rem !important}.pb-md-4,.py-md-4{padding-bottom:1.5rem !important}.pl-md-4,.px-md-4{padding-left:1.5rem !important}.p-md-5{padding:3rem !important}.pt-md-5,.py-md-5{padding-top:3rem !important}.pr-md-5,.px-md-5{padding-right:3rem !important}.pb-md-5,.py-md-5{padding-bottom:3rem !important}.pl-md-5,.px-md-5{padding-left:3rem !important}.m-md-n1{margin:-.25rem !important}.mt-md-n1,.my-md-n1{margin-top:-.25rem !important}.mr-md-n1,.mx-md-n1{margin-right:-.25rem !important}.mb-md-n1,.my-md-n1{margin-bottom:-.25rem !important}.ml-md-n1,.mx-md-n1{margin-left:-.25rem !important}.m-md-n2{margin:-.5rem !important}.mt-md-n2,.my-md-n2{margin-top:-.5rem !important}.mr-md-n2,.mx-md-n2{margin-right:-.5rem !important}.mb-md-n2,.my-md-n2{margin-bottom:-.5rem !important}.ml-md-n2,.mx-md-n2{margin-left:-.5rem !important}.m-md-n3{margin:-1rem !important}.mt-md-n3,.my-md-n3{margin-top:-1rem !important}.mr-md-n3,.mx-md-n3{margin-right:-1rem !important}.mb-md-n3,.my-md-n3{margin-bottom:-1rem !important}.ml-md-n3,.mx-md-n3{margin-left:-1rem !important}.m-md-n4{margin:-1.5rem !important}.mt-md-n4,.my-md-n4{margin-top:-1.5rem !important}.mr-md-n4,.mx-md-n4{margin-right:-1.5rem !important}.mb-md-n4,.my-md-n4{margin-bottom:-1.5rem !important}.ml-md-n4,.mx-md-n4{margin-left:-1.5rem !important}.m-md-n5{margin:-3rem !important}.mt-md-n5,.my-md-n5{margin-top:-3rem !important}.mr-md-n5,.mx-md-n5{margin-right:-3rem !important}.mb-md-n5,.my-md-n5{margin-bottom:-3rem !important}.ml-md-n5,.mx-md-n5{margin-left:-3rem !important}.m-md-auto{margin:auto !important}.mt-md-auto,.my-md-auto{margin-top:auto !important}.mr-md-auto,.mx-md-auto{margin-right:auto !important}.mb-md-auto,.my-md-auto{margin-bottom:auto !important}.ml-md-auto,.mx-md-auto{margin-left:auto !important}}@media (min-width: 992px){.m-lg-0{margin:0 !important}.mt-lg-0,.my-lg-0{margin-top:0 !important}.mr-lg-0,.mx-lg-0{margin-right:0 !important}.mb-lg-0,.my-lg-0{margin-bottom:0 !important}.ml-lg-0,.mx-lg-0{margin-left:0 !important}.m-lg-1{margin:.25rem !important}.mt-lg-1,.my-lg-1{margin-top:.25rem !important}.mr-lg-1,.mx-lg-1{margin-right:.25rem !important}.mb-lg-1,.my-lg-1{margin-bottom:.25rem !important}.ml-lg-1,.mx-lg-1{margin-left:.25rem !important}.m-lg-2{margin:.5rem !important}.mt-lg-2,.my-lg-2{margin-top:.5rem !important}.mr-lg-2,.mx-lg-2{margin-right:.5rem !important}.mb-lg-2,.my-lg-2{margin-bottom:.5rem !important}.ml-lg-2,.mx-lg-2{margin-left:.5rem !important}.m-lg-3{margin:1rem !important}.mt-lg-3,.my-lg-3{margin-top:1rem !important}.mr-lg-3,.mx-lg-3{margin-right:1rem !important}.mb-lg-3,.my-lg-3{margin-bottom:1rem !important}.ml-lg-3,.mx-lg-3{margin-left:1rem !important}.m-lg-4{margin:1.5rem !important}.mt-lg-4,.my-lg-4{margin-top:1.5rem !important}.mr-lg-4,.mx-lg-4{margin-right:1.5rem !important}.mb-lg-4,.my-lg-4{margin-bottom:1.5rem !important}.ml-lg-4,.mx-lg-4{margin-left:1.5rem !important}.m-lg-5{margin:3rem !important}.mt-lg-5,.my-lg-5{margin-top:3rem !important}.mr-lg-5,.mx-lg-5{margin-right:3rem !important}.mb-lg-5,.my-lg-5{margin-bottom:3rem !important}.ml-lg-5,.mx-lg-5{margin-left:3rem !important}.p-lg-0{padding:0 !important}.pt-lg-0,.py-lg-0{padding-top:0 !important}.pr-lg-0,.px-lg-0{padding-right:0 !important}.pb-lg-0,.py-lg-0{padding-bottom:0 !important}.pl-lg-0,.px-lg-0{padding-left:0 !important}.p-lg-1{padding:.25rem !important}.pt-lg-1,.py-lg-1{padding-top:.25rem !important}.pr-lg-1,.px-lg-1{padding-right:.25rem !important}.pb-lg-1,.py-lg-1{padding-bottom:.25rem !important}.pl-lg-1,.px-lg-1{padding-left:.25rem !important}.p-lg-2{padding:.5rem !important}.pt-lg-2,.py-lg-2{padding-top:.5rem !important}.pr-lg-2,.px-lg-2{padding-right:.5rem !important}.pb-lg-2,.py-lg-2{padding-bottom:.5rem !important}.pl-lg-2,.px-lg-2{padding-left:.5rem !important}.p-lg-3{padding:1rem !important}.pt-lg-3,.py-lg-3{padding-top:1rem !important}.pr-lg-3,.px-lg-3{padding-right:1rem !important}.pb-lg-3,.py-lg-3{padding-bottom:1rem !important}.pl-lg-3,.px-lg-3{padding-left:1rem !important}.p-lg-4{padding:1.5rem !important}.pt-lg-4,.py-lg-4{padding-top:1.5rem !important}.pr-lg-4,.px-lg-4{padding-right:1.5rem !important}.pb-lg-4,.py-lg-4{padding-bottom:1.5rem !important}.pl-lg-4,.px-lg-4{padding-left:1.5rem !important}.p-lg-5{padding:3rem !important}.pt-lg-5,.py-lg-5{padding-top:3rem !important}.pr-lg-5,.px-lg-5{padding-right:3rem !important}.pb-lg-5,.py-lg-5{padding-bottom:3rem !important}.pl-lg-5,.px-lg-5{padding-left:3rem !important}.m-lg-n1{margin:-.25rem !important}.mt-lg-n1,.my-lg-n1{margin-top:-.25rem !important}.mr-lg-n1,.mx-lg-n1{margin-right:-.25rem !important}.mb-lg-n1,.my-lg-n1{margin-bottom:-.25rem !important}.ml-lg-n1,.mx-lg-n1{margin-left:-.25rem !important}.m-lg-n2{margin:-.5rem !important}.mt-lg-n2,.my-lg-n2{margin-top:-.5rem !important}.mr-lg-n2,.mx-lg-n2{margin-right:-.5rem !important}.mb-lg-n2,.my-lg-n2{margin-bottom:-.5rem !important}.ml-lg-n2,.mx-lg-n2{margin-left:-.5rem !important}.m-lg-n3{margin:-1rem !important}.mt-lg-n3,.my-lg-n3{margin-top:-1rem !important}.mr-lg-n3,.mx-lg-n3{margin-right:-1rem !important}.mb-lg-n3,.my-lg-n3{margin-bottom:-1rem !important}.ml-lg-n3,.mx-lg-n3{margin-left:-1rem !important}.m-lg-n4{margin:-1.5rem !important}.mt-lg-n4,.my-lg-n4{margin-top:-1.5rem !important}.mr-lg-n4,.mx-lg-n4{margin-right:-1.5rem !important}.mb-lg-n4,.my-lg-n4{margin-bottom:-1.5rem !important}.ml-lg-n4,.mx-lg-n4{margin-left:-1.5rem !important}.m-lg-n5{margin:-3rem !important}.mt-lg-n5,.my-lg-n5{margin-top:-3rem !important}.mr-lg-n5,.mx-lg-n5{margin-right:-3rem !important}.mb-lg-n5,.my-lg-n5{margin-bottom:-3rem !important}.ml-lg-n5,.mx-lg-n5{margin-left:-3rem !important}.m-lg-auto{margin:auto !important}.mt-lg-auto,.my-lg-auto{margin-top:auto !important}.mr-lg-auto,.mx-lg-auto{margin-right:auto !important}.mb-lg-auto,.my-lg-auto{margin-bottom:auto !important}.ml-lg-auto,.mx-lg-auto{margin-left:auto !important}}@media (min-width: 1200px){.m-xl-0{margin:0 !important}.mt-xl-0,.my-xl-0{margin-top:0 !important}.mr-xl-0,.mx-xl-0{margin-right:0 !important}.mb-xl-0,.my-xl-0{margin-bottom:0 !important}.ml-xl-0,.mx-xl-0{margin-left:0 !important}.m-xl-1{margin:.25rem !important}.mt-xl-1,.my-xl-1{margin-top:.25rem !important}.mr-xl-1,.mx-xl-1{margin-right:.25rem !important}.mb-xl-1,.my-xl-1{margin-bottom:.25rem !important}.ml-xl-1,.mx-xl-1{margin-left:.25rem !important}.m-xl-2{margin:.5rem !important}.mt-xl-2,.my-xl-2{margin-top:.5rem !important}.mr-xl-2,.mx-xl-2{margin-right:.5rem !important}.mb-xl-2,.my-xl-2{margin-bottom:.5rem !important}.ml-xl-2,.mx-xl-2{margin-left:.5rem !important}.m-xl-3{margin:1rem !important}.mt-xl-3,.my-xl-3{margin-top:1rem !important}.mr-xl-3,.mx-xl-3{margin-right:1rem !important}.mb-xl-3,.my-xl-3{margin-bottom:1rem !important}.ml-xl-3,.mx-xl-3{margin-left:1rem !important}.m-xl-4{margin:1.5rem !important}.mt-xl-4,.my-xl-4{margin-top:1.5rem !important}.mr-xl-4,.mx-xl-4{margin-right:1.5rem !important}.mb-xl-4,.my-xl-4{margin-bottom:1.5rem !important}.ml-xl-4,.mx-xl-4{margin-left:1.5rem !important}.m-xl-5{margin:3rem !important}.mt-xl-5,.my-xl-5{margin-top:3rem !important}.mr-xl-5,.mx-xl-5{margin-right:3rem !important}.mb-xl-5,.my-xl-5{margin-bottom:3rem !important}.ml-xl-5,.mx-xl-5{margin-left:3rem !important}.p-xl-0{padding:0 !important}.pt-xl-0,.py-xl-0{padding-top:0 !important}.pr-xl-0,.px-xl-0{padding-right:0 !important}.pb-xl-0,.py-xl-0{padding-bottom:0 !important}.pl-xl-0,.px-xl-0{padding-left:0 !important}.p-xl-1{padding:.25rem !important}.pt-xl-1,.py-xl-1{padding-top:.25rem !important}.pr-xl-1,.px-xl-1{padding-right:.25rem !important}.pb-xl-1,.py-xl-1{padding-bottom:.25rem !important}.pl-xl-1,.px-xl-1{padding-left:.25rem !important}.p-xl-2{padding:.5rem !important}.pt-xl-2,.py-xl-2{padding-top:.5rem !important}.pr-xl-2,.px-xl-2{padding-right:.5rem !important}.pb-xl-2,.py-xl-2{padding-bottom:.5rem !important}.pl-xl-2,.px-xl-2{padding-left:.5rem !important}.p-xl-3{padding:1rem !important}.pt-xl-3,.py-xl-3{padding-top:1rem !important}.pr-xl-3,.px-xl-3{padding-right:1rem !important}.pb-xl-3,.py-xl-3{padding-bottom:1rem !important}.pl-xl-3,.px-xl-3{padding-left:1rem !important}.p-xl-4{padding:1.5rem !important}.pt-xl-4,.py-xl-4{padding-top:1.5rem !important}.pr-xl-4,.px-xl-4{padding-right:1.5rem !important}.pb-xl-4,.py-xl-4{padding-bottom:1.5rem !important}.pl-xl-4,.px-xl-4{padding-left:1.5rem !important}.p-xl-5{padding:3rem !important}.pt-xl-5,.py-xl-5{padding-top:3rem !important}.pr-xl-5,.px-xl-5{padding-right:3rem !important}.pb-xl-5,.py-xl-5{padding-bottom:3rem !important}.pl-xl-5,.px-xl-5{padding-left:3rem !important}.m-xl-n1{margin:-.25rem !important}.mt-xl-n1,.my-xl-n1{margin-top:-.25rem !important}.mr-xl-n1,.mx-xl-n1{margin-right:-.25rem !important}.mb-xl-n1,.my-xl-n1{margin-bottom:-.25rem !important}.ml-xl-n1,.mx-xl-n1{margin-left:-.25rem !important}.m-xl-n2{margin:-.5rem !important}.mt-xl-n2,.my-xl-n2{margin-top:-.5rem !important}.mr-xl-n2,.mx-xl-n2{margin-right:-.5rem !important}.mb-xl-n2,.my-xl-n2{margin-bottom:-.5rem !important}.ml-xl-n2,.mx-xl-n2{margin-left:-.5rem !important}.m-xl-n3{margin:-1rem !important}.mt-xl-n3,.my-xl-n3{margin-top:-1rem !important}.mr-xl-n3,.mx-xl-n3{margin-right:-1rem !important}.mb-xl-n3,.my-xl-n3{margin-bottom:-1rem !important}.ml-xl-n3,.mx-xl-n3{margin-left:-1rem !important}.m-xl-n4{margin:-1.5rem !important}.mt-xl-n4,.my-xl-n4{margin-top:-1.5rem !important}.mr-xl-n4,.mx-xl-n4{margin-right:-1.5rem !important}.mb-xl-n4,.my-xl-n4{margin-bottom:-1.5rem !important}.ml-xl-n4,.mx-xl-n4{margin-left:-1.5rem !important}.m-xl-n5{margin:-3rem !important}.mt-xl-n5,.my-xl-n5{margin-top:-3rem !important}.mr-xl-n5,.mx-xl-n5{margin-right:-3rem !important}.mb-xl-n5,.my-xl-n5{margin-bottom:-3rem !important}.ml-xl-n5,.mx-xl-n5{margin-left:-3rem !important}.m-xl-auto{margin:auto !important}.mt-xl-auto,.my-xl-auto{margin-top:auto !important}.mr-xl-auto,.mx-xl-auto{margin-right:auto !important}.mb-xl-auto,.my-xl-auto{margin-bottom:auto !important}.ml-xl-auto,.mx-xl-auto{margin-left:auto !important}}.text-monospace{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace !important}.text-justify{text-align:justify !important}.text-wrap{white-space:normal !important}.text-nowrap{white-space:nowrap !important}.text-truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.text-left{text-align:left !important}.text-right{text-align:right !important}.text-center{text-align:center !important}@media (min-width: 576px){.text-sm-left{text-align:left !important}.text-sm-right{text-align:right !important}.text-sm-center{text-align:center !important}}@media (min-width: 768px){.text-md-left{text-align:left !important}.text-md-right{text-align:right !important}.text-md-center{text-align:center !important}}@media (min-width: 992px){.text-lg-left{text-align:left !important}.text-lg-right{text-align:right !important}.text-lg-center{text-align:center !important}}@media (min-width: 1200px){.text-xl-left{text-align:left !important}.text-xl-right{text-align:right !important}.text-xl-center{text-align:center !important}}.text-lowercase{text-transform:lowercase !important}.text-uppercase{text-transform:uppercase !important}.text-capitalize{text-transform:capitalize !important}.font-weight-light{font-weight:300 !important}.font-weight-lighter{font-weight:lighter !important}.font-weight-normal{font-weight:400 !important}.font-weight-bold{font-weight:700 !important}.font-weight-bolder{font-weight:bolder !important}.font-italic{font-style:italic !important}.text-white{color:#fff !important}.text-primary{color:#007bff !important}a.text-primary:hover,a.text-primary:focus{color:#0056b3 !important}.text-secondary{color:#6c757d !important}a.text-secondary:hover,a.text-secondary:focus{color:#494f54 !important}.text-success{color:#28a745 !important}a.text-success:hover,a.text-success:focus{color:#19692c !important}.text-info{color:#17a2b8 !important}a.text-info:hover,a.text-info:focus{color:#0f6674 !important}.text-warning{color:#ffc107 !important}a.text-warning:hover,a.text-warning:focus{color:#ba8b00 !important}.text-danger{color:#dc3545 !important}a.text-danger:hover,a.text-danger:focus{color:#a71d2a !important}.text-light{color:#f8f9fa !important}a.text-light:hover,a.text-light:focus{color:#cbd3da !important}.text-dark{color:#343a40 !important}a.text-dark:hover,a.text-dark:focus{color:#121416 !important}.text-body{color:#212529 !important}.text-muted{color:#6c757d !important}.text-black-50{color:rgba(0,0,0,0.5) !important}.text-white-50{color:rgba(255,255,255,0.5) !important}.text-hide{font:0/0 a;color:transparent;text-shadow:none;background-color:transparent;border:0}.text-decoration-none{text-decoration:none !important}.text-break{word-break:break-word !important;overflow-wrap:break-word !important}.text-reset{color:inherit !important}.visible{visibility:visible !important}.invisible{visibility:hidden !important}@media print{*,*::before,*::after{text-shadow:none !important;box-shadow:none !important}a:not(.btn){text-decoration:underline}abbr[title]::after{content:" (" attr(title) ")"}pre{white-space:pre-wrap !important}pre,blockquote{border:1px solid #adb5bd;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}p,h2,h3{orphans:3;widows:3}h2,h3{page-break-after:avoid}@page{size:a3}body{min-width:992px !important}.container{min-width:992px !important}.navbar{display:none}.badge{border:1px solid #000}.table{border-collapse:collapse !important}.table td,.table th{background-color:#fff !important}.table-bordered th,.table-bordered td{border:1px solid #dee2e6 !important}.table-dark{color:inherit}.table-dark th,.table-dark td,.table-dark thead th,.table-dark tbody+tbody{border-color:#dee2e6}.table .thead-dark th{color:inherit;border-color:#dee2e6}}\n',""])},function(e,t,i){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=function(e,t){var i=e[1]||"",r=e[3];if(!r)return i;if(t&&"function"==typeof btoa){var o=(n=r,a=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(l," */")),s=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot).concat(e," */")}));return[i].concat(s).concat([o]).join("\n")}var n,a,l;return[i].join("\n")}(t,e);return t[2]?"@media ".concat(t[2],"{").concat(i,"}"):i})).join("")},t.i=function(e,i){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},o=0;o<this.length;o++){var s=this[o][0];null!=s&&(r[s]=!0)}for(var n=0;n<e.length;n++){var a=e[n];null!=a[0]&&r[a[0]]||(i&&!a[2]?a[2]=i:i&&(a[2]="(".concat(a[2],") and (").concat(i,")")),t.push(a))}},t}},function(e,t,i){"use strict";var r,o={},s=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},n=function(){var e={};return function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}e[t]=i}return e[t]}}();function a(e,t){for(var i=[],r={},o=0;o<e.length;o++){var s=e[o],n=t.base?s[0]+t.base:s[0],a={css:s[1],media:s[2],sourceMap:s[3]};r[n]?r[n].parts.push(a):i.push(r[n]={id:n,parts:[a]})}return i}function l(e,t){for(var i=0;i<e.length;i++){var r=e[i],s=o[r.id],n=0;if(s){for(s.refs++;n<s.parts.length;n++)s.parts[n](r.parts[n]);for(;n<r.parts.length;n++)s.parts.push(g(r.parts[n],t))}else{for(var a=[];n<r.parts.length;n++)a.push(g(r.parts[n],t));o[r.id]={id:r.id,refs:1,parts:a}}}}function c(e){var t=document.createElement("style");if(void 0===e.attributes.nonce){var r=i.nc;r&&(e.attributes.nonce=r)}if(Object.keys(e.attributes).forEach((function(i){t.setAttribute(i,e.attributes[i])})),"function"==typeof e.insert)e.insert(t);else{var o=n(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var h,d=(h=[],function(e,t){return h[e]=t,h.filter(Boolean).join("\n")});function u(e,t,i,r){var o=i?"":r.css;if(e.styleSheet)e.styleSheet.cssText=d(t,o);else{var s=document.createTextNode(o),n=e.childNodes;n[t]&&e.removeChild(n[t]),n.length?e.insertBefore(s,n[t]):e.appendChild(s)}}function p(e,t,i){var r=i.css,o=i.media,s=i.sourceMap;if(o&&e.setAttribute("media",o),s&&btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var m=null,f=0;function g(e,t){var i,r,o;if(t.singleton){var s=f++;i=m||(m=c(t)),r=u.bind(null,i,s,!1),o=u.bind(null,i,s,!0)}else i=c(t),r=p.bind(null,i,t),o=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(i)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else o()}}e.exports=function(e,t){(t=t||{}).attributes="object"==typeof t.attributes?t.attributes:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=s());var i=a(e,t);return l(i,t),function(e){for(var r=[],s=0;s<i.length;s++){var n=i[s],c=o[n.id];c&&(c.refs--,r.push(c))}e&&l(a(e,t),t);for(var h=0;h<r.length;h++){var d=r[h];if(0===d.refs){for(var u=0;u<d.parts.length;u++)d.parts[u]();delete o[d.id]}}}}},function(e,t,i){"use strict";i.r(t);var r=[["0",10],["A",26],["a",26],["_",1],["$",1]].map((function(e){for(var t=[],i=e[0].charCodeAt(0),r=i+e[1],o=i;o<r;++o)t.push(o);return String.fromCharCode.apply(null,t)})).join("");function o(e,t){return(t&&4!==t?[0,6]:[0,6,12,18]).map((function(t){return r.substr(parseInt(e/(1<<t))%64,1)})).reverse().join("")}const s={xmlToJson:function e(t,i){if(t.nodeType===t.TEXT_NODE){var r=t.nodeValue;if(null===r.match(/^\s+$/))return r}else if(t.nodeType===t.ELEMENT_NODE||t.nodeType===t.DOCUMENT_NODE){var o={type:t.nodeName,children:[]};if(t.nodeType===t.ELEMENT_NODE)for(var s=0;s<t.attributes.length;s++){var n=t.attributes[s];o[i[n.nodeName]||n.nodeName]=n.nodeValue}for(var a=0;a<t.childNodes.length;a++){(s=e(t.childNodes[a],i))&&o.children.push(s)}return o}},clone:function(e){return JSON.parse(JSON.stringify(e))},compressGuid:function(e){var t=[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30].map((function(t){return parseInt(e.substr(t,2),16)}));return o(t[0],2)+[1,4,7,10,13].map((function(e){return o((t[e]<<16)+(t[e+1]<<8)+t[e+2])})).join("")},findNodeOfType:function(e,t){var i=[],r=function(e){e.type===t&&i.push(e),(e.children||[]).forEach((function(e){r(e)}))};return r(e),i},timeout:function(e){return new Promise((function(t,i){setTimeout(t,e)}))},httpRequest:function(e){return new Promise((function(t,i){var r=new XMLHttpRequest;r.open(e.method||"GET",e.url,!0),r.onload=function(o){console.log(e.url,r.readyState,r.status),4===r.readyState&&(200===r.status?t(r.responseXML):i(r.statusText))},r.send(null)}))},loadJSON:function(e,t,i){var r=e=>void 0;t=t||r,i=i||r;var o=new XMLHttpRequest;o.overrideMimeType("application/json"),o.open("GET",e,!0),o.addEventListener("load",(function(e){var r=e.target.response;if(200===this.status){var o;try{o=JSON.parse(r)}catch(e){i(`utils.loadJSON(): Failed to parse JSON response - ${e}`)}t(o)}else if(0===this.status){console.warn("loadFile: HTTP Status 0 received.");try{t(JSON.parse(r))}catch(e){i(`utils.loadJSON(): Failed to parse JSON response - ${e}`)}}else i(e)}),!1),o.addEventListener("error",(function(e){i(e)}),!1),o.send(null)},loadArraybuffer:function(e,t,i){var r=e=>void 0;t=t||r,i=i||r;const o=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(o){const e=!!o[2];var s=o[3];s=window.decodeURIComponent(s),e&&(s=window.atob(s));try{const e=new ArrayBuffer(s.length),i=new Uint8Array(e);for(var n=0;n<s.length;n++)i[n]=s.charCodeAt(n);window.setTimeout((function(){t(e)}),0)}catch(e){window.setTimeout((function(){i(e)}),0)}}else{const r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onreadystatechange=function(){4===r.readyState&&(200===r.status?t(r.response):i("loadArrayBuffer error : "+r.response))},r.send(null)}},queryString:function(){for(var e={},t=window.location.search.substring(1).split("&"),i=0;i<t.length;i++){var r=t[i].split("=");if(void 0===e[r[0]])e[r[0]]=decodeURIComponent(r[1]);else if("string"==typeof e[r[0]]){var o=[e[r[0]],decodeURIComponent(r[1])];e[r[0]]=o}else e[r[0]].push(decodeURIComponent(r[1]))}return e}(),isArray:function(e){return e&&!e.propertyIsEnumerable("length")&&"object"==typeof e&&"number"==typeof e.length},isString:function(e){return"string"==typeof e||e instanceof String},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},isID:function(e){return s.isString(e)||s.isNumeric(e)},isSameComponent:function(e,t){return!(!e||!t)&&(s.isNumeric(e)||s.isString(e)?`${e}`:e.id)===(s.isNumeric(t)||s.isString(t)?`${t}`:t.id)},isFunction:function(e){return"function"==typeof e},isObject:function(e){const t={}.constructor;return!!e&&e.constructor===t},copy:function(e){return s.apply(e,{})},apply:function(e,t){for(const i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},apply2:function(e,t){for(const i in e)e.hasOwnProperty(i)&&void 0!==e[i]&&null!==e[i]&&(t[i]=e[i]);return t},applyIf:function(e,t){for(const i in e)e.hasOwnProperty(i)&&(void 0!==t[i]&&null!==t[i]||(t[i]=e[i]));return t},isEmptyObject:function(e){for(const t in e)if(e.hasOwnProperty(t))return!1;return!0},inQuotes:function(e){return s.isNumeric(e)?`${e}`:`'${e}'`},concat:function(e,t){const i=new e.constructor(e.length+t.length);return i.set(e),i.set(t,e.length),i},flattenParentChildHierarchy:function(e){var t=[];return function e(i){i.id=i.uuid,delete i.oid,t.push(i);var r=i.children;if(r)for(var o=0,s=r.length;o<s;o++){r[o].parent=i.id,e(r[o])}i.children=[]}(e),console.log(JSON.stringify(t,null,"\t")),t}};class n{constructor(e,t){this.items=e||[],this._lastUniqueId=(t||0)+1}addItem(){let e;if(2===arguments.length){const t=arguments[0];if(e=arguments[1],this.items[t])throw"ID clash: '"+t+"'";return this.items[t]=e,t}for(e=arguments[0]||{};;){const t=this._lastUniqueId++;if(!this.items[t])return this.items[t]=e,t}}removeItem(e){const t=this.items[e];return delete this.items[e],t}}class a{constructor(e,t,i,r){this.viewerUI=e?e.viewerUI||e:this,this.server=e?e.server:i,this.viewer=e?e.viewer:r,this._children=[],e&&e._children.push(this),this._subIdMap=null,this._subIdEvents=null,this._eventSubs=null,this._events=null,this._eventCallDepth=0,this._enabled=null,this._active=null}fire(e,t,i){this._events||(this._events={}),this._eventSubs||(this._eventSubs={}),!0!==i&&(this._events[e]=t||!0);const r=this._eventSubs[e];let o;if(r)for(const i in r)r.hasOwnProperty(i)&&(o=r[i],this._eventCallDepth++,this._eventCallDepth<300?o.callback.call(o.scope,t):this.error("fire: potential stack overflow from recursive event '"+e+"' - dropping this event"),this._eventCallDepth--)}on(e,t,i){this._events||(this._events={}),this._subIdMap||(this._subIdMap=new n),this._subIdEvents||(this._subIdEvents={}),this._eventSubs||(this._eventSubs={});let r=this._eventSubs[e];r||(r={},this._eventSubs[e]=r);const o=this._subIdMap.addItem();r[o]={callback:t,scope:i||this},this._subIdEvents[o]=e;const s=this._events[e];return void 0!==s&&t.call(i||this,s),o}off(e){if(null==e)return;if(!this._subIdEvents)return;const t=this._subIdEvents[e];if(t){delete this._subIdEvents[e];const i=this._eventSubs[t];i&&delete i[e],this._subIdMap.removeItem(e)}}once(e,t,i){const r=this,o=this.on(e,(function(e){r.off(o),t.call(i||this,e)}),i)}log(e){e="[LOG]"+this._message(e),window.console.log(e)}_message(e){return" ["+s.inQuotes(this.id)+"]: "+e}warn(e){e="[WARN]"+this._message(e),window.console.warn(e)}error(e){e="[ERROR]"+this._message(e),window.console.error(e)}_mutexActivation(e){const t=[],i=e.length;for(let e=0;e<i;e++)t[e]=!1;for(let r=0;r<i;r++){e[r].on("active",function(){const o=r;return function(r){if(r&&!t[o])for(let r=0;r<i;r++)r!==o&&(t[r]=!0,e[r].setActive(!1),t[r]=!1)}}())}}setEnabled(e){this._enabled!==e&&(this._enabled=e,this.fire("enabled",this._enabled))}getEnabled(){return this._enabled}setActive(e){this._active!==e&&(this._active=e,this.fire("active",this._active))}getActive(){return this._active}destroy(){if(!this.destroyed){this.fire("destroyed",this.destroyed=!0),this._subIdMap=null,this._subIdEvents=null,this._eventSubs=null,this._events=null,this._eventCallDepth=0;for(let e=0,t=this._children.length;e<t;e++)this._children.destroy();this._children=[]}}}class l extends a{constructor(e,t={}){super(e,t),this._dialog=$('<div class="loadingDialog modal" tabindex="-1" role="dialog">\n    <div class="modal-dialog" role="document">\n        <div class="modal-content">\n            <div class="modal-body" style="text-align:center;">\n                <br>\n                <div class="loader" style="display:inline-block;"></div>\n\n                <br>\n                <div class="modal-header" style="display:inline-block; border: 0;">\n                    <h5 class="modal-title"><span class="xeokit-model-message"></span>\n                    </h5>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>'),this._dialog.appendTo("body")}show(e){this._dialog.find(".xeokit-model-message").text(e),this._dialog.modal("show")}hide(){this._dialog.modal("hide")}destroy(){super.destroy(),this._dialog.remove()}}const c=new Float32Array(16),h=new Float32Array(16),d=new Float32Array(4),u={MAX_DOUBLE:Number.MAX_VALUE,MIN_DOUBLE:Number.MIN_VALUE,DEGTORAD:.0174532925,RADTODEG:57.295779513,vec2:e=>new Float32Array(e||2),vec3:e=>new Float32Array(e||3),vec4:e=>new Float32Array(e||4),mat3:e=>new Float32Array(e||9),mat3ToMat4:(e,t=new Float32Array(16))=>(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=0,t[4]=e[3],t[5]=e[4],t[6]=e[5],t[7]=0,t[8]=e[6],t[9]=e[7],t[10]=e[8],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t),mat4:e=>new Float32Array(e||16),mat4ToMat3(e,t){},createUUID:(()=>{const e=[];for(let t=0;t<256;t++)e[t]=(t<16?"0":"")+t.toString(16);return()=>{const t=4294967295*Math.random()|0,i=4294967295*Math.random()|0,r=4294967295*Math.random()|0,o=4294967295*Math.random()|0;return`${e[255&t]+e[t>>8&255]+e[t>>16&255]+e[t>>24&255]}-${e[255&i]}${e[i>>8&255]}-${e[i>>16&15|64]}${e[i>>24&255]}-${e[63&r|128]}${e[r>>8&255]}-${e[r>>16&255]}${e[r>>24&255]}${e[255&o]}${e[o>>8&255]}${e[o>>16&255]}${e[o>>24&255]}`}})(),clamp:(e,t,i)=>Math.max(t,Math.min(i,e)),fmod(e,t){if(e<t)return console.error("math.fmod : Attempting to find modulus within negative range - would be infinite loop - ignoring"),e;for(;t<=e;)e-=t;return e},negateVec4:(e,t)=>(t||(t=e),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t),addVec4:(e,t,i)=>(i||(i=e),i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i),addVec4Scalar:(e,t,i)=>(i||(i=e),i[0]=e[0]+t,i[1]=e[1]+t,i[2]=e[2]+t,i[3]=e[3]+t,i),addVec3:(e,t,i)=>(i||(i=e),i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i),addVec3Scalar:(e,t,i)=>(i||(i=e),i[0]=e[0]+t,i[1]=e[1]+t,i[2]=e[2]+t,i),subVec4:(e,t,i)=>(i||(i=e),i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i),subVec3:(e,t,i)=>(i||(i=e),i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i),subVec2:(e,t,i)=>(i||(i=e),i[0]=e[0]-t[0],i[1]=e[1]-t[1],i),subVec4Scalar:(e,t,i)=>(i||(i=e),i[0]=e[0]-t,i[1]=e[1]-t,i[2]=e[2]-t,i[3]=e[3]-t,i),subScalarVec4:(e,t,i)=>(i||(i=e),i[0]=t-e[0],i[1]=t-e[1],i[2]=t-e[2],i[3]=t-e[3],i),mulVec4:(e,t,i)=>(i||(i=e),i[0]=e[0]*t[0],i[1]=e[1]*t[1],i[2]=e[2]*t[2],i[3]=e[3]*t[3],i),mulVec4Scalar:(e,t,i)=>(i||(i=e),i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i),mulVec3Scalar:(e,t,i)=>(i||(i=e),i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i),mulVec2Scalar:(e,t,i)=>(i||(i=e),i[0]=e[0]*t,i[1]=e[1]*t,i),divVec3:(e,t,i)=>(i||(i=e),i[0]=e[0]/t[0],i[1]=e[1]/t[1],i[2]=e[2]/t[2],i),divVec4:(e,t,i)=>(i||(i=e),i[0]=e[0]/t[0],i[1]=e[1]/t[1],i[2]=e[2]/t[2],i[3]=e[3]/t[3],i),divScalarVec3:(e,t,i)=>(i||(i=t),i[0]=e/t[0],i[1]=e/t[1],i[2]=e/t[2],i),divVec3Scalar:(e,t,i)=>(i||(i=e),i[0]=e[0]/t,i[1]=e[1]/t,i[2]=e[2]/t,i),divVec4Scalar:(e,t,i)=>(i||(i=e),i[0]=e[0]/t,i[1]=e[1]/t,i[2]=e[2]/t,i[3]=e[3]/t,i),divScalarVec4:(e,t,i)=>(i||(i=t),i[0]=e/t[0],i[1]=e/t[1],i[2]=e/t[2],i[3]=e/t[3],i),dotVec4:(e,t)=>e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3],cross3Vec4(e,t){const i=e[0],r=e[1],o=e[2],s=t[0],n=t[1],a=t[2];return[r*a-o*n,o*s-i*a,i*n-r*s,0]},cross3Vec3(e,t,i){i||(i=e);const r=e[0],o=e[1],s=e[2],n=t[0],a=t[1],l=t[2];return i[0]=o*l-s*a,i[1]=s*n-r*l,i[2]=r*a-o*n,i},sqLenVec4:e=>u.dotVec4(e,e),lenVec4:e=>Math.sqrt(u.sqLenVec4(e)),dotVec3:(e,t)=>e[0]*t[0]+e[1]*t[1]+e[2]*t[2],dotVec2:(e,t)=>e[0]*t[0]+e[1]*t[1],sqLenVec3:e=>u.dotVec3(e,e),sqLenVec2:e=>u.dotVec2(e,e),lenVec3:e=>Math.sqrt(u.sqLenVec3(e)),distVec3:(()=>{const e=new Float32Array(3);return(t,i)=>u.lenVec3(u.subVec3(t,i,e))})(),lenVec2:e=>Math.sqrt(u.sqLenVec2(e)),distVec2:(()=>{const e=new Float32Array(2);return(t,i)=>u.lenVec2(u.subVec2(t,i,e))})(),rcpVec3:(e,t)=>u.divScalarVec3(1,e,t),normalizeVec4(e,t){const i=1/u.lenVec4(e);return u.mulVec4Scalar(e,i,t)},normalizeVec3(e,t){const i=1/u.lenVec3(e);return u.mulVec3Scalar(e,i,t)},normalizeVec2(e,t){const i=1/u.lenVec2(e);return u.mulVec2Scalar(e,i,t)},angleVec3(e,t){let i=u.dotVec3(e,t)/Math.sqrt(u.sqLenVec3(e)*u.sqLenVec3(t));return i=i<-1?-1:i>1?1:i,Math.acos(i)},vec3FromMat4Scale:(()=>{const e=new Float32Array(3);return(t,i)=>(e[0]=t[0],e[1]=t[1],e[2]=t[2],i[0]=u.lenVec3(e),e[0]=t[4],e[1]=t[5],e[2]=t[6],i[1]=u.lenVec3(e),e[0]=t[8],e[1]=t[9],e[2]=t[10],i[2]=u.lenVec3(e),i)})(),vecToArray:(()=>{function e(e){return Math.round(1e5*e)/1e5}return t=>{for(let i=0,r=(t=Array.prototype.slice.call(t)).length;i<r;i++)t[i]=e(t[i]);return t}})(),xyzArrayToObject:e=>({x:e[0],y:e[1],z:e[2]}),xyzObjectToArray:(e,t)=>((t=t||new Float32Array(3))[0]=e.x,t[1]=e.y,t[2]=e.z,t),dupMat4:e=>e.slice(0,16),mat4To3:e=>[e[0],e[1],e[2],e[4],e[5],e[6],e[8],e[9],e[10]],m4s:e=>[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],setMat4ToZeroes:()=>u.m4s(0),setMat4ToOnes:()=>u.m4s(1),diagonalMat4v:e=>new Float32Array([e[0],0,0,0,0,e[1],0,0,0,0,e[2],0,0,0,0,e[3]]),diagonalMat4c:(e,t,i,r)=>u.diagonalMat4v([e,t,i,r]),diagonalMat4s:e=>u.diagonalMat4c(e,e,e,e),identityMat4:(e=new Float32Array(16))=>(e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e),identityMat3:(e=new Float32Array(9))=>(e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e),isIdentityMat4:e=>1===e[0]&&0===e[1]&&0===e[2]&&0===e[3]&&0===e[4]&&1===e[5]&&0===e[6]&&0===e[7]&&0===e[8]&&0===e[9]&&1===e[10]&&0===e[11]&&0===e[12]&&0===e[13]&&0===e[14]&&1===e[15],negateMat4:(e,t)=>(t||(t=e),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t[9]=-e[9],t[10]=-e[10],t[11]=-e[11],t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=-e[15],t),addMat4:(e,t,i)=>(i||(i=e),i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i[4]=e[4]+t[4],i[5]=e[5]+t[5],i[6]=e[6]+t[6],i[7]=e[7]+t[7],i[8]=e[8]+t[8],i[9]=e[9]+t[9],i[10]=e[10]+t[10],i[11]=e[11]+t[11],i[12]=e[12]+t[12],i[13]=e[13]+t[13],i[14]=e[14]+t[14],i[15]=e[15]+t[15],i),addMat4Scalar:(e,t,i)=>(i||(i=e),i[0]=e[0]+t,i[1]=e[1]+t,i[2]=e[2]+t,i[3]=e[3]+t,i[4]=e[4]+t,i[5]=e[5]+t,i[6]=e[6]+t,i[7]=e[7]+t,i[8]=e[8]+t,i[9]=e[9]+t,i[10]=e[10]+t,i[11]=e[11]+t,i[12]=e[12]+t,i[13]=e[13]+t,i[14]=e[14]+t,i[15]=e[15]+t,i),addScalarMat4:(e,t,i)=>u.addMat4Scalar(t,e,i),subMat4:(e,t,i)=>(i||(i=e),i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i[4]=e[4]-t[4],i[5]=e[5]-t[5],i[6]=e[6]-t[6],i[7]=e[7]-t[7],i[8]=e[8]-t[8],i[9]=e[9]-t[9],i[10]=e[10]-t[10],i[11]=e[11]-t[11],i[12]=e[12]-t[12],i[13]=e[13]-t[13],i[14]=e[14]-t[14],i[15]=e[15]-t[15],i),subMat4Scalar:(e,t,i)=>(i||(i=e),i[0]=e[0]-t,i[1]=e[1]-t,i[2]=e[2]-t,i[3]=e[3]-t,i[4]=e[4]-t,i[5]=e[5]-t,i[6]=e[6]-t,i[7]=e[7]-t,i[8]=e[8]-t,i[9]=e[9]-t,i[10]=e[10]-t,i[11]=e[11]-t,i[12]=e[12]-t,i[13]=e[13]-t,i[14]=e[14]-t,i[15]=e[15]-t,i),subScalarMat4:(e,t,i)=>(i||(i=t),i[0]=e-t[0],i[1]=e-t[1],i[2]=e-t[2],i[3]=e-t[3],i[4]=e-t[4],i[5]=e-t[5],i[6]=e-t[6],i[7]=e-t[7],i[8]=e-t[8],i[9]=e-t[9],i[10]=e-t[10],i[11]=e-t[11],i[12]=e-t[12],i[13]=e-t[13],i[14]=e-t[14],i[15]=e-t[15],i),mulMat4(e,t,i){i||(i=e);const r=e[0],o=e[1],s=e[2],n=e[3],a=e[4],l=e[5],c=e[6],h=e[7],d=e[8],u=e[9],p=e[10],m=e[11],f=e[12],g=e[13],b=e[14],_=e[15],v=t[0],x=t[1],y=t[2],w=t[3],M=t[4],k=t[5],P=t[6],E=t[7],A=t[8],C=t[9],T=t[10],D=t[11],S=t[12],L=t[13],R=t[14],I=t[15];return i[0]=v*r+x*a+y*d+w*f,i[1]=v*o+x*l+y*u+w*g,i[2]=v*s+x*c+y*p+w*b,i[3]=v*n+x*h+y*m+w*_,i[4]=M*r+k*a+P*d+E*f,i[5]=M*o+k*l+P*u+E*g,i[6]=M*s+k*c+P*p+E*b,i[7]=M*n+k*h+P*m+E*_,i[8]=A*r+C*a+T*d+D*f,i[9]=A*o+C*l+T*u+D*g,i[10]=A*s+C*c+T*p+D*b,i[11]=A*n+C*h+T*m+D*_,i[12]=S*r+L*a+R*d+I*f,i[13]=S*o+L*l+R*u+I*g,i[14]=S*s+L*c+R*p+I*b,i[15]=S*n+L*h+R*m+I*_,i},mulMat3(e,t,i){i||(i=new Float32Array(9));const r=e[0],o=e[3],s=e[6],n=e[1],a=e[4],l=e[7],c=e[2],h=e[5],d=e[8],u=t[0],p=t[3],m=t[6],f=t[1],g=t[4],b=t[7],_=t[2],v=t[5],x=t[8];return i[0]=r*u+o*f+s*_,i[3]=r*p+o*g+s*v,i[6]=r*m+o*b+s*x,i[1]=n*u+a*f+l*_,i[4]=n*p+a*g+l*v,i[7]=n*m+a*b+l*x,i[2]=c*u+h*f+d*_,i[5]=c*p+h*g+d*v,i[8]=c*m+h*b+d*x,i},mulMat4Scalar:(e,t,i)=>(i||(i=e),i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i[4]=e[4]*t,i[5]=e[5]*t,i[6]=e[6]*t,i[7]=e[7]*t,i[8]=e[8]*t,i[9]=e[9]*t,i[10]=e[10]*t,i[11]=e[11]*t,i[12]=e[12]*t,i[13]=e[13]*t,i[14]=e[14]*t,i[15]=e[15]*t,i),mulMat4v4(e,t,i=u.vec4()){const r=t[0],o=t[1],s=t[2],n=t[3];return i[0]=e[0]*r+e[4]*o+e[8]*s+e[12]*n,i[1]=e[1]*r+e[5]*o+e[9]*s+e[13]*n,i[2]=e[2]*r+e[6]*o+e[10]*s+e[14]*n,i[3]=e[3]*r+e[7]*o+e[11]*s+e[15]*n,i},transposeMat4(e,t){const i=e[4],r=e[14],o=e[8],s=e[13],n=e[12],a=e[9];if(!t||e===t){const t=e[1],l=e[2],c=e[3],h=e[6],d=e[7],u=e[11];return e[1]=i,e[2]=o,e[3]=n,e[4]=t,e[6]=a,e[7]=s,e[8]=l,e[9]=h,e[11]=r,e[12]=c,e[13]=d,e[14]=u,e}return t[0]=e[0],t[1]=i,t[2]=o,t[3]=n,t[4]=e[1],t[5]=e[5],t[6]=a,t[7]=s,t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=r,t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t},transposeMat3(e,t){if(t===e){const i=e[1],r=e[2],o=e[5];t[1]=e[3],t[2]=e[6],t[3]=i,t[5]=e[7],t[6]=r,t[7]=o}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},determinantMat4(e){const t=e[0],i=e[1],r=e[2],o=e[3],s=e[4],n=e[5],a=e[6],l=e[7],c=e[8],h=e[9],d=e[10],u=e[11],p=e[12],m=e[13],f=e[14],g=e[15];return p*h*a*o-c*m*a*o-p*n*d*o+s*m*d*o+c*n*f*o-s*h*f*o-p*h*r*l+c*m*r*l+p*i*d*l-t*m*d*l-c*i*f*l+t*h*f*l+p*n*r*u-s*m*r*u-p*i*a*u+t*m*a*u+s*i*f*u-t*n*f*u-c*n*r*g+s*h*r*g+c*i*a*g-t*h*a*g-s*i*d*g+t*n*d*g},inverseMat4(e,t){t||(t=e);const i=e[0],r=e[1],o=e[2],s=e[3],n=e[4],a=e[5],l=e[6],c=e[7],h=e[8],d=e[9],u=e[10],p=e[11],m=e[12],f=e[13],g=e[14],b=e[15],_=i*a-r*n,v=i*l-o*n,x=i*c-s*n,y=r*l-o*a,w=r*c-s*a,M=o*c-s*l,k=h*f-d*m,P=h*g-u*m,E=h*b-p*m,A=d*g-u*f,C=d*b-p*f,T=u*b-p*g,D=1/(_*T-v*C+x*A+y*E-w*P+M*k);return t[0]=(a*T-l*C+c*A)*D,t[1]=(-r*T+o*C-s*A)*D,t[2]=(f*M-g*w+b*y)*D,t[3]=(-d*M+u*w-p*y)*D,t[4]=(-n*T+l*E-c*P)*D,t[5]=(i*T-o*E+s*P)*D,t[6]=(-m*M+g*x-b*v)*D,t[7]=(h*M-u*x+p*v)*D,t[8]=(n*C-a*E+c*k)*D,t[9]=(-i*C+r*E-s*k)*D,t[10]=(m*w-f*x+b*_)*D,t[11]=(-h*w+d*x-p*_)*D,t[12]=(-n*A+a*P-l*k)*D,t[13]=(i*A-r*P+o*k)*D,t[14]=(-m*y+f*v-g*_)*D,t[15]=(h*y-d*v+u*_)*D,t},traceMat4:e=>e[0]+e[5]+e[10]+e[15],translationMat4v(e,t){const i=t||u.identityMat4();return i[12]=e[0],i[13]=e[1],i[14]=e[2],i},translationMat3v(e,t){const i=t||u.identityMat3();return i[6]=e[0],i[7]=e[1],i},translationMat4c:(()=>{const e=new Float32Array(3);return(t,i,r,o)=>(e[0]=t,e[1]=i,e[2]=r,u.translationMat4v(e,o))})(),translationMat4s:(e,t)=>u.translationMat4c(e,e,e,t),translateMat4v:(e,t)=>u.translateMat4c(e[0],e[1],e[2],t),OLDtranslateMat4c(e,t,i,r){const o=r[12];r[0]+=o*e,r[4]+=o*t,r[8]+=o*i;const s=r[13];r[1]+=s*e,r[5]+=s*t,r[9]+=s*i;const n=r[14];r[2]+=n*e,r[6]+=n*t,r[10]+=n*i;const a=r[15];return r[3]+=a*e,r[7]+=a*t,r[11]+=a*i,r},translateMat4c(e,t,i,r){const o=r[3];r[0]+=o*e,r[1]+=o*t,r[2]+=o*i;const s=r[7];r[4]+=s*e,r[5]+=s*t,r[6]+=s*i;const n=r[11];r[8]+=n*e,r[9]+=n*t,r[10]+=n*i;const a=r[15];return r[12]+=a*e,r[13]+=a*t,r[14]+=a*i,r},rotationMat4v(e,t,i){const r=u.normalizeVec4([t[0],t[1],t[2],0],[]),o=Math.sin(e),s=Math.cos(e),n=1-s,a=r[0],l=r[1],c=r[2];let h,d,p,m,f,g;return h=a*l,d=l*c,p=c*a,m=a*o,f=l*o,g=c*o,(i=i||u.mat4())[0]=n*a*a+s,i[1]=n*h+g,i[2]=n*p-f,i[3]=0,i[4]=n*h-g,i[5]=n*l*l+s,i[6]=n*d+m,i[7]=0,i[8]=n*p+f,i[9]=n*d-m,i[10]=n*c*c+s,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},rotationMat4c:(e,t,i,r,o)=>u.rotationMat4v(e,[t,i,r],o),scalingMat4v:(e,t=u.identityMat4())=>(t[0]=e[0],t[5]=e[1],t[10]=e[2],t),scalingMat3v:(e,t=u.identityMat3())=>(t[0]=e[0],t[4]=e[1],t),scalingMat4c:(()=>{const e=new Float32Array(3);return(t,i,r,o)=>(e[0]=t,e[1]=i,e[2]=r,u.scalingMat4v(e,o))})(),scaleMat4c:(e,t,i,r)=>(r[0]*=e,r[4]*=t,r[8]*=i,r[1]*=e,r[5]*=t,r[9]*=i,r[2]*=e,r[6]*=t,r[10]*=i,r[3]*=e,r[7]*=t,r[11]*=i,r),scaleMat4v(e,t){const i=e[0],r=e[1],o=e[2];return t[0]*=i,t[4]*=r,t[8]*=o,t[1]*=i,t[5]*=r,t[9]*=o,t[2]*=i,t[6]*=r,t[10]*=o,t[3]*=i,t[7]*=r,t[11]*=o,t},scalingMat4s:e=>u.scalingMat4c(e,e,e),rotationTranslationMat4(e,t,i=u.mat4()){const r=e[0],o=e[1],s=e[2],n=e[3],a=r+r,l=o+o,c=s+s,h=r*a,d=r*l,p=r*c,m=o*l,f=o*c,g=s*c,b=n*a,_=n*l,v=n*c;return i[0]=1-(m+g),i[1]=d+v,i[2]=p-_,i[3]=0,i[4]=d-v,i[5]=1-(h+g),i[6]=f+b,i[7]=0,i[8]=p+_,i[9]=f-b,i[10]=1-(h+m),i[11]=0,i[12]=t[0],i[13]=t[1],i[14]=t[2],i[15]=1,i},mat4ToEuler(e,t,i=u.vec4()){const r=u.clamp,o=e[0],s=e[4],n=e[8],a=e[1],l=e[5],c=e[9],h=e[2],d=e[6],p=e[10];return"XYZ"===t?(i[1]=Math.asin(r(n,-1,1)),Math.abs(n)<.99999?(i[0]=Math.atan2(-c,p),i[2]=Math.atan2(-s,o)):(i[0]=Math.atan2(d,l),i[2]=0)):"YXZ"===t?(i[0]=Math.asin(-r(c,-1,1)),Math.abs(c)<.99999?(i[1]=Math.atan2(n,p),i[2]=Math.atan2(a,l)):(i[1]=Math.atan2(-h,o),i[2]=0)):"ZXY"===t?(i[0]=Math.asin(r(d,-1,1)),Math.abs(d)<.99999?(i[1]=Math.atan2(-h,p),i[2]=Math.atan2(-s,l)):(i[1]=0,i[2]=Math.atan2(a,o))):"ZYX"===t?(i[1]=Math.asin(-r(h,-1,1)),Math.abs(h)<.99999?(i[0]=Math.atan2(d,p),i[2]=Math.atan2(a,o)):(i[0]=0,i[2]=Math.atan2(-s,l))):"YZX"===t?(i[2]=Math.asin(r(a,-1,1)),Math.abs(a)<.99999?(i[0]=Math.atan2(-c,l),i[1]=Math.atan2(-h,o)):(i[0]=0,i[1]=Math.atan2(n,p))):"XZY"===t&&(i[2]=Math.asin(-r(s,-1,1)),Math.abs(s)<.99999?(i[0]=Math.atan2(d,l),i[1]=Math.atan2(n,o)):(i[0]=Math.atan2(-c,p),i[1]=0)),i},composeMat4:(e,t,i,r=u.mat4())=>(u.quaternionToRotationMat4(t,r),u.scaleMat4v(i,r),u.translateMat4v(e,r),r),decomposeMat4:(()=>{const e=new Float32Array(3),t=new Float32Array(16);return function(i,r,o,s){e[0]=i[0],e[1]=i[1],e[2]=i[2];let n=u.lenVec3(e);e[0]=i[4],e[1]=i[5],e[2]=i[6];const a=u.lenVec3(e);e[8]=i[8],e[9]=i[9],e[10]=i[10];const l=u.lenVec3(e);u.determinantMat4(i)<0&&(n=-n),r[0]=i[12],r[1]=i[13],r[2]=i[14],t.set(i);const c=1/n,h=1/a,d=1/l;return t[0]*=c,t[1]*=c,t[2]*=c,t[4]*=h,t[5]*=h,t[6]*=h,t[8]*=d,t[9]*=d,t[10]*=d,u.mat4ToQuaternion(t,o),s[0]=n,s[1]=a,s[2]=l,this}})(),lookAtMat4v(e,t,i,r){r||(r=u.mat4());const o=e[0],s=e[1],n=e[2],a=i[0],l=i[1],c=i[2],h=t[0],d=t[1],p=t[2];if(o===h&&s===d&&n===p)return u.identityMat4();let m,f,g,b,_,v,x,y,w,M;return m=o-h,f=s-d,g=n-p,b=l*(g*=M=1/Math.sqrt(m*m+f*f+g*g))-c*(f*=M),_=c*(m*=M)-a*g,v=a*f-l*m,(M=Math.sqrt(b*b+_*_+v*v))?(b*=M=1/M,_*=M,v*=M):(b=0,_=0,v=0),x=f*v-g*_,y=g*b-m*v,w=m*_-f*b,(M=Math.sqrt(x*x+y*y+w*w))?(x*=M=1/M,y*=M,w*=M):(x=0,y=0,w=0),r[0]=b,r[1]=x,r[2]=m,r[3]=0,r[4]=_,r[5]=y,r[6]=f,r[7]=0,r[8]=v,r[9]=w,r[10]=g,r[11]=0,r[12]=-(b*o+_*s+v*n),r[13]=-(x*o+y*s+w*n),r[14]=-(m*o+f*s+g*n),r[15]=1,r},lookAtMat4c:(e,t,i,r,o,s,n,a,l)=>u.lookAtMat4v([e,t,i],[r,o,s],[n,a,l],[]),orthoMat4c(e,t,i,r,o,s,n){n||(n=u.mat4());const a=t-e,l=r-i,c=s-o;return n[0]=2/a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=2/l,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=-2/c,n[11]=0,n[12]=-(e+t)/a,n[13]=-(r+i)/l,n[14]=-(s+o)/c,n[15]=1,n},frustumMat4v(e,t,i){i||(i=u.mat4());const r=[e[0],e[1],e[2],0],o=[t[0],t[1],t[2],0];u.addVec4(o,r,c),u.subVec4(o,r,h);const s=2*r[2],n=h[0],a=h[1],l=h[2];return i[0]=s/n,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=s/a,i[6]=0,i[7]=0,i[8]=c[0]/n,i[9]=c[1]/a,i[10]=-c[2]/l,i[11]=-1,i[12]=0,i[13]=0,i[14]=-s*o[2]/l,i[15]=0,i},frustumMat4(e,t,i,r,o,s,n){n||(n=u.mat4());const a=t-e,l=r-i,c=s-o;return n[0]=2*o/a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=2*o/l,n[6]=0,n[7]=0,n[8]=(t+e)/a,n[9]=(r+i)/l,n[10]=-(s+o)/c,n[11]=-1,n[12]=0,n[13]=0,n[14]=-s*o*2/c,n[15]=0,n},perspectiveMat4(e,t,i,r,o){const s=[],n=[];return s[2]=i,n[2]=r,n[1]=s[2]*Math.tan(e/2),s[1]=-n[1],n[0]=n[1]*t,s[0]=-n[0],u.frustumMat4v(s,n,o)},transformPoint3(e,t,i=u.vec3()){const r=t[0],o=t[1],s=t[2];return i[0]=e[0]*r+e[4]*o+e[8]*s+e[12],i[1]=e[1]*r+e[5]*o+e[9]*s+e[13],i[2]=e[2]*r+e[6]*o+e[10]*s+e[14],i},transformPoint4:(e,t,i=u.vec4())=>(i[0]=e[0]*t[0]+e[4]*t[1]+e[8]*t[2]+e[12]*t[3],i[1]=e[1]*t[0]+e[5]*t[1]+e[9]*t[2]+e[13]*t[3],i[2]=e[2]*t[0]+e[6]*t[1]+e[10]*t[2]+e[14]*t[3],i[3]=e[3]*t[0]+e[7]*t[1]+e[11]*t[2]+e[15]*t[3],i),transformPoints3(e,t,i){const r=i||[],o=t.length;let s,n,a,l;const c=e[0],h=e[1],d=e[2],u=e[3],p=e[4],m=e[5],f=e[6],g=e[7],b=e[8],_=e[9],v=e[10],x=e[11],y=e[12],w=e[13],M=e[14],k=e[15];let P;for(let e=0;e<o;++e)s=(l=t[e])[0],n=l[1],a=l[2],(P=r[e]||(r[e]=[0,0,0]))[0]=c*s+p*n+b*a+y,P[1]=h*s+m*n+_*a+w,P[2]=d*s+f*n+v*a+M,P[3]=u*s+g*n+x*a+k;return r.length=o,r},transformPositions3(e,t,i=t){let r;const o=t.length;let s,n,a;const l=e[0],c=e[1],h=e[2],d=e[3],u=e[4],p=e[5],m=e[6],f=e[7],g=e[8],b=e[9],_=e[10],v=e[11],x=e[12],y=e[13],w=e[14],M=e[15];for(r=0;r<o;r+=3)s=t[r+0],n=t[r+1],a=t[r+2],i[r+0]=l*s+u*n+g*a+x,i[r+1]=c*s+p*n+b*a+y,i[r+2]=h*s+m*n+_*a+w,i[r+3]=d*s+f*n+v*a+M;return i},transformPositions4(e,t,i=t){let r;const o=t.length;let s,n,a;const l=e[0],c=e[1],h=e[2],d=e[3],u=e[4],p=e[5],m=e[6],f=e[7],g=e[8],b=e[9],_=e[10],v=e[11],x=e[12],y=e[13],w=e[14],M=e[15];for(r=0;r<o;r+=4)s=t[r+0],n=t[r+1],a=t[r+2],i[r+0]=l*s+u*n+g*a+x,i[r+1]=c*s+p*n+b*a+y,i[r+2]=h*s+m*n+_*a+w,i[r+3]=d*s+f*n+v*a+M;return i},transformVec3(e,t,i){const r=t[0],o=t[1],s=t[2];return(i=i||this.vec3())[0]=e[0]*r+e[4]*o+e[8]*s,i[1]=e[1]*r+e[5]*o+e[9]*s,i[2]=e[2]*r+e[6]*o+e[10]*s,i},transformVec4(e,t,i){const r=t[0],o=t[1],s=t[2],n=t[3];return(i=i||u.vec4())[0]=e[0]*r+e[4]*o+e[8]*s+e[12]*n,i[1]=e[1]*r+e[5]*o+e[9]*s+e[13]*n,i[2]=e[2]*r+e[6]*o+e[10]*s+e[14]*n,i[3]=e[3]*r+e[7]*o+e[11]*s+e[15]*n,i},rotateVec3X(e,t,i,r){const o=[],s=[];return o[0]=e[0]-t[0],o[1]=e[1]-t[1],o[2]=e[2]-t[2],s[0]=o[0],s[1]=o[1]*Math.cos(i)-o[2]*Math.sin(i),s[2]=o[1]*Math.sin(i)+o[2]*Math.cos(i),r[0]=s[0]+t[0],r[1]=s[1]+t[1],r[2]=s[2]+t[2],r},rotateVec3Y(e,t,i,r){const o=[],s=[];return o[0]=e[0]-t[0],o[1]=e[1]-t[1],o[2]=e[2]-t[2],s[0]=o[2]*Math.sin(i)+o[0]*Math.cos(i),s[1]=o[1],s[2]=o[2]*Math.cos(i)-o[0]*Math.sin(i),r[0]=s[0]+t[0],r[1]=s[1]+t[1],r[2]=s[2]+t[2],r},rotateVec3Z(e,t,i,r){const o=[],s=[];return o[0]=e[0]-t[0],o[1]=e[1]-t[1],o[2]=e[2]-t[2],s[0]=o[0]*Math.cos(i)-o[1]*Math.sin(i),s[1]=o[0]*Math.sin(i)+o[1]*Math.cos(i),s[2]=o[2],r[0]=s[0]+t[0],r[1]=s[1]+t[1],r[2]=s[2]+t[2],r},projectVec4(e,t){const i=1/e[3];return(t=t||u.vec2())[0]=e[0]*i,t[1]=e[1]*i,t},unprojectVec3:(()=>{const e=new Float32Array(16),t=new Float32Array(16),i=new Float32Array(16);return function(r,o,s,n){return this.transformVec3(this.mulMat4(this.inverseMat4(o,e),this.inverseMat4(s,t),i),r,n)}})(),lerpVec3(e,t,i,r,o,s){const n=s||u.vec3(),a=(e-t)/(i-t);return n[0]=r[0]+a*(o[0]-r[0]),n[1]=r[1]+a*(o[1]-r[1]),n[2]=r[2]+a*(o[2]-r[2]),n},lerpMat4(e,t,i,r,o,s){const n=s||u.mat4(),a=(e-t)/(i-t);return n[0]=r[0]+a*(o[0]-r[0]),n[1]=r[1]+a*(o[1]-r[1]),n[2]=r[2]+a*(o[2]-r[2]),n[3]=r[3]+a*(o[3]-r[3]),n[4]=r[4]+a*(o[4]-r[4]),n[5]=r[5]+a*(o[5]-r[5]),n[6]=r[6]+a*(o[6]-r[6]),n[7]=r[7]+a*(o[7]-r[7]),n[8]=r[8]+a*(o[8]-r[8]),n[9]=r[9]+a*(o[9]-r[9]),n[10]=r[10]+a*(o[10]-r[10]),n[11]=r[11]+a*(o[11]-r[11]),n[12]=r[12]+a*(o[12]-r[12]),n[13]=r[13]+a*(o[13]-r[13]),n[14]=r[14]+a*(o[14]-r[14]),n[15]=r[15]+a*(o[15]-r[15]),n},flatten(e){const t=[];let i,r,o,s,n;for(i=0,r=e.length;i<r;i++)for(o=0,s=(n=e[i]).length;o<s;o++)t.push(n[o]);return t},identityQuaternion:(e=u.vec4())=>(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e),eulerToQuaternion(e,t,i=u.vec4()){const r=e[0]*u.DEGTORAD/2,o=e[1]*u.DEGTORAD/2,s=e[2]*u.DEGTORAD/2,n=Math.cos(r),a=Math.cos(o),l=Math.cos(s),c=Math.sin(r),h=Math.sin(o),d=Math.sin(s);return"XYZ"===t?(i[0]=c*a*l+n*h*d,i[1]=n*h*l-c*a*d,i[2]=n*a*d+c*h*l,i[3]=n*a*l-c*h*d):"YXZ"===t?(i[0]=c*a*l+n*h*d,i[1]=n*h*l-c*a*d,i[2]=n*a*d-c*h*l,i[3]=n*a*l+c*h*d):"ZXY"===t?(i[0]=c*a*l-n*h*d,i[1]=n*h*l+c*a*d,i[2]=n*a*d+c*h*l,i[3]=n*a*l-c*h*d):"ZYX"===t?(i[0]=c*a*l-n*h*d,i[1]=n*h*l+c*a*d,i[2]=n*a*d-c*h*l,i[3]=n*a*l+c*h*d):"YZX"===t?(i[0]=c*a*l+n*h*d,i[1]=n*h*l+c*a*d,i[2]=n*a*d-c*h*l,i[3]=n*a*l-c*h*d):"XZY"===t&&(i[0]=c*a*l-n*h*d,i[1]=n*h*l-c*a*d,i[2]=n*a*d+c*h*l,i[3]=n*a*l+c*h*d),i},mat4ToQuaternion(e,t=u.vec4()){const i=e[0],r=e[4],o=e[8],s=e[1],n=e[5],a=e[9],l=e[2],c=e[6],h=e[10];let d;const p=i+n+h;return p>0?(d=.5/Math.sqrt(p+1),t[3]=.25/d,t[0]=(c-a)*d,t[1]=(o-l)*d,t[2]=(s-r)*d):i>n&&i>h?(d=2*Math.sqrt(1+i-n-h),t[3]=(c-a)/d,t[0]=.25*d,t[1]=(r+s)/d,t[2]=(o+l)/d):n>h?(d=2*Math.sqrt(1+n-i-h),t[3]=(o-l)/d,t[0]=(r+s)/d,t[1]=.25*d,t[2]=(a+c)/d):(d=2*Math.sqrt(1+h-i-n),t[3]=(s-r)/d,t[0]=(o+l)/d,t[1]=(a+c)/d,t[2]=.25*d),t},vec3PairToQuaternion(e,t,i=u.vec4()){const r=Math.sqrt(u.dotVec3(e,e)*u.dotVec3(t,t));let o=r+u.dotVec3(e,t);return o<1e-8*r?(o=0,Math.abs(e[0])>Math.abs(e[2])?(i[0]=-e[1],i[1]=e[0],i[2]=0):(i[0]=0,i[1]=-e[2],i[2]=e[1])):u.cross3Vec3(e,t,i),i[3]=o,u.normalizeQuaternion(i)},angleAxisToQuaternion(e,t=u.vec4()){const i=e[3]/2,r=Math.sin(i);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(i),t},quaternionToEuler:(()=>{const e=new Float32Array(16);return(t,i,r)=>(r=r||u.vec3(),u.quaternionToRotationMat4(t,e),u.mat4ToEuler(e,i,r),r)})(),mulQuaternions(e,t,i=u.vec4()){const r=e[0],o=e[1],s=e[2],n=e[3],a=t[0],l=t[1],c=t[2],h=t[3];return i[0]=n*a+r*h+o*c-s*l,i[1]=n*l+o*h+s*a-r*c,i[2]=n*c+s*h+r*l-o*a,i[3]=n*h-r*a-o*l-s*c,i},vec3ApplyQuaternion(e,t,i=u.vec3()){const r=t[0],o=t[1],s=t[2],n=e[0],a=e[1],l=e[2],c=e[3],h=c*r+a*s-l*o,d=c*o+l*r-n*s,p=c*s+n*o-a*r,m=-n*r-a*o-l*s;return i[0]=h*c+m*-n+d*-l-p*-a,i[1]=d*c+m*-a+p*-n-h*-l,i[2]=p*c+m*-l+h*-a-d*-n,i},quaternionToMat4(e,t){t=u.identityMat4(t);const i=e[0],r=e[1],o=e[2],s=e[3],n=2*i,a=2*r,l=2*o,c=n*s,h=a*s,d=l*s,p=n*i,m=a*i,f=l*i,g=a*r,b=l*r,_=l*o;return t[0]=1-(g+_),t[1]=m+d,t[2]=f-h,t[4]=m-d,t[5]=1-(p+_),t[6]=b+c,t[8]=f+h,t[9]=b-c,t[10]=1-(p+g),t},quaternionToRotationMat4(e,t){const i=e[0],r=e[1],o=e[2],s=e[3],n=i+i,a=r+r,l=o+o,c=i*n,h=i*a,d=i*l,u=r*a,p=r*l,m=o*l,f=s*n,g=s*a,b=s*l;return t[0]=1-(u+m),t[4]=h-b,t[8]=d+g,t[1]=h+b,t[5]=1-(c+m),t[9]=p-f,t[2]=d-g,t[6]=p+f,t[10]=1-(c+u),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},normalizeQuaternion(e,t=e){const i=u.lenVec4([e[0],e[1],e[2],e[3]]);return t[0]=e[0]/i,t[1]=e[1]/i,t[2]=e[2]/i,t[3]=e[3]/i,t},conjugateQuaternion:(e,t=e)=>(t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t),inverseQuaternion:(e,t)=>u.normalizeQuaternion(u.conjugateQuaternion(e,t)),quaternionToAngleAxis(e,t=u.vec4()){const i=(e=u.normalizeQuaternion(e,d))[3],r=2*Math.acos(i),o=Math.sqrt(1-i*i);return o<.001?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):(t[0]=e[0]/o,t[1]=e[1]/o,t[2]=e[2]/o),t[3]=r,t},AABB3:e=>new Float32Array(e||6),AABB2:e=>new Float32Array(e||4),OBB3:e=>new Float32Array(e||32),OBB2:e=>new Float32Array(e||16),Sphere3:(e,t,i,r)=>new Float32Array([e,t,i,r]),transformOBB3(e,t,i=t){let r;const o=t.length;let s,n,a;const l=e[0],c=e[1],h=e[2],d=e[3],u=e[4],p=e[5],m=e[6],f=e[7],g=e[8],b=e[9],_=e[10],v=e[11],x=e[12],y=e[13],w=e[14],M=e[15];for(r=0;r<o;r+=4)s=t[r+0],n=t[r+1],a=t[r+2],i[r+0]=l*s+u*n+g*a+x,i[r+1]=c*s+p*n+b*a+y,i[r+2]=h*s+m*n+_*a+w,i[r+3]=d*s+f*n+v*a+M;return i},getAABB3Diag:(()=>{const e=new Float32Array(3),t=new Float32Array(3),i=new Float32Array(3);return r=>(e[0]=r[0],e[1]=r[1],e[2]=r[2],t[0]=r[3],t[1]=r[4],t[2]=r[5],u.subVec3(t,e,i),Math.abs(u.lenVec3(i)))})(),getAABB3DiagPoint:(()=>{const e=new Float32Array(3),t=new Float32Array(3),i=new Float32Array(3);return(r,o)=>{e[0]=r[0],e[1]=r[1],e[2]=r[2],t[0]=r[3],t[1]=r[4],t[2]=r[5];const s=u.subVec3(t,e,i),n=o[0]-r[0],a=r[3]-o[0],l=o[1]-r[1],c=r[4]-o[1],h=o[2]-r[2],d=r[5]-o[2];return s[0]+=n>a?n:a,s[1]+=l>c?l:c,s[2]+=h>d?h:d,Math.abs(u.lenVec3(s))}})(),getAABB3Center(e,t){const i=t||u.vec3();return i[0]=(e[0]+e[3])/2,i[1]=(e[1]+e[4])/2,i[2]=(e[2]+e[5])/2,i},getAABB2Center(e,t){const i=t||u.vec2();return i[0]=(e[2]+e[0])/2,i[1]=(e[3]+e[1])/2,i},collapseAABB3:(e=u.AABB3())=>(e[0]=u.MAX_DOUBLE,e[1]=u.MAX_DOUBLE,e[2]=u.MAX_DOUBLE,e[3]=-u.MAX_DOUBLE,e[4]=-u.MAX_DOUBLE,e[5]=-u.MAX_DOUBLE,e),AABB3ToOBB3:(e,t=u.OBB3())=>(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=1,t[4]=e[3],t[5]=e[1],t[6]=e[2],t[7]=1,t[8]=e[3],t[9]=e[4],t[10]=e[2],t[11]=1,t[12]=e[0],t[13]=e[4],t[14]=e[2],t[15]=1,t[16]=e[0],t[17]=e[1],t[18]=e[5],t[19]=1,t[20]=e[3],t[21]=e[1],t[22]=e[5],t[23]=1,t[24]=e[3],t[25]=e[4],t[26]=e[5],t[27]=1,t[28]=e[0],t[29]=e[4],t[30]=e[5],t[31]=1,t),positions3ToAABB3:(()=>{const e=new Float32Array(3);return(t,i,r)=>{i=i||u.AABB3();let o,s,n,a=u.MAX_DOUBLE,l=u.MAX_DOUBLE,c=u.MAX_DOUBLE,h=-u.MAX_DOUBLE,d=-u.MAX_DOUBLE,p=-u.MAX_DOUBLE;for(let i=0,m=t.length;i<m;i+=3)r?(e[0]=t[i+0],e[1]=t[i+1],e[2]=t[i+2],u.decompressPosition(e,r,e),o=e[0],s=e[1],n=e[2]):(o=t[i+0],s=t[i+1],n=t[i+2]),o<a&&(a=o),s<l&&(l=s),n<c&&(c=n),o>h&&(h=o),s>d&&(d=s),n>p&&(p=n);return i[0]=a,i[1]=l,i[2]=c,i[3]=h,i[4]=d,i[5]=p,i}})(),OBB3ToAABB3(e,t=u.AABB3()){let i,r,o,s=u.MAX_DOUBLE,n=u.MAX_DOUBLE,a=u.MAX_DOUBLE,l=-u.MAX_DOUBLE,c=-u.MAX_DOUBLE,h=-u.MAX_DOUBLE;for(let t=0,d=e.length;t<d;t+=4)(i=e[t+0])<s&&(s=i),(r=e[t+1])<n&&(n=r),(o=e[t+2])<a&&(a=o),i>l&&(l=i),r>c&&(c=r),o>h&&(h=o);return t[0]=s,t[1]=n,t[2]=a,t[3]=l,t[4]=c,t[5]=h,t},points3ToAABB3(e,t=u.AABB3()){let i,r,o,s=u.MAX_DOUBLE,n=u.MAX_DOUBLE,a=u.MAX_DOUBLE,l=-u.MAX_DOUBLE,c=-u.MAX_DOUBLE,h=-u.MAX_DOUBLE;for(let t=0,d=e.length;t<d;t++)(i=e[t][0])<s&&(s=i),(r=e[t][1])<n&&(n=r),(o=e[t][2])<a&&(a=o),i>l&&(l=i),r>c&&(c=r),o>h&&(h=o);return t[0]=s,t[1]=n,t[2]=a,t[3]=l,t[4]=c,t[5]=h,t},points3ToSphere3:(()=>{const e=new Float32Array(3);return(t,i)=>{i=i||u.vec4();let r,o=0,s=0,n=0;const a=t.length;for(r=0;r<a;r++)o+=t[r][0],s+=t[r][1],n+=t[r][2];i[0]=o/a,i[1]=s/a,i[2]=n/a;let l,c=0;for(r=0;r<a;r++)(l=Math.abs(u.lenVec3(u.subVec3(t[r],i,e))))>c&&(c=l);return i[3]=c,i}})(),positions3ToSphere3:(()=>{const e=new Float32Array(3),t=new Float32Array(3);return(i,r)=>{r=r||u.vec4();let o,s=0,n=0,a=0;const l=i.length;let c=0;for(o=0;o<l;o+=3)s+=i[o],n+=i[o+1],a+=i[o+2];const h=l/3;let d;for(r[0]=s/h,r[1]=n/h,r[2]=a/h,o=0;o<l;o+=3)e[0]=i[o],e[1]=i[o+1],e[2]=i[o+2],(d=Math.abs(u.lenVec3(u.subVec3(e,r,t))))>c&&(c=d);return r[3]=c,r}})(),OBB3ToSphere3:(()=>{const e=new Float32Array(3),t=new Float32Array(3);return(i,r)=>{r=r||u.vec4();let o,s=0,n=0,a=0;const l=i.length,c=l/4;for(o=0;o<l;o+=4)s+=i[o+0],n+=i[o+1],a+=i[o+2];r[0]=s/c,r[1]=n/c,r[2]=a/c;let h,d=0;for(o=0;o<l;o+=4)e[0]=i[o+0],e[1]=i[o+1],e[2]=i[o+2],(h=Math.abs(u.lenVec3(u.subVec3(e,r,t))))>d&&(d=h);return r[3]=d,r}})(),getSphere3Center:(e,t=u.vec3())=>(t[0]=e[0],t[1]=e[1],t[2]=e[2],t),expandAABB3:(e,t)=>(e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]>t[2]&&(e[2]=t[2]),e[3]<t[3]&&(e[3]=t[3]),e[4]<t[4]&&(e[4]=t[4]),e[5]<t[5]&&(e[5]=t[5]),e),expandAABB3Point3:(e,t)=>(e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]>t[2]&&(e[2]=t[2]),e[3]<t[0]&&(e[3]=t[0]),e[4]<t[1]&&(e[4]=t[1]),e[5]<t[2]&&(e[5]=t[2]),e),expandAABB3Points3(e,t){for(var i,r,o,s=0,n=t.length;s<n;s+=3)i=t[s],r=t[s+1],o=t[s+2],e[0]>i&&(e[0]=i),e[1]>r&&(e[1]=r),e[2]>o&&(e[2]=o),e[3]<i&&(e[3]=i),e[4]<r&&(e[4]=r),e[5]<o&&(e[5]=o);return e},collapseAABB2:(e=u.AABB2())=>(e[0]=u.MAX_DOUBLE,e[1]=u.MAX_DOUBLE,e[2]=-u.MAX_DOUBLE,e[3]=-u.MAX_DOUBLE,e),point3AABB3Intersect:(e,t)=>e[0]>t[0]||e[3]<t[0]||e[1]>t[1]||e[4]<t[1]||e[2]>t[2]||e[5]<t[2],OBB3ToAABB2(e,t=u.AABB2()){let i,r,o,s,n=u.MAX_DOUBLE,a=u.MAX_DOUBLE,l=-u.MAX_DOUBLE,c=-u.MAX_DOUBLE;for(let t=0,h=e.length;t<h;t+=4)i=e[t+0],r=e[t+1],(i*=s=1/(o=e[t+3]||1))<n&&(n=i),(r*=s)<a&&(a=r),i>l&&(l=i),r>c&&(c=r);return t[0]=n,t[1]=a,t[2]=l,t[3]=c,t},expandAABB2:(e,t)=>(e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[2]&&(e[2]=t[2]),e[3]<t[3]&&(e[3]=t[3]),e),expandAABB2Point2:(e,t)=>(e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1]),e),AABB2ToCanvas(e,t,i,r=e){const o=.5*(e[0]+1),s=.5*(e[1]+1),n=.5*(e[2]+1),a=.5*(e[3]+1);return r[0]=Math.floor(o*t),r[1]=i-Math.floor(a*i),r[2]=Math.floor(n*t),r[3]=i-Math.floor(s*i),r},tangentQuadraticBezier:(e,t,i,r)=>2*(1-e)*(i-t)+2*e*(r-i),tangentQuadraticBezier3:(e,t,i,r,o)=>-3*t*(1-e)*(1-e)+3*i*(1-e)*(1-e)-6*e*i*(1-e)+6*e*r*(1-e)-3*e*e*r+3*e*e*o,tangentSpline:e=>6*e*e-6*e+(3*e*e-4*e+1)+(-6*e*e+6*e)+(3*e*e-2*e),catmullRomInterpolate(e,t,i,r,o){const s=.5*(i-e),n=.5*(r-t),a=o*o;return(2*t-2*i+s+n)*(o*a)+(-3*t+3*i-2*s-n)*a+s*o+t},b2p0(e,t){const i=1-e;return i*i*t},b2p1:(e,t)=>2*(1-e)*e*t,b2p2:(e,t)=>e*e*t,b2(e,t,i,r){return this.b2p0(e,t)+this.b2p1(e,i)+this.b2p2(e,r)},b3p0(e,t){const i=1-e;return i*i*i*t},b3p1(e,t){const i=1-e;return 3*i*i*e*t},b3p2:(e,t)=>3*(1-e)*e*e*t,b3p3:(e,t)=>e*e*e*t,b3(e,t,i,r,o){return this.b3p0(e,t)+this.b3p1(e,i)+this.b3p2(e,r)+this.b3p3(e,o)},triangleNormal(e,t,i,r=u.vec3()){const o=t[0]-e[0],s=t[1]-e[1],n=t[2]-e[2],a=i[0]-e[0],l=i[1]-e[1],c=i[2]-e[2],h=s*c-n*l,d=n*a-o*c,p=o*l-s*a,m=Math.sqrt(h*h+d*d+p*p);return 0===m?(r[0]=0,r[1]=0,r[2]=0):(r[0]=h/m,r[1]=d/m,r[2]=p/m),r},rayTriangleIntersect:(()=>{const e=new Float32Array(3),t=new Float32Array(3),i=new Float32Array(3),r=new Float32Array(3),o=new Float32Array(3);return(s,n,a,l,c,h)=>{h=h||u.vec3();const d=u.subVec3(l,a,e),p=u.subVec3(c,a,t),m=u.cross3Vec3(n,p,i),f=u.dotVec3(d,m);if(f<1e-6)return null;const g=u.subVec3(s,a,r),b=u.dotVec3(g,m);if(b<0||b>f)return null;const _=u.cross3Vec3(g,d,o),v=u.dotVec3(n,_);if(v<0||b+v>f)return null;const x=u.dotVec3(p,_)/f;return h[0]=s[0]+x*n[0],h[1]=s[1]+x*n[1],h[2]=s[2]+x*n[2],h}})(),rayPlaneIntersect:(()=>{const e=new Float32Array(3),t=new Float32Array(3),i=new Float32Array(3),r=new Float32Array(3);return(o,s,n,a,l,c)=>{c=c||u.vec3(),s=u.normalizeVec3(s,e);const h=u.subVec3(a,n,t),d=u.subVec3(l,n,i),p=u.cross3Vec3(h,d,r);u.normalizeVec3(p,p);const m=-u.dotVec3(n,p),f=-(u.dotVec3(o,p)+m)/u.dotVec3(s,p);return c[0]=o[0]+f*s[0],c[1]=o[1]+f*s[1],c[2]=o[2]+f*s[2],c}})(),cartesianToBarycentric:(()=>{const e=new Float32Array(3),t=new Float32Array(3),i=new Float32Array(3);return(r,o,s,n,a)=>{const l=u.subVec3(n,o,e),c=u.subVec3(s,o,t),h=u.subVec3(r,o,i),d=u.dotVec3(l,l),p=u.dotVec3(l,c),m=u.dotVec3(l,h),f=u.dotVec3(c,c),g=u.dotVec3(c,h),b=d*f-p*p;if(0===b)return null;const _=1/b,v=(f*m-p*g)*_,x=(d*g-p*m)*_;return a[0]=1-v-x,a[1]=x,a[2]=v,a}})(),barycentricInsideTriangle(e){const t=e[1],i=e[2];return i>=0&&t>=0&&i+t<1},barycentricToCartesian(e,t,i,r,o=u.vec3()){const s=e[0],n=e[1],a=e[2];return o[0]=t[0]*s+i[0]*n+r[0]*a,o[1]=t[1]*s+i[1]*n+r[1]*a,o[2]=t[2]*s+i[2]*n+r[2]*a,o},mergeVertices(e,t,i,r){const o={},s=[],n=[],a=t?[]:null,l=i?[]:null,c=[];let h,d,u,p;let m,f,g=0;for(m=0,f=e.length;m<f;m+=3)h=e[m],d=e[m+1],u=e[m+2],void 0===o[p=`${Math.round(1e4*h)}_${Math.round(1e4*d)}_${Math.round(1e4*u)}`]&&(o[p]=n.length/3,n.push(h),n.push(d),n.push(u),t&&(a.push(t[m]),a.push(t[m+1]),a.push(t[m+2])),i&&(l.push(i[g]),l.push(i[g+1]))),s[m/3]=o[p],g+=2;for(m=0,f=r.length;m<f;m++)c[m]=s[r[m]];const b={positions:n,indices:c};return a&&(b.normals=a),l&&(b.uv=l),b},buildNormals:(()=>{const e=new Float32Array(3),t=new Float32Array(3),i=new Float32Array(3),r=new Float32Array(3),o=new Float32Array(3),s=new Float32Array(3);return(n,a,l)=>{let c,h;const d=new Array(n.length/3);let p,m,f,g,b,_,v;for(c=0,h=a.length;c<h;c+=3){p=a[c],m=a[c+1],f=a[c+2],e[0]=n[3*p],e[1]=n[3*p+1],e[2]=n[3*p+2],t[0]=n[3*m],t[1]=n[3*m+1],t[2]=n[3*m+2],i[0]=n[3*f],i[1]=n[3*f+1],i[2]=n[3*f+2],u.subVec3(t,e,r),u.subVec3(i,e,o);const l=new Float32Array(3);u.normalizeVec3(u.cross3Vec3(r,o,s),l),d[p]||(d[p]=[]),d[m]||(d[m]=[]),d[f]||(d[f]=[]),d[p].push(l),d[m].push(l),d[f].push(l)}for(l=l&&l.length===n.length?l:new Float32Array(n.length),c=0,h=d.length;c<h;c++){g=d[c].length,b=0,_=0,v=0;for(let e=0;e<g;e++)b+=d[c][e][0],_+=d[c][e][1],v+=d[c][e][2];l[3*c]=b/g,l[3*c+1]=_/g,l[3*c+2]=v/g}return l}})(),buildTangents:(()=>{const e=new Float32Array(3),t=new Float32Array(3),i=new Float32Array(3),r=new Float32Array(3),o=new Float32Array(3),s=new Float32Array(3),n=new Float32Array(3);return(a,l,c)=>{const h=new Float32Array(a.length);for(let d=0;d<l.length;d+=3){let p=l[d];const m=a.subarray(3*p,3*p+3),f=c.subarray(2*p,2*p+2);p=l[d+1];const g=a.subarray(3*p,3*p+3),b=c.subarray(2*p,2*p+2);p=l[d+2];const _=a.subarray(3*p,3*p+3),v=c.subarray(2*p,2*p+2),x=u.subVec3(g,m,e),y=u.subVec3(_,m,t),w=u.subVec2(b,f,i),M=u.subVec2(v,f,r),k=1/(w[0]*M[1]-w[1]*M[0]),P=u.mulVec3Scalar(u.subVec3(u.mulVec3Scalar(x,M[1],o),u.mulVec3Scalar(y,w[1],s),n),k,s);let E;for(let e=0;e<3;e++)h[E=3*l[d+e]]+=P[0],h[E+1]+=P[1],h[E+2]+=P[2]}return h}})(),buildPickTriangles(e,t,i){const r=t.length,o=i?new Uint16Array(9*r):new Float32Array(9*r),s=new Uint8Array(12*r);let n,a,l,c,h,d,u=0,p=0,m=0;for(let i=0;i<r;i+=3)d=u>>24&255,h=u>>16&255,c=u>>8&255,l=255&u,n=3*(a=t[i]),o[p++]=e[n],o[p++]=e[n+1],o[p++]=e[n+2],s[m++]=l,s[m++]=c,s[m++]=h,s[m++]=d,n=3*(a=t[i+1]),o[p++]=e[n],o[p++]=e[n+1],o[p++]=e[n+2],s[m++]=l,s[m++]=c,s[m++]=h,s[m++]=d,n=3*(a=t[i+2]),o[p++]=e[n],o[p++]=e[n+1],o[p++]=e[n+2],s[m++]=l,s[m++]=c,s[m++]=h,s[m++]=d,u++;return{positions:o,colors:s}},faceToVertexNormals(e,t,i={}){const r=i.smoothNormalsAngleThreshold||20,o={},s=[],n={};let a,l,c,h,d;let p,m,f,g,b,_;for(m=0,g=e.length;m<g;m+=3){p=m/3,l=e[m],c=e[m+1],h=e[m+2],void 0===o[d=`${Math.round(1e4*l)}_${Math.round(1e4*c)}_${Math.round(1e4*h)}`]?o[d]=[p]:o[d].push(p);const i=u.normalizeVec3([t[m],t[m+1],t[m+2]]);s[p]=i,a=u.vec4([i[0],i[1],i[2],1]),n[p]=a}for(d in o)if(o.hasOwnProperty(d)){const e=o[d],t=e.length;for(m=0;m<t;m++){const i=e[m];for(a=n[i],f=0;f<t;f++){if(m===f)continue;const t=e[f];b=s[i],_=s[t],Math.abs(u.angleVec3(b,_)/u.DEGTORAD)<r&&(a[0]+=_[0],a[1]+=_[1],a[2]+=_[2],a[3]+=1)}}}for(m=0,g=t.length;m<g;m+=3)a=n[m/3],t[m+0]=a[0]/a[3],t[m+1]=a[1]/a[3],t[m+2]=a[2]/a[3]},canvasPosToWorldRay:(()=>{const e=new Float32Array(16),t=new Float32Array(16),i=new Float32Array(4),r=new Float32Array(4),o=new Float32Array(4),s=new Float32Array(4);return(n,a,l,c,h,d)=>{const p=u.mulMat4(l,a,e),m=u.inverseMat4(p,t),f=n.width,g=n.height,b=(c[0]-f/2)/(f/2),_=-(c[1]-g/2)/(g/2);i[0]=b,i[1]=_,i[2]=-1,i[3]=1,u.transformVec4(m,i,r),u.mulVec4Scalar(r,1/r[3]),o[0]=b,o[1]=_,o[2]=1,o[3]=1,u.transformVec4(m,o,s),u.mulVec4Scalar(s,1/s[3]),h[0]=s[0],h[1]=s[1],h[2]=s[2],u.subVec3(s,r,d),u.normalizeVec3(d)}})(),canvasPosToLocalRay:(()=>{const e=new Float32Array(3),t=new Float32Array(3);return(i,r,o,s,n,a,l)=>{u.canvasPosToWorldRay(i,r,o,n,e,t),u.worldRayToLocalRay(s,e,t,a,l)}})(),worldRayToLocalRay:(()=>{const e=new Float32Array(16),t=new Float32Array(4),i=new Float32Array(4);return(r,o,s,n,a)=>{const l=u.inverseMat4(r,e);t[0]=o[0],t[1]=o[1],t[2]=o[2],t[3]=1,u.transformVec4(l,t,i),n[0]=i[0],n[1]=i[1],n[2]=i[2],u.transformVec3(l,s,a)}})(),buildKDTree:(()=>{const e=10,t=20,i=new Float32Array;return(r,o)=>{const s=r.length/3,n=new Array(s);for(let e=0;e<s;++e)n[e]=e;return function r(o,s,n,a){const l=new Float32Array(6),c={triangles:null,left:null,right:null,leaf:!1,splitDim:0,aabb:l};let h,d;for(l[0]=l[1]=l[2]=Number.POSITIVE_INFINITY,l[3]=l[4]=l[5]=Number.NEGATIVE_INFINITY,h=0,d=o.length;h<d;++h){var u=3*o[h];for(let e=0;e<3;++e){const t=3*s[u+e];n[t]<l[0]&&(l[0]=n[t]),n[t]>l[3]&&(l[3]=n[t]),n[t+1]<l[1]&&(l[1]=n[t+1]),n[t+1]>l[4]&&(l[4]=n[t+1]),n[t+2]<l[2]&&(l[2]=n[t+2]),n[t+2]>l[5]&&(l[5]=n[t+2])}}if(o.length<t||a>e)return c.triangles=o,c.leaf=!0,c;i[0]=l[3]-l[0],i[1]=l[4]-l[1],i[2]=l[5]-l[2];let p=0;i[1]>i[p]&&(p=1),i[2]>i[p]&&(p=2),c.splitDim=p;const m=(l[p]+l[p+3])/2,f=new Array(o.length);let g=0;const b=new Array(o.length);let _=0;for(h=0,d=o.length;h<d;++h){const e=s[u=3*o[h]],t=3*s[u+1],i=3*s[u+2];n[3*e+p]<=m||n[t+p]<=m||n[i+p]<=m?f[g++]=o[h]:b[_++]=o[h]}return f.length=g,b.length=_,c.left=r(f,s,n,a+1),c.right=r(b,s,n,a+1),c}(n,r,o,0)}})(),decompressPosition(e,t,i){i[0]=e[0]*t[0]+t[12],i[1]=e[1]*t[5]+t[13],i[2]=e[2]*t[10]+t[14]},decompressPositions(e,t,i=new Float32Array(e.length)){for(let r=0,o=e.length;r<o;r+=3)i[r+0]=e[r+0]*t[0]+t[12],i[r+1]=e[r+1]*t[5]+t[13],i[r+2]=e[r+2]*t[10]+t[14];return i},decompressUV(e,t,i){i[0]=e[0]*t[0]+t[6],i[1]=e[1]*t[4]+t[7]},decompressUVs(e,t,i=new Float32Array(e.length)){for(let r=0,o=e.length;r<o;r+=3)i[r+0]=e[r+0]*t[0]+t[6],i[r+1]=e[r+1]*t[4]+t[7];return i},octDecodeVec2(e,t){let i=e[0],r=e[1];i=(2*i+1)/255,r=(2*r+1)/255;const o=1-Math.abs(i)-Math.abs(r);o<0&&(i=(1-Math.abs(r))*(i>=0?1:-1),r=(1-Math.abs(i))*(r>=0?1:-1));const s=Math.sqrt(i*i+r*r+o*o);return t[0]=i/s,t[1]=r/s,t[2]=o/s,t},octDecodeVec2s(e,t){for(let i=0,r=0,o=e.length;i<o;i+=2){let o=e[i+0],s=e[i+1];o=(2*o+1)/255,s=(2*s+1)/255;const n=1-Math.abs(o)-Math.abs(s);n<0&&(o=(1-Math.abs(s))*(o>=0?1:-1),s=(1-Math.abs(o))*(s>=0?1:-1));const a=Math.sqrt(o*o+s*s+n*n);t[r+0]=o/a,t[r+1]=s/a,t[r+2]=n/a,r+=3}return t}};u.buildEdgeIndices=function(){const e=[],t=[],i=[],r=[],o=[];let s=0;const n=new Uint16Array(3),a=new Uint16Array(3),l=new Uint16Array(3),c=u.vec3(),h=u.vec3(),d=u.vec3(),p=u.vec3(),m=u.vec3(),f=u.vec3(),g=u.vec3();return function(b,_,v,x){!function(o,s){const n={};let a,l,c,h;const d=Math.pow(10,4);let u,p,m=0;for(u=0,p=o.length;u<p;u+=3)a=o[u],l=o[u+1],c=o[u+2],void 0===n[h=Math.round(a*d)+"_"+Math.round(l*d)+"_"+Math.round(c*d)]&&(n[h]=m/3,e[m++]=a,e[m++]=l,e[m++]=c),t[u/3]=n[h];for(u=0,p=s.length;u<p;u++)r[u]=t[s[u]],i[r[u]]=s[u]}(b,_),function(t,i){s=0;for(let b=0,_=t;b<_;b+=3){const t=3*r[b],_=3*r[b+1],v=3*r[b+2];i?(n[0]=e[t],n[1]=e[t+1],n[2]=e[t+2],a[0]=e[_],a[1]=e[_+1],a[2]=e[_+2],l[0]=e[v],l[1]=e[v+1],l[2]=e[v+2],u.decompressPosition(n,i,c),u.decompressPosition(a,i,h),u.decompressPosition(l,i,d)):(c[0]=e[t],c[1]=e[t+1],c[2]=e[t+2],h[0]=e[_],h[1]=e[_+1],h[2]=e[_+2],d[0]=e[v],d[1]=e[v+1],d[2]=e[v+2]),u.subVec3(d,h,p),u.subVec3(c,h,m),u.cross3Vec3(p,m,f),u.normalizeVec3(f,g);const x=o[s]||(o[s]={normal:u.vec3()});x.normal[0]=g[0],x.normal[1]=g[1],x.normal[2]=g[2],s++}}(_.length,v);const y=[],w=Math.cos(u.DEGTORAD*x),M={};let k,P,E,A,C,T,D,S,L,R,I,N=!1;for(let e=0,t=_.length;e<t;e+=3){const t=e/3;for(let i=0;i<3;i++)k=r[e+i],P=r[e+(i+1)%3],void 0===M[C=(E=Math.min(k,P))+","+(A=Math.max(k,P))]?M[C]={index1:E,index2:A,face1:t,face2:void 0}:M[C].face2=t}for(C in M)void 0!==(T=M[C]).face2&&(D=o[T.face1].normal,S=o[T.face2].normal,(L=u.dotVec3(D,S))>w)||(R=i[T.index1],I=i[T.index2],(!N&&R>65535||I>65535)&&(N=!0),y.push(R),y.push(I));return N?new Uint32Array(y):new Uint16Array(y)}}();const p=u.vec3();class m{constructor(e){this.objectsVisible=[],this.objectsEdges=[],this.objectsXrayed=[],this.objectsHighlighted=[],this.objectsSelected=[],this.objectsClippable=[],this.objectsPickable=[],this.objectsColorize=[],this.objectsOpacity=[],this.numObjects=0,e&&this.saveObjects(e)}saveObjects(e,t,i){const r=t.rootMetaObject;if(!r)return;const o=r.getObjectIDsInSubtree();this.numObjects=0,this._mask=i?s.apply(i,{}):null;const n=e.objects,a=!i||i.visible,l=!i||i.edges,c=!i||i.xrayed,h=!i||i.highlighted,d=!i||i.selected,u=!i||i.clippable,p=!i||i.pickable,m=!i||i.colorize,f=!i||i.opacity;for(var g=0,b=o.length;g<b;g++){const e=n[o[g]];if(e){if(a&&(this.objectsVisible[g]=e.visible),l&&(this.objectsEdges[g]=e.edges),c&&(this.objectsXrayed[g]=e.xrayed),h&&(this.objectsHighlighted[g]=e.highlighted),d&&(this.objectsSelected[g]=e.selected),u&&(this.objectsClippable[g]=e.clippable),p&&(this.objectsPickable[g]=e.pickable),m){const t=e.colorize;this.objectsColorize[3*g+0]=t[0],this.objectsColorize[3*g+1]=t[1],this.objectsColorize[3*g+2]=t[2]}f&&(this.objectsOpacity[g]=e.opacity),this.numObjects++}}}restoreObjects(e,t){const i=t.rootMetaObject;if(!i)return;const r=i.getObjectIDsInSubtree(),o=this._mask,s=!o||o.visible,n=!o||o.edges,a=!o||o.xrayed,l=!o||o.highlighted,c=!o||o.selected,h=!o||o.clippable,d=!o||o.pickable,u=!o||o.colorize,m=!o||o.opacity,f=e.objects;for(var g=0,b=r.length;g<b;g++){const e=f[r[g]];e&&(s&&(e.visible=this.objectsVisible[g]),n&&(e.edges=this.objectsEdges[g]),a&&(e.xrayed=this.objectsXrayed[g]),l&&(e.highlighted=this.objectsHighlighted[g]),c&&(e.selected=this.objectsSelected[g]),h&&(e.clippable=this.objectsClippable[g]),d&&(e.pickable=this.objectsPickable[g]),u&&(p[0]=this.objectsColorize[3*g+0],p[1]=this.objectsColorize[3*g+1],p[2]=this.objectsColorize[3*g+2],e.colorize=p),m&&(e.opacity=this.objectsOpacity[g]))}}}const f=u.vec3();class g extends a{constructor(e,t={}){if(super(e,t),!t.buttonElement)throw"Missing config: buttonElement";const i=t.buttonElement,r=this.viewer.camera;this._modelMementos={},r.eye=[.577,.577,.577],r.look=[0,0,0],r.up=[-1,1,-1],this.viewerUI.models.on("modelLoaded",e=>{this._saveModelMemento(e)}),this.viewerUI.models.on("modelUnloaded",e=>{this._destroyModelMemento(e)}),this.on("enabled",e=>{e?i.removeClass("disabled"):i.addClass("disabled")}),this.on("active",e=>{e?i.addClass("active"):i.removeClass("active")}),i.on("click",e=>{this.getEnabled()&&this.reset(),e.preventDefault()})}_saveModelMemento(e){const t=this.viewer.metaScene.metaModels[e];if(!t)return void this.error("MetaModel not found: "+e);const i=new m;i.saveObjects(this.viewer.scene,t),this._modelMementos[e]=i}_restoreModelMemento(e){const t=this.viewer.metaScene.metaModels[e];t?this._modelMementos[e].restoreObjects(this.viewer.scene,t):this.error("MetaModel not found: "+e)}_destroyModelMemento(e){delete this._modelMementos[e]}reset(){const e=this.viewer.scene.modelIds;for(var t=0,i=e.length;t<i;t++){const i=e[t];this._restoreModelMemento(i)}this.fire("reset",!0),this._resetCamera()}_resetCamera(){const e=this.viewer,t=e.scene,i=t.getAABB(t.visibleObjectIds),r=u.getAABB3Diag(i),o=u.getAABB3Center(i,f),s=Math.abs(r/Math.tan(32.5)),n=t.camera,a=n.yUp?[-1,-1,-1]:[1,1,1],l=n.yUp?[-1,1,-1]:[-1,1,1];e.cameraControl.pivotPos=o,e.cameraFlight.flyTo({look:o,eye:[o[0]-s*a[0],o[1]-s*a[1],o[2]-s*a[2]],up:l,orthoScale:1.3*r,projection:"perspective",duration:1})}}const b=u.vec3();class _ extends a{constructor(e,t={}){if(super(e,t),!t.buttonElement)throw"Missing config: buttonElement";const i=t.buttonElement;this.on("enabled",e=>{e?i.removeClass("disabled"):i.addClass("disabled")}),this.on("active",e=>{e?i.addClass("active"):i.removeClass("active")}),i.on("click",e=>{this.getEnabled()&&this.fit(),e.preventDefault()})}fit(){const e=this.viewer.scene,t=e.getAABB(e.visibleObjectIds);this.viewer.cameraFlight.flyTo({aabb:t}),this.viewer.cameraControl.pivotPos=u.getAABB3Center(t,b)}set fov(e){this.viewer.scene.cameraFlight.fitFOV=e}get fov(){return this.viewer.scene.cameraFlight.fitFOV}set duration(e){this.viewer.scene.cameraFlight.duration=e}get duration(){return this.viewer.scene.cameraFlight.duration}}class v extends a{constructor(e,t){if(super(e,t),!t.buttonElement)throw"Missing config: buttonElement";const i=t.buttonElement,r=this.viewer.cameraControl;r.firstPerson=!1,r.pivoting=!0,r.panToPointer=!0,this.on("enabled",e=>{e?i.removeClass("disabled"):i.addClass("disabled")}),this.on("active",e=>{e?i.addClass("active"):i.removeClass("active")}),this.on("active",e=>{e?(r.firstPerson=!0,r.panToPointer=!0,r.pivoting=!1):(r.firstPerson=!1,r.pivoting=!0,r.panToPointer=!0),this.viewer.cameraControl.planView=!1}),i.on("click",e=>{if(!this.getEnabled())return;const t=this.getActive();this.setActive(!t),e.preventDefault()}),this.viewerUI.on("reset",()=>{this.setActive(!1)})}}class x extends a{constructor(e,t){if(super(e,t),!t.buttonElement)throw"Missing config: buttonElement";const i=t.buttonElement;this.on("enabled",e=>{e?i.removeClass("disabled"):i.addClass("disabled")}),this.on("active",e=>{e?i.addClass("active"):i.removeClass("active")}),this.on("active",e=>{e?this.viewer.cameraFlight.flyTo({projection:"ortho",duration:.5},()=>{}):this.viewer.cameraFlight.flyTo({projection:"perspective",duration:.5},()=>{}),this.viewer.cameraControl.planView=!1}),i.on("click",e=>{this.setActive(!this.getActive()),e.preventDefault()}),this.viewerUI.on("reset",()=>{this.setActive(!1)})}}class y extends a{constructor(e,t){if(super(e,t),!t.buttonElement)throw"Missing config: buttonElement";const i=t.buttonElement;this.on("enabled",e=>{e?i.removeClass("disabled"):i.addClass("disabled")}),this.on("active",e=>{e?i.addClass("active"):i.removeClass("active")}),this.on("active",e=>{this.activateHideMode(e)}),i.on("click",e=>{if(!this.getEnabled())return;const t=this.getActive();this.setActive(!t),e.preventDefault()}),this.viewerUI.on("reset",()=>{this.setActive(!1)})}activateHideMode(e){if(e){var t=null;this._onHover=this.viewer.cameraControl.on("hover",e=>{t&&(t.highlighted=!1,t=null),(t=e.entity).highlighted=!0}),this._onHoverOff=this.viewer.cameraControl.on("hoverOff",e=>{t&&(t.highlighted=!1,t=null)});const e=u.vec2();this._onMousedown=this.viewer.scene.input.on("mousedown",t=>{e[0]=t[0],e[1]=t[1]}),this._onMouseup=this.viewer.scene.input.on("mouseup",i=>{if(t){if(!function(e,t){return Math.abs(e[0]-t[0])<4&&Math.abs(e[1]-t[1])<4}(e,i))return void(t=null);t.visible=!1,t.highlighted=!1,t=null}})}else t&&(t.highlighted=!1,t=null),this.viewer.cameraControl.off(this._onHover),this.viewer.cameraControl.off(this._onHoverOff),this.viewer.cameraControl.off(this._onMousedown),this.viewer.cameraControl.off(this._onMouseup)}}class w extends a{constructor(e,t){if(super(e),!t.buttonElement)throw"Missing config: buttonElement";const i=t.buttonElement;this.on("enabled",e=>{e?i.removeClass("disabled"):i.addClass("disabled")}),this.on("active",e=>{e?i.addClass("active"):i.removeClass("active")}),this.on("active",e=>{const t=this.viewer,i=t.cameraControl;if(e){var r=null;this._onHover=i.on("hover",e=>{r&&(r.highlighted=!1,r=null),(r=e.entity).highlighted=!0}),this._onHoverOff=i.on("hoverOff",e=>{r&&(r.highlighted=!1,r=null)});const e=u.vec2();this._onMousedown=t.scene.input.on("mousedown",t=>{e[0]=t[0],e[1]=t[1]}),this._onMouseup=t.scene.input.on("mouseup",t=>{if(r){if(!function(e,t){return Math.abs(e[0]-t[0])<4&&Math.abs(e[1]-t[1])<4}(e,t))return void(r=null);r.selected=!r.selected,r=null}})}else r&&(r.highlighted=!1,r=null),i.off(this._onHover),i.off(this._onHoverOff),i.off(this._onMousedown),i.off(this._onMouseup)}),i.on("click",e=>{if(!this.getEnabled())return;const t=this.getActive();this.setActive(!t),e.preventDefault()}),this.viewerUI.on("reset",()=>{this.setActive(!1)})}}class M extends a{constructor(e,t){if(super(e),!t.buttonElement)throw"Missing config: buttonElement";const i=t.buttonElement;this.on("enabled",e=>{e?i.removeClass("disabled"):i.addClass("disabled")}),this.on("active",e=>{e?i.addClass("active"):i.removeClass("active")}),this.on("active",e=>{const t=this.viewer,i=t.cameraControl;if(e){var r=null;this._onHover=i.on("hover",e=>{r&&(r.highlighted=!1,r=null),(r=e.entity).highlighted=!0}),this._onHoverOff=i.on("hoverOff",e=>{r&&(r.highlighted=!1,r=null)});const e=u.vec2();this._onMousedown=t.scene.input.on("mousedown",t=>{e[0]=t[0],e[1]=t[1]}),this._onMouseup=t.scene.input.on("mouseup",t=>{if(r){if(!function(e,t){return Math.abs(e[0]-t[0])<4&&Math.abs(e[1]-t[1])<4}(e,t))return void(r=null);this.fire("queryPicked",r.id),r=null}else this.fire("queryNotPicked",!1)})}else i.off(this._onHover),i.off(this._onHoverOff),i.off(this._onMousedown),i.off(this._onMouseup)}),i.on("click",e=>{if(!this.getEnabled())return;const t=this.getActive();this.setActive(!t),e.preventDefault()}),this.viewerUI.on("reset",()=>{this.setActive(!1)})}}class k{constructor(e,t,i){this.id=i&&i.id?i.id:e,this.viewer=t,this._eventSubs={},t.addPlugin(this)}on(e,t){let i=this._eventSubs[e];i||(i=[],this._eventSubs[e]=i),i.push(t)}fire(e,t){const i=this._eventSubs[e];if(i)for(let e=0,r=i.length;e<r;e++)i[e](t)}log(e){console.log(`[xeokit plugin ${this.id}]: ${e}`)}warn(e){console.warn(`[xeokit plugin ${this.id}]: ${e}`)}error(e){console.error(`[xeokit plugin ${this.id}]: ${e}`)}send(e,t){}destroy(){this.viewer.removePlugin(this)}}const P={build:{version:"0.8"},client:{browser:navigator&&navigator.userAgent?navigator.userAgent:"n/a"},components:{scenes:0,models:0,meshes:0,objects:0},memory:{meshes:0,positions:0,colors:0,normals:0,uvs:0,indices:0,textures:0,transforms:0,materials:0,programs:0},frame:{frameCount:0,fps:0,useProgram:0,bindTexture:0,bindArray:0,drawElements:0,drawArrays:0,tasksRun:0,tasksScheduled:0}},E={},A=new n,C=new class{constructor(){this._head=[],this._headLength=0,this._tail=[],this._index=0,this._length=0}get length(){return this._length}shift(){if(this._index>=this._headLength){const e=this._head;if(e.length=0,this._head=this._tail,this._tail=e,this._index=0,this._headLength=this._head.length,!this._headLength)return}const e=this._head[this._index];return this._index<0?delete this._head[this._index++]:this._head[this._index++]=void 0,this._length--,e}push(e){return this._length++,this._tail.push(e),this}unshift(e){return this._head[--this._index]=e,this._length++,this}},T={sceneId:null,time:null,startTime:null,prevTime:null,deltaTime:null},D=10,S=[];let L,R=0,I=0;const N=new function(){this.version="1.0.0",this.scenes={},this._superTypes={},this._addScene=function(e){if(e.id){if(N.scenes[e.id])return void console.error(`[ERROR] Scene ${s.inQuotes(e.id)} already exists`)}else e.id=A.addItem({});N.scenes[e.id]=e;const t=e.ticksPerOcclusionTest,i=e.ticksPerRender;E[e.id]={ticksPerOcclusionTest:t,occlusionTestCountdown:t,ticksPerRender:i,renderCountdown:i},P.components.scenes++,e.once("destroyed",()=>{A.removeItem(e.id),delete N.scenes[e.id],delete E[e.id],P.components.scenes--})},this.clear=function(){let e;for(const t in N.scenes)N.scenes.hasOwnProperty(t)&&(e=N.scenes[t],"default.scene"===t?e.clear():(e.destroy(),delete N.scenes[e.id]))},this.scheduleTask=function(e,t){C.push(e),C.push(t)},this.runTasks=function(e=-1){let t,i,r=(new Date).getTime(),o=0;for(;C.length>0&&(e<0||r<e);)t=C.shift(),(i=C.shift())?t.call(i):t(),r=(new Date).getTime(),o++;return o},this.getNumTasks=function(){return C.length}},F=function(){let e=Date.now();if(R>0){var t=1e3/(L=e-R);I+=t,S.push(t),S.length>=30&&(I-=S.shift()),P.frame.fps=Math.round(I/S.length)}!function(e){const t=N.runTasks(e+D),i=N.getNumTasks();P.frame.tasksRun=t,P.frame.tasksScheduled=i,P.frame.tasksBudget=D}(e),function(e){for(var t in T.time=e,N.scenes)if(N.scenes.hasOwnProperty(t)){var i=N.scenes[t];T.sceneId=t,T.startTime=i.startTime,T.deltaTime=null!=T.prevTime?T.time-T.prevTime:0,i.fire("tick",T,!0)}T.prevTime=e}(e),function(){const e=N.scenes;let t,i,r,o,s;for(s in e)e.hasOwnProperty(s)&&(t=e[s],(i=E[s])||(i=E[s]={}),r=t.ticksPerOcclusionTest,i.ticksPerOcclusionTest!==r&&(i.ticksPerOcclusionTest=r,i.renderCountdown=r),0==--i.occlusionTestCountdown&&(t.doOcclusionTest(),i.occlusionTestCountdown=r),o=t.ticksPerRender,i.ticksPerRender!==o&&(i.ticksPerRender=o,i.renderCountdown=o),0==--i.renderCountdown&&(t.render(!1),i.renderCountdown=o))}(),R=e,window.requestAnimationFrame(F)};window.requestAnimationFrame(F);class B{get type(){return"Component"}get isComponent(){return!0}constructor(e=null,t={}){if(this.scene=null,"Scene"===this.type)this.scene=this,this.viewer=t.viewer;else{if("Scene"===e.type)this.scene=e;else{if(!(e instanceof B))throw"Invalid param: owner must be a Component";this.scene=e.scene}this._owner=e,this._renderer=this.scene._renderer}this._dontClear=!!t.dontClear,this._renderer=this.scene._renderer,this.meta=t.meta||{},this.id=t.id,this.destroyed=!1,this._attached={},this._attachments=null,this._subIdMap=null,this._subIdEvents=null,this._eventSubs=null,this._events=null,this._eventCallDepth=0,this._ownedComponents=null,this!==this.scene&&this.scene._addComponent(this),this._updateScheduled=!1,e&&e._own(this)}glRedraw(){this._renderer.imageDirty(),this.castsShadow&&this._renderer.shadowsDirty()}glResort(){this._renderer.needStateSort()}get owner(){return this._owner}isType(e){return this.type===e}fire(e,t,i){this._events||(this._events={}),this._eventSubs||(this._eventSubs={}),!0!==i&&(this._events[e]=t||!0);const r=this._eventSubs[e];let o;if(r)for(const i in r)r.hasOwnProperty(i)&&(o=r[i],this._eventCallDepth++,this._eventCallDepth<300?o.callback.call(o.scope,t):this.error("fire: potential stack overflow from recursive event '"+e+"' - dropping this event"),this._eventCallDepth--)}on(e,t,i){this._events||(this._events={}),this._subIdMap||(this._subIdMap=new n),this._subIdEvents||(this._subIdEvents={}),this._eventSubs||(this._eventSubs={});let r=this._eventSubs[e];r||(r={},this._eventSubs[e]=r);const o=this._subIdMap.addItem();r[o]={callback:t,scope:i||this},this._subIdEvents[o]=e;const s=this._events[e];return void 0!==s&&t.call(i||this,s),o}off(e){if(null==e)return;if(!this._subIdEvents)return;const t=this._subIdEvents[e];if(t){delete this._subIdEvents[e];const i=this._eventSubs[t];i&&delete i[e],this._subIdMap.removeItem(e)}}once(e,t,i){const r=this,o=this.on(e,(function(e){r.off(o),t.call(i||this,e)}),i)}hasSubs(e){return this._eventSubs&&!!this._eventSubs[e]}log(e){e="[LOG]"+this._message(e),window.console.log(e),this.scene.fire("log",e)}_message(e){return" ["+this.type+" "+s.inQuotes(this.id)+"]: "+e}warn(e){e="[WARN]"+this._message(e),window.console.warn(e),this.scene.fire("warn",e)}error(e){e="[ERROR]"+this._message(e),window.console.error(e),this.scene.fire("error",e)}_attach(e){const t=e.name;if(!t)return void this.error("Component 'name' expected");let i=e.component;const r=e.sceneDefault,o=e.sceneSingleton,n=e.type,a=e.on,l=!1!==e.recompiles;if(i&&(s.isNumeric(i)||s.isString(i))){const e=i;if(!(i=this.scene.components[e]))return void this.error("Component not found: "+s.inQuotes(e))}if(!i)if(!0===o){const e=this.scene.types[n];for(const t in e)if(e.hasOwnProperty){i=e[t];break}if(!i)return this.error("Scene has no default component for '"+t+"'"),null}else if(!0===r&&!(i=this.scene[t]))return this.error("Scene has no default component for '"+t+"'"),null;if(i){if(i.scene.id!==this.scene.id)return void this.error("Not in same scene: "+i.type+" "+s.inQuotes(i.id));if(n&&!i.isType(n))return void this.error("Expected a "+n+" type or subtype: "+i.type+" "+s.inQuotes(i.id))}this._attachments||(this._attachments={});const c=this._attached[t];let h,d,u;if(c){if(i&&c.id===i.id)return;const e=this._attachments[c.id];for(d=0,u=(h=e.subs).length;d<u;d++)c.off(h[d]);delete this._attached[t],delete this._attachments[c.id];const r=e.params.onDetached;r&&(s.isFunction(r)?r(c):r.scope?r.callback.call(r.scope,c):r.callback(c)),e.managingLifecycle&&c.destroy()}if(i){const r={params:e,component:i,subs:[],managingLifecycle:!1};r.subs.push(i.once("destroyed",(function(){r.params.component=null,this._attach(r.params)}),this)),l&&r.subs.push(i.on("dirty",(function(){this.fire("dirty",this)}),this)),this._attached[t]=i,this._attachments[i.id]=r;const o=e.onAttached;if(o&&(s.isFunction(o)?o(i):o.scope?o.callback.call(o.scope,i):o.callback(i)),a){let e,t,o,n;for(e in a)if(a.hasOwnProperty(e)){if(t=a[e],s.isFunction(t)?(o=t,n=null):(o=t.callback,n=t.scope),!o)continue;r.subs.push(i.on(e,o,n))}}}return l&&this.fire("dirty",this),this.fire(t,i),i}_checkComponent(e,t){if(!t.isComponent){if(!s.isID(t))return void this.error("Expected a Component or ID");{const e=t;if(!(t=this.scene.components[e]))return void this.error("Component not found: "+e)}}if(e===t.type){if(t.scene.id===this.scene.id)return t;this.error("Not in same scene: "+t.type)}else this.error("Expected a "+e+" Component")}_checkComponent2(e,t){if(!t.isComponent){if(!s.isID(t))return void this.error("Expected a Component or ID");{const e=t;if(!(t=this.scene.components[e]))return void this.error("Component not found: "+e)}}if(t.scene.id===this.scene.id){for(var i=0,r=e.length;i<r;i++)if(e[i]===t.type)return t;return this.error("Expected component types: "+e),null}this.error("Not in same scene: "+t.type)}_own(e){this._ownedComponents||(this._ownedComponents={}),this._ownedComponents[e.id]||(this._ownedComponents[e.id]=e),e.once("destroyed",()=>{delete this._ownedComponents[e.id]},this)}_needUpdate(e){this._updateScheduled||(this._updateScheduled=!0,0===e?this._doUpdate():N.scheduleTask(this._doUpdate,this))}_doUpdate(){this._updateScheduled&&(this._updateScheduled=!1,this._update&&this._update())}_update(){}clear(){if(this._ownedComponents)for(var e in this._ownedComponents)if(this._ownedComponents.hasOwnProperty(e)){this._ownedComponents[e].destroy(),delete this._ownedComponents[e]}}destroy(){if(this.destroyed)return;let e,t,i,r,o,s;if(this.fire("destroyed",this.destroyed=!0),this._attachments)for(e in this._attachments)if(this._attachments.hasOwnProperty(e)){for(i=(t=this._attachments[e]).component,o=0,s=(r=t.subs).length;o<s;o++)i.off(r[o]);t.managingLifecycle&&i.destroy()}if(this._ownedComponents)for(e in this._ownedComponents)this._ownedComponents.hasOwnProperty(e)&&((i=this._ownedComponents[e]).destroy(),delete this._ownedComponents[e]);this.scene._removeComponent(this),this._attached={},this._attachments=null,this._subIdMap=null,this._subIdEvents=null,this._eventSubs=null,this._events=null,this._eventCallDepth=0,this._ownedComponents=null,this._updateScheduled=!1}}const O=new n({});class j{constructor(e){this.id=O.addItem({});for(const t in e)e.hasOwnProperty(t)&&(this[t]=e[t])}destroy(){O.removeItem(this.id)}}class z extends B{get type(){return"SectionPlane"}constructor(e,t={}){super(e,t),this._state=new j({active:!0,pos:new Float32Array(3),dir:new Float32Array(3)}),this.active=t.active,this.pos=t.pos,this.dir=t.dir,this.scene._sectionPlaneCreated(this)}set active(e){this._state.active=!1!==e,this.glRedraw(),this.fire("active",this._state.active)}get active(){return this._state.active}set pos(e){this._state.pos.set(e||[0,0,0]),this.glRedraw(),this.fire("pos",this._state.pos)}get pos(){return this._state.pos}set dir(e){this._state.dir.set(e||[0,0,-1]),this.glRedraw(),this.fire("dir",this._state.dir)}get dir(){return this._state.dir}destroy(){this._state.destroy(),this.scene._sectionPlaneDestroyed(this),super.destroy()}}function V(e={}){let t=e.radiusTop||1;t<0&&(console.error("negative radiusTop not allowed - will invert"),t*=-1);let i=e.radiusBottom||1;i<0&&(console.error("negative radiusBottom not allowed - will invert"),i*=-1);let r=e.height||1;r<0&&(console.error("negative height not allowed - will invert"),r*=-1);let o=e.radialSegments||32;o<0&&(console.error("negative radialSegments not allowed - will invert"),o*=-1),o<3&&(o=3);let n=e.heightSegments||1;n<0&&(console.error("negative heightSegments not allowed - will invert"),n*=-1),n<1&&(n=1);const a=!!e.openEnded;let l=e.center;const c=l?l[0]:0,h=l?l[1]:0,d=l?l[2]:0,u=r/2,p=r/n,m=2*Math.PI/o,f=1/o,g=(t-i)/n,b=[],_=[],v=[],x=[];let y,w,M,k,P,E,A,C,T,D,S;const L=(90-180*Math.atan(r/(i-t))/Math.PI)/90;for(y=0;y<=n;y++)for(P=t-y*g,E=u-y*p,w=0;w<=o;w++)M=Math.sin(w*m),k=Math.cos(w*m),_.push(P*M),_.push(L),_.push(P*k),v.push(w*f),v.push(1*y/n),b.push(P*M+c),b.push(E+h),b.push(P*k+d);for(y=0;y<n;y++)for(w=0;w<=o;w++)C=(A=y*(o+1)+w)+o,x.push(A),x.push(C),x.push(C+1),x.push(A),x.push(C+1),x.push(A+1);if(!a&&t>0){for(T=b.length/3,_.push(0),_.push(1),_.push(0),v.push(.5),v.push(.5),b.push(0+c),b.push(u+h),b.push(0+d),w=0;w<=o;w++)M=Math.sin(w*m),k=Math.cos(w*m),D=.5*Math.sin(w*m)+.5,S=.5*Math.cos(w*m)+.5,_.push(t*M),_.push(1),_.push(t*k),v.push(D),v.push(S),b.push(t*M+c),b.push(u+h),b.push(t*k+d);for(w=0;w<o;w++)l=T,A=T+1+w,x.push(A),x.push(A+1),x.push(l)}if(!a&&i>0){for(T=b.length/3,_.push(0),_.push(-1),_.push(0),v.push(.5),v.push(.5),b.push(0+c),b.push(0-u+h),b.push(0+d),w=0;w<=o;w++)M=Math.sin(w*m),k=Math.cos(w*m),D=.5*Math.sin(w*m)+.5,S=.5*Math.cos(w*m)+.5,_.push(i*M),_.push(-1),_.push(i*k),v.push(D),v.push(S),b.push(i*M+c),b.push(0-u+h),b.push(i*k+d);for(w=0;w<o;w++)l=T,A=T+1+w,x.push(l),x.push(A+1),x.push(A)}return s.apply(e,{positions:b,normals:_,uv:v,indices:x})}function U(e={}){let t=e.radius||1;t<0&&(console.error("negative radius not allowed - will invert"),t*=-1),t*=.5;let i=e.tube||.3;i<0&&(console.error("negative tube not allowed - will invert"),i*=-1);let r=e.radialSegments||32;r<0&&(console.error("negative radialSegments not allowed - will invert"),r*=-1),r<4&&(r=4);let o=e.tubeSegments||24;o<0&&(console.error("negative tubeSegments not allowed - will invert"),o*=-1),o<4&&(o=4);let n=e.arc||2*Math.PI;n<0&&(console.warn("negative arc not allowed - will invert"),n*=-1),n>360&&(n=360);const a=e.center;let l=a?a[0]:0,c=a?a[1]:0;const h=a?a[2]:0,d=[],p=[],m=[],f=[];let g,b,_,v,x,y,w,M,k,P,E,A;for(M=0;M<=o;M++)for(w=0;w<=r;w++)g=w/r*n,b=.785398+M/o*Math.PI*2,l=t*Math.cos(g),c=t*Math.sin(g),_=(t+i*Math.cos(b))*Math.cos(g),v=(t+i*Math.cos(b))*Math.sin(g),x=i*Math.sin(b),d.push(_+l),d.push(v+c),d.push(x+h),m.push(1-w/r),m.push(M/o),y=u.normalizeVec3(u.subVec3([_,v,x],[l,c,h],[]),[]),p.push(y[0]),p.push(y[1]),p.push(y[2]);for(M=1;M<=o;M++)for(w=1;w<=r;w++)k=(r+1)*M+w-1,P=(r+1)*(M-1)+w-1,E=(r+1)*(M-1)+w,A=(r+1)*M+w,f.push(k),f.push(P),f.push(E),f.push(E),f.push(A),f.push(k);return s.apply(e,{positions:d,normals:p,uv:m,indices:f})}function H(e={}){let t=e.xSize||1;t<0&&(console.error("negative xSize not allowed - will invert"),t*=-1);let i=e.ySize||1;i<0&&(console.error("negative ySize not allowed - will invert"),i*=-1);let r=e.zSize||1;r<0&&(console.error("negative zSize not allowed - will invert"),r*=-1);const o=e.center,n=o?o[0]:0,a=o?o[1]:0,l=o?o[2]:0,c=-t+n,h=-i+a,d=-r+l,u=t+n,p=i+a,m=r+l;return s.apply(e,{positions:[u,p,m,c,p,m,c,h,m,u,h,m,u,p,m,u,h,m,u,h,d,u,p,d,u,p,m,u,p,d,c,p,d,c,p,m,c,p,m,c,p,d,c,h,d,c,h,m,c,h,d,u,h,d,u,h,m,c,h,m,u,h,d,c,h,d,c,p,d,u,p,d],normals:[0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1],uv:[1,0,0,0,0,1,1,1,0,0,0,1,1,1,1,0,1,1,1,0,0,0,0,1,1,0,0,0,0,1,1,1,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0],indices:[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]})}class G extends B{get type(){return"Geometry"}get isGeometry(){return!0}constructor(e,t={}){super(e,t),P.memory.meshes++}destroy(){super.destroy(),P.memory.meshes--}}class W{constructor(e,t,i,r,o,s,n,a,l){switch(this._gl=e,this.type=t,this.allocated=!1,i.constructor){case Uint8Array:this.itemType=e.UNSIGNED_BYTE,this.itemByteSize=1;break;case Int8Array:this.itemType=e.BYTE,this.itemByteSize=1;break;case Uint16Array:this.itemType=e.UNSIGNED_SHORT,this.itemByteSize=2;break;case Int16Array:this.itemType=e.SHORT,this.itemByteSize=2;break;case Uint32Array:this.itemType=e.UNSIGNED_INT,this.itemByteSize=4;break;case Int32Array:this.itemType=e.INT,this.itemByteSize=4;break;default:this.itemType=e.FLOAT,this.itemByteSize=4}this.usage=s,this.length=0,this.dataLength=r,this.numItems=0,this.itemSize=o,this.normalized=!!n,this.stride=a||0,this.offset=l||0,this._allocate(i)}_allocate(e){if(this.allocated=!1,this._handle=this._gl.createBuffer(),!this._handle)throw"Failed to allocate WebGL ArrayBuffer";this._handle&&(this._gl.bindBuffer(this.type,this._handle),this._gl.bufferData(this.type,e.length>this.dataLength?e.slice(0,this.dataLength):e,this.usage),this._gl.bindBuffer(this.type,null),this.length=e.length,this.numItems=this.length/this.itemSize,this.allocated=!0)}setData(e,t){this.allocated&&(e.length+(t||0)>this.length?(this.destroy(),this._allocate(e)):(this._gl.bindBuffer(this.type,this._handle),t||0===t?this._gl.bufferSubData(this.type,t*this.itemByteSize,e):this._gl.bufferData(this.type,e,this.usage),this._gl.bindBuffer(this.type,null)))}bind(){this.allocated&&this._gl.bindBuffer(this.type,this._handle)}unbind(){this.allocated&&this._gl.bindBuffer(this.type,null)}destroy(){this.allocated&&(this._gl.deleteBuffer(this._handle),this._handle=null,this.allocated=!1)}}const q={WEBGL:!1,SUPPORTED_EXTENSIONS:{}},X=document.createElement("canvas");if(X){const e=X.getContext("webgl",{antialias:!0})||X.getContext("experimental-webgl",{antialias:!0});q.WEBGL=!!e,q.WEBGL&&(q.ANTIALIAS=e.getContextAttributes().antialias,e.getShaderPrecisionFormat?e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0?q.FS_MAX_FLOAT_PRECISION="highp":e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?q.FS_MAX_FLOAT_PRECISION="mediump":q.FS_MAX_FLOAT_PRECISION="lowp":q.FS_MAX_FLOAT_PRECISION="mediump",q.DEPTH_BUFFER_BITS=e.getParameter(e.DEPTH_BITS),q.MAX_TEXTURE_SIZE=e.getParameter(e.MAX_TEXTURE_SIZE),q.MAX_CUBE_MAP_SIZE=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),q.MAX_RENDERBUFFER_SIZE=e.getParameter(e.MAX_RENDERBUFFER_SIZE),q.MAX_TEXTURE_UNITS=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),q.MAX_TEXTURE_IMAGE_UNITS=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),q.MAX_VERTEX_ATTRIBS=e.getParameter(e.MAX_VERTEX_ATTRIBS),q.MAX_VERTEX_UNIFORM_VECTORS=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),q.MAX_FRAGMENT_UNIFORM_VECTORS=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),q.MAX_VARYING_VECTORS=e.getParameter(e.MAX_VARYING_VECTORS),e.getSupportedExtensions().forEach((function(e){q.SUPPORTED_EXTENSIONS[e]=!0})))}var Y=function(){const e=[],t=[],i=[],r=[],o=[];let s=0;const n=new Uint16Array(3),a=new Uint16Array(3),l=new Uint16Array(3),c=u.vec3(),h=u.vec3(),d=u.vec3(),p=u.vec3(),m=u.vec3(),f=u.vec3(),g=u.vec3();return function(b,_,v,x){!function(o,s){const n={};let a,l,c,h;const d=Math.pow(10,4);let u,p,m=0;for(u=0,p=o.length;u<p;u+=3)a=o[u],l=o[u+1],c=o[u+2],void 0===n[h=Math.round(a*d)+"_"+Math.round(l*d)+"_"+Math.round(c*d)]&&(n[h]=m/3,e[m++]=a,e[m++]=l,e[m++]=c),t[u/3]=n[h];for(u=0,p=s.length;u<p;u++)r[u]=t[s[u]],i[r[u]]=s[u]}(b,_),function(t,i){s=0;for(let b=0,_=t;b<_;b+=3){const t=3*r[b],_=3*r[b+1],v=3*r[b+2];i?(n[0]=e[t],n[1]=e[t+1],n[2]=e[t+2],a[0]=e[_],a[1]=e[_+1],a[2]=e[_+2],l[0]=e[v],l[1]=e[v+1],l[2]=e[v+2],u.decompressPosition(n,i,c),u.decompressPosition(a,i,h),u.decompressPosition(l,i,d)):(c[0]=e[t],c[1]=e[t+1],c[2]=e[t+2],h[0]=e[_],h[1]=e[_+1],h[2]=e[_+2],d[0]=e[v],d[1]=e[v+1],d[2]=e[v+2]),u.subVec3(d,h,p),u.subVec3(c,h,m),u.cross3Vec3(p,m,f),u.normalizeVec3(f,g);const x=o[s]||(o[s]={normal:u.vec3()});x.normal[0]=g[0],x.normal[1]=g[1],x.normal[2]=g[2],s++}}(_.length,v);const y=[],w=Math.cos(u.DEGTORAD*x),M={};let k,P,E,A,C,T,D,S,L,R,I,N=!1;for(let e=0,t=_.length;e<t;e+=3){const t=e/3;for(let i=0;i<3;i++)k=r[e+i],P=r[e+(i+1)%3],void 0===M[C=(E=Math.min(k,P))+","+(A=Math.max(k,P))]?M[C]={index1:E,index2:A,face1:t,face2:void 0}:M[C].face2=t}for(C in M)void 0!==(T=M[C]).face2&&(D=o[T.face1].normal,S=o[T.face2].normal,(L=u.dotVec3(D,S))>w)||(R=i[T.index1],I=i[T.index2],(!N&&R>65535||I>65535)&&(N=!0),y.push(R),y.push(I));return N?new Uint32Array(y):new Uint16Array(y)}}();function K(e,t,i,r){let o=e[t]/(Math.abs(e[t])+Math.abs(e[t+1])+Math.abs(e[t+2])),s=e[t+1]/(Math.abs(e[t])+Math.abs(e[t+1])+Math.abs(e[t+2]));if(e[t+2]<0){let e=(1-Math.abs(s))*(o>=0?1:-1),t=(1-Math.abs(o))*(s>=0?1:-1);o=e,s=t}return new Int8Array([Math[i](127.5*o+(o<0?-1:0)),Math[r](127.5*s+(s<0?-1:0))])}function Q(e){let t=e[0],i=e[1];t/=t<0?127:128,i/=i<0?127:128;const r=1-Math.abs(t)-Math.abs(i);r<0&&(t=(1-Math.abs(i))*(t>=0?1:-1),i=(1-Math.abs(t))*(i>=0?1:-1));const o=Math.sqrt(t*t+i*i+r*r);return[t/o,i/o,r/o]}function Z(e,t,i){return e[t]*i[0]+e[t+1]*i[1]+e[t+2]*i[2]}const J={getPositionsBounds:function(e){const t=new Float32Array(3),i=new Float32Array(3);let r,o;for(r=0;r<3;r++)t[r]=Number.MAX_VALUE,i[r]=-Number.MAX_VALUE;for(r=0;r<e.length;r+=3)for(o=0;o<3;o++)t[o]=Math.min(t[o],e[r+o]),i[o]=Math.max(i[o],e[r+o]);return{min:t,max:i}},compressPositions:function(){const e=u.mat4(),t=u.mat4();return function(i,r,o){const s=new Uint16Array(i.length);var n=new Float32Array([o[0]!==r[0]?65535/(o[0]-r[0]):0,o[1]!==r[1]?65535/(o[1]-r[1]):0,o[2]!==r[2]?65535/(o[2]-r[2]):0]);let a;for(a=0;a<i.length;a+=3)s[a+0]=Math.floor((i[a+0]-r[0])*n[0]),s[a+1]=Math.floor((i[a+1]-r[1])*n[1]),s[a+2]=Math.floor((i[a+2]-r[2])*n[2]);return u.identityMat4(e),u.translationMat4v(r,e),u.identityMat4(t),u.scalingMat4v([(o[0]-r[0])/65535,(o[1]-r[1])/65535,(o[2]-r[2])/65535],t),{quantized:s,decodeMatrix:u.mulMat4(e,t,u.identityMat4())}}}(),decompressPositions:function(e,t,i=new Float32Array(e.length)){for(let r=0,o=e.length;r<o;r+=3)i[r+0]=e[r+0]*t[0]+t[12],i[r+1]=e[r+1]*t[5]+t[13],i[r+2]=e[r+2]*t[10]+t[14];return i},decompressPosition:function(e,t,i){return i[0]=e[0]*t[0]+t[12],i[1]=e[1]*t[5]+t[13],i[2]=e[2]*t[10]+t[14],i},decompressAABB:function(e,t,i=e){return i[0]=e[0]*t[0]+t[12],i[1]=e[1]*t[5]+t[13],i[2]=e[2]*t[10]+t[14],i[3]=e[3]*t[0]+t[12],i[4]=e[4]*t[5]+t[13],i[5]=e[5]*t[10]+t[14],i},getUVBounds:function(e){const t=new Float32Array(2),i=new Float32Array(2);let r,o;for(r=0;r<2;r++)t[r]=Number.MAX_VALUE,i[r]=-Number.MAX_VALUE;for(r=0;r<e.length;r+=2)for(o=0;o<2;o++)t[o]=Math.min(t[o],e[r+o]),i[o]=Math.max(i[o],e[r+o]);return{min:t,max:i}},compressUVs:function(){const e=u.mat3(),t=u.mat3();return function(i,r,o){const s=new Uint16Array(i.length),n=new Float32Array([65535/(o[0]-r[0]),65535/(o[1]-r[1])]);let a;for(a=0;a<i.length;a+=2)s[a+0]=Math.floor((i[a+0]-r[0])*n[0]),s[a+1]=Math.floor((i[a+1]-r[1])*n[1]);return u.identityMat3(e),u.translationMat3v(r,e),u.identityMat3(t),u.scalingMat3v([(o[0]-r[0])/65535,(o[1]-r[1])/65535],t),{quantized:s,decodeMatrix:u.mulMat3(e,t,u.identityMat3())}}}(),decompressUVs:function(e,t,i=new Float32Array(e.length)){for(let r=0,o=e.length;r<o;r+=3)i[r+0]=e[r+0]*t[0]+t[6],i[r+1]=e[r+1]*t[4]+t[7];return i},decompressUV:function(e,t,i){i[0]=e[0]*t[0]+t[6],i[1]=e[1]*t[4]+t[7]},compressNormals:function(e){const t=new Int8Array(e.length);let i,r,o,s,n;for(let a=0;a<e.length;a+=3)o=i=K(e,a,"floor","floor"),s=n=Z(e,a,r=Q(i)),(s=Z(e,a,r=Q(i=K(e,a,"ceil","floor"))))>n&&(o=i,n=s),(s=Z(e,a,r=Q(i=K(e,a,"floor","ceil"))))>n&&(o=i,n=s),(s=Z(e,a,r=Q(i=K(e,a,"ceil","ceil"))))>n&&(o=i,n=s),t[a]=o[0],t[a+1]=o[1];return t},decompressNormals:function(e,t){for(let i=0,r=0,o=e.length;i<o;i+=2){let o=e[i+0],s=e[i+1];o=(2*o+1)/255,s=(2*s+1)/255;const n=1-Math.abs(o)-Math.abs(s);n<0&&(o=(1-Math.abs(s))*(o>=0?1:-1),s=(1-Math.abs(o))*(s>=0?1:-1));const a=Math.sqrt(o*o+s*s+n*n);t[r+0]=o/a,t[r+1]=s/a,t[r+2]=n/a,r+=3}return t},decompressNormal:function(e,t){let i=e[0],r=e[1];i=(2*i+1)/255,r=(2*r+1)/255;const o=1-Math.abs(i)-Math.abs(r);o<0&&(i=(1-Math.abs(r))*(i>=0?1:-1),r=(1-Math.abs(i))*(r>=0?1:-1));const s=Math.sqrt(i*i+r*r+o*o);return t[0]=i/s,t[1]=r/s,t[2]=o/s,t}},ee=P.memory,te=q.SUPPORTED_EXTENSIONS.OES_element_index_uint,ie=te?Uint32Array:Uint16Array,re=u.AABB3();class oe extends G{get type(){return"ReadableGeometry"}get isReadableGeometry(){return!0}constructor(e,t={}){super(e,t),this._state=new j({compressGeometry:!!t.compressGeometry,primitive:null,primitiveName:null,positions:null,normals:null,colors:null,uv:null,indices:null,positionsDecodeMatrix:null,uvDecodeMatrix:null,positionsBuf:null,normalsBuf:null,colorsbuf:null,uvBuf:null,indicesBuf:null,hash:""}),this._edgeThreshold=t.edgeThreshold||10,this._edgeIndicesBuf=null,this._pickTrianglePositionsBuf=null,this._pickTriangleColorsBuf=null,this._aabbDirty=!0,this._boundingSphere=!0,this._aabb=null,this._aabbDirty=!0,this._obb=null,this._obbDirty=!0;const i=this._state,r=this.scene.canvas.gl;switch(t.primitive=t.primitive||"triangles",t.primitive){case"points":i.primitive=r.POINTS,i.primitiveName=t.primitive;break;case"lines":i.primitive=r.LINES,i.primitiveName=t.primitive;break;case"line-loop":i.primitive=r.LINE_LOOP,i.primitiveName=t.primitive;break;case"line-strip":i.primitive=r.LINE_STRIP,i.primitiveName=t.primitive;break;case"triangles":i.primitive=r.TRIANGLES,i.primitiveName=t.primitive;break;case"triangle-strip":i.primitive=r.TRIANGLE_STRIP,i.primitiveName=t.primitive;break;case"triangle-fan":i.primitive=r.TRIANGLE_FAN,i.primitiveName=t.primitive;break;default:this.error("Unsupported value for 'primitive': '"+t.primitive+"' - supported values are 'points', 'lines', 'line-loop', 'line-strip', 'triangles', 'triangle-strip' and 'triangle-fan'. Defaulting to 'triangles'."),i.primitive=r.TRIANGLES,i.primitiveName=t.primitive}if(t.positions)if(this._state.compressGeometry){const e=J.getPositionsBounds(t.positions),r=J.compressPositions(t.positions,e.min,e.max);i.positions=r.quantized,i.positionsDecodeMatrix=r.decodeMatrix}else i.positions=t.positions.constructor===Float32Array?t.positions:new Float32Array(t.positions);if(t.colors&&(i.colors=t.colors.constructor===Float32Array?t.colors:new Float32Array(t.colors)),t.uv)if(this._state.compressGeometry){const e=J.getUVBounds(t.uv),r=J.compressUVs(t.uv,e.min,e.max);i.uv=r.quantized,i.uvDecodeMatrix=r.decodeMatrix}else i.uv=t.uv.constructor===Float32Array?t.uv:new Float32Array(t.uv);if(t.normals&&(this._state.compressGeometry?i.normals=J.compressNormals(t.normals):i.normals=t.normals.constructor===Float32Array?t.normals:new Float32Array(t.normals)),t.indices){if(!te&&t.indices.constructor===Uint32Array)return void this.error("This WebGL implementation does not support Uint32Array");i.indices=t.indices.constructor===Uint32Array||t.indices.constructor===Uint16Array?t.indices:new ie(t.indices)}this._buildHash(),ee.meshes++,this._buildVBOs()}_buildVBOs(){const e=this._state,t=this.scene.canvas.gl;if(e.indices&&(e.indicesBuf=new W(t,t.ELEMENT_ARRAY_BUFFER,e.indices,e.indices.length,1,t.STATIC_DRAW),ee.indices+=e.indicesBuf.numItems),e.positions&&(e.positionsBuf=new W(t,t.ARRAY_BUFFER,e.positions,e.positions.length,3,t.STATIC_DRAW),ee.positions+=e.positionsBuf.numItems),e.normals){let i=e.compressGeometry;e.normalsBuf=new W(t,t.ARRAY_BUFFER,e.normals,e.normals.length,3,t.STATIC_DRAW,i),ee.normals+=e.normalsBuf.numItems}e.colors&&(e.colorsBuf=new W(t,t.ARRAY_BUFFER,e.colors,e.colors.length,4,t.STATIC_DRAW),ee.colors+=e.colorsBuf.numItems),e.uv&&(e.uvBuf=new W(t,t.ARRAY_BUFFER,e.uv,e.uv.length,2,t.STATIC_DRAW),ee.uvs+=e.uvBuf.numItems)}_buildHash(){const e=this._state,t=["/g"];t.push("/"+e.primitive+";"),e.positions&&t.push("p"),e.colors&&t.push("c"),(e.normals||e.autoVertexNormals)&&t.push("n"),e.uv&&t.push("u"),e.compressGeometry&&t.push("cp"),t.push(";"),e.hash=t.join("")}_getEdgeIndices(){return this._edgeIndicesBuf||this._buildEdgeIndices(),this._edgeIndicesBuf}_getPickTrianglePositions(){return this._pickTrianglePositionsBuf||this._buildPickTriangleVBOs(),this._pickTrianglePositionsBuf}_getPickTriangleColors(){return this._pickTriangleColorsBuf||this._buildPickTriangleVBOs(),this._pickTriangleColorsBuf}_buildEdgeIndices(){const e=this._state;if(!e.positions||!e.indices)return;const t=this.scene.canvas.gl,i=Y(e.positions,e.indices,e.positionsDecodeMatrix,this._edgeThreshold);this._edgeIndicesBuf=new W(t,t.ELEMENT_ARRAY_BUFFER,i,i.length,1,t.STATIC_DRAW),ee.indices+=this._edgeIndicesBuf.numItems}_buildPickTriangleVBOs(){const e=this._state;if(!e.positions||!e.indices)return;const t=this.scene.canvas.gl,i=u.buildPickTriangles(e.positions,e.indices,e.compressGeometry),r=i.positions,o=i.colors;this._pickTrianglePositionsBuf=new W(t,t.ARRAY_BUFFER,r,r.length,3,t.STATIC_DRAW),this._pickTriangleColorsBuf=new W(t,t.ARRAY_BUFFER,o,o.length,4,t.STATIC_DRAW,!0),ee.positions+=this._pickTrianglePositionsBuf.numItems,ee.colors+=this._pickTriangleColorsBuf.numItems}_buildPickVertexVBOs(){}_webglContextLost(){this._sceneVertexBufs&&this._sceneVertexBufs.webglContextLost()}_webglContextRestored(){this._sceneVertexBufs&&this._sceneVertexBufs.webglContextRestored(),this._buildVBOs(),this._edgeIndicesBuf=null,this._pickVertexPositionsBuf=null,this._pickTrianglePositionsBuf=null,this._pickTriangleColorsBuf=null,this._pickVertexPositionsBuf=null,this._pickVertexColorsBuf=null}get primitive(){return this._state.primitiveName}get compressGeometry(){return this._state.compressGeometry}get positions(){return this._state.positions?this._state.compressGeometry?(this._decompressedPositions||(this._decompressedPositions=new Float32Array(this._state.positions.length),J.decompressPositions(this._state.positions,this._state.positionsDecodeMatrix,this._decompressedPositions)),this._decompressedPositions):this._state.positions:null}set positions(e){const t=this._state,i=t.positions;if(i)if(i.length===e.length){if(this._state.compressGeometry){const i=J.getPositionsBounds(e),r=J.compressPositions(e,i.min,i.max);e=r.quantized,t.positionsDecodeMatrix=r.decodeMatrix}i.set(e),t.positionsBuf&&t.positionsBuf.setData(i),this._setAABBDirty(),this.glRedraw()}else this.error("can't update geometry positions - new positions are wrong length");else this.error("can't update geometry positions - geometry has no positions")}get normals(){if(this._state.normals){if(!this._state.compressGeometry)return this._state.normals;if(!this._decompressedNormals){const e=this._state.normals.length,t=e+e/2;this._decompressedNormals=new Float32Array(t),J.decompressNormals(this._state.normals,this._decompressedNormals)}return this._decompressedNormals}}set normals(e){if(this._state.compressGeometry)return void this.error("can't update geometry normals - quantized geometry is immutable");const t=this._state,i=t.normals;i?i.length===e.length?(i.set(e),t.normalsBuf&&t.normalsBuf.setData(i),this.glRedraw()):this.error("can't update geometry normals - new normals are wrong length"):this.error("can't update geometry normals - geometry has no normals")}get uv(){return this._state.uv?this._state.compressGeometry?(this._decompressedUV||(this._decompressedUV=new Float32Array(this._state.uv.length),J.decompressUVs(this._state.uv,this._state.uvDecodeMatrix,this._decompressedUV)),this._decompressedUV):this._state.uv:null}set uv(e){if(this._state.compressGeometry)return void this.error("can't update geometry UVs - quantized geometry is immutable");const t=this._state,i=t.uv;i?i.length===e.length?(i.set(e),t.uvBuf&&t.uvBuf.setData(i),this.glRedraw()):this.error("can't update geometry UVs - new UVs are wrong length"):this.error("can't update geometry UVs - geometry has no UVs")}get colors(){return this._state.colors}set colors(e){if(this._state.compressGeometry)return void this.error("can't update geometry colors - quantized geometry is immutable");const t=this._state,i=t.colors;i?i.length===e.length?(i.set(e),t.colorsBuf&&t.colorsBuf.setData(i),this.glRedraw()):this.error("can't update geometry colors - new colors are wrong length"):this.error("can't update geometry colors - geometry has no colors")}get indices(){return this._state.indices}get aabb(){return this._aabbDirty&&(this._aabb||(this._aabb=u.AABB3()),u.positions3ToAABB3(this._state.positions,this._aabb,this._state.positionsDecodeMatrix),this._aabbDirty=!1),this._aabb}get obb(){return this._obbDirty&&(this._obb||(this._obb=u.OBB3()),u.positions3ToAABB3(this._state.positions,re,this._state.positionsDecodeMatrix),u.AABB3ToOBB3(re,this._obb),this._obbDirty=!1),this._obb}_setAABBDirty(){this._aabbDirty||(this._aabbDirty=!0,this._aabbDirty=!0,this._obbDirty=!0)}_getState(){return this._state}destroy(){super.destroy();const e=this._state;e.indicesBuf&&e.indicesBuf.destroy(),e.positionsBuf&&e.positionsBuf.destroy(),e.normalsBuf&&e.normalsBuf.destroy(),e.uvBuf&&e.uvBuf.destroy(),e.colorsBuf&&e.colorsBuf.destroy(),this._edgeIndicesBuf&&this._edgeIndicesBuf.destroy(),this._pickTrianglePositionsBuf&&this._pickTrianglePositionsBuf.destroy(),this._pickTriangleColorsBuf&&this._pickTriangleColorsBuf.destroy(),this._pickVertexPositionsBuf&&this._pickVertexPositionsBuf.destroy(),this._pickVertexColorsBuf&&this._pickVertexColorsBuf.destroy(),e.destroy(),ee.meshes--}}class se extends B{get type(){return"Material"}constructor(e,t={}){super(e,t),P.memory.materials++}destroy(){super.destroy(),P.memory.materials--}}const ne={opaque:0,mask:1,blend:2},ae=["opaque","mask","blend"];class le extends se{get type(){return"PhongMaterial"}constructor(e,t={}){super(e,t),this._state=new j({type:"PhongMaterial",ambient:u.vec3([1,1,1]),diffuse:u.vec3([1,1,1]),specular:u.vec3([1,1,1]),emissive:u.vec3([0,0,0]),alpha:null,shininess:null,reflectivity:null,alphaMode:null,alphaCutoff:null,lineWidth:null,pointSize:null,backfaces:null,frontface:null,hash:null}),this.ambient=t.ambient,this.diffuse=t.diffuse,this.specular=t.specular,this.emissive=t.emissive,this.alpha=t.alpha,this.shininess=t.shininess,this.reflectivity=t.reflectivity,this.lineWidth=t.lineWidth,this.pointSize=t.pointSize,t.ambientMap&&(this._ambientMap=this._checkComponent("Texture",t.ambientMap)),t.diffuseMap&&(this._diffuseMap=this._checkComponent("Texture",t.diffuseMap)),t.specularMap&&(this._specularMap=this._checkComponent("Texture",t.specularMap)),t.emissiveMap&&(this._emissiveMap=this._checkComponent("Texture",t.emissiveMap)),t.alphaMap&&(this._alphaMap=this._checkComponent("Texture",t.alphaMap)),t.reflectivityMap&&(this._reflectivityMap=this._checkComponent("Texture",t.reflectivityMap)),t.normalMap&&(this._normalMap=this._checkComponent("Texture",t.normalMap)),t.occlusionMap&&(this._occlusionMap=this._checkComponent("Texture",t.occlusionMap)),t.diffuseFresnel&&(this._diffuseFresnel=this._checkComponent("Fresnel",t.diffuseFresnel)),t.specularFresnel&&(this._specularFresnel=this._checkComponent("Fresnel",t.specularFresnel)),t.emissiveFresnel&&(this._emissiveFresnel=this._checkComponent("Fresnel",t.emissiveFresnel)),t.alphaFresnel&&(this._alphaFresnel=this._checkComponent("Fresnel",t.alphaFresnel)),t.reflectivityFresnel&&(this._reflectivityFresnel=this._checkComponent("Fresnel",t.reflectivityFresnel)),this.alphaMode=t.alphaMode,this.alphaCutoff=t.alphaCutoff,this.backfaces=t.backfaces,this.frontface=t.frontface,this._makeHash()}_makeHash(){const e=this._state,t=["/p"];this._normalMap&&(t.push("/nm"),this._normalMap.hasMatrix&&t.push("/mat")),this._ambientMap&&(t.push("/am"),this._ambientMap.hasMatrix&&t.push("/mat"),t.push("/"+this._ambientMap.encoding)),this._diffuseMap&&(t.push("/dm"),this._diffuseMap.hasMatrix&&t.push("/mat"),t.push("/"+this._diffuseMap.encoding)),this._specularMap&&(t.push("/sm"),this._specularMap.hasMatrix&&t.push("/mat")),this._emissiveMap&&(t.push("/em"),this._emissiveMap.hasMatrix&&t.push("/mat"),t.push("/"+this._emissiveMap.encoding)),this._alphaMap&&(t.push("/opm"),this._alphaMap.hasMatrix&&t.push("/mat")),this._reflectivityMap&&(t.push("/rm"),this._reflectivityMap.hasMatrix&&t.push("/mat")),this._occlusionMap&&(t.push("/ocm"),this._occlusionMap.hasMatrix&&t.push("/mat")),this._diffuseFresnel&&t.push("/df"),this._specularFresnel&&t.push("/sf"),this._emissiveFresnel&&t.push("/ef"),this._alphaFresnel&&t.push("/of"),this._reflectivityFresnel&&t.push("/rf"),t.push(";"),e.hash=t.join("")}set ambient(e){let t=this._state.ambient;if(t){if(e&&t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2])return}else t=this._state.ambient=new Float32Array(3);e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):(t[0]=.2,t[1]=.2,t[2]=.2),this.glRedraw()}get ambient(){return this._state.ambient}set diffuse(e){let t=this._state.diffuse;if(t){if(e&&t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2])return}else t=this._state.diffuse=new Float32Array(3);e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):(t[0]=1,t[1]=1,t[2]=1),this.glRedraw()}get diffuse(){return this._state.diffuse}set specular(e){let t=this._state.specular;if(t){if(e&&t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2])return}else t=this._state.specular=new Float32Array(3);e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):(t[0]=1,t[1]=1,t[2]=1),this.glRedraw()}get specular(){return this._state.specular}set emissive(e){let t=this._state.emissive;if(t){if(e&&t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2])return}else t=this._state.emissive=new Float32Array(3);e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):(t[0]=0,t[1]=0,t[2]=0),this.glRedraw()}get emissive(){return this._state.emissive}set alpha(e){e=null!=e?e:1,this._state.alpha!==e&&(this._state.alpha=e,this.glRedraw())}get alpha(){return this._state.alpha}set shininess(e){this._state.shininess=void 0!==e?e:80,this.glRedraw()}get shininess(){return this._state.shininess}set lineWidth(e){this._state.lineWidth=e||1,this.glRedraw()}get lineWidth(){return this._state.lineWidth}set pointSize(e){this._state.pointSize=e||1,this.glRedraw()}get pointSize(){return this._state.pointSize}set reflectivity(e){this._state.reflectivity=void 0!==e?e:1,this.glRedraw()}get reflectivity(){return this._state.reflectivity}get normalMap(){return this._normalMap}get ambientMap(){return this._ambientMap}get diffuseMap(){return this._diffuseMap}get specularMap(){return this._specularMap}get emissiveMap(){return this._emissiveMap}get alphaMap(){return this._alphaMap}get reflectivityMap(){return this._reflectivityMap}get occlusionMap(){return this._occlusionMap}get diffuseFresnel(){return this._diffuseFresnel}get specularFresnel(){return this._specularFresnel}get emissiveFresnel(){return this._emissiveFresnel}get alphaFresnel(){return this._alphaFresnel}get reflectivityFresnel(){return this._reflectivityFresnel}set alphaMode(e){let t=ne[e=e||"opaque"];void 0===t&&(this.error("Unsupported value for 'alphaMode': "+e+" - defaulting to 'opaque'"),t="opaque"),this._state.alphaMode!==t&&(this._state.alphaMode=t,this.glRedraw())}get alphaMode(){return ae[this._state.alphaMode]}set alphaCutoff(e){null==e&&(e=.5),this._state.alphaCutoff!==e&&(this._state.alphaCutoff=e)}get alphaCutoff(){return this._state.alphaCutoff}set backfaces(e){e=!!e,this._state.backfaces!==e&&(this._state.backfaces=e,this.glRedraw())}get backfaces(){return this._state.backfaces}set frontface(e){e="cw"!==e,this._state.frontface!==e&&(this._state.frontface=e,this.glRedraw())}get frontface(){return this._state.frontface?"ccw":"cw"}destroy(){super.destroy(),this._state.destroy()}}const ce={default:{fill:!0,fillColor:[.4,.4,.4],fillAlpha:.2,edges:!0,edgeColor:[.2,.2,.2],edgeAlpha:.5,edgeWidth:1},defaultWhiteBG:{fill:!0,fillColor:[1,1,1],fillAlpha:.6,edgeColor:[.2,.2,.2],edgeAlpha:1,edgeWidth:1},defaultLightBG:{fill:!0,fillColor:[.4,.4,.4],fillAlpha:.2,edges:!0,edgeColor:[.2,.2,.2],edgeAlpha:.5,edgeWidth:1},defaultDarkBG:{fill:!0,fillColor:[.4,.4,.4],fillAlpha:.2,edges:!0,edgeColor:[.5,.5,.5],edgeAlpha:.5,edgeWidth:1},phosphorous:{fill:!0,fillColor:[0,0,0],fillAlpha:.4,edges:!0,edgeColor:[.9,.9,.9],edgeAlpha:.5,edgeWidth:2},sunset:{fill:!0,fillColor:[.9,.9,.6],fillAlpha:.2,edges:!0,edgeColor:[.9,.9,.9],edgeAlpha:.5,edgeWidth:1},vectorscope:{fill:!0,fillColor:[0,0,0],fillAlpha:.7,edges:!0,edgeColor:[.2,1,.2],edgeAlpha:1,edgeWidth:2},battlezone:{fill:!0,fillColor:[0,0,0],fillAlpha:1,edges:!0,edgeColor:[.2,1,.2],edgeAlpha:1,edgeWidth:3},sepia:{fill:!0,fillColor:[.970588207244873,.7965892553329468,.6660899519920349],fillAlpha:.4,edges:!0,edgeColor:[.529411792755127,.4577854573726654,.4100345969200134],edgeAlpha:1,edgeWidth:1},yellowHighlight:{fill:!0,fillColor:[1,1,0],fillAlpha:.5,edges:!0,edgeColor:[.529411792755127,.4577854573726654,.4100345969200134],edgeAlpha:1,edgeWidth:1},greenSelected:{fill:!0,fillColor:[0,1,0],fillAlpha:.5,edges:!0,edgeColor:[.4577854573726654,.529411792755127,.4100345969200134],edgeAlpha:1,edgeWidth:1},gamegrid:{fill:!0,fillColor:[.2,.2,.7],fillAlpha:.9,edges:!0,edgeColor:[.4,.4,1.6],edgeAlpha:.8,edgeWidth:3}};class he extends se{get type(){return"EmphasisMaterial"}get presets(){return ce}constructor(e,t={}){super(e,t),this._state=new j({type:"EmphasisMaterial",fill:null,fillColor:null,fillAlpha:null,edges:null,edgeColor:null,edgeAlpha:null,edgeWidth:null,backfaces:!0}),this._preset="default",t.preset?(this.preset=t.preset,void 0!==t.fill&&(this.fill=t.fill),t.fillColor&&(this.fillColor=t.fillColor),void 0!==t.fillAlpha&&(this.fillAlpha=t.fillAlpha),void 0!==t.edges&&(this.edges=t.edges),t.edgeColor&&(this.edgeColor=t.edgeColor),void 0!==t.edgeAlpha&&(this.edgeAlpha=t.edgeAlpha),void 0!==t.edgeWidth&&(this.edgeWidth=t.edgeWidth),void 0!==t.backfaces&&(this.backfaces=t.backfaces)):(this.fill=t.fill,this.fillColor=t.fillColor,this.fillAlpha=t.fillAlpha,this.edges=t.edges,this.edgeColor=t.edgeColor,this.edgeAlpha=t.edgeAlpha,this.edgeWidth=t.edgeWidth,this.backfaces=t.backfaces)}set fill(e){e=!1!==e,this._state.fill!==e&&(this._state.fill=e,this.glRedraw())}get fill(){return this._state.fill}set fillColor(e){let t=this._state.fillColor;if(t){if(e&&t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2])return}else t=this._state.fillColor=new Float32Array(3);e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):(t[0]=.4,t[1]=.4,t[2]=.4),this.glRedraw()}get fillColor(){return this._state.fillColor}set fillAlpha(e){e=null!=e?e:.2,this._state.fillAlpha!==e&&(this._state.fillAlpha=e,this.glRedraw())}get fillAlpha(){return this._state.fillAlpha}set edges(e){e=!1!==e,this._state.edges!==e&&(this._state.edges=e,this.glRedraw())}get edges(){return this._state.edges}set edgeColor(e){let t=this._state.edgeColor;if(t){if(e&&t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2])return}else t=this._state.edgeColor=new Float32Array(3);e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):(t[0]=.2,t[1]=.2,t[2]=.2),this.glRedraw()}get edgeColor(){return this._state.edgeColor}set edgeAlpha(e){e=null!=e?e:.5,this._state.edgeAlpha!==e&&(this._state.edgeAlpha=e,this.glRedraw())}get edgeAlpha(){return this._state.edgeAlpha}set edgeWidth(e){this._state.edgeWidth=e||1,this.glRedraw()}get edgeWidth(){return this._state.edgeWidth}set backfaces(e){e=!!e,this._state.backfaces!==e&&(this._state.backfaces=e,this.glRedraw())}get backfaces(){return this._state.backfaces}set preset(e){if(e=e||"default",this._preset===e)return;const t=ce[e];t?(this.fill=t.fill,this.fillColor=t.fillColor,this.fillAlpha=t.fillAlpha,this.edges=t.edges,this.edgeColor=t.edgeColor,this.edgeAlpha=t.edgeAlpha,this.edgeWidth=t.edgeWidth,this._preset=e):this.error("unsupported preset: '"+e+"' - supported values are "+Object.keys(ce).join(", "))}get preset(){return this._preset}destroy(){super.destroy(),this._state.destroy()}}const de=new Float32Array(4),ue=new Float32Array(4),pe=new Float32Array(4),me=new Float32Array([1,0,0]),fe=new Float32Array([0,1,0]),ge=new Float32Array([0,0,1]),be=new Float32Array(3),_e=new Float32Array(3),ve=u.identityMat4();class xe extends B{constructor(e,t={}){if(super(e,t),this._parentNode=null,this._children=[],this._aabb=null,this._aabbDirty=!0,this.scene._aabbDirty=!0,this._scale=u.vec3(),this._quaternion=u.identityQuaternion(),this._rotation=u.vec3(),this._position=u.vec3(),this._localMatrix=u.identityMat4(),this._worldMatrix=u.identityMat4(),this._localMatrixDirty=!0,this._worldMatrixDirty=!0,t.matrix?this.matrix=t.matrix:(this.scale=t.scale,this.position=t.position,t.quaternion||(this.rotation=t.rotation)),this._isModel=t.isModel,this._isModel&&this.scene._registerModel(this),this._isObject=t.isObject,this._isObject&&this.scene._registerObject(this),this.visible=t.visible,this.culled=t.culled,this.pickable=t.pickable,this.clippable=t.clippable,this.collidable=t.collidable,this.castsShadow=t.castsShadow,this.receivesShadow=t.receivesShadow,this.xrayed=t.xrayed,this.highlighted=t.highlighted,this.selected=t.selected,this.edges=t.edges,this.colorize=t.colorize,this.opacity=t.opacity,t.children){const e=t.children;for(let i=0,r=e.length;i<r;i++)this.addChild(e[i],t.inheritStates)}if(t.parentId){const e=this.scene.components[t.parentId];e?e.isNode?e.addChild(this):this.error("Parent is not a Node: '"+t.parentId+"'"):this.error("Parent not found: '"+t.parentId+"'")}else t.parent&&(t.parent.isNode||this.error("Parent is not a Node"),t.parent.addChild(this))}get isEntity(){return!0}get isModel(){return this._isModel}get isObject(){return this._isObject}get aabb(){return this._aabbDirty&&this._updateAABB(),this._aabb}set visible(e){e=!1!==e,this._visible=e;for(let t=0,i=this._children.length;t<i;t++)this._children[t].visible=e;this._isObject&&this.scene._objectVisibilityUpdated(this,e)}get visible(){return this._visible}set xrayed(e){e=!!e,this._xrayed=e;for(let t=0,i=this._children.length;t<i;t++)this._children[t].xrayed=e;this._isObject&&this.scene._objectXRayedUpdated(this,e)}get xrayed(){return this._xrayed}set highlighted(e){e=!!e,this._highlighted=e;for(let t=0,i=this._children.length;t<i;t++)this._children[t].highlighted=e;this._isObject&&this.scene._objectHighlightedUpdated(this,e)}get highlighted(){return this._highlighted}set selected(e){e=!!e,this._selected=e;for(let t=0,i=this._children.length;t<i;t++)this._children[t].selected=e;this._isObject&&this.scene._objectSelectedUpdated(this,e)}get selected(){return this._selected}set edges(e){e=!!e,this._edges=e;for(let t=0,i=this._children.length;t<i;t++)this._children[t].edges=e}get edges(){return this._edges}set culled(e){e=!!e,this._culled=e;for(let t=0,i=this._children.length;t<i;t++)this._children[t].culled=e}get culled(){return this._culled}set clippable(e){e=!1!==e,this._clippable=e;for(let t=0,i=this._children.length;t<i;t++)this._children[t].clippable=e}get clippable(){return this._clippable}set collidable(e){e=!1!==e,this._collidable=e;for(let t=0,i=this._children.length;t<i;t++)this._children[t].collidable=e}get collidable(){return this._collidable}set pickable(e){e=!1!==e,this._pickable=e;for(let t=0,i=this._children.length;t<i;t++)this._children[t].pickable=e}get pickable(){return this._pickable}set colorize(e){let t=this._colorize;t||((t=this._colorize=new Float32Array(4))[3]=1),e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):(t[0]=1,t[1]=1,t[2]=1);for(let e=0,i=this._children.length;e<i;e++)this._children[e].colorize=t}get colorize(){return this._colorize.slice(0,3)}set opacity(e){let t=this._colorize;t||((t=this._colorize=new Float32Array(4))[0]=1,t[1]=1,t[2]=1),t[3]=null!=e?e:1;for(let t=0,i=this._children.length;t<i;t++)this._children[t].opacity=e}get opacity(){return this._colorize[3]}set castsShadow(e){e=!!e,this._castsShadow=e;for(let t=0,i=this._children.length;t<i;t++)this._children[t].castsShadow=e}get castsShadow(){return this._castsShadow}set receivesShadow(e){e=!!e,this._receivesShadow=e;for(let t=0,i=this._children.length;t<i;t++)this._children[t].receivesShadow=e}get receivesShadow(){return this._receivesShadow}get isNode(){return!0}_setLocalMatrixDirty(){this._localMatrixDirty=!0,this._setWorldMatrixDirty()}_setWorldMatrixDirty(){this._worldMatrixDirty=!0;for(let e=0,t=this._children.length;e<t;e++)this._children[e]._setWorldMatrixDirty()}_buildWorldMatrix(){const e=this.matrix;if(this._parentNode)u.mulMat4(this._parentNode.worldMatrix,e,this._worldMatrix);else for(let t=0,i=e.length;t<i;t++)this._worldMatrix[t]=e[t];this._worldMatrixDirty=!1}_setSubtreeAABBsDirty(e){if(e._aabbDirty=!0,e._children)for(let t=0,i=e._children.length;t<i;t++)this._setSubtreeAABBsDirty(e._children[t])}_setAABBDirty(){if(this._setSubtreeAABBsDirty(this),this.collidable)for(let e=this;e;e=e._parentNode)e._aabbDirty=!0}_updateAABB(){if(this.scene._aabbDirty=!0,this._aabb||(this._aabb=u.AABB3()),this._buildAABB)this._buildAABB(this.worldMatrix,this._aabb);else{let e;u.collapseAABB3(this._aabb);for(let t=0,i=this._children.length;t<i;t++)(e=this._children[t]).collidable&&u.expandAABB3(this._aabb,e.aabb)}this._aabbDirty=!1}addChild(e,t){if(s.isNumeric(e)||s.isString(e)){const t=e;if(!(e=this.scene.component[t]))return void this.warn("Component not found: "+s.inQuotes(t));if(!e.isNode&&!e.isMesh)return void this.error("Not a Node or Mesh: "+t)}else{if(!e.isNode&&!e.isMesh)return void this.error("Not a Node or Mesh: "+e.id);if(e._parentNode){if(e._parentNode.id===this.id)return void this.warn("Already a child: "+e.id);e._parentNode.removeChild(e)}}e.id;if(e.scene.id===this.scene.id)return this._children.push(e),e._parentNode=this,t&&(e.visible=this.visible,e.culled=this.culled,e.xrayed=this.xrayed,e.highlited=this.highlighted,e.selected=this.selected,e.edges=this.edges,e.clippable=this.clippable,e.pickable=this.pickable,e.collidable=this.collidable,e.castsShadow=this.castsShadow,e.receivesShadow=this.receivesShadow,e.colorize=this.colorize,e.opacity=this.opacity),e._setWorldMatrixDirty(),e._setAABBDirty(),e;this.error("Child not in same Scene: "+e.id)}removeChild(e){for(let t=0,i=this._children.length;t<i;t++)if(this._children[t].id===e.id)return e._parentNode=null,this._children=this._children.splice(t,1),e._setWorldMatrixDirty(),e._setAABBDirty(),void this._setAABBDirty()}removeChildren(){let e;for(let t=0,i=this._children.length;t<i;t++)(e=this._children[t])._parentNode=null,e._setWorldMatrixDirty(),e._setAABBDirty();this._children=[],this._setAABBDirty()}get numChildren(){return this._children.length}get children(){return this._children}set parent(e){if(s.isNumeric(e)||s.isString(e)){const t=e;if(!(e=this.scene.components[t]))return void this.warn("Node not found: "+s.inQuotes(t));if(!e.isNode)return void this.error("Not a Node: "+e.id)}e.scene.id===this.scene.id?this._parentNode&&this._parentNode.id===e.id?this.warn("Already a child of Node: "+e.id):e.addChild(this):this.error("Node not in same Scene: "+e.id)}get parent(){return this._parentNode}set position(e){this._position.set(e||[0,0,0]),this._setLocalMatrixDirty(),this._setAABBDirty(),this.glRedraw()}get position(){return this._position}set rotation(e){this._rotation.set(e||[0,0,0]),u.eulerToQuaternion(this._rotation,"XYZ",this._quaternion),this._setLocalMatrixDirty(),this._setAABBDirty(),this.glRedraw()}get rotation(){return this._rotation}set quaternion(e){this._quaternion.set(e||[0,0,0,1]),u.quaternionToEuler(this._quaternion,"XYZ",this._rotation),this._setLocalMatrixDirty(),this._setAABBDirty(),this.glRedraw()}get quaternion(){return this._quaternion}set scale(e){this._scale.set(e||[1,1,1]),this._setLocalMatrixDirty(),this._setAABBDirty(),this.glRedraw()}get scale(){return this._scale}set matrix(e){this._localMatrix||(this._localMatrix=u.identityMat4()),this._localMatrix.set(e||ve),u.decomposeMat4(this._localMatrix,this._position,this._quaternion,this._scale),this._localMatrixDirty=!1,this._setWorldMatrixDirty(),this._setAABBDirty(),this.glRedraw()}get matrix(){return this._localMatrixDirty&&(this._localMatrix||(this._localMatrix=u.identityMat4()),u.composeMat4(this._position,this._quaternion,this._scale,this._localMatrix),this._localMatrixDirty=!1),this._localMatrix}get worldMatrix(){return this._worldMatrixDirty&&this._buildWorldMatrix(),this._worldMatrix}rotate(e,t){return de[0]=e[0],de[1]=e[1],de[2]=e[2],de[3]=t*u.DEGTORAD,u.angleAxisToQuaternion(de,ue),u.mulQuaternions(this.quaternion,ue,pe),this.quaternion=pe,this._setLocalMatrixDirty(),this._setAABBDirty(),this.glRedraw(),this}rotateOnWorldAxis(e,t){return de[0]=e[0],de[1]=e[1],de[2]=e[2],de[3]=t*u.DEGTORAD,u.angleAxisToQuaternion(de,ue),u.mulQuaternions(ue,this.quaternion,ue),this}rotateX(e){return this.rotate(me,e)}rotateY(e){return this.rotate(fe,e)}rotateZ(e){return this.rotate(ge,e)}translate(e,t){return u.vec3ApplyQuaternion(this.quaternion,e,be),u.mulVec3Scalar(be,t,_e),u.addVec3(this.position,_e,this.position),this._setLocalMatrixDirty(),this._setAABBDirty(),this.glRedraw(),this}translateX(e){return this.translate(me,e)}translateY(e){return this.translate(fe,e)}translateZ(e){return this.translate(ge,e)}get type(){return"Node"}destroy(){if(super.destroy(),this._parentNode&&this._parentNode.removeChild(this),this._isObject&&(this.scene._deregisterObject(this),this._visible&&this.scene._objectVisibilityUpdated(this,!1),this._xrayed&&this.scene._objectXRayedUpdated(this,!1),this._selected&&this.scene._objectSelectedUpdated(this,!1),this._highlighted&&this.scene._objectHighlightedUpdated(this,!1)),this._isModel&&this.scene._deregisterModel(this),this._children.length){const e=this._children.splice();let t;for(let i=0,r=e.length;i<r;i++)(t=e[i]).destroy()}this._children=[],this._setAABBDirty(),this.scene._aabbDirty=!0}}const ye=function(e){"LambertMaterial"===e._material._state.type?(this.vertex=function(e){const t=e.scene._sectionPlanesState,i=e.scene._lightsState,r=e._geometry._state,o=e._state.billboard,s=e._state.stationary,n=t.sectionPlanes.length>0,a=!!r.compressGeometry;let l,c,h;const d=[];d.push("// Lambertian drawing vertex shader"),d.push("attribute vec3 position;"),d.push("uniform mat4 modelMatrix;"),d.push("uniform mat4 viewMatrix;"),d.push("uniform mat4 projMatrix;"),d.push("uniform vec4 colorize;"),a&&d.push("uniform mat4 positionsDecodeMatrix;");n&&d.push("varying vec4 vWorldPosition;");if(d.push("uniform vec4 lightAmbient;"),d.push("uniform vec4 materialColor;"),d.push("uniform vec3 materialEmissive;"),r.normalsBuf){for(d.push("attribute vec3 normal;"),d.push("uniform mat4 modelNormalMatrix;"),d.push("uniform mat4 viewNormalMatrix;"),l=0,c=i.lights.length;l<c;l++)"ambient"!==(h=i.lights[l]).type&&(d.push("uniform vec4 lightColor"+l+";"),"dir"===h.type&&d.push("uniform vec3 lightDir"+l+";"),"point"===h.type&&d.push("uniform vec3 lightPos"+l+";"),"spot"===h.type&&(d.push("uniform vec3 lightPos"+l+";"),d.push("uniform vec3 lightDir"+l+";")));a&&(d.push("vec3 octDecode(vec2 oct) {"),d.push("    vec3 v = vec3(oct.xy, 1.0 - abs(oct.x) - abs(oct.y));"),d.push("    if (v.z < 0.0) {"),d.push("        v.xy = (1.0 - abs(v.yx)) * vec2(v.x >= 0.0 ? 1.0 : -1.0, v.y >= 0.0 ? 1.0 : -1.0);"),d.push("    }"),d.push("    return normalize(v);"),d.push("}"))}d.push("varying vec4 vColor;"),"points"===r.primitiveName&&d.push("uniform float pointSize;");"spherical"!==o&&"cylindrical"!==o||(d.push("void billboard(inout mat4 mat) {"),d.push("   mat[0][0] = 1.0;"),d.push("   mat[0][1] = 0.0;"),d.push("   mat[0][2] = 0.0;"),"spherical"===o&&(d.push("   mat[1][0] = 0.0;"),d.push("   mat[1][1] = 1.0;"),d.push("   mat[1][2] = 0.0;")),d.push("   mat[2][0] = 0.0;"),d.push("   mat[2][1] = 0.0;"),d.push("   mat[2][2] =1.0;"),d.push("}"));d.push("void main(void) {"),d.push("vec4 localPosition = vec4(position, 1.0); "),d.push("vec4 worldPosition;"),a&&d.push("localPosition = positionsDecodeMatrix * localPosition;");r.normalsBuf&&(a?d.push("vec4 localNormal = vec4(octDecode(normal.xy), 0.0); "):d.push("vec4 localNormal = vec4(normal, 0.0); "),d.push("mat4 modelNormalMatrix2 = modelNormalMatrix;"),d.push("mat4 viewNormalMatrix2 = viewNormalMatrix;"));d.push("mat4 viewMatrix2 = viewMatrix;"),d.push("mat4 modelMatrix2 = modelMatrix;"),s&&d.push("viewMatrix2[3][0] = viewMatrix2[3][1] = viewMatrix2[3][2] = 0.0;");"spherical"===o||"cylindrical"===o?(d.push("mat4 modelViewMatrix = viewMatrix2 * modelMatrix2;"),d.push("billboard(modelMatrix2);"),d.push("billboard(viewMatrix2);"),d.push("billboard(modelViewMatrix);"),r.normalsBuf&&(d.push("mat4 modelViewNormalMatrix =  viewNormalMatrix2 * modelNormalMatrix2;"),d.push("billboard(modelNormalMatrix2);"),d.push("billboard(viewNormalMatrix2);"),d.push("billboard(modelViewNormalMatrix);")),d.push("worldPosition = modelMatrix2 * localPosition;"),d.push("vec4 viewPosition = modelViewMatrix * localPosition;")):(d.push("worldPosition = modelMatrix2 * localPosition;"),d.push("vec4 viewPosition  = viewMatrix2 * worldPosition; "));r.normalsBuf&&d.push("vec3 viewNormal = normalize((viewNormalMatrix2 * modelNormalMatrix2 * localNormal).xyz);");if(d.push("vec3 reflectedColor = vec3(0.0, 0.0, 0.0);"),d.push("vec3 viewLightDir = vec3(0.0, 0.0, -1.0);"),d.push("float lambertian = 1.0;"),r.normalsBuf)for(l=0,c=i.lights.length;l<c;l++)if("ambient"!==(h=i.lights[l]).type){if("dir"===h.type)"view"===h.space?d.push("viewLightDir = normalize(lightDir"+l+");"):d.push("viewLightDir = normalize((viewMatrix2 * vec4(lightDir"+l+", 0.0)).xyz);");else if("point"===h.type)"view"===h.space?d.push("viewLightDir = normalize(lightPos"+l+" - viewPosition.xyz);"):d.push("viewLightDir = normalize((viewMatrix2 * vec4(lightPos"+l+", 0.0)).xyz);");else{if("spot"!==h.type)continue;"view"===h.space?d.push("viewLightDir = normalize(lightDir"+l+");"):d.push("viewLightDir = normalize((viewMatrix2 * vec4(lightDir"+l+", 0.0)).xyz);")}d.push("lambertian = max(dot(-viewNormal, viewLightDir), 0.0);"),d.push("reflectedColor += lambertian * (lightColor"+l+".rgb * lightColor"+l+".a);")}d.push("vColor = vec4(materialEmissive.rgb + (reflectedColor * materialColor.rgb), materialColor.a) * colorize;"),n&&d.push("vWorldPosition = worldPosition;");"points"===r.primitiveName&&d.push("gl_PointSize = pointSize;");return d.push("   gl_Position = projMatrix * viewPosition;"),d.push("}"),d}(e),this.fragment=function(e){const t=e.scene,i=t._sectionPlanesState,r=(e._material._state,e._geometry._state);let o,s;const n=i.sectionPlanes.length>0,a=t.gammaOutput,l=[];if(l.push("// Lambertian drawing fragment shader"),l.push("precision lowp float;"),n)for(l.push("varying vec4 vWorldPosition;"),l.push("uniform bool clippable;"),o=0,s=i.sectionPlanes.length;o<s;o++)l.push("uniform bool sectionPlaneActive"+o+";"),l.push("uniform vec3 sectionPlanePos"+o+";"),l.push("uniform vec3 sectionPlaneDir"+o+";");l.push("varying vec4 vColor;"),a&&(l.push("uniform float gammaFactor;"),l.push("    vec4 linearToGamma( in vec4 value, in float gammaFactor ) {"),l.push("    return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );"),l.push("}"));if(l.push("void main(void) {"),n){for(l.push("if (clippable) {"),l.push("  float dist = 0.0;"),o=0,s=i.sectionPlanes.length;o<s;o++)l.push("if (sectionPlaneActive"+o+") {"),l.push("   dist += clamp(dot(-sectionPlaneDir"+o+".xyz, vWorldPosition.xyz - sectionPlanePos"+o+".xyz), 0.0, 1000.0);"),l.push("}");l.push("  if (dist > 0.0) { discard; }"),l.push("}")}"points"===r.primitiveName&&(l.push("vec2 cxy = 2.0 * gl_PointCoord - 1.0;"),l.push("float r = dot(cxy, cxy);"),l.push("if (r > 1.0) {"),l.push("   discard;"),l.push("}"));a?l.push("gl_FragColor = linearToGamma(vColor, gammaFactor);"):l.push("gl_FragColor = vColor;");return l.push("}"),l}(e)):(this.vertex=function(e){const t=e.scene,i=e._material,r=e._state,o=t._sectionPlanesState,s=e._geometry._state,n=t._lightsState;let a,l,c;const h=r.billboard,d=r.stationary,u=function(e){if(!e._geometry._state.uvBuf)return!1;const t=e._material;return!!(t._ambientMap||t._occlusionMap||t._baseColorMap||t._diffuseMap||t._alphaMap||t._specularMap||t._glossinessMap||t._specularGlossinessMap||t._emissiveMap||t._metallicMap||t._roughnessMap||t._metallicRoughnessMap||t._reflectivityMap||t._normalMap)}(e),p=ke(e),m=o.sectionPlanes.length>0,f=Me(e),g=!!s.compressGeometry,b=[];p&&i._normalMap&&b.push("#extension GL_OES_standard_derivatives : enable");b.push("// Drawing vertex shader"),b.push("attribute  vec3 position;"),g&&b.push("uniform mat4 positionsDecodeMatrix;");b.push("uniform  mat4 modelMatrix;"),b.push("uniform  mat4 viewMatrix;"),b.push("uniform  mat4 projMatrix;"),b.push("varying  vec3 vViewPosition;"),m&&b.push("varying vec4 vWorldPosition;");n.lightMaps.length>0&&b.push("varying    vec3 vWorldNormal;");if(p){for(b.push("attribute  vec3 normal;"),b.push("uniform    mat4 modelNormalMatrix;"),b.push("uniform    mat4 viewNormalMatrix;"),b.push("varying    vec3 vViewNormal;"),a=0,l=n.lights.length;a<l;a++)"ambient"!==(c=n.lights[a]).type&&("dir"===c.type&&b.push("uniform vec3 lightDir"+a+";"),"point"===c.type&&b.push("uniform vec3 lightPos"+a+";"),"spot"===c.type&&(b.push("uniform vec3 lightPos"+a+";"),b.push("uniform vec3 lightDir"+a+";")),"dir"===c.type&&"view"===c.space||b.push("varying vec4 vViewLightReverseDirAndDist"+a+";"));g&&(b.push("vec3 octDecode(vec2 oct) {"),b.push("    vec3 v = vec3(oct.xy, 1.0 - abs(oct.x) - abs(oct.y));"),b.push("    if (v.z < 0.0) {"),b.push("        v.xy = (1.0 - abs(v.yx)) * vec2(v.x >= 0.0 ? 1.0 : -1.0, v.y >= 0.0 ? 1.0 : -1.0);"),b.push("    }"),b.push("    return normalize(v);"),b.push("}"))}u&&(b.push("attribute vec2 uv;"),b.push("varying vec2 vUV;"),g&&b.push("uniform mat3 uvDecodeMatrix;"));s.colors&&(b.push("attribute vec4 color;"),b.push("varying vec4 vColor;"));"points"===s.primitiveName&&b.push("uniform float pointSize;");"spherical"!==h&&"cylindrical"!==h||(b.push("void billboard(inout mat4 mat) {"),b.push("   mat[0][0] = 1.0;"),b.push("   mat[0][1] = 0.0;"),b.push("   mat[0][2] = 0.0;"),"spherical"===h&&(b.push("   mat[1][0] = 0.0;"),b.push("   mat[1][1] = 1.0;"),b.push("   mat[1][2] = 0.0;")),b.push("   mat[2][0] = 0.0;"),b.push("   mat[2][1] = 0.0;"),b.push("   mat[2][2] =1.0;"),b.push("}"));if(f)for(b.push("const mat4 texUnitConverter = mat4(0.5, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.5, 0.5, 0.5, 1.0);"),a=0,l=n.lights.length;a<l;a++)n.lights[a].castsShadow&&(b.push("uniform mat4 shadowViewMatrix"+a+";"),b.push("uniform mat4 shadowProjMatrix"+a+";"),b.push("varying vec4 vShadowPosFromLight"+a+";"));b.push("void main(void) {"),b.push("vec4 localPosition = vec4(position, 1.0); "),b.push("vec4 worldPosition;"),g&&b.push("localPosition = positionsDecodeMatrix * localPosition;");p&&(g?b.push("vec4 localNormal = vec4(octDecode(normal.xy), 0.0); "):b.push("vec4 localNormal = vec4(normal, 0.0); "),b.push("mat4 modelNormalMatrix2    = modelNormalMatrix;"),b.push("mat4 viewNormalMatrix2     = viewNormalMatrix;"));b.push("mat4 viewMatrix2           = viewMatrix;"),b.push("mat4 modelMatrix2          = modelMatrix;"),d&&b.push("viewMatrix2[3][0] = viewMatrix2[3][1] = viewMatrix2[3][2] = 0.0;");"spherical"===h||"cylindrical"===h?(b.push("mat4 modelViewMatrix = viewMatrix2 * modelMatrix2;"),b.push("billboard(modelMatrix2);"),b.push("billboard(viewMatrix2);"),b.push("billboard(modelViewMatrix);"),p&&(b.push("mat4 modelViewNormalMatrix =  viewNormalMatrix2 * modelNormalMatrix2;"),b.push("billboard(modelNormalMatrix2);"),b.push("billboard(viewNormalMatrix2);"),b.push("billboard(modelViewNormalMatrix);")),b.push("worldPosition = modelMatrix2 * localPosition;"),b.push("vec4 viewPosition = modelViewMatrix * localPosition;")):(b.push("worldPosition = modelMatrix2 * localPosition;"),b.push("vec4 viewPosition  = viewMatrix2 * worldPosition; "));if(p)for(b.push("vec3 worldNormal = (modelNormalMatrix2 * localNormal).xyz; "),n.lightMaps.length>0&&b.push("vWorldNormal = worldNormal;"),b.push("vViewNormal = normalize((viewNormalMatrix2 * vec4(worldNormal, 1.0)).xyz);"),b.push("vec3 tmpVec3;"),b.push("float lightDist;"),a=0,l=n.lights.length;a<l;a++)"ambient"!==(c=n.lights[a]).type&&("dir"===c.type&&"world"===c.space&&(b.push("tmpVec3 = vec3(viewMatrix2 * vec4(lightDir"+a+", 0.0) ).xyz;"),b.push("vViewLightReverseDirAndDist"+a+" = vec4(-tmpVec3, 0.0);")),"point"===c.type&&("world"===c.space?(b.push("tmpVec3 = (viewMatrix2 * vec4(lightPos"+a+", 1.0)).xyz - viewPosition.xyz;"),b.push("lightDist = abs(length(tmpVec3));")):(b.push("tmpVec3 = lightPos"+a+".xyz - viewPosition.xyz;"),b.push("lightDist = abs(length(tmpVec3));")),b.push("vViewLightReverseDirAndDist"+a+" = vec4(tmpVec3, lightDist);")));u&&(g?b.push("vUV = (uvDecodeMatrix * vec3(uv, 1.0)).xy;"):b.push("vUV = uv;"));s.colors&&b.push("vColor = color;");"points"===s.primitiveName&&b.push("gl_PointSize = pointSize;");m&&b.push("vWorldPosition = worldPosition;");if(b.push("   vViewPosition = viewPosition.xyz;"),b.push("   gl_Position = projMatrix * viewPosition;"),b.push("const mat4 texUnitConverter = mat4(0.5, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.5, 0.5, 0.5, 1.0);"),f)for(b.push("vec4 tempx; "),a=0,l=n.lights.length;a<l;a++)n.lights[a].castsShadow&&b.push("vShadowPosFromLight"+a+" = texUnitConverter * shadowProjMatrix"+a+" * (shadowViewMatrix"+a+" * worldPosition); ");return b.push("}"),b}(e),this.fragment=function(e){const t=e.scene,i=t.canvas.gl,r=e._material,o=e._geometry._state,s=e.scene._sectionPlanesState,n=e.scene._lightsState,a=e._material._state,l=s.sectionPlanes.length>0,c=ke(e),h=o.uvBuf,d="PhongMaterial"===a.type,u="MetallicMaterial"===a.type,p="SpecularMaterial"===a.type,m=Me(e),f=(t.gammaInput,t.gammaOutput);let g,b;const _=[];_.push("// Drawing fragment shader"),c&&r._normalMap&&_.push("#extension GL_OES_standard_derivatives : enable");_.push("precision "+function(e){if(!e.getShaderPrecisionFormat)return"mediump";if(e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";if(e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0)return"mediump";return"lowp"}(i)+" float;"),m&&(_.push("float unpackDepth (vec4 color) {"),_.push("  const vec4 bitShift = vec4(1.0, 1.0/256.0, 1.0/(256.0 * 256.0), 1.0/(256.0*256.0*256.0));"),_.push("  return dot(color, bitShift);"),_.push("}"));_.push("uniform float gammaFactor;"),_.push("vec4 linearToLinear( in vec4 value ) {"),_.push("  return value;"),_.push("}"),_.push("vec4 sRGBToLinear( in vec4 value ) {"),_.push("  return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );"),_.push("}"),_.push("vec4 gammaToLinear( in vec4 value) {"),_.push("  return vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );"),_.push("}"),f&&(_.push("vec4 linearToGamma( in vec4 value, in float gammaFactor ) {"),_.push("  return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );"),_.push("}"));if(l){_.push("varying vec4 vWorldPosition;"),_.push("uniform bool clippable;");for(var v=0;v<s.sectionPlanes.length;v++)_.push("uniform bool sectionPlaneActive"+v+";"),_.push("uniform vec3 sectionPlanePos"+v+";"),_.push("uniform vec3 sectionPlaneDir"+v+";")}c&&(n.lightMaps.length>0&&(_.push("uniform samplerCube lightMap;"),_.push("uniform mat4 viewNormalMatrix;")),n.reflectionMaps.length>0&&_.push("uniform samplerCube reflectionMap;"),(n.lightMaps.length>0||n.reflectionMaps.length>0)&&_.push("uniform mat4 viewMatrix;"),_.push("#define PI 3.14159265359"),_.push("#define RECIPROCAL_PI 0.31830988618"),_.push("#define RECIPROCAL_PI2 0.15915494"),_.push("#define EPSILON 1e-6"),_.push("#define saturate(a) clamp( a, 0.0, 1.0 )"),_.push("vec3 inverseTransformDirection(in vec3 dir, in mat4 matrix) {"),_.push("   return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );"),_.push("}"),_.push("struct IncidentLight {"),_.push("   vec3 color;"),_.push("   vec3 direction;"),_.push("};"),_.push("struct ReflectedLight {"),_.push("   vec3 diffuse;"),_.push("   vec3 specular;"),_.push("};"),_.push("struct Geometry {"),_.push("   vec3 position;"),_.push("   vec3 viewNormal;"),_.push("   vec3 worldNormal;"),_.push("   vec3 viewEyeDir;"),_.push("};"),_.push("struct Material {"),_.push("   vec3    diffuseColor;"),_.push("   float   specularRoughness;"),_.push("   vec3    specularColor;"),_.push("   float   shine;"),_.push("};"),d&&((n.lightMaps.length>0||n.reflectionMaps.length>0)&&(_.push("void computePhongLightMapping(const in Geometry geometry, const in Material material, inout ReflectedLight reflectedLight) {"),n.lightMaps.length>0&&(_.push("   vec3 irradiance = "+we[n.lightMaps[0].encoding]+"(textureCube(lightMap, geometry.worldNormal)).rgb;"),_.push("   irradiance *= PI;"),_.push("   vec3 diffuseBRDFContrib = (RECIPROCAL_PI * material.diffuseColor);"),_.push("   reflectedLight.diffuse += irradiance * diffuseBRDFContrib;")),n.reflectionMaps.length>0&&(_.push("   vec3 reflectVec             = reflect(-geometry.viewEyeDir, geometry.viewNormal);"),_.push("   vec3 radiance               = textureCube(reflectionMap, reflectVec).rgb * 0.2;"),_.push("   reflectedLight.specular     += radiance;")),_.push("}")),_.push("void computePhongLighting(const in IncidentLight directLight, const in Geometry geometry, const in Material material, inout ReflectedLight reflectedLight) {"),_.push("   float dotNL     = saturate(dot(geometry.viewNormal, directLight.direction));"),_.push("   vec3 irradiance = dotNL * directLight.color * PI;"),_.push("   reflectedLight.diffuse  += irradiance * (RECIPROCAL_PI * material.diffuseColor);"),_.push("   reflectedLight.specular += directLight.color * material.specularColor * pow(max(dot(reflect(-directLight.direction, -geometry.viewNormal), geometry.viewEyeDir), 0.0), material.shine);"),_.push("}")),(u||p)&&(_.push("float GGXRoughnessToBlinnExponent(const in float ggxRoughness) {"),_.push("   float r = ggxRoughness + 0.0001;"),_.push("   return (2.0 / (r * r) - 2.0);"),_.push("}"),_.push("float getSpecularMIPLevel(const in float blinnShininessExponent, const in int maxMIPLevel) {"),_.push("   float maxMIPLevelScalar = float( maxMIPLevel );"),_.push("   float desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( ( blinnShininessExponent * blinnShininessExponent ) + 1.0 );"),_.push("   return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );"),_.push("}"),n.reflectionMaps.length>0&&(_.push("vec3 getLightProbeIndirectRadiance(const in vec3 reflectVec, const in float blinnShininessExponent, const in int maxMIPLevel) {"),_.push("   float mipLevel = 0.5 * getSpecularMIPLevel(blinnShininessExponent, maxMIPLevel);"),_.push("   vec3 envMapColor = "+we[n.reflectionMaps[0].encoding]+"(textureCube(reflectionMap, reflectVec, mipLevel)).rgb;"),_.push("  return envMapColor;"),_.push("}")),_.push("vec3 F_Schlick(const in vec3 specularColor, const in float dotLH) {"),_.push("   float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );"),_.push("   return ( 1.0 - specularColor ) * fresnel + specularColor;"),_.push("}"),_.push("float G_GGX_Smith(const in float alpha, const in float dotNL, const in float dotNV) {"),_.push("   float a2 = ( alpha * alpha );"),_.push("   float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * ( dotNL * dotNL ) );"),_.push("   float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * ( dotNV * dotNV ) );"),_.push("   return 1.0 / ( gl * gv );"),_.push("}"),_.push("float G_GGX_SmithCorrelated(const in float alpha, const in float dotNL, const in float dotNV) {"),_.push("   float a2 = ( alpha * alpha );"),_.push("   float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * ( dotNV * dotNV ) );"),_.push("   float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * ( dotNL * dotNL ) );"),_.push("   return 0.5 / max( gv + gl, EPSILON );"),_.push("}"),_.push("float D_GGX(const in float alpha, const in float dotNH) {"),_.push("   float a2 = ( alpha * alpha );"),_.push("   float denom = ( dotNH * dotNH) * ( a2 - 1.0 ) + 1.0;"),_.push("   return RECIPROCAL_PI * a2 / ( denom * denom);"),_.push("}"),_.push("vec3 BRDF_Specular_GGX(const in IncidentLight incidentLight, const in Geometry geometry, const in vec3 specularColor, const in float roughness) {"),_.push("   float alpha = ( roughness * roughness );"),_.push("   vec3 halfDir = normalize( incidentLight.direction + geometry.viewEyeDir );"),_.push("   float dotNL = saturate( dot( geometry.viewNormal, incidentLight.direction ) );"),_.push("   float dotNV = saturate( dot( geometry.viewNormal, geometry.viewEyeDir ) );"),_.push("   float dotNH = saturate( dot( geometry.viewNormal, halfDir ) );"),_.push("   float dotLH = saturate( dot( incidentLight.direction, halfDir ) );"),_.push("   vec3  F = F_Schlick( specularColor, dotLH );"),_.push("   float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );"),_.push("   float D = D_GGX( alpha, dotNH );"),_.push("   return F * (G * D);"),_.push("}"),_.push("vec3 BRDF_Specular_GGX_Environment(const in Geometry geometry, const in vec3 specularColor, const in float roughness) {"),_.push("   float dotNV = saturate(dot(geometry.viewNormal, geometry.viewEyeDir));"),_.push("   const vec4 c0 = vec4( -1, -0.0275, -0.572,  0.022);"),_.push("   const vec4 c1 = vec4(  1,  0.0425,   1.04, -0.04);"),_.push("   vec4 r = roughness * c0 + c1;"),_.push("   float a004 = min(r.x * r.x, exp2(-9.28 * dotNV)) * r.x + r.y;"),_.push("   vec2 AB    = vec2(-1.04, 1.04) * a004 + r.zw;"),_.push("   return specularColor * AB.x + AB.y;"),_.push("}"),(n.lightMaps.length>0||n.reflectionMaps.length>0)&&(_.push("void computePBRLightMapping(const in Geometry geometry, const in Material material, inout ReflectedLight reflectedLight) {"),n.lightMaps.length>0&&(_.push("   vec3 irradiance = sRGBToLinear(textureCube(lightMap, geometry.worldNormal)).rgb;"),_.push("   irradiance *= PI;"),_.push("   vec3 diffuseBRDFContrib = (RECIPROCAL_PI * material.diffuseColor);"),_.push("   reflectedLight.diffuse += irradiance * diffuseBRDFContrib;")),n.reflectionMaps.length>0&&(_.push("   vec3 reflectVec             = reflect(-geometry.viewEyeDir, geometry.viewNormal);"),_.push("   reflectVec                  = inverseTransformDirection(reflectVec, viewMatrix);"),_.push("   float blinnExpFromRoughness = GGXRoughnessToBlinnExponent(material.specularRoughness);"),_.push("   vec3 radiance               = getLightProbeIndirectRadiance(reflectVec, blinnExpFromRoughness, 8);"),_.push("   vec3 specularBRDFContrib    = BRDF_Specular_GGX_Environment(geometry, material.specularColor, material.specularRoughness);"),_.push("   reflectedLight.specular     += radiance * specularBRDFContrib;")),_.push("}")),_.push("void computePBRLighting(const in IncidentLight incidentLight, const in Geometry geometry, const in Material material, inout ReflectedLight reflectedLight) {"),_.push("   float dotNL     = saturate(dot(geometry.viewNormal, incidentLight.direction));"),_.push("   vec3 irradiance = dotNL * incidentLight.color * PI;"),_.push("   reflectedLight.diffuse  += irradiance * (RECIPROCAL_PI * material.diffuseColor);"),_.push("   reflectedLight.specular += irradiance * BRDF_Specular_GGX(incidentLight, geometry, material.specularColor, material.specularRoughness);"),_.push("}")));_.push("varying vec3 vViewPosition;"),o.colors&&_.push("varying vec4 vColor;");h&&(c&&r._normalMap||r._ambientMap||r._baseColorMap||r._diffuseMap||r._emissiveMap||r._metallicMap||r._roughnessMap||r._metallicRoughnessMap||r._specularMap||r._glossinessMap||r._specularGlossinessMap||r._occlusionMap||r._alphaMap)&&_.push("varying vec2 vUV;");c&&(n.lightMaps.length>0&&_.push("varying vec3 vWorldNormal;"),_.push("varying vec3 vViewNormal;"));a.ambient&&_.push("uniform vec3 materialAmbient;");a.baseColor&&_.push("uniform vec3 materialBaseColor;");void 0!==a.alpha&&null!==a.alpha&&_.push("uniform vec4 materialAlphaModeCutoff;");a.emissive&&_.push("uniform vec3 materialEmissive;");a.diffuse&&_.push("uniform vec3 materialDiffuse;");void 0!==a.glossiness&&null!==a.glossiness&&_.push("uniform float materialGlossiness;");void 0!==a.shininess&&null!==a.shininess&&_.push("uniform float materialShininess;");a.specular&&_.push("uniform vec3 materialSpecular;");void 0!==a.metallic&&null!==a.metallic&&_.push("uniform float materialMetallic;");void 0!==a.roughness&&null!==a.roughness&&_.push("uniform float materialRoughness;");void 0!==a.specularF0&&null!==a.specularF0&&_.push("uniform float materialSpecularF0;");h&&r._ambientMap&&(_.push("uniform sampler2D ambientMap;"),r._ambientMap._state.matrix&&_.push("uniform mat4 ambientMapMatrix;"));h&&r._baseColorMap&&(_.push("uniform sampler2D baseColorMap;"),r._baseColorMap._state.matrix&&_.push("uniform mat4 baseColorMapMatrix;"));h&&r._diffuseMap&&(_.push("uniform sampler2D diffuseMap;"),r._diffuseMap._state.matrix&&_.push("uniform mat4 diffuseMapMatrix;"));h&&r._emissiveMap&&(_.push("uniform sampler2D emissiveMap;"),r._emissiveMap._state.matrix&&_.push("uniform mat4 emissiveMapMatrix;"));c&&h&&r._metallicMap&&(_.push("uniform sampler2D metallicMap;"),r._metallicMap._state.matrix&&_.push("uniform mat4 metallicMapMatrix;"));c&&h&&r._roughnessMap&&(_.push("uniform sampler2D roughnessMap;"),r._roughnessMap._state.matrix&&_.push("uniform mat4 roughnessMapMatrix;"));c&&h&&r._metallicRoughnessMap&&(_.push("uniform sampler2D metallicRoughnessMap;"),r._metallicRoughnessMap._state.matrix&&_.push("uniform mat4 metallicRoughnessMapMatrix;"));c&&r._normalMap&&(_.push("uniform sampler2D normalMap;"),r._normalMap._state.matrix&&_.push("uniform mat4 normalMapMatrix;"),_.push("vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {"),_.push("      vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );"),_.push("      vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );"),_.push("      vec2 st0 = dFdx( uv.st );"),_.push("      vec2 st1 = dFdy( uv.st );"),_.push("      vec3 S = normalize( q0 * st1.t - q1 * st0.t );"),_.push("      vec3 T = normalize( -q0 * st1.s + q1 * st0.s );"),_.push("      vec3 N = normalize( surf_norm );"),_.push("      vec3 mapN = texture2D( normalMap, uv ).xyz * 2.0 - 1.0;"),_.push("      mat3 tsn = mat3( S, T, N );"),_.push("      return normalize( tsn * mapN );"),_.push("}"));h&&r._occlusionMap&&(_.push("uniform sampler2D occlusionMap;"),r._occlusionMap._state.matrix&&_.push("uniform mat4 occlusionMapMatrix;"));h&&r._alphaMap&&(_.push("uniform sampler2D alphaMap;"),r._alphaMap._state.matrix&&_.push("uniform mat4 alphaMapMatrix;"));c&&h&&r._specularMap&&(_.push("uniform sampler2D specularMap;"),r._specularMap._state.matrix&&_.push("uniform mat4 specularMapMatrix;"));c&&h&&r._glossinessMap&&(_.push("uniform sampler2D glossinessMap;"),r._glossinessMap._state.matrix&&_.push("uniform mat4 glossinessMapMatrix;"));c&&h&&r._specularGlossinessMap&&(_.push("uniform sampler2D materialSpecularGlossinessMap;"),r._specularGlossinessMap._state.matrix&&_.push("uniform mat4 materialSpecularGlossinessMapMatrix;"));c&&(r._diffuseFresnel||r._specularFresnel||r._alphaFresnel||r._emissiveFresnel||r._reflectivityFresnel)&&(_.push("float fresnel(vec3 eyeDir, vec3 normal, float edgeBias, float centerBias, float power) {"),_.push("    float fr = abs(dot(eyeDir, normal));"),_.push("    float finalFr = clamp((fr - edgeBias) / (centerBias - edgeBias), 0.0, 1.0);"),_.push("    return pow(finalFr, power);"),_.push("}"),r._diffuseFresnel&&(_.push("uniform float  diffuseFresnelCenterBias;"),_.push("uniform float  diffuseFresnelEdgeBias;"),_.push("uniform float  diffuseFresnelPower;"),_.push("uniform vec3   diffuseFresnelCenterColor;"),_.push("uniform vec3   diffuseFresnelEdgeColor;")),r._specularFresnel&&(_.push("uniform float  specularFresnelCenterBias;"),_.push("uniform float  specularFresnelEdgeBias;"),_.push("uniform float  specularFresnelPower;"),_.push("uniform vec3   specularFresnelCenterColor;"),_.push("uniform vec3   specularFresnelEdgeColor;")),r._alphaFresnel&&(_.push("uniform float  alphaFresnelCenterBias;"),_.push("uniform float  alphaFresnelEdgeBias;"),_.push("uniform float  alphaFresnelPower;"),_.push("uniform vec3   alphaFresnelCenterColor;"),_.push("uniform vec3   alphaFresnelEdgeColor;")),r._reflectivityFresnel&&(_.push("uniform float  materialSpecularF0FresnelCenterBias;"),_.push("uniform float  materialSpecularF0FresnelEdgeBias;"),_.push("uniform float  materialSpecularF0FresnelPower;"),_.push("uniform vec3   materialSpecularF0FresnelCenterColor;"),_.push("uniform vec3   materialSpecularF0FresnelEdgeColor;")),r._emissiveFresnel&&(_.push("uniform float  emissiveFresnelCenterBias;"),_.push("uniform float  emissiveFresnelEdgeBias;"),_.push("uniform float  emissiveFresnelPower;"),_.push("uniform vec3   emissiveFresnelCenterColor;"),_.push("uniform vec3   emissiveFresnelEdgeColor;")));if(_.push("uniform vec4   lightAmbient;"),c)for(v=0,g=n.lights.length;v<g;v++)"ambient"!==(b=n.lights[v]).type&&(_.push("uniform vec4 lightColor"+v+";"),"point"===b.type&&_.push("uniform vec3 lightAttenuation"+v+";"),"dir"===b.type&&"view"===b.space&&_.push("uniform vec3 lightDir"+v+";"),"point"===b.type&&"view"===b.space?_.push("uniform vec3 lightPos"+v+";"):_.push("varying vec4 vViewLightReverseDirAndDist"+v+";"));if(m)for(v=0,g=n.lights.length;v<g;v++)n.lights[v].castsShadow&&(_.push("varying vec4 vShadowPosFromLight"+v+";"),_.push("uniform sampler2D shadowMap"+v+";"));if(_.push("uniform vec4 colorize;"),_.push("void main(void) {"),l){_.push("if (clippable) {"),_.push("  float dist = 0.0;");for(v=0;v<s.sectionPlanes.length;v++)_.push("if (sectionPlaneActive"+v+") {"),_.push("   dist += clamp(dot(-sectionPlaneDir"+v+".xyz, vWorldPosition.xyz - sectionPlanePos"+v+".xyz), 0.0, 1000.0);"),_.push("}");_.push("  if (dist > 0.0) { discard; }"),_.push("}")}"points"===o.primitiveName&&(_.push("vec2 cxy = 2.0 * gl_PointCoord - 1.0;"),_.push("float r = dot(cxy, cxy);"),_.push("if (r > 1.0) {"),_.push("   discard;"),_.push("}"));_.push("float occlusion = 1.0;"),a.ambient?_.push("vec3 ambientColor = materialAmbient;"):_.push("vec3 ambientColor = vec3(1.0, 1.0, 1.0);");a.diffuse?_.push("vec3 diffuseColor = materialDiffuse;"):a.baseColor?_.push("vec3 diffuseColor = materialBaseColor;"):_.push("vec3 diffuseColor = vec3(1.0, 1.0, 1.0);");o.colors&&_.push("diffuseColor *= vColor.rgb;");a.emissive?_.push("vec3 emissiveColor = materialEmissive;"):_.push("vec3  emissiveColor = vec3(0.0, 0.0, 0.0);");a.specular?_.push("vec3 specular = materialSpecular;"):_.push("vec3 specular = vec3(1.0, 1.0, 1.0);");void 0!==a.alpha?_.push("float alpha = materialAlphaModeCutoff[0];"):_.push("float alpha = 1.0;");o.colors&&_.push("alpha *= vColor.a;");void 0!==a.glossiness?_.push("float glossiness = materialGlossiness;"):_.push("float glossiness = 1.0;");void 0!==a.metallic?_.push("float metallic = materialMetallic;"):_.push("float metallic = 1.0;");void 0!==a.roughness?_.push("float roughness = materialRoughness;"):_.push("float roughness = 1.0;");void 0!==a.specularF0?_.push("float specularF0 = materialSpecularF0;"):_.push("float specularF0 = 1.0;");h&&(c&&r._normalMap||r._ambientMap||r._baseColorMap||r._diffuseMap||r._occlusionMap||r._emissiveMap||r._metallicMap||r._roughnessMap||r._metallicRoughnessMap||r._specularMap||r._glossinessMap||r._specularGlossinessMap||r._alphaMap)&&(_.push("vec4 texturePos = vec4(vUV.s, vUV.t, 1.0, 1.0);"),_.push("vec2 textureCoord;"));h&&r._ambientMap&&(r._ambientMap._state.matrix?_.push("textureCoord = (ambientMapMatrix * texturePos).xy;"):_.push("textureCoord = texturePos.xy;"),_.push("vec4 ambientTexel = texture2D(ambientMap, textureCoord).rgb;"),_.push("ambientTexel = "+we[r._ambientMap._state.encoding]+"(ambientTexel);"),_.push("ambientColor *= ambientTexel.rgb;"));h&&r._diffuseMap&&(r._diffuseMap._state.matrix?_.push("textureCoord = (diffuseMapMatrix * texturePos).xy;"):_.push("textureCoord = texturePos.xy;"),_.push("vec4 diffuseTexel = texture2D(diffuseMap, textureCoord);"),_.push("diffuseTexel = "+we[r._diffuseMap._state.encoding]+"(diffuseTexel);"),_.push("diffuseColor *= diffuseTexel.rgb;"),_.push("alpha *= diffuseTexel.a;"));h&&r._baseColorMap&&(r._baseColorMap._state.matrix?_.push("textureCoord = (baseColorMapMatrix * texturePos).xy;"):_.push("textureCoord = texturePos.xy;"),_.push("vec4 baseColorTexel = texture2D(baseColorMap, textureCoord);"),_.push("baseColorTexel = "+we[r._baseColorMap._state.encoding]+"(baseColorTexel);"),_.push("diffuseColor *= baseColorTexel.rgb;"),_.push("alpha *= baseColorTexel.a;"));h&&r._emissiveMap&&(r._emissiveMap._state.matrix?_.push("textureCoord = (emissiveMapMatrix * texturePos).xy;"):_.push("textureCoord = texturePos.xy;"),_.push("vec4 emissiveTexel = texture2D(emissiveMap, textureCoord);"),_.push("emissiveTexel = "+we[r._emissiveMap._state.encoding]+"(emissiveTexel);"),_.push("emissiveColor *= emissiveTexel.rgb;"));h&&r._alphaMap&&(r._alphaMap._state.matrix?_.push("textureCoord = (alphaMapMatrix * texturePos).xy;"):_.push("textureCoord = texturePos.xy;"),_.push("alpha *= texture2D(alphaMap, textureCoord).r;"));h&&r._occlusionMap&&(r._occlusionMap._state.matrix?_.push("textureCoord = (occlusionMapMatrix * texturePos).xy;"):_.push("textureCoord = texturePos.xy;"),_.push("occlusion *= texture2D(occlusionMap, textureCoord).r;"));if(c&&(n.lights.length>0||n.lightMaps.length>0||n.reflectionMaps.length>0)){h&&r._normalMap?(r._normalMap._state.matrix?_.push("textureCoord = (normalMapMatrix * texturePos).xy;"):_.push("textureCoord = texturePos.xy;"),_.push("vec3 viewNormal = perturbNormal2Arb( vViewPosition, normalize(vViewNormal), textureCoord );")):_.push("vec3 viewNormal = normalize(vViewNormal);"),h&&r._specularMap&&(r._specularMap._state.matrix?_.push("textureCoord = (specularMapMatrix * texturePos).xy;"):_.push("textureCoord = texturePos.xy;"),_.push("specular *= texture2D(specularMap, textureCoord).rgb;")),h&&r._glossinessMap&&(r._glossinessMap._state.matrix?_.push("textureCoord = (glossinessMapMatrix * texturePos).xy;"):_.push("textureCoord = texturePos.xy;"),_.push("glossiness *= texture2D(glossinessMap, textureCoord).r;")),h&&r._specularGlossinessMap&&(r._specularGlossinessMap._state.matrix?_.push("textureCoord = (materialSpecularGlossinessMapMatrix * texturePos).xy;"):_.push("textureCoord = texturePos.xy;"),_.push("vec4 specGlossRGB = texture2D(materialSpecularGlossinessMap, textureCoord).rgba;"),_.push("specular *= specGlossRGB.rgb;"),_.push("glossiness *= specGlossRGB.a;")),h&&r._metallicMap&&(r._metallicMap._state.matrix?_.push("textureCoord = (metallicMapMatrix * texturePos).xy;"):_.push("textureCoord = texturePos.xy;"),_.push("metallic *= texture2D(metallicMap, textureCoord).r;")),h&&r._roughnessMap&&(r._roughnessMap._state.matrix?_.push("textureCoord = (roughnessMapMatrix * texturePos).xy;"):_.push("textureCoord = texturePos.xy;"),_.push("roughness *= texture2D(roughnessMap, textureCoord).r;")),h&&r._metallicRoughnessMap&&(r._metallicRoughnessMap._state.matrix?_.push("textureCoord = (metallicRoughnessMapMatrix * texturePos).xy;"):_.push("textureCoord = texturePos.xy;"),_.push("vec3 metalRoughRGB = texture2D(metallicRoughnessMap, textureCoord).rgb;"),_.push("metallic *= metalRoughRGB.b;"),_.push("roughness *= metalRoughRGB.g;")),_.push("vec3 viewEyeDir = normalize(-vViewPosition);"),r._diffuseFresnel&&(_.push("float diffuseFresnel = fresnel(viewEyeDir, viewNormal, diffuseFresnelEdgeBias, diffuseFresnelCenterBias, diffuseFresnelPower);"),_.push("diffuseColor *= mix(diffuseFresnelEdgeColor, diffuseFresnelCenterColor, diffuseFresnel);")),r._specularFresnel&&(_.push("float specularFresnel = fresnel(viewEyeDir, viewNormal, specularFresnelEdgeBias, specularFresnelCenterBias, specularFresnelPower);"),_.push("specular *= mix(specularFresnelEdgeColor, specularFresnelCenterColor, specularFresnel);")),r._alphaFresnel&&(_.push("float alphaFresnel = fresnel(viewEyeDir, viewNormal, alphaFresnelEdgeBias, alphaFresnelCenterBias, alphaFresnelPower);"),_.push("alpha *= mix(alphaFresnelEdgeColor.r, alphaFresnelCenterColor.r, alphaFresnel);")),r._emissiveFresnel&&(_.push("float emissiveFresnel = fresnel(viewEyeDir, viewNormal, emissiveFresnelEdgeBias, emissiveFresnelCenterBias, emissiveFresnelPower);"),_.push("emissiveColor *= mix(emissiveFresnelEdgeColor, emissiveFresnelCenterColor, emissiveFresnel);")),_.push("if (materialAlphaModeCutoff[1] == 1.0 && alpha < materialAlphaModeCutoff[2]) {"),_.push("   discard;"),_.push("}"),_.push("IncidentLight  light;"),_.push("Material       material;"),_.push("Geometry       geometry;"),_.push("ReflectedLight reflectedLight = ReflectedLight(vec3(0.0,0.0,0.0), vec3(0.0,0.0,0.0));"),_.push("vec3           viewLightDir;"),d&&(_.push("material.diffuseColor      = diffuseColor;"),_.push("material.specularColor     = specular;"),_.push("material.shine             = materialShininess;")),p&&(_.push("float oneMinusSpecularStrength = 1.0 - max(max(specular.r, specular.g ),specular.b);"),_.push("material.diffuseColor      = diffuseColor * oneMinusSpecularStrength;"),_.push("material.specularRoughness = clamp( 1.0 - glossiness, 0.04, 1.0 );"),_.push("material.specularColor     = specular;")),u&&(_.push("float dielectricSpecular = 0.16 * specularF0 * specularF0;"),_.push("material.diffuseColor      = diffuseColor * (1.0 - dielectricSpecular) * (1.0 - metallic);"),_.push("material.specularRoughness = clamp(roughness, 0.04, 1.0);"),_.push("material.specularColor     = mix(vec3(dielectricSpecular), diffuseColor, metallic);")),_.push("geometry.position      = vViewPosition;"),n.lightMaps.length>0&&_.push("geometry.worldNormal   = normalize(vWorldNormal);"),_.push("geometry.viewNormal    = viewNormal;"),_.push("geometry.viewEyeDir    = viewEyeDir;"),d&&(n.lightMaps.length>0||n.reflectionMaps.length>0)&&_.push("computePhongLightMapping(geometry, material, reflectedLight);"),(p||u)&&(n.lightMaps.length>0||n.reflectionMaps.length>0)&&_.push("computePBRLightMapping(geometry, material, reflectedLight);"),_.push("float shadow = 1.0;"),_.push("float shadowAcneRemover = 0.007;"),_.push("vec3 fragmentDepth;"),_.push("float texelSize = 1.0 / 1024.0;"),_.push("float amountInLight = 0.0;"),_.push("vec3 shadowCoord;"),_.push("vec4 rgbaDepth;"),_.push("float depth;");for(v=0,g=n.lights.length;v<g;v++)"ambient"!==(b=n.lights[v]).type&&("dir"===b.type&&"view"===b.space?_.push("viewLightDir = -normalize(lightDir"+v+");"):"point"===b.type&&"view"===b.space?_.push("viewLightDir = normalize(lightPos"+v+" - vViewPosition);"):_.push("viewLightDir = normalize(vViewLightReverseDirAndDist"+v+".xyz);"),m&&b.castsShadow?(_.push("shadow = 0.0;"),_.push("fragmentDepth = vShadowPosFromLight"+v+".xyz;"),_.push("fragmentDepth.z -= shadowAcneRemover;"),_.push("for (int x = -3; x <= 3; x++) {"),_.push("  for (int y = -3; y <= 3; y++) {"),_.push("      float texelDepth = unpackDepth(texture2D(shadowMap"+v+", fragmentDepth.xy + vec2(x, y) * texelSize));"),_.push("      if (fragmentDepth.z < texelDepth) {"),_.push("          shadow += 1.0;"),_.push("      }"),_.push("  }"),_.push("}"),_.push("shadow = shadow / 9.0;"),_.push("light.color =  lightColor"+v+".rgb * (lightColor"+v+".a * shadow);")):_.push("light.color =  lightColor"+v+".rgb * (lightColor"+v+".a );"),_.push("light.direction = viewLightDir;"),d&&_.push("computePhongLighting(light, geometry, material, reflectedLight);"),(p||u)&&_.push("computePBRLighting(light, geometry, material, reflectedLight);"));d?(_.push("ambientColor *= (lightAmbient.rgb * lightAmbient.a);"),_.push("vec3 outgoingLight =  ((occlusion * (( reflectedLight.diffuse + reflectedLight.specular)))) + emissiveColor;")):_.push("vec3 outgoingLight = (occlusion * (reflectedLight.diffuse)) + (occlusion * reflectedLight.specular) + emissiveColor;")}else _.push("ambientColor *= (lightAmbient.rgb * lightAmbient.a);"),_.push("vec3 outgoingLight = emissiveColor + ambientColor;");_.push("gl_FragColor = vec4(outgoingLight, alpha) * colorize;"),f&&_.push("gl_FragColor = linearToGamma(gl_FragColor, gammaFactor);");return _.push("}"),_}(e))},we={linear:"linearToLinear",sRGB:"sRGBToLinear",gamma:"gammaToLinear"};function Me(e){if(!e.receivesShadow)return!1;const t=e.scene._lightsState.lights;if(!t||0===t.length)return!1;for(let e=0,i=t.length;e<i;e++)if(t[e].castsShadow)return!0;return!1}function ke(e){const t=e._geometry._state.primitiveName;return!(!e._geometry._state.autoVertexNormals&&!e._geometry._state.normalsBuf||"triangles"!==t&&"triangle-strip"!==t&&"triangle-fan"!==t)}class Pe{constructor(e,t,i){if(this.allocated=!1,this.compiled=!1,this.handle=e.createShader(t),this.handle){if(this.allocated=!0,e.shaderSource(this.handle,i),e.compileShader(this.handle),this.compiled=e.getShaderParameter(this.handle,e.COMPILE_STATUS),!this.compiled&&!e.isContextLost()){const t=i.split("\n"),r=[];for(let e=0;e<t.length;e++)r.push(e+1+": "+t[e]+"\n");this.errors=[],this.errors.push(""),this.errors.push(e.getShaderInfoLog(this.handle)),this.errors=this.errors.concat(r.join(""))}}else this.errors=["Failed to allocate"]}destroy(){}}class Ee{constructor(e,t){this.bindTexture=function(i,r){return!!i.bind(r)&&(e.uniform1i(t,r),!0)}}}class Ae{constructor(e,t){this._gl=e,this.location=t}bindArrayBuffer(e){e&&(e.bind(),this._gl.enableVertexAttribArray(this.location),this._gl.vertexAttribPointer(this.location,e.itemSize,e.itemType,e.normalized,e.stride,e.offset))}}const Ce=new n({});function Te(e){const t=[];let i,r;for(let o=0,s=e.length;o<s;o++)(r=(i=e[o]).indexOf("/"))>0&&"/"===i.charAt(r+1)&&(i=i.substring(0,r)),t.push(i);return t.join("\n")}class De{constructor(e,t){this.id=Ce.addItem({}),this.source=t,this.init(e)}init(e){if(this.gl=e,this.allocated=!1,this.compiled=!1,this.linked=!1,this.validated=!1,this.errors=null,this.uniforms={},this.samplers={},this.attributes={},this._vertexShader=new Pe(e,e.VERTEX_SHADER,Te(this.source.vertex)),this._fragmentShader=new Pe(e,e.FRAGMENT_SHADER,Te(this.source.fragment)),!this._vertexShader.allocated)return void(this.errors=["Vertex shader failed to allocate"].concat(this._vertexShader.errors));if(!this._fragmentShader.allocated)return void(this.errors=["Fragment shader failed to allocate"].concat(this._fragmentShader.errors));if(this.allocated=!0,!this._vertexShader.compiled)return void(this.errors=["Vertex shader failed to compile"].concat(this._vertexShader.errors));if(!this._fragmentShader.compiled)return void(this.errors=["Fragment shader failed to compile"].concat(this._fragmentShader.errors));let t,i,r,o,s;if(this.compiled=!0,this.handle=e.createProgram(),!this.handle)return void(this.errors=["Failed to allocate program"]);if(e.attachShader(this.handle,this._vertexShader.handle),e.attachShader(this.handle,this._fragmentShader.handle),e.linkProgram(this.handle),this.linked=e.getProgramParameter(this.handle,e.LINK_STATUS),this.validated=!0,!this.linked||!this.validated)return this.errors=[],this.errors.push(""),this.errors.push(e.getProgramInfoLog(this.handle)),this.errors.push("\nVertex shader:\n"),this.errors=this.errors.concat(this.source.vertex),this.errors.push("\nFragment shader:\n"),void(this.errors=this.errors.concat(this.source.fragment));const n=e.getProgramParameter(this.handle,e.ACTIVE_UNIFORMS);for(i=0;i<n;++i)(r=e.getActiveUniform(this.handle,i))&&("\0"===(o=r.name)[o.length-1]&&(o=o.substr(0,o.length-1)),s=e.getUniformLocation(this.handle,o),r.type===e.SAMPLER_2D||r.type===e.SAMPLER_CUBE||35682===r.type?this.samplers[o]=new Ee(e,s):this.uniforms[o]=s);const a=e.getProgramParameter(this.handle,e.ACTIVE_ATTRIBUTES);for(i=0;i<a;i++)(t=e.getActiveAttrib(this.handle,i))&&(s=e.getAttribLocation(this.handle,t.name),this.attributes[t.name]=new Ae(e,s));this.allocated=!0}bind(){this.allocated&&this.gl.useProgram(this.handle)}getLocation(e){if(this.allocated)return this.uniforms[e]}getAttribute(e){if(this.allocated)return this.attributes[e]}bindTexture(e,t,i){if(!this.allocated)return!1;const r=this.samplers[e];return!!r&&r.bindTexture(t,i)}destroy(){this.allocated&&(Ce.removeItem(this.id),this.gl.deleteProgram(this.handle),this.gl.deleteShader(this._vertexShader.handle),this.gl.deleteShader(this._fragmentShader.handle),this.handle=null,this.attributes=null,this.uniforms=null,this.samplers=null,this.allocated=!1)}}const Se=new n({}),Le=function(e,t){this.id=Se.addItem({}),this._hash=e,this._scene=t.scene,this._useCount=0,this._shaderSource=new ye(t),this._allocate(t)},Re={};Le.get=function(e){const t=e.scene,i=[t.canvas.canvas.id,(t.gammaInput?"gi;":";")+(t.gammaOutput?"go":""),t._lightsState.getHash(),t._sectionPlanesState.getHash(),e._geometry._state.hash,e._material._state.hash,e._state.drawHash].join(";");let r=Re[i];if(!r){if((r=new Le(i,e)).errors)return console.log(r.errors.join("\n")),null;Re[i]=r,P.memory.programs++}return r._useCount++,r},Le.prototype.put=function(){0==--this._useCount&&(Se.removeItem(this.id),this._program&&this._program.destroy(),delete Re[this._hash],P.memory.programs--)},Le.prototype.webglContextRestored=function(){this._program=null},Le.prototype.drawMesh=function(e,t){this._program||this._allocate(t);const i=q.MAX_TEXTURE_UNITS,r=t.scene,o=t._material,s=r.canvas.gl,n=this._program,a=t._state,l=t._material._state,c=t._geometry._state;if(e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e)),l.id!==this._lastMaterialId){e.textureUnit=this._baseTextureUnit;const t=l.backfaces;e.backfaces!==t&&(t?s.disable(s.CULL_FACE):s.enable(s.CULL_FACE),e.backfaces=t);const r=l.frontface;switch(e.frontface!==r&&(r?s.frontFace(s.CCW):s.frontFace(s.CW),e.frontface=r),e.lineWidth!==l.lineWidth&&(s.lineWidth(l.lineWidth),e.lineWidth=l.lineWidth),this._uPointSize&&s.uniform1f(this._uPointSize,l.pointSize),l.type){case"LambertMaterial":this._uMaterialAmbient&&s.uniform3fv(this._uMaterialAmbient,l.ambient),this._uMaterialColor&&s.uniform4f(this._uMaterialColor,l.color[0],l.color[1],l.color[2],l.alpha),this._uMaterialEmissive&&s.uniform3fv(this._uMaterialEmissive,l.emissive);break;case"PhongMaterial":this._uMaterialShininess&&s.uniform1f(this._uMaterialShininess,l.shininess),this._uMaterialAmbient&&s.uniform3fv(this._uMaterialAmbient,l.ambient),this._uMaterialDiffuse&&s.uniform3fv(this._uMaterialDiffuse,l.diffuse),this._uMaterialSpecular&&s.uniform3fv(this._uMaterialSpecular,l.specular),this._uMaterialEmissive&&s.uniform3fv(this._uMaterialEmissive,l.emissive),this._uAlphaModeCutoff&&s.uniform4f(this._uAlphaModeCutoff,1*l.alpha,1===l.alphaMode?1:0,l.alphaCutoff,0),o._ambientMap&&o._ambientMap._state.texture&&this._uMaterialAmbientMap&&(n.bindTexture(this._uMaterialAmbientMap,o._ambientMap._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uMaterialAmbientMapMatrix&&s.uniformMatrix4fv(this._uMaterialAmbientMapMatrix,!1,o._ambientMap._state.matrix)),o._diffuseMap&&o._diffuseMap._state.texture&&this._uDiffuseMap&&(n.bindTexture(this._uDiffuseMap,o._diffuseMap._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uDiffuseMapMatrix&&s.uniformMatrix4fv(this._uDiffuseMapMatrix,!1,o._diffuseMap._state.matrix)),o._specularMap&&o._specularMap._state.texture&&this._uSpecularMap&&(n.bindTexture(this._uSpecularMap,o._specularMap._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uSpecularMapMatrix&&s.uniformMatrix4fv(this._uSpecularMapMatrix,!1,o._specularMap._state.matrix)),o._emissiveMap&&o._emissiveMap._state.texture&&this._uEmissiveMap&&(n.bindTexture(this._uEmissiveMap,o._emissiveMap._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uEmissiveMapMatrix&&s.uniformMatrix4fv(this._uEmissiveMapMatrix,!1,o._emissiveMap._state.matrix)),o._alphaMap&&o._alphaMap._state.texture&&this._uAlphaMap&&(n.bindTexture(this._uAlphaMap,o._alphaMap._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uAlphaMapMatrix&&s.uniformMatrix4fv(this._uAlphaMapMatrix,!1,o._alphaMap._state.matrix)),o._reflectivityMap&&o._reflectivityMap._state.texture&&this._uReflectivityMap&&(n.bindTexture(this._uReflectivityMap,o._reflectivityMap._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,this._uReflectivityMapMatrix&&s.uniformMatrix4fv(this._uReflectivityMapMatrix,!1,o._reflectivityMap._state.matrix)),o._normalMap&&o._normalMap._state.texture&&this._uNormalMap&&(n.bindTexture(this._uNormalMap,o._normalMap._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uNormalMapMatrix&&s.uniformMatrix4fv(this._uNormalMapMatrix,!1,o._normalMap._state.matrix)),o._occlusionMap&&o._occlusionMap._state.texture&&this._uOcclusionMap&&(n.bindTexture(this._uOcclusionMap,o._occlusionMap._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uOcclusionMapMatrix&&s.uniformMatrix4fv(this._uOcclusionMapMatrix,!1,o._occlusionMap._state.matrix)),o._diffuseFresnel&&(this._uDiffuseFresnelEdgeBias&&s.uniform1f(this._uDiffuseFresnelEdgeBias,o._diffuseFresnel.edgeBias),this._uDiffuseFresnelCenterBias&&s.uniform1f(this._uDiffuseFresnelCenterBias,o._diffuseFresnel.centerBias),this._uDiffuseFresnelEdgeColor&&s.uniform3fv(this._uDiffuseFresnelEdgeColor,o._diffuseFresnel.edgeColor),this._uDiffuseFresnelCenterColor&&s.uniform3fv(this._uDiffuseFresnelCenterColor,o._diffuseFresnel.centerColor),this._uDiffuseFresnelPower&&s.uniform1f(this._uDiffuseFresnelPower,o._diffuseFresnel.power)),o._specularFresnel&&(this._uSpecularFresnelEdgeBias&&s.uniform1f(this._uSpecularFresnelEdgeBias,o._specularFresnel.edgeBias),this._uSpecularFresnelCenterBias&&s.uniform1f(this._uSpecularFresnelCenterBias,o._specularFresnel.centerBias),this._uSpecularFresnelEdgeColor&&s.uniform3fv(this._uSpecularFresnelEdgeColor,o._specularFresnel.edgeColor),this._uSpecularFresnelCenterColor&&s.uniform3fv(this._uSpecularFresnelCenterColor,o._specularFresnel.centerColor),this._uSpecularFresnelPower&&s.uniform1f(this._uSpecularFresnelPower,o._specularFresnel.power)),o._alphaFresnel&&(this._uAlphaFresnelEdgeBias&&s.uniform1f(this._uAlphaFresnelEdgeBias,o._alphaFresnel.edgeBias),this._uAlphaFresnelCenterBias&&s.uniform1f(this._uAlphaFresnelCenterBias,o._alphaFresnel.centerBias),this._uAlphaFresnelEdgeColor&&s.uniform3fv(this._uAlphaFresnelEdgeColor,o._alphaFresnel.edgeColor),this._uAlphaFresnelCenterColor&&s.uniform3fv(this._uAlphaFresnelCenterColor,o._alphaFresnel.centerColor),this._uAlphaFresnelPower&&s.uniform1f(this._uAlphaFresnelPower,o._alphaFresnel.power)),o._reflectivityFresnel&&(this._uReflectivityFresnelEdgeBias&&s.uniform1f(this._uReflectivityFresnelEdgeBias,o._reflectivityFresnel.edgeBias),this._uReflectivityFresnelCenterBias&&s.uniform1f(this._uReflectivityFresnelCenterBias,o._reflectivityFresnel.centerBias),this._uReflectivityFresnelEdgeColor&&s.uniform3fv(this._uReflectivityFresnelEdgeColor,o._reflectivityFresnel.edgeColor),this._uReflectivityFresnelCenterColor&&s.uniform3fv(this._uReflectivityFresnelCenterColor,o._reflectivityFresnel.centerColor),this._uReflectivityFresnelPower&&s.uniform1f(this._uReflectivityFresnelPower,o._reflectivityFresnel.power)),o._emissiveFresnel&&(this._uEmissiveFresnelEdgeBias&&s.uniform1f(this._uEmissiveFresnelEdgeBias,o._emissiveFresnel.edgeBias),this._uEmissiveFresnelCenterBias&&s.uniform1f(this._uEmissiveFresnelCenterBias,o._emissiveFresnel.centerBias),this._uEmissiveFresnelEdgeColor&&s.uniform3fv(this._uEmissiveFresnelEdgeColor,o._emissiveFresnel.edgeColor),this._uEmissiveFresnelCenterColor&&s.uniform3fv(this._uEmissiveFresnelCenterColor,o._emissiveFresnel.centerColor),this._uEmissiveFresnelPower&&s.uniform1f(this._uEmissiveFresnelPower,o._emissiveFresnel.power));break;case"MetallicMaterial":this._uBaseColor&&s.uniform3fv(this._uBaseColor,l.baseColor),this._uMaterialMetallic&&s.uniform1f(this._uMaterialMetallic,l.metallic),this._uMaterialRoughness&&s.uniform1f(this._uMaterialRoughness,l.roughness),this._uMaterialSpecularF0&&s.uniform1f(this._uMaterialSpecularF0,l.specularF0),this._uMaterialEmissive&&s.uniform3fv(this._uMaterialEmissive,l.emissive),this._uAlphaModeCutoff&&s.uniform4f(this._uAlphaModeCutoff,1*l.alpha,1===l.alphaMode?1:0,l.alphaCutoff,0);const t=o._baseColorMap;t&&t._state.texture&&this._uBaseColorMap&&(n.bindTexture(this._uBaseColorMap,t._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uBaseColorMapMatrix&&s.uniformMatrix4fv(this._uBaseColorMapMatrix,!1,t._state.matrix));const r=o._metallicMap;r&&r._state.texture&&this._uMetallicMap&&(n.bindTexture(this._uMetallicMap,r._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uMetallicMapMatrix&&s.uniformMatrix4fv(this._uMetallicMapMatrix,!1,r._state.matrix));const a=o._roughnessMap;a&&a._state.texture&&this._uRoughnessMap&&(n.bindTexture(this._uRoughnessMap,a._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uRoughnessMapMatrix&&s.uniformMatrix4fv(this._uRoughnessMapMatrix,!1,a._state.matrix));const c=o._metallicRoughnessMap;c&&c._state.texture&&this._uMetallicRoughnessMap&&(n.bindTexture(this._uMetallicRoughnessMap,c._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uMetallicRoughnessMapMatrix&&s.uniformMatrix4fv(this._uMetallicRoughnessMapMatrix,!1,c._state.matrix)),(h=o._emissiveMap)&&h._state.texture&&this._uEmissiveMap&&(n.bindTexture(this._uEmissiveMap,h._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uEmissiveMapMatrix&&s.uniformMatrix4fv(this._uEmissiveMapMatrix,!1,h._state.matrix)),(d=o._occlusionMap)&&o._occlusionMap._state.texture&&this._uOcclusionMap&&(n.bindTexture(this._uOcclusionMap,d._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uOcclusionMapMatrix&&s.uniformMatrix4fv(this._uOcclusionMapMatrix,!1,d._state.matrix)),(u=o._alphaMap)&&u._state.texture&&this._uAlphaMap&&(n.bindTexture(this._uAlphaMap,u._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uAlphaMapMatrix&&s.uniformMatrix4fv(this._uAlphaMapMatrix,!1,u._state.matrix)),(p=o._normalMap)&&p._state.texture&&this._uNormalMap&&(n.bindTexture(this._uNormalMap,p._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uNormalMapMatrix&&s.uniformMatrix4fv(this._uNormalMapMatrix,!1,p._state.matrix));break;case"SpecularMaterial":this._uMaterialDiffuse&&s.uniform3fv(this._uMaterialDiffuse,l.diffuse),this._uMaterialSpecular&&s.uniform3fv(this._uMaterialSpecular,l.specular),this._uMaterialGlossiness&&s.uniform1f(this._uMaterialGlossiness,l.glossiness),this._uMaterialReflectivity&&s.uniform1f(this._uMaterialReflectivity,l.reflectivity),this._uMaterialEmissive&&s.uniform3fv(this._uMaterialEmissive,l.emissive),this._uAlphaModeCutoff&&s.uniform4f(this._uAlphaModeCutoff,1*l.alpha,1===l.alphaMode?1:0,l.alphaCutoff,0);const m=o._diffuseMap;m&&m._state.texture&&this._uDiffuseMap&&(n.bindTexture(this._uDiffuseMap,m._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uDiffuseMapMatrix&&s.uniformMatrix4fv(this._uDiffuseMapMatrix,!1,m._state.matrix));const f=o._specularMap;f&&f._state.texture&&this._uSpecularMap&&(n.bindTexture(this._uSpecularMap,f._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uSpecularMapMatrix&&s.uniformMatrix4fv(this._uSpecularMapMatrix,!1,f._state.matrix));const g=o._glossinessMap;g&&g._state.texture&&this._uGlossinessMap&&(n.bindTexture(this._uGlossinessMap,g._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uGlossinessMapMatrix&&s.uniformMatrix4fv(this._uGlossinessMapMatrix,!1,g._state.matrix));const b=o._specularGlossinessMap;var h,d,u,p;b&&b._state.texture&&this._uSpecularGlossinessMap&&(n.bindTexture(this._uSpecularGlossinessMap,b._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uSpecularGlossinessMapMatrix&&s.uniformMatrix4fv(this._uSpecularGlossinessMapMatrix,!1,b._state.matrix)),(h=o._emissiveMap)&&h._state.texture&&this._uEmissiveMap&&(n.bindTexture(this._uEmissiveMap,h._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uEmissiveMapMatrix&&s.uniformMatrix4fv(this._uEmissiveMapMatrix,!1,h._state.matrix)),(d=o._occlusionMap)&&d._state.texture&&this._uOcclusionMap&&(n.bindTexture(this._uOcclusionMap,d._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uOcclusionMapMatrix&&s.uniformMatrix4fv(this._uOcclusionMapMatrix,!1,d._state.matrix)),(u=o._alphaMap)&&u._state.texture&&this._uAlphaMap&&(n.bindTexture(this._uAlphaMap,u._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uAlphaMapMatrix&&s.uniformMatrix4fv(this._uAlphaMapMatrix,!1,u._state.matrix)),(p=o._normalMap)&&p._state.texture&&this._uNormalMap&&(n.bindTexture(this._uNormalMap,p._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uNormalMapMatrix&&s.uniformMatrix4fv(this._uNormalMapMatrix,!1,p._state.matrix))}this._lastMaterialId=l.id}if(s.uniformMatrix4fv(this._uModelMatrix,s.FALSE,t.worldMatrix),this._uModelNormalMatrix&&s.uniformMatrix4fv(this._uModelNormalMatrix,s.FALSE,t.worldNormalMatrix),this._uClippable&&s.uniform1i(this._uClippable,a.clippable),this._uColorize){const e=a.colorize,t=this._lastColorize;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]||(s.uniform4fv(this._uColorize,e),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3])}c.id!==this._lastGeometryId&&(this._uPositionsDecodeMatrix&&s.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,c.positionsDecodeMatrix),this._uUVDecodeMatrix&&s.uniformMatrix3fv(this._uUVDecodeMatrix,!1,c.uvDecodeMatrix),this._aPosition&&(this._aPosition.bindArrayBuffer(c.positionsBuf),e.bindArray++),this._aNormal&&(this._aNormal.bindArrayBuffer(c.normalsBuf),e.bindArray++),this._aUV&&(this._aUV.bindArrayBuffer(c.uvBuf),e.bindArray++),this._aColor&&(this._aColor.bindArrayBuffer(c.colorsBuf),e.bindArray++),this._aFlags&&(this._aFlags.bindArrayBuffer(c.flagsBuf),e.bindArray++),c.indicesBuf?(c.indicesBuf.bind(),e.bindArray++):c.positions,this._lastGeometryId=c.id),c.indicesBuf?(s.drawElements(c.primitive,c.indicesBuf.numItems,c.indicesBuf.itemType,0),e.drawElements++):c.positions&&(s.drawArrays(s.TRIANGLES,0,c.positions.numItems),e.drawArrays++)},Le.prototype._allocate=function(e){const t=e.scene.canvas.gl,i=e._material,r=e.scene._lightsState,o=e.scene._sectionPlanesState,s=e._material._state;if(this._program=new De(t,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const n=this._program;this._uPositionsDecodeMatrix=n.getLocation("positionsDecodeMatrix"),this._uUVDecodeMatrix=n.getLocation("uvDecodeMatrix"),this._uModelMatrix=n.getLocation("modelMatrix"),this._uModelNormalMatrix=n.getLocation("modelNormalMatrix"),this._uViewMatrix=n.getLocation("viewMatrix"),this._uViewNormalMatrix=n.getLocation("viewNormalMatrix"),this._uProjMatrix=n.getLocation("projMatrix"),this._uGammaFactor=n.getLocation("gammaFactor"),this._uLightAmbient=[],this._uLightColor=[],this._uLightDir=[],this._uLightPos=[],this._uLightAttenuation=[],this._uShadowViewMatrix=[],this._uShadowProjMatrix=[];const a=r.lights;let l;for(var c=0,h=a.length;c<h;c++){switch((l=a[c]).type){case"ambient":this._uLightAmbient[c]=n.getLocation("lightAmbient");break;case"dir":this._uLightColor[c]=n.getLocation("lightColor"+c),this._uLightPos[c]=null,this._uLightDir[c]=n.getLocation("lightDir"+c);break;case"point":this._uLightColor[c]=n.getLocation("lightColor"+c),this._uLightPos[c]=n.getLocation("lightPos"+c),this._uLightDir[c]=null,this._uLightAttenuation[c]=n.getLocation("lightAttenuation"+c);break;case"spot":this._uLightColor[c]=n.getLocation("lightColor"+c),this._uLightPos[c]=n.getLocation("lightPos"+c),this._uLightDir[c]=n.getLocation("lightDir"+c),this._uLightAttenuation[c]=n.getLocation("lightAttenuation"+c)}l.castsShadow&&(this._uShadowViewMatrix[c]=n.getLocation("shadowViewMatrix"+c),this._uShadowProjMatrix[c]=n.getLocation("shadowProjMatrix"+c))}r.lightMaps.length>0&&(this._uLightMap="lightMap"),r.reflectionMaps.length>0&&(this._uReflectionMap="reflectionMap"),this._uSectionPlanes=[];for(c=0,h=o.sectionPlanes.length;c<h;c++)this._uSectionPlanes.push({active:n.getLocation("sectionPlaneActive"+c),pos:n.getLocation("sectionPlanePos"+c),dir:n.getLocation("sectionPlaneDir"+c)});switch(this._uPointSize=n.getLocation("pointSize"),s.type){case"LambertMaterial":this._uMaterialColor=n.getLocation("materialColor"),this._uMaterialEmissive=n.getLocation("materialEmissive"),this._uAlphaModeCutoff=n.getLocation("materialAlphaModeCutoff");break;case"PhongMaterial":this._uMaterialAmbient=n.getLocation("materialAmbient"),this._uMaterialDiffuse=n.getLocation("materialDiffuse"),this._uMaterialSpecular=n.getLocation("materialSpecular"),this._uMaterialEmissive=n.getLocation("materialEmissive"),this._uAlphaModeCutoff=n.getLocation("materialAlphaModeCutoff"),this._uMaterialShininess=n.getLocation("materialShininess"),i._ambientMap&&(this._uMaterialAmbientMap="ambientMap",this._uMaterialAmbientMapMatrix=n.getLocation("ambientMapMatrix")),i._diffuseMap&&(this._uDiffuseMap="diffuseMap",this._uDiffuseMapMatrix=n.getLocation("diffuseMapMatrix")),i._specularMap&&(this._uSpecularMap="specularMap",this._uSpecularMapMatrix=n.getLocation("specularMapMatrix")),i._emissiveMap&&(this._uEmissiveMap="emissiveMap",this._uEmissiveMapMatrix=n.getLocation("emissiveMapMatrix")),i._alphaMap&&(this._uAlphaMap="alphaMap",this._uAlphaMapMatrix=n.getLocation("alphaMapMatrix")),i._reflectivityMap&&(this._uReflectivityMap="reflectivityMap",this._uReflectivityMapMatrix=n.getLocation("reflectivityMapMatrix")),i._normalMap&&(this._uNormalMap="normalMap",this._uNormalMapMatrix=n.getLocation("normalMapMatrix")),i._occlusionMap&&(this._uOcclusionMap="occlusionMap",this._uOcclusionMapMatrix=n.getLocation("occlusionMapMatrix")),i._diffuseFresnel&&(this._uDiffuseFresnelEdgeBias=n.getLocation("diffuseFresnelEdgeBias"),this._uDiffuseFresnelCenterBias=n.getLocation("diffuseFresnelCenterBias"),this._uDiffuseFresnelEdgeColor=n.getLocation("diffuseFresnelEdgeColor"),this._uDiffuseFresnelCenterColor=n.getLocation("diffuseFresnelCenterColor"),this._uDiffuseFresnelPower=n.getLocation("diffuseFresnelPower")),i._specularFresnel&&(this._uSpecularFresnelEdgeBias=n.getLocation("specularFresnelEdgeBias"),this._uSpecularFresnelCenterBias=n.getLocation("specularFresnelCenterBias"),this._uSpecularFresnelEdgeColor=n.getLocation("specularFresnelEdgeColor"),this._uSpecularFresnelCenterColor=n.getLocation("specularFresnelCenterColor"),this._uSpecularFresnelPower=n.getLocation("specularFresnelPower")),i._alphaFresnel&&(this._uAlphaFresnelEdgeBias=n.getLocation("alphaFresnelEdgeBias"),this._uAlphaFresnelCenterBias=n.getLocation("alphaFresnelCenterBias"),this._uAlphaFresnelEdgeColor=n.getLocation("alphaFresnelEdgeColor"),this._uAlphaFresnelCenterColor=n.getLocation("alphaFresnelCenterColor"),this._uAlphaFresnelPower=n.getLocation("alphaFresnelPower")),i._reflectivityFresnel&&(this._uReflectivityFresnelEdgeBias=n.getLocation("reflectivityFresnelEdgeBias"),this._uReflectivityFresnelCenterBias=n.getLocation("reflectivityFresnelCenterBias"),this._uReflectivityFresnelEdgeColor=n.getLocation("reflectivityFresnelEdgeColor"),this._uReflectivityFresnelCenterColor=n.getLocation("reflectivityFresnelCenterColor"),this._uReflectivityFresnelPower=n.getLocation("reflectivityFresnelPower")),i._emissiveFresnel&&(this._uEmissiveFresnelEdgeBias=n.getLocation("emissiveFresnelEdgeBias"),this._uEmissiveFresnelCenterBias=n.getLocation("emissiveFresnelCenterBias"),this._uEmissiveFresnelEdgeColor=n.getLocation("emissiveFresnelEdgeColor"),this._uEmissiveFresnelCenterColor=n.getLocation("emissiveFresnelCenterColor"),this._uEmissiveFresnelPower=n.getLocation("emissiveFresnelPower"));break;case"MetallicMaterial":this._uBaseColor=n.getLocation("materialBaseColor"),this._uMaterialMetallic=n.getLocation("materialMetallic"),this._uMaterialRoughness=n.getLocation("materialRoughness"),this._uMaterialSpecularF0=n.getLocation("materialSpecularF0"),this._uMaterialEmissive=n.getLocation("materialEmissive"),this._uAlphaModeCutoff=n.getLocation("materialAlphaModeCutoff"),i._baseColorMap&&(this._uBaseColorMap="baseColorMap",this._uBaseColorMapMatrix=n.getLocation("baseColorMapMatrix")),i._metallicMap&&(this._uMetallicMap="metallicMap",this._uMetallicMapMatrix=n.getLocation("metallicMapMatrix")),i._roughnessMap&&(this._uRoughnessMap="roughnessMap",this._uRoughnessMapMatrix=n.getLocation("roughnessMapMatrix")),i._metallicRoughnessMap&&(this._uMetallicRoughnessMap="metallicRoughnessMap",this._uMetallicRoughnessMapMatrix=n.getLocation("metallicRoughnessMapMatrix")),i._emissiveMap&&(this._uEmissiveMap="emissiveMap",this._uEmissiveMapMatrix=n.getLocation("emissiveMapMatrix")),i._occlusionMap&&(this._uOcclusionMap="occlusionMap",this._uOcclusionMapMatrix=n.getLocation("occlusionMapMatrix")),i._alphaMap&&(this._uAlphaMap="alphaMap",this._uAlphaMapMatrix=n.getLocation("alphaMapMatrix")),i._normalMap&&(this._uNormalMap="normalMap",this._uNormalMapMatrix=n.getLocation("normalMapMatrix"));break;case"SpecularMaterial":this._uMaterialDiffuse=n.getLocation("materialDiffuse"),this._uMaterialSpecular=n.getLocation("materialSpecular"),this._uMaterialGlossiness=n.getLocation("materialGlossiness"),this._uMaterialReflectivity=n.getLocation("reflectivityFresnel"),this._uMaterialEmissive=n.getLocation("materialEmissive"),this._uAlphaModeCutoff=n.getLocation("materialAlphaModeCutoff"),i._diffuseMap&&(this._uDiffuseMap="diffuseMap",this._uDiffuseMapMatrix=n.getLocation("diffuseMapMatrix")),i._specularMap&&(this._uSpecularMap="specularMap",this._uSpecularMapMatrix=n.getLocation("specularMapMatrix")),i._glossinessMap&&(this._uGlossinessMap="glossinessMap",this._uGlossinessMapMatrix=n.getLocation("glossinessMapMatrix")),i._specularGlossinessMap&&(this._uSpecularGlossinessMap="materialSpecularGlossinessMap",this._uSpecularGlossinessMapMatrix=n.getLocation("materialSpecularGlossinessMapMatrix")),i._emissiveMap&&(this._uEmissiveMap="emissiveMap",this._uEmissiveMapMatrix=n.getLocation("emissiveMapMatrix")),i._occlusionMap&&(this._uOcclusionMap="occlusionMap",this._uOcclusionMapMatrix=n.getLocation("occlusionMapMatrix")),i._alphaMap&&(this._uAlphaMap="alphaMap",this._uAlphaMapMatrix=n.getLocation("alphaMapMatrix")),i._normalMap&&(this._uNormalMap="normalMap",this._uNormalMapMatrix=n.getLocation("normalMapMatrix"))}this._aPosition=n.getAttribute("position"),this._aNormal=n.getAttribute("normal"),this._aUV=n.getAttribute("uv"),this._aColor=n.getAttribute("color"),this._aFlags=n.getAttribute("flags"),this._uClippable=n.getLocation("clippable"),this._uColorize=n.getLocation("colorize"),this._lastMaterialId=null,this._lastVertexBufsId=null,this._lastGeometryId=null,this._lastColorize=new Float32Array(4),this._baseTextureUnit=0},Le.prototype._bindProgram=function(e){const t=q.MAX_TEXTURE_UNITS,i=this._scene,r=i.canvas.gl,o=i._lightsState,s=i._sectionPlanesState;o.lights;let n;const a=this._program;a.bind(),e.useProgram++,e.textureUnit=0,this._lastMaterialId=null,this._lastVertexBufsId=null,this._lastGeometryId=null,this._lastColorize[0]=-1,this._lastColorize[1]=-1,this._lastColorize[2]=-1,this._lastColorize[3]=-1;const l=i.camera,c=l._state;r.uniformMatrix4fv(this._uViewMatrix,!1,c.matrix),r.uniformMatrix4fv(this._uViewNormalMatrix,!1,c.normalMatrix),r.uniformMatrix4fv(this._uProjMatrix,!1,l._project._state.matrix);for(var h=0,d=o.lights.length;h<d;h++)if(n=o.lights[h],this._uLightAmbient[h])r.uniform4f(this._uLightAmbient[h],n.color[0],n.color[1],n.color[2],n.intensity);else if(this._uLightColor[h]&&r.uniform4f(this._uLightColor[h],n.color[0],n.color[1],n.color[2],n.intensity),this._uLightPos[h]&&(r.uniform3fv(this._uLightPos[h],n.pos),this._uLightAttenuation[h]&&r.uniform1f(this._uLightAttenuation[h],n.attenuation)),this._uLightDir[h]&&r.uniform3fv(this._uLightDir[h],n.dir),n.castsShadow){this._uShadowViewMatrix[h]&&r.uniformMatrix4fv(this._uShadowViewMatrix[h],!1,n.getShadowViewMatrix()),this._uShadowProjMatrix[h]&&r.uniformMatrix4fv(this._uShadowProjMatrix[h],!1,n.getShadowProjMatrix());const i=n.getShadowRenderBuf();i&&(a.bindTexture("shadowMap"+h,i.getTexture(),e.textureUnit),e.textureUnit=(e.textureUnit+1)%t,e.bindTexture++)}if(o.lightMaps.length>0&&o.lightMaps[0].texture&&this._uLightMap&&(a.bindTexture(this._uLightMap,o.lightMaps[0].texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%t,e.bindTexture++),o.reflectionMaps.length>0&&o.reflectionMaps[0].texture&&this._uReflectionMap&&(a.bindTexture(this._uReflectionMap,o.reflectionMaps[0].texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%t,e.bindTexture++),s.sectionPlanes.length>0){const e=i._sectionPlanesState.sectionPlanes;let t,o,s,n,a;for(h=0,d=this._uSectionPlanes.length;h<d;h++)o=(t=this._uSectionPlanes[h]).active,s=e[h],o&&r.uniform1i(o,s.active),(n=t.pos)&&r.uniform3fv(t.pos,s.pos),(a=t.dir)&&r.uniform3fv(t.dir,s.dir)}this._uGammaFactor&&r.uniform1f(this._uGammaFactor,i.gammaFactor),this._baseTextureUnit=e.textureUnit};class Ie{constructor(e){this.vertex=function(e){const t=e.scene,i=t._lightsState,r=function(e){const t=e._geometry._state.primitiveName;if((e._geometry._state.autoVertexNormals||e._geometry._state.normalsBuf)&&("triangles"===t||"triangle-strip"===t||"triangle-fan"===t))return!0;return!1}(e),o=t._sectionPlanesState.sectionPlanes.length>0,s=!!e._geometry._state.compressGeometry,n=e._state.billboard,a=e._state.stationary,l=[];let c,h,d;l.push("// EmphasisFillShaderSource vertex shader"),l.push("attribute vec3 position;"),l.push("uniform mat4 modelMatrix;"),l.push("uniform mat4 viewMatrix;"),l.push("uniform mat4 projMatrix;"),l.push("uniform vec4 colorize;"),s&&l.push("uniform mat4 positionsDecodeMatrix;");o&&l.push("varying vec4 vWorldPosition;");if(l.push("uniform vec4   lightAmbient;"),l.push("uniform vec4   fillColor;"),r){for(l.push("attribute vec3 normal;"),l.push("uniform mat4 modelNormalMatrix;"),l.push("uniform mat4 viewNormalMatrix;"),c=0,h=i.lights.length;c<h;c++)"ambient"!==(d=i.lights[c]).type&&(l.push("uniform vec4 lightColor"+c+";"),"dir"===d.type&&l.push("uniform vec3 lightDir"+c+";"),"point"===d.type&&l.push("uniform vec3 lightPos"+c+";"),"spot"===d.type&&l.push("uniform vec3 lightPos"+c+";"));s&&(l.push("vec3 octDecode(vec2 oct) {"),l.push("    vec3 v = vec3(oct.xy, 1.0 - abs(oct.x) - abs(oct.y));"),l.push("    if (v.z < 0.0) {"),l.push("        v.xy = (1.0 - abs(v.yx)) * vec2(v.x >= 0.0 ? 1.0 : -1.0, v.y >= 0.0 ? 1.0 : -1.0);"),l.push("    }"),l.push("    return normalize(v);"),l.push("}"))}l.push("varying vec4 vColor;"),("spherical"===n||"cylindrical"===n)&&(l.push("void billboard(inout mat4 mat) {"),l.push("   mat[0][0] = 1.0;"),l.push("   mat[0][1] = 0.0;"),l.push("   mat[0][2] = 0.0;"),"spherical"===n&&(l.push("   mat[1][0] = 0.0;"),l.push("   mat[1][1] = 1.0;"),l.push("   mat[1][2] = 0.0;")),l.push("   mat[2][0] = 0.0;"),l.push("   mat[2][1] = 0.0;"),l.push("   mat[2][2] =1.0;"),l.push("}"));l.push("void main(void) {"),l.push("vec4 localPosition = vec4(position, 1.0); "),l.push("vec4 worldPosition;"),s&&l.push("localPosition = positionsDecodeMatrix * localPosition;");r&&(s?l.push("vec4 localNormal = vec4(octDecode(normal.xy), 0.0); "):l.push("vec4 localNormal = vec4(normal, 0.0); "),l.push("mat4 modelNormalMatrix2 = modelNormalMatrix;"),l.push("mat4 viewNormalMatrix2 = viewNormalMatrix;"));l.push("mat4 viewMatrix2 = viewMatrix;"),l.push("mat4 modelMatrix2 = modelMatrix;"),a&&l.push("viewMatrix2[3][0] = viewMatrix2[3][1] = viewMatrix2[3][2] = 0.0;");"spherical"===n||"cylindrical"===n?(l.push("mat4 modelViewMatrix = viewMatrix2 * modelMatrix2;"),l.push("billboard(modelMatrix2);"),l.push("billboard(viewMatrix2);"),l.push("billboard(modelViewMatrix);"),r&&(l.push("mat4 modelViewNormalMatrix =  viewNormalMatrix2 * modelNormalMatrix2;"),l.push("billboard(modelNormalMatrix2);"),l.push("billboard(viewNormalMatrix2);"),l.push("billboard(modelViewNormalMatrix);")),l.push("worldPosition = modelMatrix2 * localPosition;"),l.push("vec4 viewPosition = modelViewMatrix * localPosition;")):(l.push("worldPosition = modelMatrix2 * localPosition;"),l.push("vec4 viewPosition  = viewMatrix2 * worldPosition; "));r&&l.push("vec3 viewNormal = normalize((viewNormalMatrix2 * modelNormalMatrix2 * localNormal).xyz);");if(l.push("vec3 reflectedColor = vec3(0.0, 0.0, 0.0);"),l.push("vec3 viewLightDir = vec3(0.0, 0.0, -1.0);"),l.push("float lambertian = 1.0;"),r)for(c=0,h=i.lights.length;c<h;c++)if("ambient"!==(d=i.lights[c]).type){if("dir"===d.type)"view"===d.space?l.push("viewLightDir = normalize(lightDir"+c+");"):l.push("viewLightDir = normalize((viewMatrix2 * vec4(lightDir"+c+", 0.0)).xyz);");else{if("point"!==d.type)continue;"view"===d.space?l.push("viewLightDir = normalize(lightPos"+c+" - viewPosition.xyz);"):l.push("viewLightDir = normalize((viewMatrix2 * vec4(lightPos"+c+", 0.0)).xyz);")}l.push("lambertian = max(dot(-viewNormal, viewLightDir), 0.0);"),l.push("reflectedColor += lambertian * (lightColor"+c+".rgb * lightColor"+c+".a);")}l.push("vColor = vec4(reflectedColor * fillColor.rgb, fillColor.a);"),o&&l.push("vWorldPosition = worldPosition;");"points"===e._geometry._state.primitiveName&&l.push("gl_PointSize = pointSize;");return l.push("   gl_Position = projMatrix * viewPosition;"),l.push("}"),l}(e),this.fragment=function(e){const t=e.scene._sectionPlanesState,i=e.scene.gammaOutput,r=t.sectionPlanes.length>0;let o,s;const n=[];n.push("// Lambertian drawing fragment shader"),n.push("precision lowp float;"),i&&(n.push("uniform float gammaFactor;"),n.push("vec4 linearToGamma( in vec4 value, in float gammaFactor ) {"),n.push("  return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );"),n.push("}"));if(r)for(n.push("varying vec4 vWorldPosition;"),n.push("uniform bool clippable;"),o=0,s=t.sectionPlanes.length;o<s;o++)n.push("uniform bool sectionPlaneActive"+o+";"),n.push("uniform vec3 sectionPlanePos"+o+";"),n.push("uniform vec3 sectionPlaneDir"+o+";");if(n.push("varying vec4 vColor;"),n.push("void main(void) {"),r){for(n.push("if (clippable) {"),n.push("  float dist = 0.0;"),o=0,s=t.sectionPlanes.length;o<s;o++)n.push("if (sectionPlaneActive"+o+") {"),n.push("   dist += clamp(dot(-sectionPlaneDir"+o+".xyz, vWorldPosition.xyz - sectionPlanePos"+o+".xyz), 0.0, 1000.0);"),n.push("}");n.push("  if (dist > 0.0) { discard; }"),n.push("}")}"points"===e._geometry._state.primitiveName&&(n.push("vec2 cxy = 2.0 * gl_PointCoord - 1.0;"),n.push("float r = dot(cxy, cxy);"),n.push("if (r > 1.0) {"),n.push("   discard;"),n.push("}"));n.push("gl_FragColor = vColor;"),i?n.push("gl_FragColor = linearToGamma(vColor, gammaFactor);"):n.push("gl_FragColor = vColor;");return n.push("}"),n}(e)}}const Ne=new n({}),Fe=function(e,t){this.id=Ne.addItem({}),this._hash=e,this._scene=t.scene,this._useCount=0,this._shaderSource=new Ie(t),this._allocate(t)},Be={};Fe.get=function(e){const t=[e.scene.id,e.scene.gammaOutput?"go":"",e.scene._sectionPlanesState.getHash(),e._geometry._state.normalsBuf?"n":"",e._geometry._state.compressGeometry?"cp":"",e._state.hash].join(";");let i=Be[t];return i||(i=new Fe(t,e),Be[t]=i,P.memory.programs++),i._useCount++,i},Fe.prototype.put=function(){0==--this._useCount&&(Ne.removeItem(this.id),this._program&&this._program.destroy(),delete Be[this._hash],P.memory.programs--)},Fe.prototype.webglContextRestored=function(){this._program=null},Fe.prototype.drawMesh=function(e,t,i){this._program||this._allocate(t);const r=this._scene.canvas.gl,o=0===i?t._xrayMaterial._state:1===i?t._highlightMaterial._state:t._selectedMaterial._state,s=t._state,n=t._geometry._state;if(e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e)),o.id!==this._lastMaterialId){const t=o.fillColor,i=o.backfaces;e.backfaces!==i&&(i?r.disable(r.CULL_FACE):r.enable(r.CULL_FACE),e.backfaces=i),r.uniform4f(this._uFillColor,t[0],t[1],t[2],o.fillAlpha),this._lastMaterialId=o.id}r.uniformMatrix4fv(this._uModelMatrix,r.FALSE,t.worldMatrix),this._uModelNormalMatrix&&r.uniformMatrix4fv(this._uModelNormalMatrix,r.FALSE,t.worldNormalMatrix),this._uClippable&&r.uniform1i(this._uClippable,s.clippable),n.id!==this._lastGeometryId&&(this._uPositionsDecodeMatrix&&r.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,n.positionsDecodeMatrix),this._uUVDecodeMatrix&&r.uniformMatrix3fv(this._uUVDecodeMatrix,!1,n.uvDecodeMatrix),this._aPosition&&(this._aPosition.bindArrayBuffer(n.positionsBuf),e.bindArray++),this._aNormal&&(this._aNormal.bindArrayBuffer(n.normalsBuf),e.bindArray++),n.indicesBuf?(n.indicesBuf.bind(),e.bindArray++):n.positionsBuf,this._lastGeometryId=n.id),n.indicesBuf?(r.drawElements(n.primitive,n.indicesBuf.numItems,n.indicesBuf.itemType,0),e.drawElements++):n.positionsBuf&&(r.drawArrays(r.TRIANGLES,0,n.positionsBuf.numItems),e.drawArrays++)},Fe.prototype._allocate=function(e){const t=e.scene._lightsState,i=e.scene._sectionPlanesState,r=e.scene.canvas.gl;if(this._program=new De(r,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const o=this._program;this._uPositionsDecodeMatrix=o.getLocation("positionsDecodeMatrix"),this._uModelMatrix=o.getLocation("modelMatrix"),this._uModelNormalMatrix=o.getLocation("modelNormalMatrix"),this._uViewMatrix=o.getLocation("viewMatrix"),this._uViewNormalMatrix=o.getLocation("viewNormalMatrix"),this._uProjMatrix=o.getLocation("projMatrix"),this._uLightAmbient=[],this._uLightColor=[],this._uLightDir=[],this._uLightPos=[],this._uLightAttenuation=[];for(var s=0,n=t.lights.length;s<n;s++){switch(t.lights[s].type){case"ambient":this._uLightAmbient[s]=o.getLocation("lightAmbient");break;case"dir":this._uLightColor[s]=o.getLocation("lightColor"+s),this._uLightPos[s]=null,this._uLightDir[s]=o.getLocation("lightDir"+s);break;case"point":this._uLightColor[s]=o.getLocation("lightColor"+s),this._uLightPos[s]=o.getLocation("lightPos"+s),this._uLightDir[s]=null,this._uLightAttenuation[s]=o.getLocation("lightAttenuation"+s)}}this._uSectionPlanes=[];for(s=0,n=i.sectionPlanes.length;s<n;s++)this._uSectionPlanes.push({active:o.getLocation("sectionPlaneActive"+s),pos:o.getLocation("sectionPlanePos"+s),dir:o.getLocation("sectionPlaneDir"+s)});this._uFillColor=o.getLocation("fillColor"),this._aPosition=o.getAttribute("position"),this._aNormal=o.getAttribute("normal"),this._uClippable=o.getLocation("clippable"),this._uGammaFactor=o.getLocation("gammaFactor"),this._lastMaterialId=null,this._lastVertexBufsId=null,this._lastGeometryId=null},Fe.prototype._bindProgram=function(e){const t=this._scene,i=t.canvas.gl,r=t._sectionPlanesState,o=t._lightsState,s=t.camera,n=s._state;let a;this._program.bind(),e.useProgram++,e.textureUnit=0,this._lastMaterialId=null,this._lastVertexBufsId=null,this._lastGeometryId=null,this._lastIndicesBufId=null,i.uniformMatrix4fv(this._uViewMatrix,!1,n.matrix),i.uniformMatrix4fv(this._uViewNormalMatrix,!1,n.normalMatrix),i.uniformMatrix4fv(this._uProjMatrix,!1,s.project._state.matrix);for(var l=0,c=o.lights.length;l<c;l++)a=o.lights[l],this._uLightAmbient[l]?i.uniform4f(this._uLightAmbient[l],a.color[0],a.color[1],a.color[2],a.intensity):(this._uLightColor[l]&&i.uniform4f(this._uLightColor[l],a.color[0],a.color[1],a.color[2],a.intensity),this._uLightPos[l]&&(i.uniform3fv(this._uLightPos[l],a.pos),this._uLightAttenuation[l]&&i.uniform1f(this._uLightAttenuation[l],a.attenuation)),this._uLightDir[l]&&i.uniform3fv(this._uLightDir[l],a.dir));if(r.sectionPlanes.length>0){const e=t._sectionPlanesState.sectionPlanes;let r,o,s,n,a;for(l=0,c=this._uSectionPlanes.length;l<c;l++)o=(r=this._uSectionPlanes[l]).active,s=e[l],o&&i.uniform1i(o,s.active),(n=r.pos)&&i.uniform3fv(r.pos,s.pos),(a=r.dir)&&i.uniform3fv(r.dir,s.dir)}this._uGammaFactor&&i.uniform1f(this._uGammaFactor,t.gammaFactor)};class Oe{constructor(e){this.vertex=function(e){const t=e.scene._sectionPlanesState.sectionPlanes.length>0,i=!!e._geometry._state.compressGeometry,r=e._state.billboard,o=e._state.stationary,s=[];s.push("// Edges drawing vertex shader"),s.push("attribute vec3 position;"),s.push("uniform mat4 modelMatrix;"),s.push("uniform mat4 viewMatrix;"),s.push("uniform mat4 projMatrix;"),s.push("uniform vec4 edgeColor;"),i&&s.push("uniform mat4 positionsDecodeMatrix;");t&&s.push("varying vec4 vWorldPosition;");s.push("varying vec4 vColor;"),("spherical"===r||"cylindrical"===r)&&(s.push("void billboard(inout mat4 mat) {"),s.push("   mat[0][0] = 1.0;"),s.push("   mat[0][1] = 0.0;"),s.push("   mat[0][2] = 0.0;"),"spherical"===r&&(s.push("   mat[1][0] = 0.0;"),s.push("   mat[1][1] = 1.0;"),s.push("   mat[1][2] = 0.0;")),s.push("   mat[2][0] = 0.0;"),s.push("   mat[2][1] = 0.0;"),s.push("   mat[2][2] =1.0;"),s.push("}"));s.push("void main(void) {"),s.push("vec4 localPosition = vec4(position, 1.0); "),s.push("vec4 worldPosition;"),i&&s.push("localPosition = positionsDecodeMatrix * localPosition;");s.push("mat4 viewMatrix2 = viewMatrix;"),s.push("mat4 modelMatrix2 = modelMatrix;"),o&&s.push("viewMatrix2[3][0] = viewMatrix2[3][1] = viewMatrix2[3][2] = 0.0;");"spherical"===r||"cylindrical"===r?(s.push("mat4 modelViewMatrix = viewMatrix2 * modelMatrix2;"),s.push("billboard(modelMatrix2);"),s.push("billboard(viewMatrix2);"),s.push("billboard(modelViewMatrix);"),s.push("worldPosition = modelMatrix2 * localPosition;"),s.push("vec4 viewPosition = modelViewMatrix * localPosition;")):(s.push("worldPosition = modelMatrix2 * localPosition;"),s.push("vec4 viewPosition  = viewMatrix2 * worldPosition; "));s.push("vColor = edgeColor;"),t&&s.push("vWorldPosition = worldPosition;");return s.push("   gl_Position = projMatrix * viewPosition;"),s.push("}"),s}(e),this.fragment=function(e){const t=e.scene._sectionPlanesState,i=e.scene.gammaOutput,r=t.sectionPlanes.length>0;let o,s;const n=[];n.push("// Edges drawing fragment shader"),n.push("precision lowp float;"),i&&(n.push("uniform float gammaFactor;"),n.push("vec4 linearToGamma( in vec4 value, in float gammaFactor ) {"),n.push("  return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );"),n.push("}"));if(r)for(n.push("varying vec4 vWorldPosition;"),n.push("uniform bool clippable;"),o=0,s=t.sectionPlanes.length;o<s;o++)n.push("uniform bool sectionPlaneActive"+o+";"),n.push("uniform vec3 sectionPlanePos"+o+";"),n.push("uniform vec3 sectionPlaneDir"+o+";");if(n.push("varying vec4 vColor;"),n.push("void main(void) {"),r){for(n.push("if (clippable) {"),n.push("  float dist = 0.0;"),o=0,s=t.sectionPlanes.length;o<s;o++)n.push("if (sectionPlaneActive"+o+") {"),n.push("   dist += clamp(dot(-sectionPlaneDir"+o+".xyz, vWorldPosition.xyz - sectionPlanePos"+o+".xyz), 0.0, 1000.0);"),n.push("}");n.push("  if (dist > 0.0) { discard; }"),n.push("}")}n.push("gl_FragColor = vColor;"),i?n.push("gl_FragColor = linearToGamma(vColor, gammaFactor);"):n.push("gl_FragColor = vColor;");return n.push("}"),n}(e)}}const je=new n({}),ze=function(e,t){this.id=je.addItem({}),this._hash=e,this._scene=t.scene,this._useCount=0,this._shaderSource=new Oe(t),this._allocate(t)},Ve={};ze.get=function(e){const t=[e.scene.id,e.scene.gammaOutput?"go":"",e.scene._sectionPlanesState.getHash(),e._geometry._state.compressGeometry?"cp":"",e._state.hash].join(";");let i=Ve[t];return i||(i=new ze(t,e),Ve[t]=i,P.memory.programs++),i._useCount++,i},ze.prototype.put=function(){0==--this._useCount&&(je.removeItem(this.id),this._program&&this._program.destroy(),delete Ve[this._hash],P.memory.programs--)},ze.prototype.webglContextRestored=function(){this._program=null},ze.prototype.drawMesh=function(e,t,i){this._program||this._allocate(t);const r=this._scene.canvas.gl;let o;const s=t._state,n=t._geometry,a=n._state;switch(e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e)),i){case 0:o=t._xrayMaterial._state;break;case 1:o=t._highlightMaterial._state;break;case 2:o=t._selectedMaterial._state;break;case 3:default:o=t._edgeMaterial._state}if(o.id!==this._lastMaterialId){const t=o.backfaces;if(e.backfaces!==t&&(t?r.disable(r.CULL_FACE):r.enable(r.CULL_FACE),e.backfaces=t),e.lineWidth!==o.edgeWidth&&(r.lineWidth(o.edgeWidth),e.lineWidth=o.edgeWidth),this._uEdgeColor){const e=o.edgeColor,t=o.edgeAlpha;r.uniform4f(this._uEdgeColor,e[0],e[1],e[2],t)}this._lastMaterialId=o.id}let l;r.uniformMatrix4fv(this._uModelMatrix,r.FALSE,t.worldMatrix),this._uModelNormalMatrix&&r.uniformMatrix4fv(this._uModelNormalMatrix,r.FALSE,t.worldNormalMatrix),this._uClippable&&r.uniform1i(this._uClippable,s.clippable),a.primitive===r.TRIANGLES?l=n._getEdgeIndices():a.primitive===r.LINES&&(l=a.indicesBuf),l&&(a.id!==this._lastGeometryId&&(this._uPositionsDecodeMatrix&&r.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,a.positionsDecodeMatrix),this._aPosition&&(this._aPosition.bindArrayBuffer(a.positionsBuf,a.compressGeometry?r.UNSIGNED_SHORT:r.FLOAT),e.bindArray++),l.bind(),e.bindArray++,this._lastGeometryId=a.id),r.drawElements(r.LINES,l.numItems,l.itemType,0),e.drawElements++)},ze.prototype._allocate=function(e){const t=e.scene.canvas.gl,i=e.scene._sectionPlanesState;if(this._program=new De(t,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const r=this._program;this._uPositionsDecodeMatrix=r.getLocation("positionsDecodeMatrix"),this._uModelMatrix=r.getLocation("modelMatrix"),this._uViewMatrix=r.getLocation("viewMatrix"),this._uProjMatrix=r.getLocation("projMatrix"),this._uSectionPlanes=[];for(let e=0,t=i.sectionPlanes.length;e<t;e++)this._uSectionPlanes.push({active:r.getLocation("sectionPlaneActive"+e),pos:r.getLocation("sectionPlanePos"+e),dir:r.getLocation("sectionPlaneDir"+e)});this._uEdgeColor=r.getLocation("edgeColor"),this._aPosition=r.getAttribute("position"),this._uClippable=r.getLocation("clippable"),this._uGammaFactor=r.getLocation("gammaFactor"),this._lastMaterialId=null,this._lastVertexBufsId=null,this._lastGeometryId=null},ze.prototype._bindProgram=function(e){const t=this._program,i=this._scene,r=i.canvas.gl,o=i._sectionPlanesState,s=i.camera,n=s._state;if(t.bind(),e.useProgram++,this._lastMaterialId=null,this._lastVertexBufsId=null,this._lastGeometryId=null,r.uniformMatrix4fv(this._uViewMatrix,!1,n.matrix),r.uniformMatrix4fv(this._uProjMatrix,!1,s.project._state.matrix),o.sectionPlanes.length>0){const e=o.sectionPlanes;let t,i,s,n,a;for(let o=0,l=this._uSectionPlanes.length;o<l;o++)i=(t=this._uSectionPlanes[o]).active,s=e[o],i&&r.uniform1i(i,s.active),(n=t.pos)&&r.uniform3fv(t.pos,s.pos),(a=t.dir)&&r.uniform3fv(t.dir,s.dir)}this._uGammaFactor&&r.uniform1f(this._uGammaFactor,i.gammaFactor)};class Ue{constructor(e){this.vertex=function(e){const t=e.scene._sectionPlanesState.sectionPlanes.length>0,i=!!e._geometry._state.compressGeometry,r=e._state.billboard,o=e._state.stationary,s=[];s.push("// Mesh picking vertex shader"),s.push("attribute vec3 position;"),s.push("uniform mat4 modelMatrix;"),s.push("uniform mat4 viewMatrix;"),s.push("uniform mat4 projMatrix;"),s.push("varying vec4 vViewPosition;"),i&&s.push("uniform mat4 positionsDecodeMatrix;");t&&s.push("varying vec4 vWorldPosition;");"spherical"!==r&&"cylindrical"!==r||(s.push("void billboard(inout mat4 mat) {"),s.push("   mat[0][0] = 1.0;"),s.push("   mat[0][1] = 0.0;"),s.push("   mat[0][2] = 0.0;"),"spherical"===r&&(s.push("   mat[1][0] = 0.0;"),s.push("   mat[1][1] = 1.0;"),s.push("   mat[1][2] = 0.0;")),s.push("   mat[2][0] = 0.0;"),s.push("   mat[2][1] = 0.0;"),s.push("   mat[2][2] =1.0;"),s.push("}"));s.push("void main(void) {"),s.push("vec4 localPosition = vec4(position, 1.0); "),i&&s.push("localPosition = positionsDecodeMatrix * localPosition;");s.push("mat4 viewMatrix2 = viewMatrix;"),s.push("mat4 modelMatrix2 = modelMatrix;"),o&&s.push("viewMatrix2[3][0] = viewMatrix2[3][1] = viewMatrix2[3][2] = 0.0;");"spherical"!==r&&"cylindrical"!==r||(s.push("mat4 modelViewMatrix = viewMatrix2 * modelMatrix2;"),s.push("billboard(modelMatrix2);"),s.push("billboard(viewMatrix2);"));s.push("   vec4 worldPosition = modelMatrix2 * localPosition;"),s.push("   vec4 viewPosition = viewMatrix2 * worldPosition;"),t&&s.push("   vWorldPosition = worldPosition;");return s.push("   gl_Position = projMatrix * viewPosition;"),s.push("}"),s}(e),this.fragment=function(e){const t=e.scene._sectionPlanesState,i=t.sectionPlanes.length>0,r=[];if(r.push("// Mesh picking fragment shader"),r.push("precision lowp float;"),r.push("uniform vec4 pickColor;"),i){r.push("uniform bool clippable;"),r.push("varying vec4 vWorldPosition;");for(var o=0;o<t.sectionPlanes.length;o++)r.push("uniform bool sectionPlaneActive"+o+";"),r.push("uniform vec3 sectionPlanePos"+o+";"),r.push("uniform vec3 sectionPlaneDir"+o+";")}if(r.push("void main(void) {"),i){r.push("if (clippable) {"),r.push("  float dist = 0.0;");for(o=0;o<t.sectionPlanes.length;o++)r.push("if (sectionPlaneActive"+o+") {"),r.push("   dist += clamp(dot(-sectionPlaneDir"+o+".xyz, vWorldPosition.xyz - sectionPlanePos"+o+".xyz), 0.0, 1000.0);"),r.push("}");r.push("  if (dist > 0.0) { discard; }"),r.push("}")}return r.push("   gl_FragColor = pickColor; "),r.push("}"),r}(e)}}const He=function(e,t){this._hash=e,this._shaderSource=new Ue(t),this._scene=t.scene,this._useCount=0,this._allocate(t)},Ge={};He.get=function(e){const t=[e.scene.canvas.canvas.id,e.scene._sectionPlanesState.getHash(),e._geometry._state.hash,e._state.hash].join(";");let i=Ge[t];if(!i){if((i=new He(t,e)).errors)return console.log(i.errors.join("\n")),null;Ge[t]=i,P.memory.programs++}return i._useCount++,i},He.prototype.put=function(){0==--this._useCount&&(this._program&&this._program.destroy(),delete Ge[this._hash],P.memory.programs--)},He.prototype.webglContextRestored=function(){this._program=null},He.prototype.drawMesh=function(e,t){this._program||this._allocate(t);const i=this._scene.canvas.gl,r=t._material._state,o=t._geometry._state;if(e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e)),r.id!==this._lastMaterialId){const t=r.backfaces;e.backfaces!==t&&(t?i.disable(i.CULL_FACE):i.enable(i.CULL_FACE),e.backfaces=t);const o=r.frontface;e.frontface!==o&&(o?i.frontFace(i.CCW):i.frontFace(i.CW),e.frontface=o),this._lastMaterialId=r.id}i.uniformMatrix4fv(this._uViewMatrix,!1,e.pickViewMatrix),i.uniformMatrix4fv(this._uProjMatrix,!1,e.pickProjMatrix),i.uniformMatrix4fv(this._uModelMatrix,!1,t.worldMatrix),this._uClippable&&i.uniform1i(this._uClippable,t._state.clippable),o.id!==this._lastGeometryId&&(this._uPositionsDecodeMatrix&&i.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,o.positionsDecodeMatrix),this._aPosition&&(this._aPosition.bindArrayBuffer(o.positionsBuf,o.compressGeometry?i.UNSIGNED_SHORT:i.FLOAT),e.bindArray++),o.indicesBuf&&(o.indicesBuf.bind(),e.bindArray++),this._lastGeometryId=o.id);var s=t._state.pickID;const n=s>>24&255,a=s>>16&255,l=s>>8&255,c=255&s;i.uniform4f(this._uPickColor,c/255,l/255,a/255,n/255),o.indicesBuf?(i.drawElements(o.primitive,o.indicesBuf.numItems,o.indicesBuf.itemType,0),e.drawElements++):o.positions&&i.drawArrays(i.TRIANGLES,0,o.positions.numItems)},He.prototype._allocate=function(e){const t=e.scene.canvas.gl;if(this._program=new De(t,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const i=this._program;this._uPositionsDecodeMatrix=i.getLocation("positionsDecodeMatrix"),this._uModelMatrix=i.getLocation("modelMatrix"),this._uViewMatrix=i.getLocation("viewMatrix"),this._uProjMatrix=i.getLocation("projMatrix"),this._uSectionPlanes=[];for(let t=0,r=e.scene._sectionPlanesState.sectionPlanes.length;t<r;t++)this._uSectionPlanes.push({active:i.getLocation("sectionPlaneActive"+t),pos:i.getLocation("sectionPlanePos"+t),dir:i.getLocation("sectionPlaneDir"+t)});this._aPosition=i.getAttribute("position"),this._uClippable=i.getLocation("clippable"),this._uPickColor=i.getLocation("pickColor"),this._lastMaterialId=null,this._lastVertexBufsId=null,this._lastGeometryId=null},He.prototype._bindProgram=function(e){const t=this._scene,i=t.canvas.gl,r=t._sectionPlanesState;if(this._program.bind(),e.useProgram++,this._lastMaterialId=null,this._lastVertexBufsId=null,this._lastGeometryId=null,r.sectionPlanes.length>0){let e,t,o,s,n;for(let a=0,l=this._uSectionPlanes.length;a<l;a++)t=(e=this._uSectionPlanes[a]).active,o=r.sectionPlanes[a],t&&i.uniform1i(t,o.active),(s=e.pos)&&i.uniform3fv(e.pos,o.pos),(n=e.dir)&&i.uniform3fv(e.dir,o.dir)}};class We{constructor(e){this.vertex=function(e){const t=e.scene._sectionPlanesState.sectionPlanes.length>0,i=!!e._geometry._state.compressGeometry,r=(e._state.billboard,e._state.stationary,[]);r.push("// Surface picking vertex shader"),r.push("attribute vec3 position;"),r.push("attribute vec4 color;"),r.push("uniform mat4 modelMatrix;"),r.push("uniform mat4 viewMatrix;"),r.push("uniform mat4 projMatrix;"),t&&(r.push("uniform bool clippable;"),r.push("varying vec4 vWorldPosition;"));r.push("varying vec4 vColor;"),i&&r.push("uniform mat4 positionsDecodeMatrix;");r.push("void main(void) {"),r.push("vec4 localPosition = vec4(position, 1.0); "),i&&r.push("localPosition = positionsDecodeMatrix * localPosition;");r.push("   vec4 worldPosition = modelMatrix * localPosition; "),r.push("   vec4 viewPosition = viewMatrix * worldPosition;"),t&&r.push("   vWorldPosition = worldPosition;");return r.push("   vColor = color;"),r.push("   gl_Position = projMatrix * viewPosition;"),r.push("}"),r}(e),this.fragment=function(e){const t=e.scene._sectionPlanesState,i=t.sectionPlanes.length>0,r=[];if(r.push("// Surface picking fragment shader"),r.push("precision lowp float;"),r.push("varying vec4 vColor;"),i){r.push("uniform bool clippable;"),r.push("varying vec4 vWorldPosition;");for(var o=0;o<t.sectionPlanes.length;o++)r.push("uniform bool sectionPlaneActive"+o+";"),r.push("uniform vec3 sectionPlanePos"+o+";"),r.push("uniform vec3 sectionPlaneDir"+o+";")}if(r.push("void main(void) {"),i){r.push("if (clippable) {"),r.push("  float dist = 0.0;");for(o=0;o<t.sectionPlanes.length;o++)r.push("if (sectionPlaneActive"+o+") {"),r.push("   dist += clamp(dot(-sectionPlaneDir"+o+".xyz, vWorldPosition.xyz - sectionPlanePos"+o+".xyz), 0.0, 1000.0);"),r.push("}");r.push("  if (dist > 0.0) { discard; }"),r.push("}")}return r.push("   gl_FragColor = vColor;"),r.push("}"),r}(e)}}const qe=function(e,t){this._hash=e,this._scene=t.scene,this._useCount=0,this._shaderSource=new We(t),this._allocate(t)},Xe={};qe.get=function(e){const t=[e.scene.canvas.canvas.id,e.scene._sectionPlanesState.getHash(),e._geometry._state.compressGeometry?"cp":"",e._state.hash].join(";");let i=Xe[t];if(!i){if((i=new qe(t,e)).errors)return console.log(i.errors.join("\n")),null;Xe[t]=i,P.memory.programs++}return i._useCount++,i},qe.prototype.put=function(){0==--this._useCount&&(this._program&&this._program.destroy(),delete Xe[this._hash],P.memory.programs--)},qe.prototype.webglContextRestored=function(){this._program=null},qe.prototype.drawMesh=function(e,t){this._program||this._allocate(t);const i=this._scene,r=i.canvas.gl,o=i._sectionPlanesState,s=t._material._state,n=(t._state,t._geometry),a=t._geometry._state,l=s.backfaces,c=s.frontface,h=n._getPickTrianglePositions(),d=n._getPickTriangleColors();i.camera._state;if(this._program.bind(),e.useProgram++,r.uniformMatrix4fv(this._uViewMatrix,!1,e.pickViewMatrix),r.uniformMatrix4fv(this._uProjMatrix,!1,e.pickProjMatrix),o.sectionPlanes.length>0){const e=o.sectionPlanes;let t,i,s,n,a;for(let o=0,l=this._uSectionPlanes.length;o<l;o++)i=(t=this._uSectionPlanes[o]).active,s=e[o],i&&r.uniform1i(i,s.active),(n=t.pos)&&r.uniform3fv(t.pos,s.pos),(a=t.dir)&&r.uniform3fv(t.dir,s.dir)}e.backfaces!==l&&(l?r.disable(r.CULL_FACE):r.enable(r.CULL_FACE),e.backfaces=l),e.frontface!==c&&(c?r.frontFace(r.CCW):r.frontFace(r.CW),e.frontface=c),this._lastMaterialId=s.id,r.uniformMatrix4fv(this._uModelMatrix,!1,t.worldMatrix),this._uClippable&&r.uniform1i(this._uClippable,t._state.clippable),this._uPositionsDecodeMatrix?(r.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,a.positionsDecodeMatrix),this._aPosition.bindArrayBuffer(h,a.compressGeometry?r.UNSIGNED_SHORT:r.FLOAT)):this._aPosition.bindArrayBuffer(h),d.bind(),r.enableVertexAttribArray(this._aColor.location),r.vertexAttribPointer(this._aColor.location,d.itemSize,d.itemType,!0,0,0),r.drawArrays(a.primitive,0,h.numItems/3)},qe.prototype._allocate=function(e){const t=e.scene.canvas.gl;if(this._program=new De(t,this._shaderSource),this._useCount=0,this._program.errors)return void(this.errors=this._program.errors);const i=this._program;this._uPositionsDecodeMatrix=i.getLocation("positionsDecodeMatrix"),this._uModelMatrix=i.getLocation("modelMatrix"),this._uViewMatrix=i.getLocation("viewMatrix"),this._uProjMatrix=i.getLocation("projMatrix"),this._uSectionPlanes=[];for(let t=0,r=e.scene._sectionPlanesState.sectionPlanes.length;t<r;t++)this._uSectionPlanes.push({active:i.getLocation("sectionPlaneActive"+t),pos:i.getLocation("sectionPlanePos"+t),dir:i.getLocation("sectionPlaneDir"+t)});this._aPosition=i.getAttribute("position"),this._aColor=i.getAttribute("color"),this._uClippable=i.getLocation("clippable")};class Ye{constructor(e){this.vertex=function(e){const t=e.scene._sectionPlanesState.sectionPlanes.length>0,i=!!e._geometry._state.compressGeometry,r=e._state.billboard,o=e._state.stationary,s=[];s.push("// Mesh occlusion vertex shader"),s.push("attribute vec3 position;"),s.push("uniform mat4 modelMatrix;"),s.push("uniform mat4 viewMatrix;"),s.push("uniform mat4 projMatrix;"),i&&s.push("uniform mat4 positionsDecodeMatrix;");t&&s.push("varying vec4 vWorldPosition;");"spherical"!==r&&"cylindrical"!==r||(s.push("void billboard(inout mat4 mat) {"),s.push("   mat[0][0] = 1.0;"),s.push("   mat[0][1] = 0.0;"),s.push("   mat[0][2] = 0.0;"),"spherical"===r&&(s.push("   mat[1][0] = 0.0;"),s.push("   mat[1][1] = 1.0;"),s.push("   mat[1][2] = 0.0;")),s.push("   mat[2][0] = 0.0;"),s.push("   mat[2][1] = 0.0;"),s.push("   mat[2][2] =1.0;"),s.push("}"));s.push("void main(void) {"),s.push("vec4 localPosition = vec4(position, 1.0); "),i&&s.push("localPosition = positionsDecodeMatrix * localPosition;");s.push("mat4 viewMatrix2 = viewMatrix;"),s.push("mat4 modelMatrix2 = modelMatrix;"),o&&s.push("viewMatrix2[3][0] = viewMatrix2[3][1] = viewMatrix2[3][2] = 0.0;");"spherical"!==r&&"cylindrical"!==r||(s.push("mat4 modelViewMatrix = viewMatrix2 * modelMatrix2;"),s.push("billboard(modelMatrix2);"),s.push("billboard(viewMatrix2);"));s.push("   vec4 worldPosition = modelMatrix2 * localPosition;"),s.push("   vec4 viewPosition = viewMatrix2 * worldPosition;"),t&&s.push("   vWorldPosition = worldPosition;");return s.push("   gl_Position = projMatrix * viewPosition;"),s.push("}"),s}(e),this.fragment=function(e){const t=e.scene._sectionPlanesState,i=t.sectionPlanes.length>0,r=[];if(r.push("// Mesh occlusion fragment shader"),r.push("precision lowp float;"),i){r.push("uniform bool clippable;"),r.push("varying vec4 vWorldPosition;");for(var o=0;o<t.sectionPlanes.length;o++)r.push("uniform bool sectionPlaneActive"+o+";"),r.push("uniform vec3 sectionPlanePos"+o+";"),r.push("uniform vec3 sectionPlaneDir"+o+";")}if(r.push("void main(void) {"),i){r.push("if (clippable) {"),r.push("  float dist = 0.0;");for(o=0;o<t.sectionPlanes.length;o++)r.push("if (sectionPlaneActive"+o+") {"),r.push("   dist += clamp(dot(-sectionPlaneDir"+o+".xyz, vWorldPosition.xyz - sectionPlanePos"+o+".xyz), 0.0, 1000.0);"),r.push("}");r.push("  if (dist > 0.0) { discard; }"),r.push("}")}return r.push("   gl_FragColor = vec4(0.0, 0.0, 1.0, 1.0); "),r.push("}"),r}(e)}}const Ke=function(e,t){this._hash=e,this._shaderSource=new Ye(t),this._scene=t.scene,this._useCount=0,this._allocate(t)},$e={};Ke.get=function(e){const t=[e.scene.canvas.canvas.id,e.scene._sectionPlanesState.getHash(),e._geometry._state.hash,e._state.hash].join(";");let i=$e[t];if(!i){if((i=new Ke(t,e)).errors)return console.log(i.errors.join("\n")),null;$e[t]=i,P.memory.programs++}return i._useCount++,i},Ke.prototype.put=function(){0==--this._useCount&&(this._program&&this._program.destroy(),delete $e[this._hash],P.memory.programs--)},Ke.prototype.webglContextRestored=function(){this._program=null},Ke.prototype.drawMesh=function(e,t){this._program||this._allocate(t);const i=this._scene,r=i.canvas.gl,o=t._material._state,s=t._geometry._state;if(e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e)),o.id!==this._lastMaterialId){const t=o.backfaces;e.backfaces!==t&&(t?r.disable(r.CULL_FACE):r.enable(r.CULL_FACE),e.backfaces=t);const i=o.frontface;e.frontface!==i&&(i?r.frontFace(r.CCW):r.frontFace(r.CW),e.frontface=i),this._lastMaterialId=o.id}const n=i.camera,a=n._state;r.uniformMatrix4fv(this._uViewMatrix,!1,a.matrix),r.uniformMatrix4fv(this._uProjMatrix,!1,n._project._state.matrix),r.uniformMatrix4fv(this._uModelMatrix,r.FALSE,t.worldMatrix),this._uClippable&&r.uniform1i(this._uClippable,t._state.clippable),s.id!==this._lastGeometryId&&(this._uPositionsDecodeMatrix&&r.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,s.positionsDecodeMatrix),this._aPosition&&(this._aPosition.bindArrayBuffer(s.positionsBuf,s.compressGeometry?r.UNSIGNED_SHORT:r.FLOAT),e.bindArray++),s.indicesBuf&&(s.indicesBuf.bind(),e.bindArray++),this._lastGeometryId=s.id),s.indicesBuf?(r.drawElements(s.primitive,s.indicesBuf.numItems,s.indicesBuf.itemType,0),e.drawElements++):s.positions&&r.drawArrays(r.TRIANGLES,0,s.positions.numItems)},Ke.prototype._allocate=function(e){const t=e.scene.canvas.gl;if(this._program=new De(t,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const i=this._program;this._uPositionsDecodeMatrix=i.getLocation("positionsDecodeMatrix"),this._uModelMatrix=i.getLocation("modelMatrix"),this._uViewMatrix=i.getLocation("viewMatrix"),this._uProjMatrix=i.getLocation("projMatrix"),this._uSectionPlanes=[];for(let t=0,r=e.scene._sectionPlanesState.sectionPlanes.length;t<r;t++)this._uSectionPlanes.push({active:i.getLocation("sectionPlaneActive"+t),pos:i.getLocation("sectionPlanePos"+t),dir:i.getLocation("sectionPlaneDir"+t)});this._aPosition=i.getAttribute("position"),this._uClippable=i.getLocation("clippable"),this._lastMaterialId=null,this._lastVertexBufsId=null,this._lastGeometryId=null},Ke.prototype._bindProgram=function(e){const t=this._scene,i=t.canvas.gl,r=t._sectionPlanesState;if(this._program.bind(),e.useProgram++,this._lastMaterialId=null,this._lastVertexBufsId=null,this._lastGeometryId=null,r.sectionPlanes.length>0){let e,t,o,s,n;for(let a=0,l=this._uSectionPlanes.length;a<l;a++)t=(e=this._uSectionPlanes[a]).active,o=r.sectionPlanes[a],t&&i.uniform1i(t,o.active),(s=e.pos)&&i.uniform3fv(e.pos,o.pos),(n=e.dir)&&i.uniform3fv(e.dir,o.dir)}};const Qe=u.OBB3(),Ze=new Float32Array(4),Je=new Float32Array(4),et=new Float32Array(4),tt=new Float32Array([1,0,0]),it=new Float32Array([0,1,0]),rt=new Float32Array([0,0,1]),ot=new Float32Array(3),st=new Float32Array(3),nt=u.identityMat4();class at extends B{get type(){return"Mesh"}constructor(e,t={}){if(super(e,t),this._state=new j({visible:!0,culled:!1,pickable:null,clippable:null,collidable:null,castsShadow:null,receivesShadow:null,xrayed:!1,highlighted:!1,selected:!1,edges:!1,stationary:!!t.stationary,billboard:this._checkBillboard(t.billboard),layer:null,colorize:null,pickID:this.scene._renderer.getPickID(this),drawHash:"",pickHash:""}),this._drawRenderer=null,this._shadowRenderer=null,this._emphasisFillRenderer=null,this._emphasisEdgesRenderer=null,this._pickMeshRenderer=null,this._pickTriangleRenderer=null,this._occlusionRenderer=null,this._geometry=t.geometry?this._checkComponent2(["ReadableGeometry","VBOGeometry"],t.geometry):this.scene.geometry,this._material=t.material?this._checkComponent2(["PhongMaterial","MetallicMaterial","SpecularMaterial","LambertMaterial"],t.material):this.scene.material,this._xrayMaterial=t.xrayMaterial?this._checkComponent("EmphasisMaterial",t.xrayMaterial):this.scene.xrayMaterial,this._highlightMaterial=t.highlightMaterial?this._checkComponent("EmphasisMaterial",t.highlightMaterial):this.scene.highlightMaterial,this._selectedMaterial=t.selectedMaterial?this._checkComponent("EmphasisMaterial",t.selectedMaterial):this.scene.selectedMaterial,this._edgeMaterial=t.edgeMaterial?this._checkComponent("EdgeMaterial",t.edgeMaterial):this.scene.edgeMaterial,this._parentNode=null,this._aabb=null,this._aabbDirty=!0,this.scene._aabbDirty=!0,this._scale=u.vec3(),this._quaternion=u.identityQuaternion(),this._rotation=u.vec3(),this._position=u.vec3(),this._worldMatrix=u.identityMat4(),this._worldNormalMatrix=u.identityMat4(),this._localMatrixDirty=!0,this._worldMatrixDirty=!0,this._worldNormalMatrixDirty=!0,t.matrix?this.matrix=t.matrix:(this.scale=t.scale,this.position=t.position,t.quaternion||(this.rotation=t.rotation)),this._isObject=t.isObject,this._isObject&&this.scene._registerObject(this),this._isModel=t.isModel,this._isModel&&this.scene._registerModel(this),this.visible=t.visible,this.culled=t.culled,this.pickable=t.pickable,this.clippable=t.clippable,this.collidable=t.collidable,this.castsShadow=t.castsShadow,this.receivesShadow=t.receivesShadow,this.xrayed=t.xrayed,this.highlighted=t.highlighted,this.selected=t.selected,this.edges=t.edges,this.layer=t.layer,this.colorize=t.colorize,this.opacity=t.opacity,t.parentId){const e=this.scene.components[t.parentId];e?e.isNode?e.addChild(this):this.error("Parent is not a Node: '"+t.parentId+"'"):this.error("Parent not found: '"+t.parentId+"'"),this._parentNode=e}else t.parent&&(t.parent.isNode||this.error("Parent is not a Node"),t.parent.addChild(this),this._parentNode=t.parent);this.compile()}get isMesh(){return!0}get parent(){return this._parentNode}_checkBillboard(e){return"spherical"!==(e=e||"none")&&"cylindrical"!==e&&"none"!==e&&(this.error("Unsupported value for 'billboard': "+e+" - accepted values are 'spherical', 'cylindrical' and 'none' - defaulting to 'none'."),e="none"),e}compile(){const e=this._makeDrawHash();this._state.drawHash!==e&&(this._state.drawHash=e,this._putDrawRenderers(),this._drawRenderer=Le.get(this),this._emphasisFillRenderer=Fe.get(this),this._emphasisEdgesRenderer=ze.get(this));const t=this._makePickHash();this._state.pickHash!==t&&(this._state.pickHash=t,this._putPickRenderers(),this._pickMeshRenderer=He.get(this));const i=this._makeOcclusionHash();this._state.occlusionHash!==i&&(this._state.occlusionHash=i,this._putOcclusionRenderer(),this._occlusionRenderer=Ke.get(this))}_setLocalMatrixDirty(){this._localMatrixDirty=!0,this._setWorldMatrixDirty()}_setWorldMatrixDirty(){this._worldMatrixDirty=!0,this._worldNormalMatrixDirty=!0}_buildWorldMatrix(){const e=this.matrix;if(this._parentNode)u.mulMat4(this._parentNode.worldMatrix,e,this._worldMatrix);else for(let t=0,i=e.length;t<i;t++)this._worldMatrix[t]=e[t];this._worldMatrixDirty=!1}_buildWorldNormalMatrix(){this._worldMatrixDirty&&this._buildWorldMatrix(),this._worldNormalMatrix||(this._worldNormalMatrix=u.mat4()),u.transposeMat4(this._worldMatrix,this._worldNormalMatrix),u.inverseMat4(this._worldNormalMatrix),this._worldNormalMatrixDirty=!1}_setAABBDirty(){if(this.collidable)for(let e=this;e;e=e._parentNode)e._aabbDirty=!0}_updateAABB(){this.scene._aabbDirty=!0,this._aabb||(this._aabb=u.AABB3()),this._buildAABB(this.worldMatrix,this._aabb),this._aabbDirty=!1}_webglContextRestored(){this._drawRenderer&&this._drawRenderer.webglContextRestored(),this._shadowRenderer&&this._shadowRenderer.webglContextRestored(),this._emphasisFillRenderer&&this._emphasisFillRenderer.webglContextRestored(),this._emphasisEdgesRenderer&&this._emphasisEdgesRenderer.webglContextRestored(),this._pickMeshRenderer&&this._pickMeshRenderer.webglContextRestored(),this._pickTriangleRenderer&&this._pickMeshRenderer.webglContextRestored(),this._occlusionRenderer&&this._occlusionRenderer.webglContextRestored()}_makeDrawHash(){const e=this.scene,t=[e.canvas.canvas.id,(e.gammaInput?"gi;":";")+(e.gammaOutput?"go":""),e._lightsState.getHash(),e._sectionPlanesState.getHash()],i=this._state;return i.stationary&&t.push("/s"),"none"===i.billboard?t.push("/n"):"spherical"===i.billboard?t.push("/s"):"cylindrical"===i.billboard&&t.push("/c"),i.receivesShadow&&t.push("/rs"),t.push(";"),t.join("")}_makePickHash(){const e=this.scene,t=[e.canvas.canvas.id,e._sectionPlanesState.getHash()],i=this._state;return i.stationary&&t.push("/s"),"none"===i.billboard?t.push("/n"):"spherical"===i.billboard?t.push("/s"):"cylindrical"===i.billboard&&t.push("/c"),t.push(";"),t.join("")}_makeOcclusionHash(){const e=this.scene,t=[e.canvas.canvas.id,e._sectionPlanesState.getHash()],i=this._state;return i.stationary&&t.push("/s"),"none"===i.billboard?t.push("/n"):"spherical"===i.billboard?t.push("/s"):"cylindrical"===i.billboard&&t.push("/c"),t.push(";"),t.join("")}_buildAABB(e,t){u.transformOBB3(e,this._geometry.obb,Qe),u.OBB3ToAABB3(Qe,t)}get geometry(){return this._geometry}get material(){return this._material}set position(e){this._position.set(e||[0,0,0]),this._setLocalMatrixDirty(),this._setAABBDirty(),this.glRedraw()}get position(){return this._position}set rotation(e){this._rotation.set(e||[0,0,0]),u.eulerToQuaternion(this._rotation,"XYZ",this._quaternion),this._setLocalMatrixDirty(),this._setAABBDirty(),this.glRedraw()}get rotation(){return this._rotation}set quaternion(e){this._quaternion.set(e||[0,0,0,1]),u.quaternionToEuler(this._quaternion,"XYZ",this._rotation),this._setLocalMatrixDirty(),this._setAABBDirty(),this.glRedraw()}get quaternion(){return this._quaternion}set scale(e){this._scale.set(e||[1,1,1]),this._setLocalMatrixDirty(),this._setAABBDirty(),this.glRedraw()}get scale(){return this._scale}set matrix(e){this.__localMatrix||(this.__localMatrix=u.identityMat4()),this.__localMatrix.set(e||nt),u.decomposeMat4(this.__localMatrix,this._position,this._quaternion,this._scale),this._localMatrixDirty=!1,this._setWorldMatrixDirty(),this._setAABBDirty(),this.glRedraw()}get matrix(){return this._localMatrixDirty&&(this.__localMatrix||(this.__localMatrix=u.identityMat4()),u.composeMat4(this._position,this._quaternion,this._scale,this.__localMatrix),this._localMatrixDirty=!1),this.__localMatrix}get worldMatrix(){return this._worldMatrixDirty&&this._buildWorldMatrix(),this._worldMatrix}get worldNormalMatrix(){return this._worldNormalMatrixDirty&&this._buildWorldNormalMatrix(),this._worldNormalMatrix}rotate(e,t){return Ze[0]=e[0],Ze[1]=e[1],Ze[2]=e[2],Ze[3]=t*u.DEGTORAD,u.angleAxisToQuaternion(Ze,Je),u.mulQuaternions(this.quaternion,Je,et),this.quaternion=et,this._setLocalMatrixDirty(),this._setAABBDirty(),this.glRedraw(),this}rotateOnWorldAxis(e,t){return Ze[0]=e[0],Ze[1]=e[1],Ze[2]=e[2],Ze[3]=t*u.DEGTORAD,u.angleAxisToQuaternion(Ze,Je),u.mulQuaternions(Je,this.quaternion,Je),this}rotateX(e){return this.rotate(tt,e)}rotateY(e){return this.rotate(it,e)}rotateZ(e){return this.rotate(rt,e)}translate(e,t){return u.vec3ApplyQuaternion(this.quaternion,e,ot),u.mulVec3Scalar(ot,t,st),u.addVec3(this.position,st,this.position),this._setLocalMatrixDirty(),this._setAABBDirty(),this.glRedraw(),this}translateX(e){return this.translate(tt,e)}translateY(e){return this.translate(it,e)}translateZ(e){return this.translate(rt,e)}_putDrawRenderers(){this._drawRenderer&&(this._drawRenderer.put(),this._drawRenderer=null),this._shadowRenderer&&(this._shadowRenderer.put(),this._shadowRenderer=null),this._emphasisFillRenderer&&(this._emphasisFillRenderer.put(),this._emphasisFillRenderer=null),this._emphasisEdgesRenderer&&(this._emphasisEdgesRenderer.put(),this._emphasisEdgesRenderer=null)}_putPickRenderers(){this._pickMeshRenderer&&(this._pickMeshRenderer.put(),this._pickMeshRenderer=null),this._pickTriangleRenderer&&(this._pickTriangleRenderer.put(),this._pickTriangleRenderer=null)}_putOcclusionRenderer(){this._occlusionRenderer&&(this._occlusionRenderer.put(),this._occlusionRenderer=null)}get isEntity(){return!0}get isModel(){return this._isModel}get isObject(){return this._isObject}get aabb(){return this._aabbDirty&&this._updateAABB(),this._aabb}set visible(e){e=!1!==e,this._state.visible=e,this._isObject&&this.scene._objectVisibilityUpdated(this),this.glRedraw()}get visible(){return this._state.visible}set xrayed(e){e=!!e,this._state.xrayed!==e&&(this._state.xrayed=e,this._isObject&&this.scene._objectXRayedUpdated(this),this.glRedraw())}get xrayed(){return this._state.xrayed}set highlighted(e){(e=!!e)!==this._state.highlighted&&(this._state.highlighted=e,this._isObject&&this.scene._objectHighlightedUpdated(this),this.glRedraw())}get highlighted(){return this._state.highlighted}set selected(e){(e=!!e)!==this._state.selected&&(this._state.selected=e,this._isObject&&this.scene._objectSelectedUpdated(this),this.glRedraw())}get selected(){return this._state.selected}set edges(e){(e=!!e)!==this._state.edges&&(this._state.edges=e,this.glRedraw())}get edges(){return this._state.edges}set culled(e){this._state.culled=!!e,this.glRedraw()}get culled(){return this._state.culled}set clippable(e){e=!1!==e,this._state.clippable!==e&&(this._state.clippable=e,this.glRedraw())}get clippable(){return this._state.clippable}set collidable(e){(e=!1!==e)!==this._state.collidable&&(this._state.collidable=e,this._setAABBDirty(),this.scene._aabbDirty=!0)}get collidable(){return this._state.collidable}set pickable(e){e=!1!==e,this._state.pickable!==e&&(this._state.pickable=e)}get pickable(){return this._state.pickable}set castsShadow(e){(e=!1!==e)!==this._state.castsShadow&&(this._state.castsShadow=e,this.glRedraw())}get castsShadow(){return this._state.castsShadow}set receivesShadow(e){this._state.receivesShadow=!1}get receivesShadow(){return this._state.receivesShadow}set colorize(e){let t=this._state.colorize;t||((t=this._state.colorize=new Float32Array(4))[3]=1),e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):(t[0]=1,t[1]=1,t[2]=1),this.glRedraw()}get colorize(){return this._state.colorize}set opacity(e){let t=this._state.colorize;t||((t=this._state.colorize=new Float32Array(4))[0]=1,t[1]=1,t[2]=1),t[3]=null!=e?e:1,this.glRedraw()}get opacity(){return this._state.colorize[3]}get transparent(){return 2===this._material.alphaMode||this._state.colorize[3]<1}set layer(e){e=e||0,(e=Math.round(e))!==this._state.layer&&(this._state.layer=e,this._renderer.needStateSort())}get layer(){return this._state.layer}get stationary(){return this._state.stationary}get billboard(){return this._state.billboard}get isDrawable(){return!0}get isStateSortable(){return!0}stateSortCompare(e,t){return e._state.layer-t._state.layer||e._drawRenderer.id-t._drawRenderer.id||e._material._state.id-t._material._state.id||e._geometry._state.id-t._geometry._state.id}getRenderFlags(e){e.reset();const t=this._state;if(t.xrayed){const t=this._xrayMaterial._state;t.fill&&(t.fillAlpha<1?e.xrayedFillTransparent=!0:e.xrayedFillOpaque=!0),t.edges&&(t.edgeAlpha<1?e.xrayedEdgesTransparent=!0:e.xrayedEdgesOpaque=!0)}else{if(this._material._state.alpha<1||t.colorize[3]<1?e.normalFillTransparent=!0:e.normalFillOpaque=!0,t.edges){this._edgeMaterial._state.alpha<1?e.normalEdgesTransparent=!0:e.normalEdgesOpaque=!0}if(t.selected){const t=this._selectedMaterial._state;t.fill&&(t.fillAlpha<1?e.selectedFillTransparent=!0:e.selectedFillOpaque=!0),t.edges&&(t.edgeAlpha<1?e.selectedEdgesTransparent=!0:e.selectedEdgesOpaque=!0)}else if(t.highlighted){const t=this._highlightMaterial._state;t.fill&&(t.fillAlpha<1?e.highlightedFillTransparent=!0:e.highlightedFillOpaque=!0),t.edges&&(t.edgeAlpha<1?e.highlightedEdgesTransparent=!0:e.highlightedEdgesOpaque=!0)}}}get xrayMaterial(){return this._xrayMaterial}get highlightMaterial(){return this._highlightMaterial}get selectedMaterial(){return this._selectedMaterial}get edgeMaterial(){return this._edgeMaterial}drawNormalFillOpaque(e){(this._drawRenderer||(this._drawRenderer=Le.get(this)))&&this._drawRenderer.drawMesh(e,this)}drawNormalEdgesOpaque(e){(this._emphasisEdgesRenderer||(this._emphasisEdgesRenderer=ze.get(this)))&&this._emphasisEdgesRenderer.drawMesh(e,this,3)}drawNormalFillTransparent(e){(this._drawRenderer||(this._drawRenderer=Le.get(this)))&&this._drawRenderer.drawMesh(e,this)}drawNormalEdgesTransparent(e){(this._emphasisEdgesRenderer||(this._emphasisEdgesRenderer=ze.get(this)))&&this._emphasisEdgesRenderer.drawMesh(e,this,3)}drawXRayedFillOpaque(e){(this._emphasisFillRenderer||(this._emphasisFillRenderer=Fe.get(this)))&&this._emphasisFillRenderer.drawMesh(e,this,0)}drawXRayedEdgesOpaque(e){(this._emphasisEdgesRenderer||(this._emphasisEdgesRenderer=ze.get(this)))&&this._emphasisEdgesRenderer.drawMesh(e,this,0)}drawXRayedFillTransparent(e){(this._emphasisFillRenderer||(this._emphasisFillRenderer=Fe.get(this)))&&this._emphasisFillRenderer.drawMesh(e,this,0)}drawXRayedEdgesTransparent(e){(this._emphasisEdgesRenderer||(this._emphasisEdgesRenderer=ze.get(this)))&&this._emphasisEdgesRenderer.drawMesh(e,this,0)}drawHighlightedFillOpaque(e){(this._emphasisFillRenderer||(this._emphasisFillRenderer=Fe.get(this)))&&this._emphasisFillRenderer.drawMesh(e,this,1)}drawHighlightedEdgesOpaque(e){(this._emphasisEdgesRenderer||(this._emphasisEdgesRenderer=ze.get(this)))&&this._emphasisEdgesRenderer.drawMesh(e,this,1)}drawHighlightedFillTransparent(e){(this._emphasisFillRenderer||(this._emphasisFillRenderer=Fe.get(this)))&&this._emphasisFillRenderer.drawMesh(e,this,1)}drawHighlightedEdgesTransparent(e){(this._emphasisEdgesRenderer||(this._emphasisEdgesRenderer=ze.get(this)))&&this._emphasisEdgesRenderer.drawMesh(e,this,1)}drawSelectedFillOpaque(e){(this._emphasisFillRenderer||(this._emphasisFillRenderer=Fe.get(this)))&&this._emphasisFillRenderer.drawMesh(e,this,2)}drawSelectedEdgesOpaque(e){(this._emphasisEdgesRenderer||(this._emphasisEdgesRenderer=ze.get(this)))&&this._emphasisEdgesRenderer.drawMesh(e,this,2)}drawSelectedFillTransparent(e){(this._emphasisFillRenderer||(this._emphasisFillRenderer=Fe.get(this)))&&this._emphasisFillRenderer.drawMesh(e,this,2)}drawSelectedEdgesTransparent(e){(this._emphasisEdgesRenderer||(this._emphasisEdgesRenderer=ze.get(this)))&&this._emphasisEdgesRenderer.drawMesh(e,this,2)}drawPickMesh(e){(this._pickMeshRenderer||(this._pickMeshRenderer=He.get(this)))&&this._pickMeshRenderer.drawMesh(e,this)}drawOcclusion(e){(this._occlusionRenderer||(this._occlusionRenderer=Ke.get(this)))&&this._occlusionRenderer.drawMesh(e,this)}canPickTriangle(){return this._geometry.isReadableGeometry}drawPickTriangles(e){(this._pickTriangleRenderer||(this._pickTriangleRenderer=qe.get(this)))&&this._pickTriangleRenderer.drawMesh(e,this)}pickTriangleSurface(e,t,i){lt(this,e,t,i)}drawPickVertices(e){}delegatePickedEntity(){return this}destroy(){super.destroy(),this._putDrawRenderers(),this._putPickRenderers(),this._putOcclusionRenderer(),this.scene._renderer.putPickID(this._state.pickID),this._isObject&&(this.scene._deregisterObject(this),this._visible&&this.scene._objectVisibilityUpdated(this,!1),this._xrayed&&this.scene._objectXRayedUpdated(this,!1),this._selected&&this.scene._objectSelectedUpdated(this,!1),this._highlighted&&this.scene._objectHighlightedUpdated(this,!1)),this._isModel&&this.scene._deregisterModel(this),this.glRedraw()}}const lt=function(){const e=u.vec3(),t=u.vec3(),i=u.vec3(),r=u.vec3(),o=u.vec3(),s=u.vec3(),n=u.vec4(),a=u.vec3(),l=u.vec3(),c=u.vec3(),h=u.vec3(),d=u.vec3(),p=u.vec3(),m=u.vec3(),f=u.vec3(),g=u.vec3(),b=u.vec4(),_=u.vec4(),v=u.vec4(),x=u.vec3(),y=u.vec3(),w=u.vec3(),M=u.vec3(),k=u.vec3(),P=u.vec3(),E=u.vec3(),A=u.vec3(),C=u.vec3(),T=u.vec3(),D=u.vec3();return function(S,L,R,I){var N=I.primIndex;if(null!=N&&N>-1){const j=S.geometry._state,z=S.scene,V=z.camera,U=z.canvas;if("triangles"===j.primitiveName){I.primitive="triangle";const z=N,H=j.indices,G=j.positions;let W,q,X,Y;if(H){var F=H[z+0],B=H[z+1],O=H[z+2];s[0]=F,s[1]=B,s[2]=O,I.indices=s,W=3*F,q=3*B,X=3*O}else X=(q=(W=3*z)+3)+3;if(i[0]=G[W+0],i[1]=G[W+1],i[2]=G[W+2],r[0]=G[q+0],r[1]=G[q+1],r[2]=G[q+2],o[0]=G[X+0],o[1]=G[X+1],o[2]=G[X+2],j.compressGeometry){const e=j.positionsDecodeMatrix;e&&(J.decompressPosition(i,e,i),J.decompressPosition(r,e,r),J.decompressPosition(o,e,o))}I.canvasPos?(Y=I.canvasPos,u.canvasPosToLocalRay(U.canvas,L,R,S.worldMatrix,Y,e,t)):I.origin&&I.direction&&u.worldRayToLocalRay(S.worldMatrix,I.origin,I.direction,e,t),u.normalizeVec3(t),u.rayPlaneIntersect(e,t,i,r,o,n),I.localPos=n,I.position=n,b[0]=n[0],b[1]=n[1],b[2]=n[2],b[3]=1,u.transformVec4(S.worldMatrix,b,_),a[0]=_[0],a[1]=_[1],a[2]=_[2],I.worldPos=a,u.transformVec4(V.matrix,_,v),l[0]=v[0],l[1]=v[1],l[2]=v[2],I.viewPos=l,u.cartesianToBarycentric(n,i,r,o,c),I.bary=c;const K=j.normals;if(K){if(j.compressGeometry){const e=3*F,t=3*B,i=3*O;J.decompressNormal(K.subarray(e,e+2),h),J.decompressNormal(K.subarray(t,t+2),d),J.decompressNormal(K.subarray(i,i+2),p)}else h[0]=K[W],h[1]=K[W+1],h[2]=K[W+2],d[0]=K[q],d[1]=K[q+1],d[2]=K[q+2],p[0]=K[X],p[1]=K[X+1],p[2]=K[X+2];const e=u.addVec3(u.addVec3(u.mulVec3Scalar(h,c[0],x),u.mulVec3Scalar(d,c[1],y),w),u.mulVec3Scalar(p,c[2],M),k);I.worldNormal=u.normalizeVec3(u.transformVec3(S.worldNormalMatrix,e,P))}const $=j.uv;if($){if(m[0]=$[2*F],m[1]=$[2*F+1],f[0]=$[2*B],f[1]=$[2*B+1],g[0]=$[2*O],g[1]=$[2*O+1],j.compressGeometry){const e=j.uvDecodeMatrix;e&&(J.decompressUV(m,e,m),J.decompressUV(f,e,f),J.decompressUV(g,e,g))}I.uv=u.addVec3(u.addVec3(u.mulVec2Scalar(m,c[0],E),u.mulVec2Scalar(f,c[1],A),C),u.mulVec2Scalar(g,c[2],T),D)}}}}}();function ct(e={}){const t=e.lod||1,i=e.center?e.center[0]:0,r=e.center?e.center[1]:0,o=e.center?e.center[2]:0;let n=e.radius||1;n<0&&(console.error("negative radius not allowed - will invert"),n*=-1);let a=e.heightSegments||18;a<0&&(console.error("negative heightSegments not allowed - will invert"),a*=-1),(a=Math.floor(t*a))<18&&(a=18);let l=e.widthSegments||18;l<0&&(console.error("negative widthSegments not allowed - will invert"),l*=-1),(l=Math.floor(t*l))<18&&(l=18);const c=[],h=[],d=[],u=[];let p,m,f,g,b,_,v,x,y,w,M,k,P,E,A;for(p=0;p<=a;p++)for(f=p*Math.PI/a,g=Math.sin(f),b=Math.cos(f),m=0;m<=l;m++)_=2*m*Math.PI/l,v=Math.sin(_),y=(x=Math.cos(_))*g,w=b,M=v*g,k=1-m/l,P=p/a,h.push(y),h.push(w),h.push(M),d.push(k),d.push(P),c.push(i+n*y),c.push(r+n*w),c.push(o+n*M);for(p=0;p<a;p++)for(m=0;m<l;m++)A=(E=p*(l+1)+m)+l+1,u.push(E+1),u.push(A+1),u.push(A),u.push(E+1),u.push(A),u.push(E);return s.apply(e,{positions:c,normals:h,uv:d,indices:u})}const ht=new Float32Array([0,0,1]),dt=new Float32Array(4);class ut{constructor(e){this.id=null,this._viewer=e.viewer,this._visible=!1,this._pos=u.vec3(),this._baseDir=u.vec3(),this._rootNode=null,this._displayMeshes=null,this._affordanceMeshes=null,this._createNodes(),this._bindEvents()}_setSectionPlane(e){this._sectionPlane=e,e&&(this.id=e.id,this._setPos(e.pos),this._setDir(e.dir))}get sectionPlane(){return this._sectionPlane}_setPos(e){this._pos.set(e),this._rootNode.position=e}_setDir(e){this._baseDir.set(e),this._rootNode.quaternion=u.vec3PairToQuaternion(ht,e,dt)}setVisible(e=!0){if(this._visible!==e){var t;for(t in this._visible=e,this._displayMeshes)this._displayMeshes.hasOwnProperty(t)&&(this._displayMeshes[t].visible=e);if(!e)for(t in this._affordanceMeshes)this._affordanceMeshes.hasOwnProperty(t)&&(this._affordanceMeshes[t].visible=e)}}getVisible(){return this._visible}setCulled(e){var t;for(t in this._displayMeshes)this._displayMeshes.hasOwnProperty(t)&&(this._displayMeshes[t].culled=e);if(!e)for(t in this._affordanceMeshes)this._affordanceMeshes.hasOwnProperty(t)&&(this._affordanceMeshes[t].culled=e)}_createNodes(){const e=this._viewer.scene;this._rootNode=new xe(e,{position:[0,0,0],scale:[5,5,5]});const t=this._rootNode,i={arrowHead:new oe(t,V({radiusTop:.001,radiusBottom:.07,radialSegments:32,heightSegments:1,height:.2,openEnded:!1})),arrowHeadBig:new oe(t,V({radiusTop:.001,radiusBottom:.09,radialSegments:32,heightSegments:1,height:.25,openEnded:!1})),arrowHeadHandle:new oe(t,V({radiusTop:.09,radiusBottom:.09,radialSegments:8,heightSegments:1,height:.37,openEnded:!1})),curve:new oe(t,U({radius:.8,tube:.01,radialSegments:64,tubeSegments:14,arc:2*Math.PI/4})),curveHandle:new oe(t,U({radius:.8,tube:.06,radialSegments:64,tubeSegments:14,arc:2*Math.PI/4})),hoop:new oe(t,U({radius:.8,tube:.01,radialSegments:64,tubeSegments:8,arc:2*Math.PI})),axis:new oe(t,V({radiusTop:.01,radiusBottom:.01,radialSegments:20,heightSegments:1,height:1,openEnded:!1})),axisHandle:new oe(t,V({radiusTop:.08,radiusBottom:.08,radialSegments:20,heightSegments:1,height:1,openEnded:!1}))},r={pickable:new le(t,{diffuse:[1,1,0],alpha:0,alphaMode:"blend"}),red:new le(t,{diffuse:[1,0,0],emissive:[1,0,0],ambient:[0,0,0],specular:[.6,.6,.3],shininess:80,lineWidth:2}),highlightRed:new he(t,{edges:!1,fill:!0,fillColor:[1,0,0],fillAlpha:.6}),green:new le(t,{diffuse:[0,1,0],emissive:[0,1,0],ambient:[0,0,0],specular:[.6,.6,.3],shininess:80,lineWidth:2}),highlightGreen:new he(t,{edges:!1,fill:!0,fillColor:[0,1,0],fillAlpha:.6}),blue:new le(t,{diffuse:[0,0,1],emissive:[0,0,1],ambient:[0,0,0],specular:[.6,.6,.3],shininess:80,lineWidth:2}),highlightBlue:new he(t,{edges:!1,fill:!0,fillColor:[0,0,1],fillAlpha:.2}),center:new le(t,{diffuse:[0,0,0],emissive:[0,0,0],ambient:[0,0,0],specular:[.6,.6,.3],shininess:80}),highlightBall:new he(t,{edges:!1,fill:!0,fillColor:[.5,.5,.5],fillAlpha:.5,vertices:!1}),highlightPlane:new he(t,{edges:!0,edgeWidth:3,fill:!1,fillColor:[.5,.5,.5],fillAlpha:.5,vertices:!1})};this._displayMeshes={plane:t.addChild(new at(t,{geometry:new oe(t,{primitive:"triangles",positions:[.5,.5,0,.5,-.5,0,-.5,-.5,0,-.5,.5,0,.5,.5,-0,.5,-.5,-0,-.5,-.5,-0,-.5,.5,-0],indices:[0,1,2,2,3,0]}),material:new le(t,{emissive:[0,0,0],diffuse:[0,0,0],backfaces:!0}),opacity:.6,ghosted:!0,ghostMaterial:new he(t,{edges:!1,filled:!0,fillColor:[1,1,0],edgeColor:[0,0,0],fillAlpha:.1,backfaces:!0}),pickable:!1,collidable:!0,clippable:!1,visible:!1,scale:[2.4,2.4,1]}),!1),planeFrame:t.addChild(new at(t,{geometry:new oe(t,U({center:[0,0,0],radius:1.7,tube:.02,radialSegments:4,tubeSegments:4,arc:2*Math.PI})),material:new le(t,{emissive:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],shininess:0}),highlightMaterial:new he(t,{edges:!1,edgeColor:[0,0,0],filled:!0,fillColor:[.8,.8,.8],fillAlpha:1}),pickable:!1,collidable:!1,clippable:!1,visible:!1,scale:[1,1,.1],rotation:[0,0,45]}),!1),xCurve:t.addChild(new at(t,{geometry:i.curve,material:r.red,matrix:function(){const e=u.rotationMat4v(90*u.DEGTORAD,[0,1,0],u.identityMat4()),t=u.rotationMat4v(270*u.DEGTORAD,[1,0,0],u.identityMat4());return u.mulMat4(t,e,u.identityMat4())}(),pickable:!1,collidable:!0,clippable:!1,backfaces:!0,visible:!1}),!1),xCurveHandle:t.addChild(new at(t,{geometry:i.curveHandle,material:r.pickable,matrix:function(){const e=u.rotationMat4v(90*u.DEGTORAD,[0,1,0],u.identityMat4()),t=u.rotationMat4v(270*u.DEGTORAD,[1,0,0],u.identityMat4());return u.mulMat4(t,e,u.identityMat4())}(),pickable:!0,collidable:!0,clippable:!1,backfaces:!0,visible:!1}),!1),xCurveArrow1:t.addChild(new at(t,{geometry:i.arrowHead,material:r.red,matrix:function(){const e=u.translateMat4c(0,-.07,-.8,u.identityMat4()),t=u.scaleMat4v([.6,.6,.6],u.identityMat4()),i=u.rotationMat4v(0*u.DEGTORAD,[0,0,1],u.identityMat4());return u.mulMat4(u.mulMat4(e,t,u.identityMat4()),i,u.identityMat4())}(),pickable:!0,collidable:!0,clippable:!1,visible:!1}),!1),xCurveArrow2:t.addChild(new at(t,{geometry:i.arrowHead,material:r.red,matrix:function(){const e=u.translateMat4c(0,-.8,-.07,u.identityMat4()),t=u.scaleMat4v([.6,.6,.6],u.identityMat4()),i=u.rotationMat4v(90*u.DEGTORAD,[1,0,0],u.identityMat4());return u.mulMat4(u.mulMat4(e,t,u.identityMat4()),i,u.identityMat4())}(),pickable:!0,collidable:!0,clippable:!1,visible:!1}),!1),yCurve:t.addChild(new at(t,{geometry:i.curve,material:r.green,rotation:[-90,0,0],pickable:!1,collidable:!0,clippable:!1,backfaces:!0,visible:!1}),!1),yCurveHandle:t.addChild(new at(t,{geometry:i.curveHandle,material:r.pickable,rotation:[-90,0,0],pickable:!0,collidable:!0,clippable:!1,backfaces:!0,visible:!1}),!1),yCurveArrow1:t.addChild(new at(t,{geometry:i.arrowHead,material:r.green,matrix:function(){const e=u.translateMat4c(.07,0,-.8,u.identityMat4()),t=u.scaleMat4v([.6,.6,.6],u.identityMat4()),i=u.rotationMat4v(90*u.DEGTORAD,[0,0,1],u.identityMat4());return u.mulMat4(u.mulMat4(e,t,u.identityMat4()),i,u.identityMat4())}(),pickable:!0,collidable:!0,clippable:!1,visible:!1}),!1),yCurveArrow2:t.addChild(new at(t,{geometry:i.arrowHead,material:r.green,matrix:function(){const e=u.translateMat4c(.8,0,-.07,u.identityMat4()),t=u.scaleMat4v([.6,.6,.6],u.identityMat4()),i=u.rotationMat4v(90*u.DEGTORAD,[1,0,0],u.identityMat4());return u.mulMat4(u.mulMat4(e,t,u.identityMat4()),i,u.identityMat4())}(),pickable:!0,collidable:!0,clippable:!1,visible:!1}),!1),zCurve:t.addChild(new at(t,{geometry:i.curve,material:r.blue,matrix:u.rotationMat4v(180*u.DEGTORAD,[1,0,0],u.identityMat4()),pickable:!1,collidable:!0,clippable:!1,visible:!1}),!1),zCurveHandle:t.addChild(new at(t,{geometry:i.curveHandle,material:r.pickable,matrix:u.rotationMat4v(180*u.DEGTORAD,[1,0,0],u.identityMat4()),pickable:!0,collidable:!0,clippable:!1,visible:!1}),!1),zCurveCurveArrow1:t.addChild(new at(t,{geometry:i.arrowHead,material:r.blue,matrix:function(){const e=u.translateMat4c(.8,-.07,0,u.identityMat4()),t=u.scaleMat4v([.6,.6,.6],u.identityMat4());return u.mulMat4(e,t,u.identityMat4())}(),pickable:!0,collidable:!0,clippable:!1,visible:!1}),!1),zCurveArrow2:t.addChild(new at(t,{geometry:i.arrowHead,material:r.blue,matrix:function(){const e=u.translateMat4c(.05,-.8,0,u.identityMat4()),t=u.scaleMat4v([.6,.6,.6],u.identityMat4()),i=u.rotationMat4v(90*u.DEGTORAD,[0,0,1],u.identityMat4());return u.mulMat4(u.mulMat4(e,t,u.identityMat4()),i,u.identityMat4())}(),pickable:!0,collidable:!0,clippable:!1,visible:!1}),!1),center:t.addChild(new at(t,{geometry:new oe(t,ct({radius:.05})),material:r.center,pickable:!1,collidable:!0,clippable:!1,visible:!1}),!1),xAxisArrow:t.addChild(new at(t,{geometry:i.arrowHead,material:r.red,matrix:function(){const e=u.translateMat4c(0,1.1,0,u.identityMat4()),t=u.rotationMat4v(-90*u.DEGTORAD,[0,0,1],u.identityMat4());return u.mulMat4(t,e,u.identityMat4())}(),pickable:!1,collidable:!0,clippable:!1,visible:!1}),!1),xAxisArrowHandle:t.addChild(new at(t,{geometry:i.arrowHeadHandle,material:r.pickable,matrix:function(){const e=u.translateMat4c(0,1.1,0,u.identityMat4()),t=u.rotationMat4v(-90*u.DEGTORAD,[0,0,1],u.identityMat4());return u.mulMat4(t,e,u.identityMat4())}(),pickable:!0,collidable:!0,clippable:!1,visible:!1}),!1),xAxis:t.addChild(new at(t,{geometry:i.axis,material:r.red,matrix:function(){const e=u.translateMat4c(0,.5,0,u.identityMat4()),t=u.rotationMat4v(-90*u.DEGTORAD,[0,0,1],u.identityMat4());return u.mulMat4(t,e,u.identityMat4())}(),pickable:!1,collidable:!0,clippable:!1,visible:!1}),!1),xAxisHandle:t.addChild(new at(t,{geometry:i.axisHandle,material:r.pickable,matrix:function(){const e=u.translateMat4c(0,.5,0,u.identityMat4()),t=u.rotationMat4v(-90*u.DEGTORAD,[0,0,1],u.identityMat4());return u.mulMat4(t,e,u.identityMat4())}(),pickable:!0,collidable:!0,clippable:!1,visible:!1}),!1),yAxisArrow:t.addChild(new at(t,{geometry:i.arrowHead,material:r.green,matrix:function(){const e=u.translateMat4c(0,1.1,0,u.identityMat4()),t=u.rotationMat4v(180*u.DEGTORAD,[1,0,0],u.identityMat4());return u.mulMat4(t,e,u.identityMat4())}(),pickable:!1,collidable:!0,clippable:!1,visible:!1}),!1),yAxisArrowHandle:t.addChild(new at(t,{geometry:i.arrowHeadHandle,material:r.pickable,matrix:function(){const e=u.translateMat4c(0,1.1,0,u.identityMat4()),t=u.rotationMat4v(180*u.DEGTORAD,[1,0,0],u.identityMat4());return u.mulMat4(t,e,u.identityMat4())}(),pickable:!0,collidable:!0,clippable:!1,visible:!1,opacity:.2}),!1),yShaft:t.addChild(new at(t,{geometry:i.axis,material:r.green,position:[0,-.5,0],pickable:!1,collidable:!0,clippable:!1,visible:!1}),!1),yShaftHandle:t.addChild(new at(t,{geometry:i.axisHandle,material:r.pickable,position:[0,-.5,0],pickable:!0,collidable:!0,clippable:!1,visible:!1}),!1),zAxisArrow:t.addChild(new at(t,{geometry:i.arrowHead,material:r.blue,matrix:function(){const e=u.translateMat4c(0,1.1,0,u.identityMat4()),t=u.rotationMat4v(-90*u.DEGTORAD,[.8,0,0],u.identityMat4());return u.mulMat4(t,e,u.identityMat4())}(),pickable:!1,collidable:!0,clippable:!1,visible:!1}),!1),zAxisArrowHandle:t.addChild(new at(t,{geometry:i.arrowHeadHandle,material:r.pickable,matrix:function(){const e=u.translateMat4c(0,1.1,0,u.identityMat4()),t=u.rotationMat4v(-90*u.DEGTORAD,[.8,0,0],u.identityMat4());return u.mulMat4(t,e,u.identityMat4())}(),pickable:!0,collidable:!0,clippable:!1,visible:!1}),!1),zShaft:t.addChild(new at(t,{geometry:i.axis,material:r.blue,matrix:function(){const e=u.translateMat4c(0,.5,0,u.identityMat4()),t=u.rotationMat4v(-90*u.DEGTORAD,[1,0,0],u.identityMat4());return u.mulMat4(t,e,u.identityMat4())}(),clippable:!1,pickable:!1,collidable:!0,visible:!1}),!1),zAxisHandle:t.addChild(new at(t,{geometry:i.axisHandle,material:r.pickable,matrix:function(){const e=u.translateMat4c(0,.5,0,u.identityMat4()),t=u.rotationMat4v(-90*u.DEGTORAD,[1,0,0],u.identityMat4());return u.mulMat4(t,e,u.identityMat4())}(),clippable:!1,pickable:!0,collidable:!0,visible:!1}),!1)},this._affordanceMeshes={planeFrame:t.addChild(new at(t,{geometry:new oe(t,U({center:[0,0,0],radius:2,tube:.01,radialSegments:4,tubeSegments:4,arc:2*Math.PI})),material:new le(t,{ambient:[1,1,1],diffuse:[0,0,0],emissive:[1,1,0]}),highlighted:!0,highlightMaterial:new he(t,{edges:!1,filled:!0,fillColor:[1,1,0],fillAlpha:1}),pickable:!1,collidable:!1,clippable:!1,visible:!1,scale:[1,1,1],rotation:[0,0,45]}),!1),xHoop:t.addChild(new at(t,{geometry:i.hoop,material:r.red,highlighted:!0,highlightMaterial:r.highlightRed,matrix:function(){const e=u.rotationMat4v(90*u.DEGTORAD,[0,1,0],u.identityMat4()),t=u.rotationMat4v(270*u.DEGTORAD,[1,0,0],u.identityMat4());return u.mulMat4(t,e,u.identityMat4())}(),pickable:!1,collidable:!0,clippable:!1,visible:!1}),!1),yHoop:t.addChild(new at(t,{geometry:i.hoop,material:r.green,highlighted:!0,highlightMaterial:r.highlightGreen,rotation:[-90,0,0],pickable:!1,collidable:!0,clippable:!1,visible:!1}),!1),zHoop:t.addChild(new at(t,{geometry:i.hoop,material:r.blue,highlighted:!0,highlightMaterial:r.highlightBlue,matrix:u.rotationMat4v(180*u.DEGTORAD,[1,0,0],u.identityMat4()),pickable:!1,collidable:!0,clippable:!1,backfaces:!0,visible:!1}),!1),xAxisArrow:t.addChild(new at(t,{geometry:i.arrowHeadBig,material:r.red,matrix:function(){const e=u.translateMat4c(0,1.1,0,u.identityMat4()),t=u.rotationMat4v(-90*u.DEGTORAD,[0,0,1],u.identityMat4());return u.mulMat4(t,e,u.identityMat4())}(),pickable:!1,collidable:!0,clippable:!1,visible:!1}),!1),yAxisArrow:t.addChild(new at(t,{geometry:i.arrowHeadBig,material:r.green,matrix:function(){const e=u.translateMat4c(0,1.1,0,u.identityMat4()),t=u.rotationMat4v(180*u.DEGTORAD,[1,0,0],u.identityMat4());return u.mulMat4(t,e,u.identityMat4())}(),pickable:!1,collidable:!0,clippable:!1,visible:!1}),!1),zAxisArrow:t.addChild(new at(t,{geometry:i.arrowHeadBig,material:r.blue,matrix:function(){const e=u.translateMat4c(0,1.1,0,u.identityMat4()),t=u.rotationMat4v(-90*u.DEGTORAD,[.8,0,0],u.identityMat4());return u.mulMat4(t,e,u.identityMat4())}(),pickable:!1,collidable:!0,clippable:!1,visible:!1}),!1)}}_bindEvents(){const e=this;var t=!1;const i=-1,r=0,o=1,s=2,n=3,a=4,l=5,c=this._rootNode;var h=null,d=null;const p=u.vec2(),m=u.vec3([1,0,0]),f=u.vec3([0,1,0]),g=u.vec3([0,0,1]),b=this._viewer.scene.canvas.canvas,_=this._viewer.camera,v=this._viewer.scene;b.oncontextmenu=function(e){e.preventDefault()};{const e=u.vec3([0,0,0]);var x=-1;this._onCameraViewMatrix=v.camera.on("viewMatrix",()=>{!0}),this._onCameraProjMatrix=v.camera.on("projMatrix",()=>{!0}),this._onSceneTick=v.on("tick",()=>{var t=Math.abs(u.lenVec3(u.subVec3(v.camera.eye,c.position,e)));if(t!==x){var i=t/50*10;c.scale=[i,i,i],x=t}})}const y=function(){const e=new Float32Array(2);return function(t){if(t){for(var i=t.target,r=0,o=0;i.offsetParent;)r+=i.offsetLeft,o+=i.offsetTop,i=i.offsetParent;e[0]=t.pageX-r,e[1]=t.pageY-o}else t=window.event,e[0]=t.x,e[1]=t.y;return e}}(),w=function(){const t=u.mat4();return function(i,r){return u.quaternionToMat4(e._rootNode.quaternion,t),u.transformVec3(t,i,r),u.normalizeVec3(r),r}}();var M=function(){const e=u.vec3();return function(t){const i=Math.abs(t[0]);return i>Math.abs(t[1])&&i>Math.abs(t[2])?u.cross3Vec3(t,[0,1,0],e):u.cross3Vec3(t,[1,0,0],e),u.cross3Vec3(e,t,e),u.normalizeVec3(e),e}}();const k=function(){const t=u.vec3(),i=u.vec3(),r=u.vec4();return function(o,s,n){w(o,r);const a=M(r,s,n);E(s,a,t),E(n,a,i),u.subVec3(i,t);const l=u.dotVec3(i,r);e._pos[0]+=r[0]*l,e._pos[1]+=r[1]*l,e._pos[2]+=r[2]*l,e._rootNode.position=e._pos,e.sectionPlane&&(e.sectionPlane.pos=e._pos)}}();var P=function(){const t=u.vec4(),i=u.vec4(),r=u.vec4(),o=u.vec4();return function(s,n,a){if(w(s,o),!(E(n,o,t)&&E(a,o,i))){const e=M(o,n,a);E(n,e,t,1),E(a,e,i,1);var l=u.dotVec3(t,o);t[0]-=l*o[0],t[1]-=l*o[1],t[2]-=l*o[2],l=u.dotVec3(i,o),i[0]-=l*o[0],i[1]-=l*o[1],i[2]-=l*o[2]}u.normalizeVec3(t),u.normalizeVec3(i),l=u.dotVec3(t,i),l=u.clamp(l,-1,1);var c=Math.acos(l)*u.RADTODEG;u.cross3Vec3(t,i,r),u.dotVec3(r,o)<0&&(c=-c),e._rootNode.rotate(s,c),A()}}(),E=function(){const t=u.vec4([0,0,0,1]),i=u.mat4();return function(r,o,s,n){n=n||0,t[0]=r[0]/b.width*2-1,t[1]=-(r[1]/b.height*2-1),t[2]=0,t[3]=1,u.mulMat4(_.projMatrix,_.viewMatrix,i),u.inverseMat4(i),u.transformVec4(i,t,t),u.mulVec4Scalar(t,1/t[3]);var a=_.eye;u.subVec4(t,a,t);const l=e._sectionPlane.pos;var c=-u.dotVec3(l,o)-n,h=u.dotVec3(o,t);if(Math.abs(h)>.005){var d=-(u.dotVec3(o,a)+c)/h;return u.mulVec3Scalar(t,d,s),u.addVec3(s,a),u.subVec3(s,l,s),!0}return!1}}();const A=function(){const t=u.vec3(),i=u.mat4();return function(){e.sectionPlane&&(u.quaternionToMat4(c.quaternion,i),u.transformVec3(i,[0,0,1],t),e._sectionPlane.dir=t)}}();var C,T=!1;this._onCameraControlHover=this._viewer.cameraControl.on("hoverEnter",e=>{if(!this._visible)return;if(T)return;var c;switch(t=!1,C&&(C.visible=!1),e.entity.id){case this._displayMeshes.xAxisArrowHandle.id:case this._displayMeshes.xAxisHandle.id:c=this._affordanceMeshes.xAxisArrow,h=r;break;case this._displayMeshes.yAxisArrowHandle.id:case this._displayMeshes.yShaftHandle.id:c=this._affordanceMeshes.yAxisArrow,h=o;break;case this._displayMeshes.zAxisArrowHandle.id:case this._displayMeshes.zAxisHandle.id:c=this._affordanceMeshes.zAxisArrow,h=s;break;case this._displayMeshes.xCurveHandle.id:c=this._affordanceMeshes.xHoop,h=n;break;case this._displayMeshes.yCurveHandle.id:c=this._affordanceMeshes.yHoop,h=a;break;case this._displayMeshes.zCurveHandle.id:c=this._affordanceMeshes.zHoop,h=l;break;default:return void(h=i)}c&&(c.visible=!0),C=c,t=!0}),this._onCameraControlHoverLeave=this._viewer.cameraControl.on("hoverOut",e=>{this._visible&&(C&&(C.visible=!1),C=null,h=i)}),b.addEventListener("mousedown",this._canvasMouseDownListener=e=>{if(e.preventDefault(),this._visible&&t)switch(this._viewer.cameraControl.pointerEnabled=!1,e.which){case 1:!0,T=!0;var i=y(e);d=h,p[0]=i[0],p[1]=i[1]}}),b.addEventListener("mousemove",this._canvasMouseMoveListener=e=>{if(!this._visible)return;if(!T)return;var t=y(e);const i=t[0],c=t[1];switch(d){case r:k(m,p,t);break;case o:k(f,p,t);break;case s:k(g,p,t);break;case n:P(m,p,t);break;case a:P(f,p,t);break;case l:P(g,p,t)}p[0]=i,p[1]=c}),b.addEventListener("mouseup",this._canvasMouseUpListener=e=>{if(this._visible&&(this._viewer.cameraControl.pointerEnabled=!0,T)){switch(e.which){case 1:!1;break;case 2:!1;break;case 3:!1}T=!1,t=!1}}),b.addEventListener("wheel",this._canvasWheelListener=e=>{if(this._visible)Math.max(-1,Math.min(1,40*-e.deltaY))})}_destroy(){this._unbindEvents(),this._destroyNodes()}_unbindEvents(){const e=this._viewer,t=e.scene,i=t.canvas.canvas,r=e.camera,o=e.cameraControl;t.off(this._onSceneTick),i.removeEventListener("mousedown",this._canvasMouseDownListener),i.removeEventListener("mousemove",this._canvasMouseMoveListener),i.removeEventListener("mouseup",this._canvasMouseUpListener),i.removeEventListener("mouseenter",this._canvasMouseEnterListener),i.removeEventListener("mouseleave",this._canvasMouseLeaveListener),i.removeEventListener("wheel",this._canvasWheelListener),r.off(this._onCameraViewMatrix),r.off(this._onCameraProjMatrix),o.off(this._onCameraControlHover),o.off(this._onCameraControlHoverLeave)}_destroyNodes(){this._rootNode.destroy(),this._displayMeshes={},this._affordanceMeshes={}}}const pt=function(){const e=document.createElement("canvas"),t=String.fromCharCode;if(!e.getContext)return{saveAsBMP:function(){},saveAsPNG:function(){},saveAsJPEG:function(){}};const i=!!e.getContext("2d").getImageData,r=!!e.toDataURL,o=!!window.btoa,s=function(e){let i="";const r=e.width,o=e.height;i+="BM";let s=r*o*4+54;i+=t(s%256),s=Math.floor(s/256),i+=t(s%256),s=Math.floor(s/256),i+=t(s%256),s=Math.floor(s/256),i+=t(s%256),i+=t(0,0,0,0,54,0,0,0),i+=t(40,0,0,0);let n=r;i+=t(n%256),n=Math.floor(n/256),i+=t(n%256),n=Math.floor(n/256),i+=t(n%256),n=Math.floor(n/256),i+=t(n%256);let a=o;i+=t(a%256),a=Math.floor(a/256),i+=t(a%256),a=Math.floor(a/256),i+=t(a%256),a=Math.floor(a/256),i+=t(a%256),i+=t(1,0,32,0),i+=t(0,0,0,0);let l=r*o*4;i+=t(l%256),l=Math.floor(l/256),i+=t(l%256),l=Math.floor(l/256),i+=t(l%256),l=Math.floor(l/256),i+=t(l%256),i+=t(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const c=e.data;let h,d,u,p,m="",f=o;do{for(u=r*(f-1)*4,p="",h=0;h<r;h++)p+=t(c[u+(d=4*h)+2],c[u+d+1],c[u+d],c[u+d+3]);m+=p}while(--f);return function(e){let i,r,o="";if("string"==typeof e)o=e;else for(r=e,i=0;i<r.length;i++)o+=t(r[i]);return btoa(o)}(i+m)},n=function(e){window.open(e)||(document.location.href=e)},a=function(e,t){return"data:"+t+";base64,"+e},l=function(e){const t=document.createElement("img");return t.src=e,t},c=function(e,t,i){if(t&&i){const r=document.createElement("canvas");return r.width=t,r.height=i,r.style.width=t+"px",r.style.height=i+"px",r.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,t,i),r}return e};return{saveAsPNG:function(e,t,i,o){if(!r)return!1;const s=c(e,i,o).toDataURL("image/png");return t?l(s):(n(s),!0)},saveAsJPEG:function(e,t,i,o){if(!r)return!1;const s=c(e,i,o).toDataURL("image/jpeg");return 5==s.indexOf("image/jpeg")&&(t?l(s):(n(s),!0))},saveAsBMP:function(e,t,h,d){if(!(r&&i&&o))return!1;const u=function(e){const t=parseInt(e.width),i=parseInt(e.height);return e.getContext("2d").getImageData(0,0,t,i)}(c(e,h,d)),p=s(u);return t?l(a(p,"image/bmp")):(n(a(p,"image/bmp")),!0)}}}(),mt=".sk-fading-circle {        background: transparent;        margin: 20px auto;        width: 50px;        height:50px;        position: relative;        }        .sk-fading-circle .sk-circle {        width: 120%;        height: 120%;        position: absolute;        left: 0;        top: 0;        }        .sk-fading-circle .sk-circle:before {        content: '';        display: block;        margin: 0 auto;        width: 15%;        height: 15%;        background-color: #ff8800;        border-radius: 100%;        -webkit-animation: sk-circleFadeDelay 1.2s infinite ease-in-out both;        animation: sk-circleFadeDelay 1.2s infinite ease-in-out both;        }        .sk-fading-circle .sk-circle2 {        -webkit-transform: rotate(30deg);        -ms-transform: rotate(30deg);        transform: rotate(30deg);    }    .sk-fading-circle .sk-circle3 {        -webkit-transform: rotate(60deg);        -ms-transform: rotate(60deg);        transform: rotate(60deg);    }    .sk-fading-circle .sk-circle4 {        -webkit-transform: rotate(90deg);        -ms-transform: rotate(90deg);        transform: rotate(90deg);    }    .sk-fading-circle .sk-circle5 {        -webkit-transform: rotate(120deg);        -ms-transform: rotate(120deg);        transform: rotate(120deg);    }    .sk-fading-circle .sk-circle6 {        -webkit-transform: rotate(150deg);        -ms-transform: rotate(150deg);        transform: rotate(150deg);    }    .sk-fading-circle .sk-circle7 {        -webkit-transform: rotate(180deg);        -ms-transform: rotate(180deg);        transform: rotate(180deg);    }    .sk-fading-circle .sk-circle8 {        -webkit-transform: rotate(210deg);        -ms-transform: rotate(210deg);        transform: rotate(210deg);    }    .sk-fading-circle .sk-circle9 {        -webkit-transform: rotate(240deg);        -ms-transform: rotate(240deg);        transform: rotate(240deg);    }    .sk-fading-circle .sk-circle10 {        -webkit-transform: rotate(270deg);        -ms-transform: rotate(270deg);        transform: rotate(270deg);    }    .sk-fading-circle .sk-circle11 {        -webkit-transform: rotate(300deg);        -ms-transform: rotate(300deg);        transform: rotate(300deg);    }    .sk-fading-circle .sk-circle12 {        -webkit-transform: rotate(330deg);        -ms-transform: rotate(330deg);        transform: rotate(330deg);    }    .sk-fading-circle .sk-circle2:before {        -webkit-animation-delay: -1.1s;        animation-delay: -1.1s;    }    .sk-fading-circle .sk-circle3:before {        -webkit-animation-delay: -1s;        animation-delay: -1s;    }    .sk-fading-circle .sk-circle4:before {        -webkit-animation-delay: -0.9s;        animation-delay: -0.9s;    }    .sk-fading-circle .sk-circle5:before {        -webkit-animation-delay: -0.8s;        animation-delay: -0.8s;    }    .sk-fading-circle .sk-circle6:before {        -webkit-animation-delay: -0.7s;        animation-delay: -0.7s;    }    .sk-fading-circle .sk-circle7:before {        -webkit-animation-delay: -0.6s;        animation-delay: -0.6s;    }    .sk-fading-circle .sk-circle8:before {        -webkit-animation-delay: -0.5s;        animation-delay: -0.5s;    }    .sk-fading-circle .sk-circle9:before {        -webkit-animation-delay: -0.4s;        animation-delay: -0.4s;    }    .sk-fading-circle .sk-circle10:before {        -webkit-animation-delay: -0.3s;        animation-delay: -0.3s;    }    .sk-fading-circle .sk-circle11:before {        -webkit-animation-delay: -0.2s;        animation-delay: -0.2s;    }    .sk-fading-circle .sk-circle12:before {        -webkit-animation-delay: -0.1s;        animation-delay: -0.1s;    }    @-webkit-keyframes sk-circleFadeDelay {        0%, 39%, 100% { opacity: 0; }        40% { opacity: 1; }    }    @keyframes sk-circleFadeDelay {        0%, 39%, 100% { opacity: 0; }        40% { opacity: 1; }    }";class ft extends B{get type(){return"Spinner"}constructor(e,t={}){super(e,t),this._canvas=t.canvas,this._element=null,this._isCustom=!1,t.elementId&&(this._element=document.getElementById(t.elementId),this._element?this._adjustPosition():this.error("Can't find given Spinner HTML element: '"+t.elementId+"' - will automatically create default element")),this._element||this._createDefaultSpinner(),this.processes=0}_createDefaultSpinner(){this._injectDefaultCSS();const e=document.createElement("div"),t=e.style;t["z-index"]="9000",t.position="absolute",e.innerHTML='<div class="sk-fading-circle">                <div class="sk-circle1 sk-circle"></div>                <div class="sk-circle2 sk-circle"></div>                <div class="sk-circle3 sk-circle"></div>                <div class="sk-circle4 sk-circle"></div>                <div class="sk-circle5 sk-circle"></div>                <div class="sk-circle6 sk-circle"></div>                <div class="sk-circle7 sk-circle"></div>                <div class="sk-circle8 sk-circle"></div>                <div class="sk-circle9 sk-circle"></div>                <div class="sk-circle10 sk-circle"></div>                <div class="sk-circle11 sk-circle"></div>                <div class="sk-circle12 sk-circle"></div>                </div>',this._canvas.parentElement.appendChild(e),this._element=e,this._isCustom=!1,this._adjustPosition()}_injectDefaultCSS(){if(document.getElementById("xeokit-spinner-css"))return;const e=document.createElement("style");e.innerHTML=mt,e.id="xeokit-spinner-css",document.body.appendChild(e)}_adjustPosition(){if(this._isCustom)return;const e=this._canvas,t=this._element,i=t.style;i.left=e.offsetLeft+.5*e.clientWidth-.5*t.clientWidth+"px",i.top=e.offsetTop+.5*e.clientHeight-.5*t.clientHeight+"px"}set processes(e){if(e=e||0,this._processes===e)return;if(e<0)return;const t=this._processes;this._processes=e;const i=this._element;i&&(i.style.visibility=this._processes>0?"visible":"hidden"),this.fire("processes",this._processes),0===this._processes&&this._processes!==t&&this.fire("zeroProcesses",this._processes)}get processes(){return this._processes}_destroy(){this._element&&!this._isCustom&&(this._element.parentNode.removeChild(this._element),this._element=null)}}const gt=["webgl","experimental-webgl","webkit-3d","moz-webgl","moz-glweb20"];class bt extends B{get type(){return"Canvas"}constructor(e,t={}){super(e,t),this.canvas=t.canvas,this.gl=null,this.webgl2=!1,this.transparent=!!t.transparent,this.contextAttr=t.contextAttr||{},this.contextAttr.alpha=this.transparent,void 0!==this.contextAttr.preserveDrawingBuffer&&null!==this.contextAttr.preserveDrawingBuffer||(this.contextAttr.preserveDrawingBuffer=!0),this.contextAttr.stencil=!1,this.contextAttr.antialias=!0,this.contextAttr.premultipliedAlpha=!1!==this.contextAttr.premultipliedAlpha,this.contextAttr.antialias=!1!==this.contextAttr.antialias,this.canvas.width=this.canvas.clientWidth,this.canvas.height=this.canvas.clientHeight,this.boundary=[this.canvas.offsetLeft,this.canvas.offsetTop,this.canvas.clientWidth,this.canvas.clientHeight],this._initWebGL(t);const i=this;this.canvas.addEventListener("webglcontextlost",this._webglcontextlostListener=function(e){console.time("webglcontextrestored"),i.scene._webglContextLost(),i.fire("webglcontextlost"),e.preventDefault()},!1),this.canvas.addEventListener("webglcontextrestored",this._webglcontextrestoredListener=function(e){i._initWebGL(),i.gl&&(i.scene._webglContextRestored(i.gl),i.fire("webglcontextrestored",i.gl),e.preventDefault()),console.timeEnd("webglcontextrestored")},!1);let r=null,o=null,s=null,n=null,a=null,l=null,c=null;this._tick=this.scene.on("tick",(function(){const e=i.canvas,t=window.innerWidth!==r||window.innerHeight!==o,h=e.clientWidth!==s||e.clientHeight!==n,d=e.offsetLeft!==a||e.offsetTop!==l,u=e.parentElement;if(t||h||d||u!==c){if(i._spinner._adjustPosition(),h||d){const t=e.clientWidth,r=e.clientHeight;if(h){let t,i=0;for(const e in N.scenes)N.scenes.hasOwnProperty(e)&&(i+=(t=N.scenes[e]).canvas.canvas.clientWidth*t.canvas.canvas.clientHeight);P.memory.pixels=i,e.width=e.clientWidth,e.height=e.clientHeight}const o=i.boundary;o[0]=e.offsetLeft,o[1]=e.offsetTop,o[2]=t,o[3]=r,i.fire("boundary",o),s=t,n=r}t&&(r=window.innerWidth,o=window.innerHeight),d&&(a=e.offsetLeft,l=e.offsetTop),c=u}})),this.canvas.oncontextmenu=function(e){e.preventDefault()},this._spinner=new ft(this.scene,{canvas:this.canvas,elementId:t.spinnerElementId}),this.clearColorAmbient=t.clearColorAmbient}_createCanvas(){const e="xeokit-canvas-"+u.createUUID(),t=document.getElementsByTagName("body")[0],i=document.createElement("div"),r=i.style;r.height="100%",r.width="100%",r.padding="0",r.margin="0",r.background="rgba(0,0,0,0);",r.float="left",r.left="0",r.top="0",r.position="absolute",r.opacity="1.0",r["z-index"]="-10000",i.innerHTML+='<canvas id="'+e+'" style="width: 100%; height: 100%; float: left; margin: 0; padding: 0;"></canvas>',t.appendChild(i),this.canvas=document.getElementById(e)}_getElementXY(e){let t=0,i=0;for(;e;)t+=e.offsetLeft-e.scrollLeft,i+=e.offsetTop-e.scrollTop,e=e.offsetParent;return{x:t,y:i}}_initWebGL(){if(!this.gl)for(let e=0;!this.gl&&e<gt.length;e++)try{this.gl=this.canvas.getContext(gt[e],this.contextAttr)}catch(e){}if(this.gl||(this.error("Failed to get a WebGL context"),this.fire("webglContextFailed",!0,!0)),this.gl)if(this.webgl2)this.gl.hint(this.gl.FRAGMENT_SHADER_DERIVATIVE_HINT,this.gl.FASTEST);else if(q.SUPPORTED_EXTENSIONS.OES_standard_derivatives){const e=this.gl.getExtension("OES_standard_derivatives");this.gl.hint(e.FRAGMENT_SHADER_DERIVATIVE_HINT_OES,this.gl.FASTEST)}}set clearColorAmbient(e){this._clearColorAmbient=!!e}get clearColorAmbient(){return this._clearColorAmbient}getSnapshot(e){throw"Canvas#getSnapshot() has been replaced by Viewer#getSnapshot() - use that method instead."}_getSnapshot(e){const t=(e=e||{}).width||this.canvas.width,i=e.height||this.canvas.height,r=e.format||"jpeg";let o;switch(r){case"jpeg":o=pt.saveAsJPEG(this.canvas,!0,t,i);break;case"png":o=pt.saveAsPNG(this.canvas,!0,t,i);break;case"bmp":o=pt.saveAsBMP(this.canvas,!0,t,i);break;default:this.error("Unsupported snapshot format: '"+r+"' - supported types are 'jpeg', 'bmp' and 'png' - defaulting to 'jpeg'"),o=pt.saveAsJPEG(this.canvas,!0,t,i)}return o.src}readPixels(e,t,i,r){return this.scene._renderer.readPixels(e,t,i,r)}loseWebGLContext(){this.canvas.loseContext&&this.canvas.loseContext()}get spinner(){return this._spinner}destroy(){this.scene.off(this._tick),this._spinner._destroy(),this.canvas.removeEventListener("webglcontextlost",this._webglcontextlostListener),this.canvas.removeEventListener("webglcontextrestored",this._webglcontextrestoredListener),this.canvas=null,this.gl=null,super.destroy()}}class _t{constructor(){this.reset()}reset(){this.lastProgramId=null,this.backfaces=!1,this.frontface=!0,this.textureUnit=0,this.drawElements=0,this.drawArrays=0,this.useProgram=0,this.bindTexture=0,this.bindArray=0,this.pass=0,this.shadowViewMatrix=null,this.shadowProjMatrix=null,this.pickViewMatrix=null,this.pickProjMatrix=null,this.pickInvisible=!1,this.lineWidth=1}}class vt{constructor(){this.reset()}reset(){this.normalFillOpaque=!1,this.normalEdgesOpaque=!1,this.normalFillTransparent=!1,this.normalEdgesTransparent=!1,this.xrayedFillOpaque=!1,this.xrayedEdgesOpaque=!1,this.xrayedFillTransparent=!1,this.xrayedEdgesTransparent=!1,this.highlightedFillOpaque=!1,this.highlightedEdgesOpaque=!1,this.highlightedFillTransparent=!1,this.highlightedEdgesTransparent=!1,this.selectedFillOpaque=!1,this.selectedEdgesOpaque=!1,this.selectedFillTransparent=!1,this.selectedEdgesTransparent=!1}}class xt{constructor(e,t,i){i=i||{},this.gl=t,this.allocated=!1,this.canvas=e,this.buffer=null,this.bound=!1,this.size=i.size}setSize(e){this.size=e}webglContextRestored(e){this.gl=e,this.buffer=null,this.allocated=!1,this.bound=!1}bind(){if(this._touch(),this.bound)return;const e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,this.buffer.framebuf),this.bound=!0}_touch(){let e,t;const i=this.gl;if(this.size?(e=this.size[0],t=this.size[1]):(e=this.canvas.clientWidth,t=this.canvas.clientHeight),this.buffer){if(this.buffer.width===e&&this.buffer.height===t)return;i.deleteTexture(this.buffer.texture),i.deleteFramebuffer(this.buffer.framebuf),i.deleteRenderbuffer(this.buffer.renderbuf)}const r=i.createTexture();i.bindTexture(i.TEXTURE_2D,r),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,e,t,0,i.RGBA,i.UNSIGNED_BYTE,null),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE);const o=i.createRenderbuffer();i.bindRenderbuffer(i.RENDERBUFFER,o),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_COMPONENT16,e,t);const s=i.createFramebuffer();if(i.bindFramebuffer(i.FRAMEBUFFER,s),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,r,0),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,o),i.bindTexture(i.TEXTURE_2D,null),i.bindRenderbuffer(i.RENDERBUFFER,null),i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindFramebuffer(i.FRAMEBUFFER,s),!i.isFramebuffer(s))throw"Invalid framebuffer";i.bindFramebuffer(i.FRAMEBUFFER,null);const n=i.checkFramebufferStatus(i.FRAMEBUFFER);switch(n){case i.FRAMEBUFFER_COMPLETE:break;case i.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:throw"Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case i.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:throw"Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case i.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:throw"Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case i.FRAMEBUFFER_UNSUPPORTED:throw"Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED";default:throw"Incomplete framebuffer: "+n}this.buffer={framebuf:s,renderbuf:o,texture:r,width:e,height:t},this.bound=!1}clear(){if(!this.bound)throw"Render buffer not bound";const e=this.gl;e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}read(e,t){const i=e,r=this.canvas.height-t,o=new Uint8Array(4),s=this.gl;return s.readPixels(i,r,1,1,s.RGBA,s.UNSIGNED_BYTE,o),o}unbind(){const e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,null),this.bound=!1}getTexture(){const e=this;return{renderBuffer:this,bind:function(t){return!(!e.buffer||!e.buffer.texture)&&(e.gl.activeTexture(e.gl["TEXTURE"+t]),e.gl.bindTexture(e.gl.TEXTURE_2D,e.buffer.texture),!0)},unbind:function(t){e.buffer&&e.buffer.texture&&(e.gl.activeTexture(e.gl["TEXTURE"+t]),e.gl.bindTexture(e.gl.TEXTURE_2D,null))}}}destroy(){if(this.allocated){const e=this.gl;e.deleteTexture(this.buffer.texture),e.deleteFramebuffer(this.buffer.framebuf),e.deleteRenderbuffer(this.buffer.renderbuf),this.allocated=!1,this.buffer=null,this.bound=!1}}}class yt{constructor(){this.entity=null,this.primitive=null,this.primIndex=-1,this._canvasPos=new Int16Array([0,0]),this._origin=new Float32Array([0,0,0]),this._direction=new Float32Array([0,0,0]),this._indices=new Int32Array(3),this._localPos=new Float32Array([0,0,0]),this._worldPos=new Float32Array([0,0,0]),this._viewPos=new Float32Array([0,0,0]),this._bary=new Float32Array([0,0,0]),this._worldNormal=new Float32Array([0,0,0]),this._uv=new Float32Array([0,0]),this.reset()}get canvasPos(){return this._gotCanvasPos?this._canvasPos:null}set canvasPos(e){e?(this._canvasPos[0]=e[0],this._canvasPos[1]=e[1],this._gotCanvasPos=!0):this._gotCanvasPos=!1}get origin(){return this._gotOrigin?this._origin:null}set origin(e){e?(this._origin[0]=e[0],this._origin[1]=e[1],this._origin[2]=e[2],this._gotOrigin=!0):this._gotOrigin=!1}get direction(){return this._gotDirection?this._direction:null}set direction(e){e?(this._direction[0]=e[0],this._direction[1]=e[1],this._direction[2]=e[2],this._gotDirection=!0):this._gotDirection=!1}get indices(){return this.entity&&this._gotIndices?this._indices:null}set indices(e){e?(this._indices[0]=e[0],this._indices[1]=e[1],this._indices[2]=e[2],this._gotIndices=!0):this._gotIndices=!1}get localPos(){return this.entity&&this._gotLocalPos?this._localPos:null}set localPos(e){e?(this._localPos[0]=e[0],this._localPos[1]=e[1],this._localPos[2]=e[2],this._gotLocalPos=!0):this._gotLocalPos=!1}get worldPos(){return this.entity&&this._gotWorldPos?this._worldPos:null}set worldPos(e){e?(this._worldPos[0]=e[0],this._worldPos[1]=e[1],this._worldPos[2]=e[2],this._gotWorldPos=!0):this._gotWorldPos=!1}get viewPos(){return this.entity&&this._gotViewPos?this._viewPos:null}set viewPos(e){e?(this._viewPos[0]=e[0],this._viewPos[1]=e[1],this._viewPos[2]=e[2],this._gotViewPos=!0):this._gotViewPos=!1}get bary(){return this.entity&&this._gotBary?this._bary:null}set bary(e){e?(this._bary[0]=e[0],this._bary[1]=e[1],this._bary[2]=e[2],this._gotBary=!0):this._gotBary=!1}get worldNormal(){return this.entity&&this._gotWorldNormal?this._worldNormal:null}set worldNormal(e){e?(this._worldNormal[0]=e[0],this._worldNormal[1]=e[1],this._worldNormal[2]=e[2],this._gotWorldNormal=!0):this._gotWorldNormal=!1}get uv(){return this.entity&&this._gotUV?this._uv:null}set uv(e){e?(this._uv[0]=e[0],this._uv[1]=e[1],this._gotUV=!0):this._gotUV=!1}reset(){this.entity=null,this.primIndex=-1,this.primitive=null,this._gotCanvasPos=!1,this._gotOrigin=!1,this._gotDirection=!1,this._gotIndices=!1,this._gotLocalPos=!1,this._gotWorldPos=!1,this._gotViewPos=!1,this._gotBary=!1,this._gotWorldNormal=!1,this._gotUV=!1}}const wt=!1,Mt=u.vec3([1,0,0]),kt=20;class Pt{constructor(e){this._scene=e,this._markers={},this._markerList=[],this._markerIndices={},this._numMarkers=0,this._positions=[],this._indices=[],this._positionsBuf=null,this._indicesBuf=null,this._occlusionTestList=[],this._lenOcclusionTestList=0,this._pixels=[],this._shaderSource=null,this._program=null,this._shaderSourceHash=null,this._shaderSourceDirty=!0,this._programDirty=!1,this._markerListDirty=!1,this._positionsDirty=!1,this._vbosDirty=!1,this._occlusionTestListDirty=!1,this._lenPositionsBuf=0,e.camera.on("viewMatrix",()=>{this._occlusionTestListDirty=!0}),e.camera.on("projMatrix",()=>{this._occlusionTestListDirty=!0}),e.canvas.on("boundary",()=>{this._occlusionTestListDirty=!0})}addMarker(e){this._markers[e.id]=e,this._markerListDirty=!0}markerWorldPosUpdated(e){if(!this._markers[e.id])return;const t=this._markerIndices[e.id];this._positions[3*t+0]=e.worldPos[0],this._positions[3*t+1]=e.worldPos[1],this._positions[3*t+2]=e.worldPos[2],this._positionsDirty=!0}removeMarker(e){delete this._markers[e.id],this._markerListDirty=!0}bindRenderBuf(){const e=[this._scene.canvas.canvas.id,this._scene._sectionPlanesState.getHash()].join(";");e!==this._shaderSourceHash&&(this._shaderSourceHash=e,this._shaderSourceDirty=!0),this._shaderSourceDirty&&(this._buildShaderSource(),this._shaderSourceDirty=!1,this._programDirty=!0),this._programDirty&&(this._buildProgram(),this._programDirty=!1,this._occlusionTestListDirty=!0),this._markerListDirty&&(this._buildMarkerList(),this._markerListDirty=!1,this._positionsDirty=!0,this._occlusionTestListDirty=!0),this._positionsDirty&&(this._buildPositions(),this._positionsDirty=!1,this._vbosDirty=!0),this._vbosDirty&&(this._buildVBOs(),this._vbosDirty=!1),this._occlusionTestListDirty&&this._buildOcclusionTestList(),wt||(this._readPixelBuf=this._readPixelBuf||(this._readPixelBuf=new xt(this._scene.canvas.canvas,this._scene.canvas.gl)),this._readPixelBuf.bind(),this._readPixelBuf.clear())}_buildShaderSource(){this._shaderSource={vertex:this._buildVertexShaderSource(),fragment:this._buildFragmentShaderSource()}}_buildVertexShaderSource(){const e=this._scene._sectionPlanesState.sectionPlanes.length>0,t=[];return t.push("// Mesh occlusion vertex shader"),t.push("attribute vec3 position;"),t.push("uniform mat4 modelMatrix;"),t.push("uniform mat4 viewMatrix;"),t.push("uniform mat4 projMatrix;"),e&&t.push("varying vec4 vWorldPosition;"),t.push("void main(void) {"),t.push("vec4 worldPosition = vec4(position, 1.0); "),t.push("   vec4 viewPosition = viewMatrix * worldPosition;"),e&&t.push("   vWorldPosition = worldPosition;"),t.push("   gl_Position = projMatrix * viewPosition;"),t.push("   gl_PointSize = "+kt+".0;"),t.push("}"),t}_buildFragmentShaderSource(){const e=this._scene._sectionPlanesState,t=e.sectionPlanes.length>0,i=[];if(i.push("// Mesh occlusion fragment shader"),i.push("precision lowp float;"),t){i.push("varying vec4 vWorldPosition;");for(var r=0;r<e.sectionPlanes.length;r++)i.push("uniform bool sectionPlaneActive"+r+";"),i.push("uniform vec3 sectionPlanePos"+r+";"),i.push("uniform vec3 sectionPlaneDir"+r+";")}if(i.push("void main(void) {"),t){i.push("  float dist = 0.0;");for(r=0;r<e.sectionPlanes.length;r++)i.push("if (sectionPlaneActive"+r+") {"),i.push("   dist += clamp(dot(-sectionPlaneDir"+r+".xyz, vWorldPosition.xyz - sectionPlanePos"+r+".xyz), 0.0, 1000.0);"),i.push("}");i.push("  if (dist > 0.0) { discard; }")}return i.push("   gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0); "),i.push("}"),i}_buildProgram(){this._program&&this._program.destroy();const e=this._scene,t=e.canvas.gl,i=e._sectionPlanesState;if(this._program=new De(t,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const r=this._program;this._uViewMatrix=r.getLocation("viewMatrix"),this._uProjMatrix=r.getLocation("projMatrix"),this._uSectionPlanes=[];for(var o=0,s=i.sectionPlanes.length;o<s;o++)this._uSectionPlanes.push({active:r.getLocation("sectionPlaneActive"+o),pos:r.getLocation("sectionPlanePos"+o),dir:r.getLocation("sectionPlaneDir"+o)});this._aPosition=r.getAttribute("position")}_buildMarkerList(){for(var e in this._numMarkers=0,this._markers)this._markers.hasOwnProperty(e)&&(this._markerList[this._numMarkers]=this._markers[e],this._markerIndices[e]=this._numMarkers,this._numMarkers++);this._markerList.length=this._numMarkers}_buildPositions(){for(var e=0,t=0;t<this._numMarkers;t++)if(this._markerList[t]){const i=this._markerList[t].worldPos;this._positions[e++]=i[0],this._positions[e++]=i[1],this._positions[e++]=i[2],this._indices[t]=t}this._positions.length=3*this._numMarkers,this._indices.length=this._numMarkers}_buildVBOs(){if(this._positionsBuf){if(this._lenPositionsBuf===this._positions.length)return void this._positionsBuf.setData(this._positions);this._positionsBuf.destroy(),this._positionsBuf=null,this._indicesBuf.destroy(),this._indicesBuf=null}const e=this._scene.canvas.gl,t=3*this._numMarkers,i=this._numMarkers;this._positionsBuf=new W(e,e.ARRAY_BUFFER,new Float32Array(this._positions),t,3,e.STATIC_DRAW),this._indicesBuf=new W(e,e.ELEMENT_ARRAY_BUFFER,new Uint16Array(this._indices),i,1,e.STATIC_DRAW),this._lenPositionsBuf=this._positions.length}_buildOcclusionTestList(){const e=this._scene.canvas,t=this._scene.camera.perspective.near;let i,r,o,s,n,a,l=0;const c=e.boundary,h=c[2],d=c[3];for(this._lenOcclusionTestList=0,a=0;a<this._numMarkers;a++)(o=(i=this._markerList[a]).viewPos)[2]>-t?i._setVisible(!1):(s=(r=i.canvasPos)[0],n=r[1],s+10<0||n+10<0||s-10>h||n-10>d?i._setVisible(!1):!i.entity||i.entity.visible?i.occludable?(this._occlusionTestList[this._lenOcclusionTestList++]=i,this._pixels[l++]=s,this._pixels[l++]=n):i._setVisible(!0):i._setVisible(!1))}drawMarkers(e){const t=this._scene,i=t.canvas.gl,r=this._program,o=t._sectionPlanesState,s=t.camera,n=s._state;if(r.bind(),o.sectionPlanes.length>0){const e=t._sectionPlanesState.sectionPlanes;let r,o,s,n,c;for(var a=0,l=this._uSectionPlanes.length;a<l;a++)o=(r=this._uSectionPlanes[a]).active,s=e[a],o&&i.uniform1i(o,s.active),(n=r.pos)&&i.uniform3fv(r.pos,s.pos),(c=r.dir)&&i.uniform3fv(r.dir,s.dir)}i.uniformMatrix4fv(this._uViewMatrix,!1,n.matrix),i.uniformMatrix4fv(this._uProjMatrix,!1,s._project._state.matrix),this._aPosition.bindArrayBuffer(this._positionsBuf),this._indicesBuf.bind(),i.drawElements(i.POINTS,this._indicesBuf.numItems,this._indicesBuf.itemType,0)}doOcclusionTest(){if(!wt){const t=255*Mt[0],i=255*Mt[1],r=255*Mt[2];for(var e=0;e<this._lenOcclusionTestList;e++){const o=this._occlusionTestList[e],s=2*e,n=this._readPixelBuf.read(this._pixels[s],this._pixels[s+1]),a=n[0]===t&&n[1]===i&&n[2]===r;o._setVisible(a)}}}unbindRenderBuf(){wt||this._readPixelBuf.unbind()}destroy(){this._markers={},this._markerList.length=0,this._positionsBuf&&this._positionsBuf.destroy(),this._indicesBuf&&this._indicesBuf.destroy(),this._program&&this._program.destroy()}}const Et=function(e,t){t=t||{};const i=new _t,r=e.canvas.canvas,o=e.canvas.gl,s=!0===t.transparent,a=new n({});var l={},c={};let h=!0,d=!0,p=!0,m=!0,f=!0,g=null,b=null;function _(){h&&(!function(){for(var e in l)if(l.hasOwnProperty(e)){const r=l[e],o=r.drawableMap,s=r.drawableList;var t=0;for(var i in o)o.hasOwnProperty(i)&&(s[t++]=o[i]);s.length=t,r.lenDrawableList=t}}(),h=!1,d=!0),d&&(!function(){for(var e in l)if(l.hasOwnProperty(e)){const t=l[e];t.isStateSortable&&t.drawableList.sort(t.stateSortCompare)}}(),d=!1,p=!0)}this._occlusionTester=null,this.needStateSort=function(){d=!0},this.shadowsDirty=function(){m=!0},this.imageDirty=function(){p=!0},this.setBlendOneMinusSrcAlpha=function(e){f=e},this.webglContextLost=function(){},this.webglContextRestored=function(e){g&&g.webglContextRestored(e),b&&b.webglContextRestored(e),p=!0},this.addDrawable=function(e,t){var i=t.type;if(i){var r=l[i];r||(r={type:t.type,count:0,isStateSortable:t.isStateSortable,stateSortCompare:t.stateSortCompare,drawableMap:{},drawableList:[],lenDrawableList:0},l[i]=r),r.count++,r.drawableMap[e]=t,c[e]=t,h=!0}else console.error("Renderer#addDrawable() : drawable with ID "+e+" has no 'type' - ignoring")},this.removeDrawable=function(e){const t=c[e];if(!t)return void console.error("Renderer#removeDrawable() : drawable not found with ID "+e+" - ignoring");const i=t.type,r=l[i];--r.count<=0?delete l[i]:delete r.drawableMap[e],delete c[e],h=!0},this.getPickID=function(e){return a.addItem(e)},this.putPickID=function(e){a.removeItem(e)},this.clear=function(t){t=t||{};const i=e.viewport.boundary;if(o.viewport(i[0],i[1],i[2],i[3]),s)o.clearColor(0,0,0,0);else{const i=t.ambientColor||e.canvas.backgroundColor||this.lights.getAmbientColor();o.clearColor(i[0],i[1],i[2],1)}o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT|o.STENCIL_BUFFER_BIT)},this.render=function(e){e=e||{},_(),(p||e.force)&&(v(e),P.frame.frameCount++,p=!1)};var v=function(){const t=[],r=[],n=[],a=[],c=[],h=[],d=[],u=[],p=[],m=[],g=[],b=[],_=[],v=[],x=[],y=new vt;return function(w){w.opaqueOnly;q.SUPPORTED_EXTENSIONS.OES_element_index_uint&&o.getExtension("OES_element_index_uint");const M=e._lightsState.getAmbientColor();i.reset(),i.pass=w.pass;const k=e.viewport.boundary;if(o.viewport(k[0],k[1],k[2],k[3]),s)o.clearColor(0,0,0,0);else{const t=e.canvas.backgroundColor||M;o.clearColor(t[0],t[1],t[2],1)}let E,A,C;o.enable(o.DEPTH_TEST),o.frontFace(o.CCW),o.enable(o.CULL_FACE),o.depthMask(!0),o.lineWidth(1),i.lineWidth=1;const T=Date.now();!1!==w.clear&&o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT|o.STENCIL_BUFFER_BIT);let D=0,S=0,L=0,R=0,I=0,N=0,F=0,B=0,O=0,j=0,z=0,V=0,U=0,H=0,G=0;for(var W in l)if(l.hasOwnProperty(W)){const e=l[W].drawableList;for(E=0,A=e.length;E<A;E++)!0!==(C=e[E]).culled&&!1!==C.visible&&(C.getRenderFlags(y),y.normalFillOpaque&&C.drawNormalFillOpaque(i),y.normalEdgesOpaque&&(t[D++]=C),y.normalFillTransparent&&(r[S++]=C),y.normalEdgesTransparent&&(n[L++]=C),y.xrayedFillTransparent&&(h[N++]=C),y.xrayedFillOpaque&&(a[R++]=C),y.xrayedEdgesTransparent&&(d[F++]=C),y.xrayedEdgesOpaque&&(c[I++]=C),y.highlightedFillTransparent&&(m[j++]=C),y.highlightedFillOpaque&&(u[B++]=C),y.highlightedEdgesTransparent&&(g[z++]=C),y.highlightedEdgesOpaque&&(p[O++]=C),y.selectedFillTransparent&&(v[H++]=C),y.selectedFillOpaque&&(b[V++]=C),y.selectedEdgesTransparent&&(x[G++]=C),y.selectedEdgesOpaque&&(_[U++]=C))}if(D>0)for(E=0;E<D;E++)t[E].drawNormalEdgesOpaque(i);if(R>0)for(E=0;E<R;E++)a[E].drawXRayedFillOpaque(i);if(I>0)for(E=0;E<I;E++)c[E].drawXRayedEdgesOpaque(i);if(N>0||F>0||S>0){if(o.enable(o.CULL_FACE),o.enable(o.BLEND),f?o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA):(o.blendEquation(o.FUNC_ADD),o.blendFuncSeparate(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA,o.ONE,o.ONE_MINUS_SRC_ALPHA)),i.backfaces=!1,F>0)for(E=0;E<F;E++)d[E].drawXRayedEdgesTransparent(i);if(N>0)for(E=0;E<N;E++)h[E].drawXRayedFillTransparent(i);if(S>0)for(E=0;E<S;E++)(C=r[E]).drawNormalFillTransparent(i);if(L>0)for(E=0;E<L;E++)(C=n[E]).drawNormalEdgesTransparent(i);o.disable(o.BLEND)}if(B>0||O>0){if(i.lastProgramId=null,o.clear(o.DEPTH_BUFFER_BIT),O>0)for(E=0;E<O;E++)p[E].drawHighlightedEdgesOpaque(i);if(B>0)for(E=0;E<B;E++)u[E].drawHighlightedFillOpaque(i)}if(j>0||z>0||B>0){if(i.lastProgramId=null,o.clear(o.DEPTH_BUFFER_BIT),o.enable(o.CULL_FACE),o.enable(o.BLEND),o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA),z>0)for(E=0;E<z;E++)g[E].drawHighlightedEdgesTransparent(i);if(j>0)for(E=0;E<j;E++)m[E].drawHighlightedFillTransparent(i);o.disable(o.BLEND)}if(V>0||U>0){if(i.lastProgramId=null,o.clear(o.DEPTH_BUFFER_BIT),U>0)for(E=0;E<U;E++)_[E].drawSelectedEdgesOpaque(i);if(V>0)for(E=0;E<V;E++)b[E].drawSelectedFillOpaque(i)}if(H>0||G>0){if(i.lastProgramId=null,o.clear(o.DEPTH_BUFFER_BIT),o.enable(o.CULL_FACE),o.enable(o.BLEND),o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA),G>0)for(E=0;E<G;E++)x[E].drawSelectedEdgesTransparent(i);if(H>0)for(E=0;E<H;E++)v[E].drawSelectedFillTransparent(i);o.disable(o.BLEND)}const X=Date.now(),Y=P.frame;Y.renderTime=(X-T)/1e3,Y.drawElements=i.drawElements,Y.drawElements=i.drawElements,Y.useProgram=i.useProgram,Y.bindTexture=i.bindTexture,Y.bindArray=i.bindArray;const K=q.MAX_TEXTURE_UNITS;for(let e=0;e<K;e++)o.activeTexture(o.TEXTURE0+e);o.bindTexture(o.TEXTURE_CUBE_MAP,null),o.bindTexture(o.TEXTURE_2D,null);const $=q.MAX_VERTEX_ATTRIBS;for(let e=0;e<$;e++)o.disableVertexAttribArray(e)}}();this.pick=function(){const t=u.vec3(),s=u.mat4(),n=u.vec3([0,1,0]),c=u.frustumMat4(-1,1,-1,1,.1,1e4),h=new yt;return function(d,p=h){let m,f,b,v,y;p.reset(),_(),q.SUPPORTED_EXTENSIONS.OES_element_index_uint&&o.getExtension("OES_element_index_uint");let w=null,M=null;p.pickSurface=d.pickSurface,d.canvasPos?(m=d.canvasPos[0],f=d.canvasPos[1],w=e.camera.viewMatrix,M=e.camera.projMatrix,p.canvasPos=d.canvasPos):(d.matrix?(w=d.matrix,M=c):(b=d.origin||u.vec3([0,0,0]),v=d.direction||u.vec3([0,0,1]),y=u.addVec3(b,v,t),w=u.lookAtMat4v(b,y,n,s),M=c,p.origin=b,p.direction=v),m=.5*r.clientWidth,f=.5*r.clientHeight),(g=g||new xt(r,o)).bind();const k=function(t,r,s,n,c){i.reset(),i.backfaces=!0,i.frontface=!0,i.pickViewMatrix=s,i.pickProjMatrix=n,i.pickInvisible=!!c.pickInvisible;const h=e.viewport.boundary;let d,u;o.viewport(h[0],h[1],h[2],h[3]),o.clearColor(0,0,0,0),o.enable(o.DEPTH_TEST),o.enable(o.CULL_FACE),o.disable(o.BLEND),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT);const p=c.includeEntityIds,m=c.excludeEntityIds;for(var f in l)if(l.hasOwnProperty(f)){const e=l[f].drawableList;for(d=0,u=e.length;d<u;d++){const t=e[d];!t.drawPickMesh||!0===t.culled||!0!==c.pickInvisible&&!1===t.visible||!1===t.pickable||(p&&!p[t.id]||m&&m[t.id]||t.drawPickMesh(i))}}const b=g.read(Math.round(t),Math.round(r));let _=b[0]+256*b[1]+256*b[2]*256+256*b[3]*256*256;if(_<0)return;return a.items[_]}(m,f,w,M,d);return k?(d.pickSurface&&(k.canPickTriangle&&k.canPickTriangle()?(!function(t,r,s,n,a,l){if(!t.drawPickTriangles)return;i.reset(),i.backfaces=!0,i.frontface=!0,i.pickViewMatrix=n,i.pickProjMatrix=a;const c=e.viewport.boundary;o.viewport(c[0],c[1],c[2],c[3]),o.clearColor(0,0,0,0),o.enable(o.DEPTH_TEST),o.enable(o.CULL_FACE),o.disable(o.BLEND),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),t.drawPickTriangles(i);const h=g.read(r,s);let d=h[0]+256*h[1]+256*h[2]*256+256*h[3]*256*256;d*=3,l.primIndex=d}(k,m,f,w,M,p),k.pickTriangleSurface(w,M,p)):k.canPickWorldPos&&k.canPickWorldPos()&&(x(k,m,f,w,M,p),function(t,r,s,n,a,l){i.reset(),i.backfaces=!0,i.frontface=!0,i.pickViewMatrix=n,i.pickProjMatrix=a;const c=e.viewport.boundary;o.viewport(c[0],c[1],c[2],c[3]),o.clearColor(0,0,0,0),o.enable(o.DEPTH_TEST),o.enable(o.CULL_FACE),o.disable(o.BLEND),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),t.drawPickNormals(i);const h=g.read(Math.round(r),Math.round(s)),d=[h[0]/256-.5,h[1]/256-.5,h[2]/256-.5];u.normalizeVec3(d),l.worldNormal=d}(k,m,f,w,M,p))),g.unbind(),p.entity=k.delegatePickedEntity?k.delegatePickedEntity():k,p):(g.unbind(),null)}}();var x=function(){const t=u.vec4(),s=u.vec4(),n=u.vec4(),a=u.vec4(),l=u.vec4(),c=u.mat4(),h=u.mat4();return function(d,p,m,f,b,_){i.reset(),i.backfaces=!0,i.frontface=!0,i.pickViewMatrix=f,i.pickProjMatrix=b;const v=e.viewport.boundary;o.viewport(v[0],v[1],v[2],v[3]),o.clearColor(0,0,0,0),o.enable(o.DEPTH_TEST),o.enable(o.CULL_FACE),o.disable(o.BLEND),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),d.drawPickDepths(i);const x=g.read(Math.round(p),Math.round(m)),y=(M=[(w=x)[0]/256,w[1]/256,w[2]/256,w[3]/256],u.dotVec4(M,[1/16777216,1/65536,1/256,1]));var w,M,k=(p-r.width/2)/(r.width/2),P=-(m-r.height/2)/(r.height/2),E=u.mulMat4(b,f,c),A=u.inverseMat4(E,h);t[0]=k,t[1]=P,t[2]=-1,t[3]=1;var C=u.transformVec4(A,t);C=u.mulVec4Scalar(C,1/C[3]),s[0]=k,s[1]=P,s[2]=1,s[3]=1;var T=u.transformVec4(A,s);T=u.mulVec4Scalar(T,1/T[3]);var D=u.subVec3(T,C,n),S=u.addVec3(C,u.mulVec4Scalar(D,y,a),l);_.worldPos=S}}();this.addMarker=function(t){this._occlusionTester=this._occlusionTester||new Pt(e),this._occlusionTester.addMarker(t)},this.markerWorldPosUpdated=function(e){this._occlusionTester.markerWorldPosUpdated(e)},this.removeMarker=function(e){this._occlusionTester.removeMarker(e)},this.doOcclusionTest=function(){if(this._occlusionTester){_(),this._occlusionTester.bindRenderBuf(),i.reset(),i.backfaces=!0,i.frontface=!0;const n=e.viewport.boundary;for(var t in o.viewport(n[0],n[1],n[2],n[3]),o.clearColor(0,0,0,0),o.enable(o.DEPTH_TEST),o.enable(o.CULL_FACE),o.disable(o.BLEND),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),l)if(l.hasOwnProperty(t)){const e=l[t].drawableList;for(var r=0,s=e.length;r<s;r++){const t=e[r];t.drawOcclusion&&!0!==t.culled&&!1!==t.visible&&!1!==t.pickable&&t.drawOcclusion(i)}}this._occlusionTester.drawMarkers(i),this._occlusionTester.doOcclusionTest(),this._occlusionTester.unbindRenderBuf()}},this.readPixels=function(e,t,i,s){let n,a,l,c;for((b=b||(b=new xt(r,o))).bind(),b.clear(),this.render({force:!0,opaqueOnly:s}),a=0;a<i;a++)l=2*a,c=4*a,n=b.read(e[l],e[l+1]),t[c]=n[0],t[c+1]=n[1],t[c+2]=n[2],t[c+3]=n[3];b.unbind(),p=!0},this.destroy=function(){l={},c={},g&&g.destroy(),b&&b.destroy(),this._occlusionTester&&this._occlusionTester.destroy()}};class At extends B{get type(){return"Input"}constructor(e,t={}){super(e,t);const i=this;this.KEY_BACKSPACE=8,this.KEY_TAB=9,this.KEY_ENTER=13,this.KEY_SHIFT=16,this.KEY_CTRL=17,this.KEY_ALT=18,this.KEY_PAUSE_BREAK=19,this.KEY_CAPS_LOCK=20,this.KEY_ESCAPE=27,this.KEY_PAGE_UP=33,this.KEY_PAGE_DOWN=34,this.KEY_END=35,this.KEY_HOME=36,this.KEY_LEFT_ARROW=37,this.KEY_UP_ARROW=38,this.KEY_RIGHT_ARROW=39,this.KEY_DOWN_ARROW=40,this.KEY_INSERT=45,this.KEY_DELETE=46,this.KEY_NUM_0=48,this.KEY_NUM_1=49,this.KEY_NUM_2=50,this.KEY_NUM_3=51,this.KEY_NUM_4=52,this.KEY_NUM_5=53,this.KEY_NUM_6=54,this.KEY_NUM_7=55,this.KEY_NUM_8=56,this.KEY_NUM_9=57,this.KEY_A=65,this.KEY_B=66,this.KEY_C=67,this.KEY_D=68,this.KEY_E=69,this.KEY_F=70,this.KEY_G=71,this.KEY_H=72,this.KEY_I=73,this.KEY_J=74,this.KEY_K=75,this.KEY_L=76,this.KEY_M=77,this.KEY_N=78,this.KEY_O=79,this.KEY_P=80,this.KEY_Q=81,this.KEY_R=82,this.KEY_S=83,this.KEY_T=84,this.KEY_U=85,this.KEY_V=86,this.KEY_W=87,this.KEY_X=88,this.KEY_Y=89,this.KEY_Z=90,this.KEY_LEFT_WINDOW=91,this.KEY_RIGHT_WINDOW=92,this.KEY_SELECT_KEY=93,this.KEY_NUMPAD_0=96,this.KEY_NUMPAD_1=97,this.KEY_NUMPAD_2=98,this.KEY_NUMPAD_3=99,this.KEY_NUMPAD_4=100,this.KEY_NUMPAD_5=101,this.KEY_NUMPAD_6=102,this.KEY_NUMPAD_7=103,this.KEY_NUMPAD_8=104,this.KEY_NUMPAD_9=105,this.KEY_MULTIPLY=106,this.KEY_ADD=107,this.KEY_SUBTRACT=109,this.KEY_DECIMAL_POINT=110,this.KEY_DIVIDE=111,this.KEY_F1=112,this.KEY_F2=113,this.KEY_F3=114,this.KEY_F4=115,this.KEY_F5=116,this.KEY_F6=117,this.KEY_F7=118,this.KEY_F8=119,this.KEY_F9=120,this.KEY_F10=121,this.KEY_F11=122,this.KEY_F12=123,this.KEY_NUM_LOCK=144,this.KEY_SCROLL_LOCK=145,this.KEY_SEMI_COLON=186,this.KEY_EQUAL_SIGN=187,this.KEY_COMMA=188,this.KEY_DASH=189,this.KEY_PERIOD=190,this.KEY_FORWARD_SLASH=191,this.KEY_GRAVE_ACCENT=192,this.KEY_OPEN_BRACKET=219,this.KEY_BACK_SLASH=220,this.KEY_CLOSE_BRACKET=221,this.KEY_SINGLE_QUOTE=222,this.KEY_SPACE=32,this._element=t.element,this.altDown=!1,this.ctrlDown=!1,this.mouseDownLeft=!1,this.mouseDownMiddle=!1,this.mouseDownRight=!1,this.keyDown=[],this.enabled=!0,this.mouseover=!1,document.addEventListener("keydown",this._keyDownListener=function(e){i.enabled&&("INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&(e.keyCode===i.KEY_CTRL?i.ctrlDown=!0:e.keyCode===i.KEY_ALT&&(i.altDown=!0),i.keyDown[e.keyCode]=!0,i.fire("keydown",e.keyCode,!0)),i.mouseover&&e.preventDefault())},!1),document.addEventListener("keyup",this._keyUpListener=function(e){i.enabled&&"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&(e.keyCode===i.KEY_CTRL?i.ctrlDown=!1:e.keyCode===i.KEY_ALT&&(i.altDown=!1),i.keyDown[e.keyCode]=!1,i.fire("keyup",e.keyCode,!0))}),t.element.addEventListener("mouseenter",this._mouseEnterListener=function(e){if(!i.enabled)return;i.mouseover=!0;const t=i._getClickCoordsWithinElement(e);i.fire("mouseenter",t,!0)}),t.element.addEventListener("mouseleave",this._mouseLeaveListener=function(e){if(!i.enabled)return;i.mouseover=!1;const t=i._getClickCoordsWithinElement(e);i.fire("mouseleave",t,!0)}),t.element.addEventListener("mousedown",this._mouseDownListener=function(e){if(!i.enabled)return;switch(e.which){case 1:i.mouseDownLeft=!0;break;case 2:i.mouseDownMiddle=!0;break;case 3:i.mouseDownRight=!0}const r=i._getClickCoordsWithinElement(e);t.element.focus(),i.fire("mousedown",r,!0),i.mouseover&&e.preventDefault()}),document.addEventListener("mouseup",this._mouseUpListener=function(e){if(!i.enabled)return;switch(e.which){case 1:i.mouseDownLeft=!1;break;case 2:i.mouseDownMiddle=!1;break;case 3:i.mouseDownRight=!1}const t=i._getClickCoordsWithinElement(e);i.fire("mouseup",t,!0),i.mouseover&&e.preventDefault()},!0),document.addEventListener("click",this._clickListener=function(e){if(!i.enabled)return;switch(e.which){case 1:i.mouseDownLeft=!1,i.mouseDownRight=!1;break;case 2:i.mouseDownMiddle=!1;break;case 3:i.mouseDownLeft=!1,i.mouseDownRight=!1}const t=i._getClickCoordsWithinElement(e);i.fire("click",t,!0),i.mouseover&&e.preventDefault()}),document.addEventListener("dblclick",this._dblClickListener=function(e){if(!i.enabled)return;switch(e.which){case 1:i.mouseDownLeft=!1,i.mouseDownRight=!1;break;case 2:i.mouseDownMiddle=!1;break;case 3:i.mouseDownLeft=!1,i.mouseDownRight=!1}const t=i._getClickCoordsWithinElement(e);i.fire("dblclick",t,!0),i.mouseover&&e.preventDefault()}),t.element.addEventListener("mousemove",this._mouseMoveListener=function(e){if(!i.enabled)return;const t=i._getClickCoordsWithinElement(e);i.fire("mousemove",t,!0),i.mouseover&&e.preventDefault()}),t.element.addEventListener("wheel",this._mouseWheelListener=function(e,t){if(!i.enabled)return;const r=Math.max(-1,Math.min(1,40*-e.deltaY));i.fire("mousewheel",r,!0)},{passive:!0}),function(){let e,t;i.on("mousedown",(function(i){e=i[0],t=i[1]})),i.on("mouseup",(function(r){e>=r[0]-2&&e<=r[0]+2&&t>=r[1]-2&&t<=r[1]+2&&i.fire("mouseclicked",r,!0)}))}(),function(){const e={"landscape-primary":90,"landscape-secondary":-90,"portrait-secondary":180,"portrait-primary":0};let t,r;const o=u.vec3(),s=u.vec3(),n={orientation:null,orientationAngle:0},a={orientationAngle:0,acceleration:null,accelerationIncludingGravity:s,rotationRate:u.vec3(),interval:0},l={alpha:0,beta:0,gamma:0,absolute:!1};window.OrientationChangeEvent&&window.addEventListener("orientationchange",i._orientationchangedListener=function(){t=window.screen.orientation||window.screen.mozOrientation||window.msOrientation||null,r=t&&e[t]||0,n.orientation=t,n.orientationAngle=r,i.fire("orientationchange",n)},!1),window.DeviceMotionEvent&&window.addEventListener("devicemotion",i._deviceMotionListener=function(e){a.interval=e.interval,a.orientationAngle=r;const t=e.acceleration;t?(o[0]=t.x,o[1]=t.y,o[2]=t.z,a.acceleration=o):a.acceleration=null;const n=e.accelerationIncludingGravity;n?(s[0]=n.x,s[1]=n.y,s[2]=n.z,a.accelerationIncludingGravity=s):a.accelerationIncludingGravity=null,a.rotationRate=e.rotationRate,i.fire("devicemotion",a)},!1),window.DeviceOrientationEvent&&window.addEventListener("deviceorientation",i._deviceOrientListener=function(e){l.gamma=e.gamma,l.beta=e.beta,l.alpha=e.alpha,l.absolute=e.absolute,i.fire("deviceorientation",l)},!1)}()}_getClickCoordsWithinElement(e){const t=[0,0];if(e){let i=e.target,r=0,o=0;for(;i.offsetParent;)r+=i.offsetLeft,o+=i.offsetTop,i=i.offsetParent;t[0]=e.pageX-r,t[1]=e.pageY-o}else e=window.event,t.x=e.x,t.y=e.y;return t}setEnabled(e){this.enabled!==e&&this.fire("enabled",this.enabled=e)}destroy(){super.destroy(),document.removeEventListener("keydown",this._keyDownListener),document.removeEventListener("keyup",this._keyUpListener),this._element.removeEventListener("mouseenter",this._mouseEnterListener),this._element.removeEventListener("mouseleave",this._mouseLeaveListener),this._element.removeEventListener("mousedown",this._mouseDownListener),document.removeEventListener("mouseup",this._mouseDownListener),document.removeEventListener("click",this._clickListener),document.removeEventListener("dblclick",this._dblClickListener),this._element.removeEventListener("mousemove",this._mouseMoveListener),this._element.removeEventListener("wheel",this._mouseWheelListener),window.OrientationChangeEvent&&window.removeEventListener("orientationchange",this._orientationchangedListener),window.DeviceMotionEvent&&window.removeEventListener("devicemotion",this._deviceMotionListener),window.DeviceOrientationEvent&&window.removeEventListener("deviceorientation",this._deviceOrientListener)}}class Ct extends B{get type(){return"Viewport"}constructor(e,t={}){super(e,t),this._state=new j({boundary:[0,0,100,100]}),this.boundary=t.boundary,this.autoBoundary=t.autoBoundary}set boundary(e){if(!this._autoBoundary){if(!e){const t=this.scene.canvas.boundary;e=[0,0,t[2],t[3]]}this._state.boundary=e,this.glRedraw(),this.fire("boundary",this._state.boundary)}}get boundary(){return this._state.boundary}set autoBoundary(e){(e=!!e)!==this._autoBoundary&&(this._autoBoundary=e,this._autoBoundary?this._onCanvasSize=this.scene.canvas.on("boundary",(function(e){const t=e[2],i=e[3];this._state.boundary=[0,0,t,i],this.glRedraw(),this.fire("boundary",this._state.boundary)}),this):this._onCanvasSize&&(this.scene.canvas.off(this._onCanvasSize),this._onCanvasSize=null),this.fire("autoBoundary",this._autoBoundary))}get autoBoundary(){return this._autoBoundary}_getState(){return this._state}destroy(){super.destroy(),this._state.destroy()}}class Tt extends B{get type(){return"Perspective"}constructor(e,t={}){super(e,t),this._state=new j({matrix:u.mat4(),near:.1,far:1e4}),this._dirty=!1,this._fov=60,this._canvasResized=this.scene.canvas.on("boundary",this._needUpdate,this),this.fov=t.fov,this.fovAxis=t.fovAxis,this.near=t.near,this.far=t.far}_update(){const e=this.scene.viewport.boundary,t=e[2]/e[3];let i=this._fov;const r=this._fovAxis;("x"===r||"min"===r&&t<1||"max"===r&&t>1)&&(i/=t),i=Math.min(i,120),u.perspectiveMat4(i*(Math.PI/180),t,this._state.near,this._state.far,this._state.matrix),this.glRedraw(),this.fire("matrix",this._state.matrix)}set fov(e){this._fov=null!=e?e:60,this._needUpdate(0),this.fire("fov",this._fov)}get fov(){return this._fov}set fovAxis(e){e=e||"min",this._fovAxis!==e&&("x"!==e&&"y"!==e&&"min"!==e&&(this.error("Unsupported value for 'fovAxis': "+e+" - defaulting to 'min'"),e="min"),this._fovAxis=e,this._needUpdate(0),this.fire("fovAxis",this._fovAxis))}get fovAxis(){return this._fovAxis}set near(e){this._state.near=null!=e?e:.1,this._needUpdate(0),this.fire("near",this._state.near)}get near(){return this._state.near}set far(e){this._state.far=null!=e?e:1e4,this._needUpdate(0),this.fire("far",this._state.far)}get far(){return this._state.far}get matrix(){return this._updateScheduled&&this._doUpdate(),this._state.matrix}destroy(){super.destroy(),this._state.destroy(),super.destroy(),this.scene.canvas.off(this._canvasResized)}}class Dt extends B{get type(){return"Ortho"}constructor(e,t={}){super(e,t),this._state=new j({matrix:u.mat4(),near:.1,far:1e4}),this.scale=t.scale,this.near=t.near,this.far=t.far,this._onCanvasBoundary=this.scene.canvas.on("boundary",this._needUpdate,this)}_update(){const e=this.scene,t=.5*this._scale,i=e.viewport.boundary,r=i[2],o=i[3],s=r/o;let n,a,l,c;r>o?(n=-t,a=t,l=t/s,c=-t/s):(n=-t*s,a=t*s,l=t,c=-t),u.orthoMat4c(n,a,c,l,this._state.near,this._state.far,this._state.matrix),this.glRedraw(),this.fire("matrix",this._state.matrix)}set scale(e){null==e&&(e=1),e<=0&&(e=.01),this._scale=e,this._needUpdate(0),this.fire("scale",this._scale)}get scale(){return this._scale}set near(e){this._state.near=null!=e?e:.1,this._needUpdate(0),this.fire("near",this._state.near)}get near(){return this._state.near}set far(e){this._state.far=null!=e?e:1e4,this._needUpdate(0),this.fire("far",this._state.far)}get far(){return this._state.far}get matrix(){return this._updateScheduled&&this._doUpdate(),this._state.matrix}destroy(){super.destroy(),this._state.destroy(),this.scene.canvas.off(this._onCanvasBoundary)}}class St extends B{get type(){return"Frustum"}constructor(e,t={}){super(e,t),this._state=new j({matrix:u.mat4(),near:.1,far:1e4}),this._left=-1,this._right=1,this._bottom=-1,this._top=1,this.left=t.left,this.right=t.right,this.bottom=t.bottom,this.top=t.top,this.near=t.near,this.far=t.far}_update(){u.frustumMat4(this._left,this._right,this._bottom,this._top,this._state.near,this._state.far,this._state.matrix),this.glRedraw(),this.fire("matrix",this._state.matrix)}set left(e){this._left=null!=e?e:-1,this._needUpdate(0),this.fire("left",this._left)}get left(){return this._left}set right(e){this._right=null!=e?e:1,this._needUpdate(0),this.fire("right",this._right)}get right(){return this._right}set top(e){this._top=null!=e?e:1,this._needUpdate(0),this.fire("top",this._top)}get top(){return this._top}set bottom(e){this._bottom=null!=e?e:-1,this._needUpdate(0),this.fire("bottom",this._bottom)}get bottom(){return this._bottom}set near(e){this._state.near=null!=e?e:.1,this._needUpdate(0),this.fire("near",this._state.near)}get near(){return this._state.near}set far(e){this._state.far=null!=e?e:1e4,this._needUpdate(0),this.fire("far",this._state.far)}get far(){return this._state.far}get matrix(){return this._updateScheduled&&this._doUpdate(),this._state.matrix}destroy(){super.destroy(),this._state.destroy(),super.destroy()}}class Lt extends B{get type(){return"CustomProjection"}constructor(e,t={}){super(e,t),this._state=new j({matrix:u.mat4()}),this.matrix=t.matrix}set matrix(e){this._state.matrix.set(e||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this.glRedraw(),this.fire("far",this._state.matrix)}get matrix(){return this._state.matrix}destroy(){super.destroy(),this._state.destroy()}}const Rt=u.vec3(),It=u.vec3(),Nt=u.vec3(),Ft=u.vec3(),Bt=u.vec3(),Ot=u.vec3(),jt=u.mat4(),zt=u.mat4(),Vt=u.vec3(),Ut=u.vec3(),Ht=u.vec3(),Gt=u.vec3();class Wt extends B{get type(){return"Camera"}constructor(e,t={}){super(e,t),this._state=new j({deviceMatrix:u.mat4(),hasDeviceMatrix:!1,matrix:u.mat4(),normalMatrix:u.mat4()}),this._perspective=new Tt(this),this._ortho=new Dt(this),this._frustum=new St(this),this._customProjection=new Lt(this),this._project=this._perspective,this._eye=u.vec3([0,0,10]),this._look=u.vec3([0,0,0]),this._up=u.vec3([0,1,0]),this._worldUp=u.vec3([0,1,0]),this._worldRight=u.vec3([1,0,0]),this._worldForward=u.vec3([0,0,-1]),this.deviceMatrix=t.deviceMatrix,this.eye=t.eye,this.look=t.look,this.up=t.up,this.worldAxis=t.worldAxis,this.gimbalLock=t.gimbalLock,this.constrainPitch=t.constrainPitch,this.projection=t.projection,this._perspective.on("matrix",()=>{"perspective"===this._projectionType&&this.fire("projMatrix",this._perspective.matrix)}),this._ortho.on("matrix",()=>{"ortho"===this._projectionType&&this.fire("projMatrix",this._ortho.matrix)}),this._frustum.on("matrix",()=>{"frustum"===this._projectionType&&this.fire("projMatrix",this._frustum.matrix)}),this._customProjection.on("matrix",()=>{"customProjection"===this._projectionType&&this.fire("projMatrix",this._customProjection.matrix)})}_update(){const e=this._state;let t;"ortho"===this.projection?(u.subVec3(this._eye,this._look,Vt),u.normalizeVec3(Vt,Ut),u.mulVec3Scalar(Ut,1e3,Ht),u.addVec3(this._look,Ht,Gt),t=Gt):t=this._eye,e.hasDeviceMatrix?(u.lookAtMat4v(t,this._look,this._up,zt),u.mulMat4(e.deviceMatrix,zt,e.matrix)):u.lookAtMat4v(t,this._look,this._up,e.matrix),u.inverseMat4(this._state.matrix,this._state.normalMatrix),u.transposeMat4(this._state.normalMatrix),this.glRedraw(),this.fire("matrix",this._state.matrix),this.fire("viewMatrix",this._state.matrix)}orbitYaw(e){let t=u.subVec3(this._eye,this._look,Rt);u.rotationMat4v(.0174532925*e,this._gimbalLock?this._worldUp:this._up,jt),t=u.transformPoint3(jt,t,It),this.eye=u.addVec3(this._look,t,Nt),this.up=u.transformPoint3(jt,this._up,Ft)}orbitPitch(e){if(this._constrainPitch&&(e=u.dotVec3(this._up,this._worldUp)/u.DEGTORAD)<1)return;let t=u.subVec3(this._eye,this._look,Rt);const i=u.cross3Vec3(u.normalizeVec3(t,It),u.normalizeVec3(this._up,Nt));u.rotationMat4v(.0174532925*e,i,jt),t=u.transformPoint3(jt,t,Ft),this.up=u.transformPoint3(jt,this._up,Bt),this.eye=u.addVec3(t,this._look,Ot)}yaw(e){let t=u.subVec3(this._look,this._eye,Rt);u.rotationMat4v(.0174532925*e,this._gimbalLock?this._worldUp:this._up,jt),t=u.transformPoint3(jt,t,It),this.look=u.addVec3(t,this._eye,Nt),this._gimbalLock&&(this.up=u.transformPoint3(jt,this._up,Ft))}pitch(e){if(this._constrainPitch&&(e=u.dotVec3(this._up,this._worldUp)/u.DEGTORAD)<1)return;let t=u.subVec3(this._look,this._eye,Rt);const i=u.cross3Vec3(u.normalizeVec3(t,It),u.normalizeVec3(this._up,Nt));u.rotationMat4v(.0174532925*e,i,jt),this.up=u.transformPoint3(jt,this._up,Ot),t=u.transformPoint3(jt,t,Ft),this.look=u.addVec3(t,this._eye,Bt)}pan(e){const t=u.subVec3(this._eye,this._look,Rt),i=[0,0,0];let r;if(0!==e[0]){const o=u.cross3Vec3(u.normalizeVec3(t,[]),u.normalizeVec3(this._up,It));r=u.mulVec3Scalar(o,e[0]),i[0]+=r[0],i[1]+=r[1],i[2]+=r[2]}0!==e[1]&&(r=u.mulVec3Scalar(u.normalizeVec3(this._up,Nt),e[1]),i[0]+=r[0],i[1]+=r[1],i[2]+=r[2]),0!==e[2]&&(r=u.mulVec3Scalar(u.normalizeVec3(t,Ft),e[2]),i[0]+=r[0],i[1]+=r[1],i[2]+=r[2]),this.eye=u.addVec3(this._eye,i,Bt),this.look=u.addVec3(this._look,i,Ot)}zoom(e){const t=u.subVec3(this._eye,this._look,Rt),i=Math.abs(u.lenVec3(t,It)),r=Math.abs(i+e);if(r<.5)return;const o=u.normalizeVec3(t,Nt);this.eye=u.addVec3(this._look,u.mulVec3Scalar(o,r),Ft)}set eye(e){this._eye.set(e||[0,0,10]),this._needUpdate(0),this.fire("eye",this._eye)}get eye(){return this._eye}set look(e){this._look.set(e||[0,0,0]),this._needUpdate(0),this.fire("look",this._look)}get look(){return this._look}set up(e){this._up.set(e||[0,1,0]),this._needUpdate(0),this.fire("up",this._up)}get up(){return this._up}set deviceMatrix(e){this._state.deviceMatrix.set(e||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this._state.hasDeviceMatrix=!!e,this._needUpdate(0),this.fire("deviceMatrix",this._state.deviceMatrix)}get deviceMatrix(){return this._state.deviceMatrix}set worldAxis(e){e=e||[1,0,0,0,1,0,0,0,1],this._worldAxis?this._worldAxis.set(e):this._worldAxis=new Float32Array(e),this._worldRight[0]=this._worldAxis[0],this._worldRight[1]=this._worldAxis[1],this._worldRight[2]=this._worldAxis[2],this._worldUp[0]=this._worldAxis[3],this._worldUp[1]=this._worldAxis[4],this._worldUp[2]=this._worldAxis[5],this._worldForward[0]=this._worldAxis[6],this._worldForward[1]=this._worldAxis[7],this._worldForward[2]=this._worldAxis[8],this.fire("worldAxis",this._worldAxis)}get worldAxis(){return this._worldAxis}get worldUp(){return this._worldUp}get xUp(){return this._worldUp[0]>this._worldUp[1]&&this._worldUp[0]>this._worldUp[2]}get yUp(){return this._worldUp[1]>this._worldUp[0]&&this._worldUp[1]>this._worldUp[2]}get zUp(){return this._worldUp[2]>this._worldUp[0]&&this._worldUp[2]>this._worldUp[1]}get worldRight(){return this._worldRight}get worldForward(){return this._worldForward}set gimbalLock(e){this._gimbalLock=!1!==e,this.fire("gimbalLock",this._gimbalLock)}get gimbalLock(){return this._gimbalLock}set constrainPitch(e){this._constrainPitch=!!e,this.fire("constrainPitch",this._constrainPitch)}get eyeLookDist(){return u.lenVec3(u.subVec3(this._look,this._eye,Rt))}get matrix(){return this._updateScheduled&&this._doUpdate(),this._state.matrix}get viewMatrix(){return this._updateScheduled&&this._doUpdate(),this._state.matrix}get normalMatrix(){return this._updateScheduled&&this._doUpdate(),this._state.normalMatrix}get viewNormalMatrix(){return this._updateScheduled&&this._doUpdate(),this._state.normalMatrix}get projMatrix(){return this[this.projection].matrix}get perspective(){return this._perspective}get ortho(){return this._ortho}get frustum(){return this._frustum}get customProjection(){return this._customProjection}set projection(e){e=e||"perspective",this._projectionType!==e&&("perspective"===e?this._project=this._perspective:"ortho"===e?this._project=this._ortho:"frustum"===e?this._project=this._frustum:"customProjection"===e?this._project=this._customProjection:(this.error("Unsupported value for 'projection': "+e+" defaulting to 'perspective'"),this._project=this._perspective,e="perspective"),this._project._update(),this._projectionType=e,this.glRedraw(),this._update(),this.fire("dirty"),this.fire("projection",this._projectionType))}get projection(){return this._projectionType}get project(){return this._project}destroy(){super.destroy(),this._state.destroy()}}class qt extends B{get type(){return"Light"}get isLight(){return!0}constructor(e,t={}){super(e,t)}}class Xt extends qt{get type(){return"DirLight"}constructor(e,t={}){super(e,t);const i=this;this._shadowRenderBuf=null,this._shadowViewMatrix=null,this._shadowProjMatrix=null,this._shadowViewMatrixDirty=!0,this._shadowProjMatrixDirty=!0,this._state=new j({type:"dir",dir:u.vec3([1,1,1]),color:u.vec3([.7,.7,.8]),intensity:1,space:t.space||"view",castsShadow:!1,shadowDirty:!0,getShadowViewMatrix:function(){u.vec3();const e=u.vec3([0,1,0]);return function(){if(i._shadowViewMatrixDirty){i._shadowViewMatrix||(i._shadowViewMatrix=u.identityMat4());const t=i._state.dir;u.lookAtMat4v([-t[0],-t[1],-t[2]],[0,0,0],e,i._shadowViewMatrix),i._shadowViewMatrixDirty=!1}return i._shadowViewMatrix}}(),getShadowProjMatrix:function(){return i._shadowProjMatrixDirty&&(i._shadowProjMatrix||(i._shadowProjMatrix=u.identityMat4()),u.orthoMat4c(-10,10,-10,10,0,500,i._shadowProjMatrix),i._shadowProjMatrixDirty=!1),i._shadowProjMatrix},getShadowRenderBuf:function(){return i._shadowRenderBuf||(i._shadowRenderBuf=new xt(i.scene.canvas.canvas,i.scene.canvas.gl,{size:[1024,1024]})),i._shadowRenderBuf}}),this.dir=t.dir,this.color=t.color,this.intensity=t.intensity,this.castsShadow=t.castsShadow,this.scene._lightCreated(this)}set dir(e){this._state.dir.set(e||[1,1,1]),this._shadowViewMatrixDirty=!0,this.glRedraw()}get dir(){return this._state.dir}set color(e){this._state.color.set(e||[.7,.7,.8]),this.glRedraw()}get color(){return this._state.color}set intensity(e){e=void 0!==e?e:1,this._state.intensity=e,this.glRedraw()}get intensity(){return this._state.intensity}set castsShadow(e){e=!!e,this._state.castsShadow!==e&&(this._state.castsShadow=e,this._shadowViewMatrixDirty=!0,this.glRedraw())}get castsShadow(){return this._state.castsShadow}destroy(){super.destroy(),this._state.destroy(),this._shadowRenderBuf&&this._shadowRenderBuf.destroy(),this.scene._lightDestroyed(this),this.glRedraw()}}class Yt extends qt{get type(){return"AmbientLight"}constructor(e,t={}){super(e,t),this._state={type:"ambient",color:u.vec3([.7,.7,.7]),intensity:1},this.color=t.color,this.intensity=t.intensity,this.scene._lightCreated(this)}set color(e){this._state.color.set(e||[.7,.7,.8]),this.glRedraw()}get color(){return this._state.color}set intensity(e){this._state.intensity=void 0!==e?e:1,this.glRedraw()}get intensity(){return this._state.intensity}destroy(){super.destroy()}}const Kt={default:{edgeColor:[0,0,0],edgeAlpha:1,edgeWidth:1},defaultWhiteBG:{edgeColor:[.2,.2,.2],edgeAlpha:1,edgeWidth:1},defaultLightBG:{edgeColor:[.2,.2,.2],edgeAlpha:1,edgeWidth:1},defaultDarkBG:{edgeColor:[.5,.5,.5],edgeAlpha:1,edgeWidth:1}};class $t extends se{get type(){return"EdgeMaterial"}get presets(){return Kt}constructor(e,t={}){super(e,t),this._state=new j({type:"EdgeMaterial",edgeColor:null,edgeAlpha:null,edgeWidth:null}),this._preset="default",t.preset?(this.preset=t.preset,t.edgeColor&&(this.edgeColor=t.edgeColor),void 0!==t.edgeAlpha&&(this.edgeAlpha=t.edgeAlpha),void 0!==t.edgeWidth&&(this.edgeWidth=t.edgeWidth)):(this.edgeColor=t.edgeColor,this.edgeAlpha=t.edgeAlpha,this.edgeWidth=t.edgeWidth)}set edgeColor(e){let t=this._state.edgeColor;if(t){if(e&&t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2])return}else t=this._state.edgeColor=new Float32Array(3);e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):(t[0]=.2,t[1]=.2,t[2]=.2),this.glRedraw()}get edgeColor(){return this._state.edgeColor}set edgeAlpha(e){e=null!=e?e:1,this._state.edgeAlpha!==e&&(this._state.edgeAlpha=e,this.glRedraw())}get edgeAlpha(){return this._state.edgeAlpha}set edgeWidth(e){this._state.edgeWidth=e||1,this.glRedraw()}get edgeWidth(){return this._state.edgeWidth}set preset(e){if(e=e||"default",this._preset===e)return;const t=Kt[e];t?(this.edgeColor=t.edgeColor,this.edgeAlpha=t.edgeAlpha,this.edgeWidth=t.edgeWidth,this._preset=e):this.error("unsupported preset: '"+e+"' - supported values are "+Object.keys(Kt).join(", "))}get preset(){return this._preset}destroy(){super.destroy(),this._state.destroy()}}const Qt={meters:{abbrev:"m"},metres:{abbrev:"m"},centimeters:{abbrev:"cm"},centimetres:{abbrev:"cm"},millimeters:{abbrev:"mm"},millimetres:{abbrev:"mm"},yards:{abbrev:"yd"},feet:{abbrev:"ft"},inches:{abbrev:"in"}};class Zt extends B{constructor(e,t={}){super(e,t),this._units="meters",this._scale=1,this._origin=u.vec3([0,0,0]),this.units=t.units,this.scale=t.scale,this.origin=t.origin}get unitsInfo(){return Qt}set units(e){e||(e="meters"),Qt[e]||(this.error("Unsupported value for 'units': "+e+" defaulting to 'meters'"),e="meters"),this._units=e,this.fire("units",this._units)}get units(){return this._units}set scale(e){(e=e||1)<=0?this.error("scale value should be larger than zero"):(this._scale=e,this.fire("scale",this._scale))}get scale(){return this._scale}set origin(e){if(!e)return this._origin[0]=0,this._origin[1]=0,void(this._origin[2]=0);this._origin[0]=e[0],this._origin[1]=e[1],this._origin[2]=e[2],this.fire("origin",this._origin)}get origin(){return this._origin}worldToRealPos(e,t=new Float32Array(3)){t[0]=this._origin[0]+this._scale*e[0],t[1]=this._origin[1]+this._scale*e[1],t[2]=this._origin[2]+this._scale*e[2]}realToWorldPos(e,t=new Float32Array(3)){return t[0]=(e[0]-this._origin[0])/this._scale,t[1]=(e[1]-this._origin[1])/this._scale,t[2]=(e[2]-this._origin[2])/this._scale,t}}function Jt(e,t){const i={};let r,o;for(let s=0,n=t.length;s<n;s++)r=t[s],(o=e.component[r])?o.isEntity?i[r]=!0:e.warn("pick(): Component is not an Entity: "+r):e.warn("pick(): Component not found: "+r);return i}class ei extends B{get type(){return"Scene"}constructor(e={}){super(null,e);const t=e.canvasElement||document.getElementById(e.canvasId);if(!(t instanceof HTMLCanvasElement))throw"Mandatory config expected: valid canvasId or canvasElement";const i=!!e.transparent;this._aabbDirty=!0,this.loading=0,this.startTime=(new Date).getTime(),this.models={},this.objects={},this.visibleObjects={},this.xrayedObjects={},this.highlightedObjects={},this.selectedObjects={},this._modelIds=null,this._objectIds=null,this._visibleObjectIds=null,this._xrayedObjectIds=null,this._highlightedObjectIds=null,this._selectedObjectIds=null,this._collidables={},this._compilables={},this._needRecompile=!1,this.types={},this.components={},this.sectionPlanes={},this.lights={},this.lightMaps={},this.reflectionMaps={},this.canvas=new bt(this,{dontClear:!0,canvas:t,spinnerElementId:e.spinnerElementId,transparent:i,backgroundColor:e.backgroundColor,webgl2:!1!==e.webgl2,contextAttr:e.contextAttr||{},clearColorAmbient:e.clearColorAmbient}),this.canvas.on("boundary",()=>{this.glRedraw()}),this.canvas.on("webglContextFailed",()=>{alert("xeokit failed to find WebGL!")}),this._renderer=new Et(this,{transparent:i}),this._sectionPlanesState=new function(){this.sectionPlanes=[];let e=null;this.getHash=function(){if(e)return e;const t=this.sectionPlanes;if(0===t.length)return this.hash=";";let i;const r=[];for(let e=0,o=t.length;e<o;e++)i=t[e],r.push("cp");return r.push(";"),e=r.join("")},this.addSectionPlane=function(t){this.sectionPlanes.push(t),e=null},this.removeSectionPlane=function(t){for(let i=0,r=this.sectionPlanes.length;i<r;i++)if(this.sectionPlanes[i].id===t.id)return this.sectionPlanes.splice(i,1),void(e=null)}},this._lightsState=new function(){const e=u.vec3([0,0,0]),t=u.vec3();this.lights=[],this.reflectionMaps=[],this.lightMaps=[];let i=null,r=null;this.getHash=function(){if(i)return i;const e=[],t=this.lights;let r;for(let i=0,o=t.length;i<o;i++)r=t[i],e.push("/"),e.push(r.type),e.push("world"===r.space?"w":"v"),r.castsShadow&&e.push("sh");return this.lightMaps.length>0&&e.push("/lm"),this.reflectionMaps.length>0&&e.push("/rm"),e.push(";"),i=e.join("")},this.addLight=function(e){this.lights.push(e),r=null,i=null},this.removeLight=function(e){for(let t=0,o=this.lights.length;t<o;t++){if(this.lights[t].id===e.id)return this.lights.splice(t,1),r&&r.id===e.id&&(r=null),void(i=null)}},this.addReflectionMap=function(e){this.reflectionMaps.push(e),i=null},this.removeReflectionMap=function(e){for(let t=0,r=this.reflectionMaps.length;t<r;t++)if(this.reflectionMaps[t].id===e.id)return this.reflectionMaps.splice(t,1),void(i=null)},this.addLightMap=function(e){this.lightMaps.push(e),i=null},this.removeLightMap=function(e){for(let t=0,r=this.lightMaps.length;t<r;t++)if(this.lightMaps[t].id===e.id)return this.lightMaps.splice(t,1),void(i=null)},this.getAmbientColor=function(){if(!r)for(let e=0,t=this.lights.length;e<t;e++){const t=this.lights[e];if("ambient"===t.type){r=t;break}}if(r){const e=r.color,i=r.intensity;return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}return e}},this.input=new At(this,{dontClear:!0,element:this.canvas.canvas}),this.metrics=new Zt(this,{units:e.units,scale:e.scale,origin:e.origin}),this.ticksPerRender=e.ticksPerRender,this.ticksPerOcclusionTest=e.ticksPerOcclusionTest,this.passes=e.passes,this.clearEachPass=e.clearEachPass,this.gammaInput=e.gammaInput,this.gammaOutput=e.gammaOutput,this.gammaFactor=e.gammaFactor,N._addScene(this),this._initDefaults(),this._viewport=new Ct(this,{id:"default.viewport",autoBoundary:!0,dontClear:!0}),this._camera=new Wt(this,{id:"default.camera",dontClear:!0}),new Yt(this,{color:[.3,.3,.3],intensity:1}),new Xt(this,{dir:[.8,-.6,-.8],color:[1,1,1],intensity:1,space:"view"}),new Xt(this,{dir:[-.8,-.4,-.4],color:[1,1,1],intensity:1,space:"view"}),new Xt(this,{dir:[.2,-.8,.8],color:[.6,.6,.6],intensity:1,space:"view"}),this._camera.on("dirty",()=>{this._renderer.imageDirty()})}_initDefaults(){let e;e=this.geometry,e=this.material,e=this.xrayMaterial,e=this.edgeMaterial,e=this.selectedMaterial,e=this.highlightMaterial}_addComponent(e){if(e.id&&this.components[e.id]&&(this.error("Component "+s.inQuotes(e.id)+" already exists in Scene - ignoring ID, will randomly-generate instead"),e.id=null),!e.id)for(void 0===window.nextID&&(window.nextID=0),e.id="_"+window.nextID++;this.components[e.id];)e.id=u.createUUID();this.components[e.id]=e;const t=e.type;let i=this.types[e.type];i||(i=this.types[t]={}),i[e.id]=e,e.compile&&(this._compilables[e.id]=e),e.isDrawable&&(this._renderer.addDrawable(e.id,e),this._collidables[e.id]=e)}_removeComponent(e){var t=e.id,i=e.type;delete this.components[t];const r=this.types[i];r&&(delete r[t],s.isEmptyObject(r)&&delete this.types[i]),e.compile&&delete this._compilables[e.id],e.isDrawable&&(this._renderer.removeDrawable(e.id),delete this._collidables[e.id])}_sectionPlaneCreated(e){this.sectionPlanes[e.id]=e,this.scene._sectionPlanesState.addSectionPlane(e._state),this.scene.fire("sectionPlaneCreated",e,!0),this._needRecompile=!0}_lightCreated(e){this.lights[e.id]=e,this.scene._lightsState.addLight(e._state),this._needRecompile=!0}_lightMapCreated(e){this.lightMaps[e.id]=e,this.scene._lightsState.addLightMap(e._state),this._needRecompile=!0}_reflectionMapCreated(e){this.reflectionMaps[e.id]=e,this.scene._lightsState.addReflectionMap(e._state),this._needRecompile=!0}_sectionPlaneDestroyed(e){delete this.sectionPlanes[e.id],this.scene._sectionPlanesState.removeSectionPlane(e._state),this._needRecompile=!0}_lightDestroyed(e){delete this.lights[e.id],this.scene._lightsState.removeLight(e._state),this._needRecompile=!0}_lightMapDestroyed(e){delete this.lightMaps[e.id],this.scene._lightsState.removeLightMap(e._state),this._needRecompile=!0}_reflectionMapDestroyed(e){delete this.reflectionMaps[e.id],this.scene._lightsState.removeReflectionMap(e._state),this._needRecompile=!0}_registerModel(e){this.models[e.id]=e,this._modelIds=null}_deregisterModel(e){delete this.models[e.id],this._modelIds=null}_registerObject(e){this.objects[e.id]=e,this._objectIds=null}_deregisterObject(e){delete this.objects[e.id],this._objectIds=null}_objectVisibilityUpdated(e,t=!0){e.visible?this.visibleObjects[e.id]=e:delete this.visibleObjects[e.id],this._visibleObjectIds=null,t&&this.fire("objectVisibility",e,!0)}_objectXRayedUpdated(e){e.xrayed?this.xrayedObjects[e.id]=e:delete this.xrayedObjects[e.id],this._xrayedObjectIds=null}_objectHighlightedUpdated(e){e.highlighted?this.highlightedObjects[e.id]=e:delete this.highlightedObjects[e.id],this._highlightedObjectIds=null}_objectSelectedUpdated(e){e.selected?this.selectedObjects[e.id]=e:delete this.selectedObjects[e.id],this._selectedObjectIds=null}_webglContextLost(){this.canvas.spinner.processes++;for(const e in this.components)if(this.components.hasOwnProperty(e)){const t=this.components[e];t._webglContextLost&&t._webglContextLost()}this._renderer.webglContextLost()}_webglContextRestored(){const e=this.canvas.gl;for(const t in this.components)if(this.components.hasOwnProperty(t)){const i=this.components[t];i._webglContextRestored&&i._webglContextRestored(e)}this._renderer.webglContextRestored(e),this.canvas.spinner.processes--}doOcclusionTest(){this._needRecompile&&(this._recompile(),this._needRecompile=!1),this._renderer.doOcclusionTest()}render(e){e&&N.runTasks();const t={sceneId:null,pass:0};this._needRecompile&&(this._recompile(),this._renderer.imageDirty(),this._needRecompile=!1),t.sceneId=this.id;const i=this._passes,r=this._clearEachPass;let o,s;for(o=0;o<i;o++)t.pass=o,this.fire("rendering",t,!0),s=r||0===o,this._renderer.render({pass:o,clear:s,force:e}),this.fire("rendered",t,!0);this._saveAmbientColor()}_recompile(){for(const e in this._compilables)this._compilables.hasOwnProperty(e)&&this._compilables[e].compile()}_saveAmbientColor(){const e=this.canvas;if(e.transparent||e.backgroundImage||e.backgroundColor)this._lastAmbientColor=null;else{const t=this._lightsState.getAmbientColor();this._lastAmbientColor&&this._lastAmbientColor[0]===t[0]&&this._lastAmbientColor[1]===t[1]&&this._lastAmbientColor[2]===t[2]&&this._lastAmbientColor[3]===t[3]||(e.backgroundColor=t,this._lastAmbientColor||(this._lastAmbientColor=u.vec4([0,0,0,1])),this._lastAmbientColor.set(t))}}get modelIds(){return this._modelIds||(this._modelIds=Object.keys(this.models)),this._modelIds}get objectIds(){return this._objectIds||(this._objectIds=Object.keys(this.objects)),this._objectIds}get visibleObjectIds(){return this._visibleObjectIds||(this._visibleObjectIds=Object.keys(this.visibleObjects)),this._visibleObjectIds}get xrayedObjectIds(){return this._xrayedObjectIds||(this._xrayedObjectIds=Object.keys(this.xrayedObjects)),this._xrayedObjectIds}get highlightedObjectIds(){return this._highlightedObjectIds||(this._highlightedObjectIds=Object.keys(this.highlightedObjects)),this._highlightedObjectIds}get selectedObjectIds(){return this._selectedObjectIds||(this._selectedObjectIds=Object.keys(this.selectedObjects)),this._selectedObjectIds}set ticksPerRender(e){null==e?e=1:(!s.isNumeric(e)||e<=0)&&(this.error("Unsupported value for 'ticksPerRender': '"+e+"' - should be an integer greater than zero."),e=1),e!==this._ticksPerRender&&(this._ticksPerRender=e)}get ticksPerRender(){return this._ticksPerRender}set ticksPerOcclusionTest(e){null==e?e=20:(!s.isNumeric(e)||e<=0)&&(this.error("Unsupported value for 'ticksPerOcclusionTest': '"+e+"' - should be an integer greater than zero."),e=20),e!==this._ticksPerOcclusionTest&&(this._ticksPerOcclusionTest=e)}get ticksPerOcclusionTest(){return this._ticksPerOcclusionTest}set passes(e){null==e?e=1:(!s.isNumeric(e)||e<=0)&&(this.error("Unsupported value for 'passes': '"+e+"' - should be an integer greater than zero."),e=1),e!==this._passes&&(this._passes=e,this.glRedraw())}get passes(){return this._passes}set clearEachPass(e){(e=!!e)!==this._clearEachPass&&(this._clearEachPass=e,this.glRedraw())}get clearEachPass(){return this._clearEachPass}set gammaInput(e){(e=!1!==e)!==this._renderer.gammaInput&&(this._renderer.gammaInput=e,this._needRecompile=!0)}get gammaInput(){return this._renderer.gammaInput}set gammaOutput(e){(e=!1!==e)!==this._renderer.gammaOutput&&(this._renderer.gammaOutput=e,this._needRecompile=!0)}get gammaOutput(){return this._renderer.gammaOutput}set gammaFactor(e){(e=null==e?2.2:e)!==this._renderer.gammaFactor&&(this._renderer.gammaFactor=e,this.glRedraw())}get gammaFactor(){return this._renderer.gammaFactor}get geometry(){return this.components["default.geometry"]||H(oe)}get material(){return this.components["default.material"]||new le(this,{id:"default.material",emissive:[.4,.4,.4],dontClear:!0})}get xrayMaterial(){return this.components["default.xrayMaterial"]||new he(this,{id:"default.xrayMaterial",preset:"sepia",dontClear:!0})}get highlightMaterial(){return this.components["default.highlightMaterial"]||new he(this,{id:"default.highlightMaterial",preset:"yellowHighlight",dontClear:!0})}get selectedMaterial(){return this.components["default.selectedMaterial"]||new he(this,{id:"default.selectedMaterial",preset:"greenSelected",dontClear:!0})}get edgeMaterial(){return this.components["default.edgeMaterial"]||new $t(this,{id:"default.edgeMaterial",preset:"default",edgeColor:[0,0,0],edgeAlpha:1,edgeWidth:1,dontClear:!0})}get viewport(){return this._viewport}get camera(){return this._camera}get center(){if(this._aabbDirty||!this._center){this._center&&this._center||(this._center=u.vec3());const e=this.aabb;this._center[0]=(e[0]+e[3])/2,this._center[1]=(e[1]+e[4])/2,this._center[2]=(e[2]+e[5])/2}return this._center}get aabb(){if(this._aabbDirty){this._aabb||(this._aabb=u.AABB3());let e,t=u.MAX_DOUBLE,i=u.MAX_DOUBLE,r=u.MAX_DOUBLE,o=-u.MAX_DOUBLE,s=-u.MAX_DOUBLE,n=-u.MAX_DOUBLE;const a=this._collidables;let l,c=!1;for(const h in a)if(a.hasOwnProperty(h)){if(!1===(l=a[h]).collidable)continue;(e=l.aabb)[0]<t&&(t=e[0]),e[1]<i&&(i=e[1]),e[2]<r&&(r=e[2]),e[3]>o&&(o=e[3]),e[4]>s&&(s=e[4]),e[5]>n&&(n=e[5]),c=!0}c||(t=-100,i=-100,r=-100,o=100,s=100,n=100),this._aabb[0]=t,this._aabb[1]=i,this._aabb[2]=r,this._aabb[3]=o,this._aabb[4]=s,this._aabb[5]=n,this._aabbDirty=!1}return this._aabb}_setAABBDirty(){this._aabbDirty=!0,this.fire("boundary")}pick(e,t){if(0===this.canvas.boundary[2]||0===this.canvas.boundary[3])return this.error("Picking not allowed while canvas has zero width or height"),null;(e=e||{}).pickSurface=e.pickSurface||e.rayPick,e.canvasPos||e.origin&&e.direction||this.warn("picking without canvasPos or ray origin and direction");const i=e.includeEntities||e.include;i&&(e.includeEntityIds=Jt(this,i));const r=e.excludeEntities||e.exclude;return r&&(e.excludeEntityIds=Jt(this,r)),this._needRecompile&&(this._recompile(),this._renderer.imageDirty(),this._needRecompile=!1),(t=this._renderer.pick(e,t))?(t.entity.fire&&t.entity.fire("picked",t),t):void 0}clear(){var e;for(const t in this.components)this.components.hasOwnProperty(t)&&((e=this.components[t])._dontClear||e.destroy())}clearLights(){const e=Object.keys(this.lights);for(let t=0,i=e.length;t<i;t++)this.lights[e[t]].destroy()}clearSectionPlanes(){const e=Object.keys(this.sectionPlanes);for(let t=0,i=e.length;t<i;t++)this.sectionPlanes[e[t]].destroy()}getAABB(e){if(void 0===e)return this.aabb;if(s.isString(e)){const t=this.objects[e];if(t&&t.aabb)return t.aabb;e=[e]}if(0===e.length)return this.aabb;let t,i=1e5,r=1e5,o=1e5,n=-1e5,a=-1e5,l=-1e5;if(this._withEntities(e,this.objects,e=>{if(e.collidable){const s=e.aabb;s[0]<i&&(i=s[0]),s[1]<r&&(r=s[1]),s[2]<o&&(o=s[2]),s[3]>n&&(n=s[3]),s[4]>a&&(a=s[4]),s[5]>l&&(l=s[5]),t=!0}}),t){const e=u.AABB3();return e[0]=i,e[1]=r,e[2]=o,e[3]=n,e[4]=a,e[5]=l,e}return this.aabb}setObjectsVisible(e,t){return this._withEntities(e,this.objects,e=>{const i=e.visible!==t;return e.visible=t,i})}setObjectsCollidable(e,t){return this._withEntities(e,this.objects,e=>{const i=e.collidable!==t;return e.collidable=t,i})}setObjectsCulled(e,t){return this._withEntities(e,this.objects,e=>{const i=e.culled!==t;return e.culled=t,i})}setObjectsSelected(e,t){return this._withEntities(e,this.objects,e=>{const i=e.selected!==t;return e.selected=t,i})}setObjectsHighlighted(e,t){return this._withEntities(e,this.objects,e=>{const i=e.highlighted!==t;return e.highlighted=t,i})}setObjectsXRayed(e,t){return this._withEntities(e,this.objects,e=>{const i=e.xrayed!==t;return e.xrayed=t,i})}setObjectsEdges(e,t){return this._withEntities(e,this.objects,e=>{const i=e.edges!==t;return e.edges=t,i})}setObjectsColorized(e,t){return this._withEntities(e,this.objects,e=>{e.colorize=t})}setObjectsOpacity(e,t){return this._withEntities(e,this.objects,e=>{const i=e.opacity!==t;return e.opacity=t,i})}setObjectsPickable(e,t){return this._withEntities(e,this.objects,e=>{const i=e.pickable!==t;return e.pickable=t,i})}_withEntities(e,t,i){s.isString(e)&&(e=[e]);let r=!1;for(let o=0,s=e.length;o<s;o++){let s=t[e[o]];s&&(r=i(s)||r)}return r}destroy(){super.destroy();for(const e in this.components)this.components.hasOwnProperty(e)&&this.components[e].destroy();this.canvas.gl=null,this.components=null,this.models=null,this.objects=null,this.visibleObjects=null,this.xrayedObjects=null,this.highlightedObjects=null,this.selectedObjects=null,this.sectionPlanes=null,this.lights=null,this.lightMaps=null,this.reflectionMaps=null,this._objectIds=null,this._visibleObjectIds=null,this._xrayedObjectIds=null,this._highlightedObjectIds=null,this._selectedObjectIds=null,this.types=null,this.components=null,this.canvas=null,this._renderer=null,this.input=null,this._viewport=null,this._camera=null}}class ti{constructor(e,t,i){this.id=i.id,this._sectionPlane=i,this._mesh=new at(t,{id:i.id,geometry:new oe(t,H({xSize:.5,ySize:.5,zSize:.001})),material:new le(t,{emissive:[1,1,1],diffuse:[0,0,0],backfaces:!1}),edgeMaterial:new $t(t,{edgeColor:[0,0,0],edgeAlpha:1,edgeWidth:1}),highlightMaterial:new he(t,{fill:!0,fillColor:[.5,1,.5],fillAlpha:.7,edges:!0,edgeColor:[0,0,0],edgeAlpha:1,edgeWidth:1}),selectedMaterial:new he(t,{fill:!0,fillColor:[0,0,1],fillAlpha:.7,edges:!0,edgeColor:[1,0,0],edgeAlpha:1,edgeWidth:1}),highlighted:!0,scale:[3,3,3],position:[0,0,0],rotation:[0,0,0],opacity:.3,edges:!0});{const e=u.vec3([0,0,0]),t=u.vec3(),i=u.vec3([0,0,1]),r=u.vec4(4),o=u.vec3(),s=()=>{const s=this._sectionPlane.scene.center,n=[-this._sectionPlane.dir[0],-this._sectionPlane.dir[1],-this._sectionPlane.dir[2]];u.subVec3(s,this._sectionPlane.pos,e);const a=-u.dotVec3(n,e);u.normalizeVec3(n),u.mulVec3Scalar(n,a,t);const l=u.vec3PairToQuaternion(i,this._sectionPlane.dir,r);o[0]=.1*t[0],o[1]=.1*t[1],o[2]=.1*t[2],this._mesh.quaternion=l,this._mesh.position=o};this._onSectionPlanePos=this._sectionPlane.on("pos",s),this._onSectionPlaneDir=this._sectionPlane.on("dir",s)}this._highlighted=!1,this._selected=!1}setHighlighted(e){this._highlighted=!!e,this._mesh.highlighted=this._highlighted,this._mesh.highlightMaterial.fillColor=e?[0,.7,0]:[0,0,0]}getHighlighted(){return this._highlighted}setSelected(e){this._selected=!!e,this._mesh.edgeMaterial.edgeWidth=e?3:1,this._mesh.highlightMaterial.edgeWidth=e?3:1}getSelected(){return this._selected}destroy(){this._sectionPlane.off(this._onSectionPlanePos),this._sectionPlane.off(this._onSectionPlaneDir),this._mesh.destroy()}}class ii{constructor(e,t){if(!(t.onHoverEnterPlane&&t.onHoverLeavePlane&&t.onClickedNothing&&t.onClickedPlane))throw"Missing config(s): onHoverEnterPlane, onHoverLeavePlane, onClickedNothing || onClickedPlane";this.plugin=e,this._viewer=e.viewer,this._onHoverEnterPlane=t.onHoverEnterPlane,this._onHoverLeavePlane=t.onHoverLeavePlane,this._onClickedNothing=t.onClickedNothing,this._onClickedPlane=t.onClickedPlane,this._visible=!0,this._planes={},this._canvas=t.overviewCanvas,this._scene=new ei({canvasId:this._canvas.id,transparent:!0}),this._scene.clearLights(),new Xt(this._scene,{dir:[.4,-.4,.8],color:[.8,1,1],intensity:1,space:"view"}),new Xt(this._scene,{dir:[-.8,-.3,-.4],color:[.8,.8,.8],intensity:1,space:"view"}),new Xt(this._scene,{dir:[.8,-.6,-.8],color:[1,1,1],intensity:1,space:"view"}),this._scene.camera,this._scene.camera.perspective.fov=70,this._zUp=!1;{const e=this._scene.camera,t=u.rotationMat4c(-90*u.DEGTORAD,1,0,0),i=u.vec3(),r=u.vec3(),o=u.vec3();this._synchCamera=()=>{const s=this._viewer.camera.eye,n=this._viewer.camera.look,a=this._viewer.camera.up;u.mulVec3Scalar(u.normalizeVec3(u.subVec3(s,n,i)),7),this._zUp?(u.transformVec3(t,i,r),u.transformVec3(t,a,o),e.look=[0,0,0],e.eye=u.transformVec3(t,i,r),e.up=u.transformPoint3(t,a,o)):(e.look=[0,0,0],e.eye=i,e.up=a)}}this._onViewerCameraMatrix=this._viewer.camera.on("matrix",this._synchCamera),this._onViewerCameraWorldAxis=this._viewer.camera.on("worldAxis",this._synchCamera),this._onViewerCameraFOV=this._viewer.camera.perspective.on("fov",e=>{this._scene.camera.perspective.fov=e}),this._onViewerCameraProjection=this._viewer.camera.on("projection",e=>{this._scene.camera.projection=e});var i=null;this._onInputMouseMove=this._scene.input.on("mousemove",e=>{const t=this._scene.pick({canvasPos:e});if(t){if(!i||t.entity.id!==i.id){if(i){this._planes[i.id]&&this._onHoverLeavePlane(i.id)}i=t.entity,this._planes[i.id]&&this._onHoverEnterPlane(i.id)}}else i&&(this._onHoverLeavePlane(i.id),i=null)}),this._scene.canvas.canvas.addEventListener("mouseup",this._onCanvasMouseUp=()=>{if(i){this._planes[i.id]&&this._onClickedPlane(i.id)}else this._onClickedNothing()}),this._scene.canvas.canvas.addEventListener("mouseout",this._onCanvasMouseOut=()=>{i&&(this._onHoverLeavePlane(i.id),i=null)}),this.setVisible(t.overviewVisible)}addSectionPlane(e){this._planes[e.id]=new ti(this,this._scene,e)}setPlaneHighlighted(e,t){const i=this._planes[e];i&&i.setHighlighted(t)}setPlaneSelected(e,t){const i=this._planes[e];i&&i.setSelected(t)}removeSectionPlane(e){const t=this._planes[e.id];t&&(t.destroy(),delete this._planes[e.id])}setVisible(e=!0){this._visible=e,this._canvas.style.visibility=e?"visible":"hidden"}getVisible(){return this._visible}destroy(){this._viewer.camera.off(this._onViewerCameraMatrix),this._viewer.camera.off(this._onViewerCameraWorldAxis),this._viewer.camera.perspective.off(this._onViewerCameraFOV),this._viewer.camera.off(this._onViewerCameraProjection),this._scene.input.off(this._onInputMouseMove),this._scene.canvas.canvas.removeEventListener("mouseup",this._onCanvasMouseUp),this._scene.canvas.canvas.removeEventListener("mouseout",this._onCanvasMouseOut),this._scene.destroy()}}const ri=u.AABB3(),oi=u.vec3();class si extends k{constructor(e,t={}){if(super("SectionPlanes",e),this._freeControls=[],this._sectionPlanes=e.scene.sectionPlanes,this._controls={},this._shownControlId=null,t.overviewCanvasId){const e=document.getElementById(t.overviewCanvasId);if(!e)return void this.error("Can't find overview canvas: '"+t.overviewCanvasId+"' - will create plugin without overview");this._overview=new ii(this,{overviewCanvas:e,visible:t.overviewVisible,onHoverEnterPlane:e=>{this._overview.setPlaneHighlighted(e,!0)},onHoverLeavePlane:e=>{this._overview.setPlaneHighlighted(e,!1)},onClickedPlane:e=>{if(this.getShownControl()===e)return void this.hideControl();this.showControl(e);const t=this.sectionPlanes[e].pos;ri.set(this.viewer.scene.aabb),u.getAABB3Center(ri,oi),ri[0]+=t[0]-oi[0],ri[1]+=t[1]-oi[1],ri[2]+=t[2]-oi[2],ri[3]+=t[0]-oi[0],ri[4]+=t[1]-oi[1],ri[5]+=t[2]-oi[2],this.viewer.cameraFlight.flyTo({aabb:ri,fitFOV:65})},onClickedNothing:()=>{this.hideControl()}})}else this.error("Config missing: overviewCanvasId - will create plugin without overview");this._onSceneSectionPlaneCreated=e.scene.on("sectionPlaneCreated",e=>{this._sectionPlaneCreated(e)})}setOverviewVisible(e){this._overview&&this._overview.setVisible(e)}getOverviewVisible(){if(this._overview)return this._overview.getVisible()}get sectionPlanes(){return this._sectionPlanes}createSectionPlane(e={}){return void 0!==e.id&&null!==e.id&&this.viewer.scene.components[e.id]&&(this.error("Viewer component with this ID already exists: "+e.id),delete e.id),new z(this.viewer.scene,{id:e.id,pos:e.pos,dir:e.dir,active:!0})}_sectionPlaneCreated(e){const t=this._freeControls.length>0?this._freeControls.pop():new ut(this);t._setSectionPlane(e),t.setVisible(!1),this._controls[e.id]=t,this._overview&&this._overview.addSectionPlane(e),e.once("destroyed",()=>{this._sectionPlaneDestroyed(e)})}showControl(e){const t=this._controls[e];t?(this.hideControl(),t.setVisible(!0),this._overview&&this._overview.setPlaneSelected(e,!0),this._shownControlId=e):this.error("Control not found: "+e)}getShownControl(){return this._shownControlId}hideControl(){for(var e in this._controls)this._controls.hasOwnProperty(e)&&(this._controls[e].setVisible(!1),this._overview&&this._overview.setPlaneSelected(e,!1));this._shownControlId=null}destroySectionPlane(e){var t=this.viewer.scene.sectionPlanes[e];t?(this._sectionPlaneDestroyed(t),t.destroy(),e===this._shownControlId&&(this._shownControlId=null)):this.error("SectionPlane not found: "+e)}_sectionPlaneDestroyed(e){this._overview&&this._overview.removeSectionPlane(e);const t=this._controls[e.id];t&&(t.setVisible(!1),t._setSectionPlane(null),delete this._controls[e.id],this._freeControls.push(t))}clear(){const e=Object.keys(this._sectionPlanes);for(var t=0,i=e.length;t<i;t++)this.destroySectionPlane(e[t])}send(e,t){switch(e){case"snapshotStarting":for(let e in this._controls)this._controls.hasOwnProperty(e)&&this._controls[e].setCulled(!0);break;case"snapshotFinished":for(let e in this._controls)this._controls.hasOwnProperty(e)&&this._controls[e].setCulled(!1);break;case"clearSectionPlanes":this.clear()}}destroy(){this.clear(),this._overview&&this._overview.destroy(),this._destroyFreeControls(),super.destroy()}_destroyFreeControls(){for(var e=this._freeControls.pop();e;)e._destroy(),e=this._freeControls.pop();this.viewer.scene.off(this._onSceneSectionPlaneCreated)}}class ni extends a{constructor(e,t){if(super(e,t),!t.buttonElement)throw"Missing config: buttonElement";if(!t.sectionPlanesOverviewCanvasElement)throw"Missing config: sectionPlanesOverviewCanvasElement";const i=t.buttonElement,r=t.sectionPlanesOverviewCanvasElement;this._sectionPlanesPlugin=new si(this.viewer,{overviewCanvas:r.get(0)}),this.on("enabled",e=>{e?i.removeClass("disabled"):i.addClass("disabled")}),this.on("active",e=>{e?i.addClass("active"):i.removeClass("active")}),this.on("active",e=>{e?(this._sectionPlanesPlugin.setOverviewVisible(!0),this._onPickedSurface=this.viewer.cameraControl.on("pickedSurface",e=>{const t=this._sectionPlanesPlugin.createSectionPlane({pos:e.worldPos,dir:[-e.worldNormal[0],-e.worldNormal[1],-e.worldNormal[2]]});this._sectionPlanesPlugin.showControl(t.id)})):(this.viewer.cameraControl.off(this._onPickedSurface),this._sectionPlanesPlugin.hideControl(),this._sectionPlanesPlugin.setOverviewVisible(!1))}),i.on("click",e=>{if(!this.getEnabled())return;const t=this.getActive();this.setActive(!t),e.preventDefault()}),this.viewerUI.on("reset",()=>{this.clear(),this.setActive(!1)})}clear(){this._sectionPlanesPlugin.clear()}destroy(){this._sectionPlanesPlugin.destroy(),super.destroy()}}const ai={funcAdd:"FUNC_ADD",funcSubtract:"FUNC_SUBTRACT",funcReverseSubtract:"FUNC_REVERSE_SUBTRACT",zero:"ZERO",one:"ONE",srcColor:"SRC_COLOR",oneMinusSrcColor:"ONE_MINUS_SRC_COLOR",dstColor:"DST_COLOR",oneMinusDstColor:"ONE_MINUS_DST_COLOR",srcAlpha:"SRC_ALPHA",oneMinusSrcAlpha:"ONE_MINUS_SRC_ALPHA",dstAlpha:"DST_ALPHA",oneMinusDstAlpha:"ONE_MINUS_DST_ALPHA",contantColor:"CONSTANT_COLOR",oneMinusConstantColor:"ONE_MINUS_CONSTANT_COLOR",constantAlpha:"CONSTANT_ALPHA",oneMinusConstantAlpha:"ONE_MINUS_CONSTANT_ALPHA",srcAlphaSaturate:"SRC_ALPHA_SATURATE",front:"FRONT",back:"BACK",frontAndBack:"FRONT_AND_BACK",never:"NEVER",less:"LESS",equal:"EQUAL",lequal:"LEQUAL",greater:"GREATER",notequal:"NOTEQUAL",gequal:"GEQUAL",always:"ALWAYS",cw:"CW",ccw:"CCW",linear:"LINEAR",nearest:"NEAREST",linearMipmapNearest:"LINEAR_MIPMAP_NEAREST",nearestMipmapNearest:"NEAREST_MIPMAP_NEAREST",nearestMipmapLinear:"NEAREST_MIPMAP_LINEAR",linearMipmapLinear:"LINEAR_MIPMAP_LINEAR",repeat:"REPEAT",clampToEdge:"CLAMP_TO_EDGE",mirroredRepeat:"MIRRORED_REPEAT",alpha:"ALPHA",rgb:"RGB",rgba:"RGBA",luminance:"LUMINANCE",luminanceAlpha:"LUMINANCE_ALPHA",textureBinding2D:"TEXTURE_BINDING_2D",textureBindingCubeMap:"TEXTURE_BINDING_CUBE_MAP",compareRToTexture:"COMPARE_R_TO_TEXTURE",unsignedByte:"UNSIGNED_BYTE"};function li(e,t,i){if(void 0===t)return i;const r=ai[t];return void 0===r?i:e[r]}const ci=new Uint8Array([0,0,0,1]);class hi{constructor(e,t){this.gl=e,this.target=t||e.TEXTURE_2D,this.texture=e.createTexture(),this.setPreloadColor([0,0,0,0]),this.allocated=!0}setPreloadColor(e){e?(ci[0]=Math.floor(255*e[0]),ci[1]=Math.floor(255*e[1]),ci[2]=Math.floor(255*e[2]),ci[3]=Math.floor(255*(void 0!==e[3]?e[3]:1))):(ci[0]=0,ci[1]=0,ci[2]=0,ci[3]=255);const t=this.gl;if(t.bindTexture(this.target,this.texture),t.texParameteri(this.target,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(this.target,t.TEXTURE_MIN_FILTER,t.NEAREST),this.target===t.TEXTURE_CUBE_MAP){const e=[t.TEXTURE_CUBE_MAP_POSITIVE_X,t.TEXTURE_CUBE_MAP_NEGATIVE_X,t.TEXTURE_CUBE_MAP_POSITIVE_Y,t.TEXTURE_CUBE_MAP_NEGATIVE_Y,t.TEXTURE_CUBE_MAP_POSITIVE_Z,t.TEXTURE_CUBE_MAP_NEGATIVE_Z];for(let i=0,r=e.length;i<r;i++)t.texImage2D(e[i],0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,ci)}else t.texImage2D(this.target,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,ci);t.bindTexture(this.target,null)}setTarget(e){this.target=e||this.gl.TEXTURE_2D}setImage(e,t){const i=this.gl;if(i.bindTexture(this.target,this.texture),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,t.flipY),this.target===i.TEXTURE_CUBE_MAP){if(s.isArray(e)){const t=e,r=[i.TEXTURE_CUBE_MAP_POSITIVE_X,i.TEXTURE_CUBE_MAP_NEGATIVE_X,i.TEXTURE_CUBE_MAP_POSITIVE_Y,i.TEXTURE_CUBE_MAP_NEGATIVE_Y,i.TEXTURE_CUBE_MAP_POSITIVE_Z,i.TEXTURE_CUBE_MAP_NEGATIVE_Z];for(let e=0,o=r.length;e<o;e++)i.texImage2D(r[e],0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t[e])}}else i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,e);i.bindTexture(this.target,null)}setProps(e){const t=this.gl;if(t.bindTexture(this.target,this.texture),e.minFilter){const i=li(t,e.minFilter);i&&(t.texParameteri(this.target,t.TEXTURE_MIN_FILTER,i),i!==t.NEAREST_MIPMAP_NEAREST&&i!==t.LINEAR_MIPMAP_NEAREST&&i!==t.NEAREST_MIPMAP_LINEAR&&i!==t.LINEAR_MIPMAP_LINEAR||t.generateMipmap(this.target))}if(e.magFilter){const i=li(t,e.magFilter);i&&t.texParameteri(this.target,t.TEXTURE_MAG_FILTER,i)}if(e.wrapS){const i=li(t,e.wrapS);i&&t.texParameteri(this.target,t.TEXTURE_WRAP_S,i)}if(e.wrapT){const i=li(t,e.wrapT);i&&t.texParameteri(this.target,t.TEXTURE_WRAP_T,i)}t.bindTexture(this.target,null)}bind(e){if(this.allocated){if(this.texture){const t=this.gl;return t.activeTexture(t["TEXTURE"+e]),t.bindTexture(this.target,this.texture),!0}return!1}}unbind(e){if(this.allocated&&this.texture){const t=this.gl;t.activeTexture(t["TEXTURE"+e]),t.bindTexture(this.target,null)}}destroy(){this.allocated&&this.texture&&(this.gl.deleteTexture(this.texture),this.texture=null)}}function di(e){if(!ui(e.width)||!ui(e.height)){const t=document.createElement("canvas");t.width=pi(e.width),t.height=pi(e.height),t.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,t.width,t.height),e=t}return e}function ui(e){return 0==(e&e-1)}function pi(e){--e;for(let t=1;t<32;t<<=1)e|=e>>t;return e+1}class mi extends B{get type(){return"Texture"}constructor(e,t={}){super(e,t),this._state=new j({texture:new hi(this.scene.canvas.gl),matrix:u.identityMat4(),hasMatrix:t.translate&&(0!==t.translate[0]||0!==t.translate[1])||!!t.rotate||t.scale&&(0!==t.scale[0]||0!==t.scale[1]),minFilter:this._checkMinFilter(t.minFilter),magFilter:this._checkMagFilter(t.magFilter),wrapS:this._checkWrapS(t.wrapS),wrapT:this._checkWrapT(t.wrapT),flipY:this._checkFlipY(t.flipY),encoding:this._checkEncoding(t.encoding)}),this._src=null,this._image=null,this._translate=u.vec2([0,0]),this._scale=u.vec2([1,1]),this._rotate=u.vec2([0,0]),this._matrixDirty=!1,this.translate=t.translate,this.scale=t.scale,this.rotate=t.rotate,t.src?this.src=t.src:t.image&&(this.image=t.image),P.memory.textures++}_checkMinFilter(e){return"linear"!==(e=e||"linearMipmapLinear")&&"linearMipmapNearest"!==e&&"linearMipmapLinear"!==e&&"nearestMipmapLinear"!==e&&"nearestMipmapNearest"!==e&&(this.error("Unsupported value for 'minFilter': '"+e+"' - supported values are 'linear', 'linearMipmapNearest', 'nearestMipmapNearest', 'nearestMipmapLinear' and 'linearMipmapLinear'. Defaulting to 'linearMipmapLinear'."),e="linearMipmapLinear"),e}_checkMagFilter(e){return"linear"!==(e=e||"linear")&&"nearest"!==e&&(this.error("Unsupported value for 'magFilter': '"+e+"' - supported values are 'linear' and 'nearest'. Defaulting to 'linear'."),e="linear"),e}_checkFilter(e){return"linear"!==(e=e||"linear")&&"nearest"!==e&&(this.error("Unsupported value for 'magFilter': '"+e+"' - supported values are 'linear' and 'nearest'. Defaulting to 'linear'."),e="linear"),e}_checkWrapS(e){return"clampToEdge"!==(e=e||"repeat")&&"mirroredRepeat"!==e&&"repeat"!==e&&(this.error("Unsupported value for 'wrapS': '"+e+"' - supported values are 'clampToEdge', 'mirroredRepeat' and 'repeat'. Defaulting to 'repeat'."),e="repeat"),e}_checkWrapT(e){return"clampToEdge"!==(e=e||"repeat")&&"mirroredRepeat"!==e&&"repeat"!==e&&(this.error("Unsupported value for 'wrapT': '"+e+"' - supported values are 'clampToEdge', 'mirroredRepeat' and 'repeat'. Defaulting to 'repeat'."),e="repeat"),e}_checkFlipY(e){return!!e}_checkEncoding(e){return"linear"!==(e=e||"linear")&&"sRGB"!==e&&"gamma"!==e&&(this.error("Unsupported value for 'encoding': '"+e+"' - supported values are 'linear', 'sRGB', 'gamma'. Defaulting to 'linear'."),e="linear"),e}_webglContextRestored(){this._state.texture=new hi(this.scene.canvas.gl),this._image?this.image=this._image:this._src&&(this.src=this._src)}_update(){const e=this._state;if(this._matrixDirty){let t,i;0===this._translate[0]&&0===this._translate[1]||(t=u.translationMat4v([this._translate[0],this._translate[1],0],this._state.matrix)),1===this._scale[0]&&1===this._scale[1]||(i=u.scalingMat4v([this._scale[0],this._scale[1],1]),t=t?u.mulMat4(t,i):i),0!==this._rotate&&(i=u.rotationMat4v(.0174532925*this._rotate,[0,0,1]),t=t?u.mulMat4(t,i):i),t&&(e.matrix=t),this._matrixDirty=!1}this.glRedraw()}set image(e){this._image=di(e),this._image.crossOrigin="Anonymous",this._state.texture.setImage(this._image,this._state),this._state.texture.setProps(this._state),this._src=null,this.glRedraw()}get image(){return this._image}set src(e){this.scene.loading++,this.scene.canvas.spinner.processes++;const t=this;let i=new Image;i.onload=function(){i=di(i),t._state.texture.setImage(i,t._state),t._state.texture.setProps(t._state),t.scene.loading--,t.scene.canvas.spinner.processes--,t.glRedraw()},i.src=e,this._src=e,this._image=null}get src(){return this._src}set translate(e){this._translate.set(e||[0,0]),this._matrixDirty=!0,this._needUpdate()}get translate(){return this._translate}set scale(e){this._scale.set(e||[1,1]),this._matrixDirty=!0,this._needUpdate()}get scale(){return this._scale}set rotate(e){e=e||0,this._rotate!==e&&(this._rotate=e,this._matrixDirty=!0,this._needUpdate())}get rotate(){return this._rotate}get minFilter(){return this._state.minFilter}get magFilter(){return this._state.magFilter}get wrapS(){return this._state.wrapS}get wrapT(){return this._state.wrapT}get flipY(){return this._state.flipY}get encoding(){return this._state.encoding}destroy(){super.destroy(),this._state.texture&&this._state.texture.destroy(),this._state.destroy(),P.memory.textures--}}function fi(e,t={}){const i="lightgrey",r=t.hoverColor||"rgba(0,0,0,0.4)";var o=500+500/3,s=o/24;const n=[{boundary:[6,6,6,6],color:t.frontColor||t.color||"#55FF55"},{boundary:[18,6,6,6],color:t.backColor||t.color||"#55FF55"},{boundary:[12,6,6,6],color:t.leftColor||t.color||"#FF5555"},{boundary:[0,6,6,6],color:t.rightColor||t.color||"#FF5555"},{boundary:[6,0,6,6],color:t.topColor||t.color||"#7777FF"},{boundary:[6,12,6,6],color:t.bottomColor||t.color||"#7777FF"}],a=[{label:"front",boundaries:[[7,7,4,4]],dir:[0,1,0],up:[0,0,1]},{label:"back",boundaries:[[19,7,4,4]],dir:[0,-1,0],up:[0,0,1]},{label:"right",boundaries:[[13,7,4,4]],dir:[-1,0,0],up:[0,0,1]},{label:"left",boundaries:[[1,7,4,4]],dir:[1,0,0],up:[0,0,1]},{label:"top",boundaries:[[7,1,4,4]],dir:[0,0,-1],up:[0,1,0]},{label:"bottom",boundaries:[[7,13,4,4]],dir:[0,0,1],up:[0,-1,0]},{boundaries:[[7,5,4,2]],dir:[0,1,-1],up:[0,1,1]},{boundaries:[[1,6,4,1],[6,1,1,4]],dir:[1,0,-1],up:[1,0,1]},{boundaries:[[7,0,4,1],[19,6,4,1]],dir:[0,-1,-1],up:[0,-1,1]},{boundaries:[[13,6,4,1],[11,1,1,4]],dir:[-1,0,-1],up:[-1,0,1]},{boundaries:[[7,11,4,2]],dir:[0,1,1],up:[0,-1,1]},{boundaries:[[1,11,4,1],[6,13,1,4]],dir:[1,0,1],up:[-1,0,1]},{boundaries:[[7,17,4,1],[19,11,4,1]],dir:[0,-1,1],up:[0,1,1]},{boundaries:[[13,11,4,1],[11,13,1,4]],dir:[-1,0,1],up:[1,0,1]},{boundaries:[[5,7,2,4]],dir:[1,1,0],up:[0,0,1]},{boundaries:[[11,7,2,4]],dir:[-1,1,0],up:[0,0,1]},{boundaries:[[17,7,2,4]],dir:[-1,-1,0],up:[0,0,1]},{boundaries:[[0,7,1,4],[23,7,1,4]],dir:[1,-1,0],up:[0,0,1]},{boundaries:[[5,11,2,2]],dir:[1,1,1],up:[-1,-1,1]},{boundaries:[[23,11,1,1],[6,17,1,1],[0,11,1,1]],dir:[1,-1,1],up:[-1,1,1]},{boundaries:[[5,5,2,2]],dir:[1,1,-1],up:[1,1,1]},{boundaries:[[11,17,1,1],[17,11,2,1]],dir:[-1,-1,1],up:[1,1,1]},{boundaries:[[17,6,2,1],[11,0,1,1]],dir:[-1,-1,-1],up:[-1,-1,1]},{boundaries:[[11,11,2,2]],dir:[-1,1,1],up:[1,-1,1]},{boundaries:[[0,6,1,1],[6,0,1,1],[23,6,1,1]],dir:[1,-1,-1],up:[1,-1,1]},{boundaries:[[11,5,2,2]],dir:[-1,1,-1],up:[-1,1,1]}],l=[{boundary:[6,6,6,6],color:t.frontColor||t.color||"#55FF55"},{boundary:[18,6,6,6],color:t.backColor||t.color||"#55FF55"},{boundary:[12,6,6,6],color:t.leftColor||t.color||"#FF5555"},{boundary:[0,6,6,6],color:t.rightColor||t.color||"#FF5555"},{boundary:[6,0,6,6],color:t.topColor||t.color||"#7777FF"},{boundary:[6,12,6,6],color:t.bottomColor||t.color||"#7777FF"}],c=[{label:"front",boundaries:[[7,7,4,4]],dir:[0,0,-1],up:[0,1,0]},{label:"back",boundaries:[[19,7,4,4]],dir:[0,0,1],up:[0,1,0]},{label:"right",boundaries:[[13,7,4,4]],dir:[-1,0,0],up:[0,1,0]},{label:"left",boundaries:[[1,7,4,4]],dir:[1,0,0],up:[0,1,0]},{label:"top",boundaries:[[7,1,4,4]],dir:[0,-1,0],up:[0,0,-1]},{label:"bottom",boundaries:[[7,13,4,4]],dir:[0,1,0],up:[0,0,1]},{boundaries:[[7,5,4,2]],dir:[0,-1,-1],up:[0,1,-1]},{boundaries:[[1,6,4,1],[6,1,1,4]],dir:[1,-1,0],up:[1,1,0]},{boundaries:[[7,0,4,1],[19,6,4,1]],dir:[0,-1,1],up:[0,1,1]},{boundaries:[[13,6,4,1],[11,1,1,4]],dir:[-1,-1,0],up:[-1,1,0]},{boundaries:[[7,11,4,2]],dir:[0,1,-1],up:[0,1,1]},{boundaries:[[1,11,4,1],[6,13,1,4]],dir:[1,1,0],up:[-1,1,0]},{boundaries:[[7,17,4,1],[19,11,4,1]],dir:[0,1,1],up:[0,1,-1]},{boundaries:[[13,11,4,1],[11,13,1,4]],dir:[-1,1,0],up:[1,1,0]},{boundaries:[[5,7,2,4]],dir:[1,0,-1],up:[0,1,0]},{boundaries:[[11,7,2,4]],dir:[-1,0,-1],up:[0,1,0]},{boundaries:[[17,7,2,4]],dir:[-1,0,1],up:[0,1,0]},{boundaries:[[0,7,1,4],[23,7,1,4]],dir:[1,0,1],up:[0,1,0]},{boundaries:[[5,11,2,2]],dir:[1,1,-1],up:[-1,1,1]},{boundaries:[[23,11,1,1],[6,17,1,1],[0,11,1,1]],dir:[1,1,1],up:[-1,1,-1]},{boundaries:[[5,5,2,2]],dir:[1,-1,-1],up:[1,1,-1]},{boundaries:[[11,17,1,1],[17,11,2,1]],dir:[-1,1,1],up:[1,1,-1]},{boundaries:[[17,6,2,1],[11,0,1,1]],dir:[-1,-1,1],up:[-1,1,1]},{boundaries:[[11,11,2,2]],dir:[-1,1,-1],up:[1,1,1]},{boundaries:[[0,6,1,1],[6,0,1,1],[23,6,1,1]],dir:[1,-1,1],up:[1,1,1]},{boundaries:[[11,5,2,2]],dir:[-1,-1,-1],up:[-1,1,-1]}];for(let e=0,t=a.length;e<t;e++)u.normalizeVec3(a[e].dir,a[e].dir),u.normalizeVec3(c[e].dir,c[e].dir);var h=c;this._textureCanvas=document.createElement("canvas"),this._textureCanvas.width=o,this._textureCanvas.height=500,this._textureCanvas.style.width=o+"px",this._textureCanvas.style.height="500px",this._textureCanvas.style.padding="0",this._textureCanvas.style.margin="0",this._textureCanvas.style.top="0",this._textureCanvas.style.background=i,this._textureCanvas.style.position="absolute",this._textureCanvas.style.opacity="1.0",this._textureCanvas.style.visibility="hidden",this._textureCanvas.style["z-index"]=2e6,document.getElementsByTagName("body")[0].appendChild(this._textureCanvas);const d=this._textureCanvas.getContext("2d");function p(){for(let e=0,t=n.length;e<t;e++){const t=n[e],i=t.boundary,r=Math.round(i[0]*s),o=Math.round(i[1]*s),a=Math.round(i[2]*s),l=Math.round(i[3]*s);d.fillStyle=t.color,d.fillRect(r,o,a,l)}for(let n=0,l=h.length;n<l;n++){let l,c,u,p;const f=h[n],g=f.boundaries;for(var e=0,t=g.length;e<t;e++){const t=g[e];l=Math.round(t[0]*s),c=Math.round(t[1]*s),u=Math.round(t[2]*s),p=Math.round(t[3]*s),f.highlighted&&(d.fillStyle=f.highlighted?r:f.color||i,d.fillRect(l,c,u,p))}if(f.label){d.fillStyle="black",d.font="60px sans-serif",d.textAlign="center";var o=l+.5*u,a=c+.7*p;d.fillText(m(f.label),o,a,80)}}}var m=function(){const t={yUp:{front:"+Z",back:"-Z",right:"+X",left:"-X",top:"+Y",bottom:"-Y"},en:{front:"FRONT",back:"BACK",right:"RIGHT",left:"LEFT",top:"TOP",bottom:"BOTTOM"}};return function(i){var r;return(r=t[e.language||"en"])&&r[i]||i}}();this.setZUp=function(){!0,n,h=a,this.clear()},this.setYUp=function(){!1,l,h=c,this.clear()},this.clear=function(){d.fillStyle=i,d.fillRect(0,0,o,500);for(var e=0,t=h.length;e<t;e++){h[e].highlighted=!1}p()},this.getArea=function(e){const t=e[0]*o,i=500-500*e[1];for(var r=0,n=h.length;r<n;r++){const e=h[r].boundaries;for(var a=0,l=e.length;a<l;a++){const o=e[a];if(t>=o[0]*s&&t<=(o[0]+o[2])*s&&i>=o[1]*s&&i<=(o[1]+o[3])*s)return r}}return-1},this.setAreaHighlighted=function(e,t){var i=h[e];if(!i)throw"Area not found: "+e;i.highlighted=!!t,p()},this.getAreaDir=function(e){var t=h[e];if(!t)throw"Unknown area: "+e;return t.dir},this.getAreaUp=function(e){var t=h[e];if(!t)throw"Unknown area: "+e;return t.up},this.getImage=function(){return this._textureCanvas},this.destroy=function(){this._textureCanvas&&(this._textureCanvas.parentNode.removeChild(this._textureCanvas),this._textureCanvas=null)},this.clear()}class gi extends k{constructor(e,t={}){super("NavCube",e,t),e.navCube=this;try{this._navCubeScene=new ei({canvasId:t.canvasId,canvasElement:t.canvasElement,transparent:!0}),this._navCubeCanvas=this._navCubeScene.canvas.canvas}catch(e){return void this.error(e)}const i=this._navCubeScene;i.clearLights(),new Xt(i,{dir:[.4,-.4,.8],color:[.8,1,1],intensity:1,space:"view"}),new Xt(i,{dir:[-.8,-.3,-.4],color:[.8,.8,.8],intensity:1,space:"view"}),new Xt(i,{dir:[.8,-.6,-.8],color:[1,1,1],intensity:1,space:"view"}),this._navCubeCamera=i.camera,this._navCubeCamera.ortho.scale=7,this._navCubeCamera.ortho.near=.1,this._navCubeCamera.ortho.far=2e3,this._zUp=Boolean(e.camera.zUp);var r,o,s,n,a=this;this._synchCamera=(r=u.rotationMat4c(-90*u.DEGTORAD,1,0,0),o=u.vec3(),s=u.vec3(),n=u.vec3(),function(){var t=e.camera.eye,i=e.camera.look,l=e.camera.up;o=u.mulVec3Scalar(u.normalizeVec3(u.subVec3(t,i,o)),5),a._zUp?(u.transformVec3(r,o,s),u.transformVec3(r,l,n),a._navCubeCamera.look=[0,0,0],a._navCubeCamera.eye=u.transformVec3(r,o,s),a._navCubeCamera.up=u.transformPoint3(r,l,n)):(a._navCubeCamera.look=[0,0,0],a._navCubeCamera.eye=o,a._navCubeCamera.up=l)}),this._cubeTextureCanvas=new fi(e,t),this._cubeSampler=new mi(i,{image:this._cubeTextureCanvas.getImage(),flipY:!0,wrapS:"clampToEdge",wrapT:"clampToEdge"}),this._cubeMesh=new at(i,{geometry:new oe(i,{primitive:"triangles",normals:[0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1],positions:[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,1,-1,-1,1,-1,-1,1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,1,-1,1,1,-1],uv:[.5,.6666,.25,.6666,.25,.3333,.5,.3333,.5,.6666,.5,.3333,.75,.3333,.75,.6666,.5,.6666,.5,1,.25,1,.25,.6666,.25,.6666,0,.6666,0,.3333,.25,.3333,.25,0,.5,0,.5,.3333,.25,.3333,.75,.3333,1,.3333,1,.6666,.75,.6666],indices:[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]}),material:new le(i,{diffuse:[.4,.4,.4],specular:[.4,.4,.4],emissive:[.6,.6,.6],diffuseMap:this._cubeSampler,emissiveMap:this._cubeSampler}),visible:!0,edges:!0}),this._shadow=new at(i,{geometry:new oe(i,V({center:[0,0,0],radiusTop:.001,radiusBottom:1.4,height:.01,radialSegments:20,heightSegments:1,openEnded:!0})),material:new le(i,{diffuse:[0,0,0],specular:[0,0,0],emissive:[0,0,0],alpha:.5}),position:[0,-1.5,0],visible:!0,pickable:!1,backfaces:!1}),this._onCameraMatrix=e.camera.on("matrix",this._synchCamera),this._onCameraWorldAxis=e.camera.on("worldAxis",()=>{e.camera.zUp?(this._zUp=!0,this._cubeTextureCanvas.setZUp(),this._repaint(),this._synchCamera()):e.camera.yUp&&(this._zUp=!1,this._cubeTextureCanvas.setYUp(),this._repaint(),this._synchCamera())}),this._onCameraFOV=e.camera.perspective.on("fov",e=>{this._synchProjection&&(this._navCubeCamera.perspective.fov=e)}),this._onCameraProjection=e.camera.on("projection",e=>{this._synchProjection&&(this._navCubeCamera.projection=e)});var l=-1;function c(e){var t=[0,0];if(e){for(var i=e.target,r=0,o=0;i.offsetParent;)r+=i.offsetLeft,o+=i.offsetTop,i=i.offsetParent;t[0]=e.pageX-r,t[1]=e.pageY-o}else e=window.event,t[0]=e.x,t[1]=e.y;return t}var h,d,p=null,m=null,f=!1,g=!1,b=0,_=null,v=null,x=.5;a._navCubeCanvas.addEventListener("mouseenter",a._onMouseEnter=function(e){g=!0}),a._navCubeCanvas.addEventListener("mouseleave",a._onMouseLeave=function(e){g=!1}),a._navCubeCanvas.addEventListener("mousedown",a._onMouseDown=function(e){p=e.x,m=e.y,h=e.clientX,d=e.clientY;var t=c(e),r=i.pick({canvasPos:t});f=!!r}),document.addEventListener("mouseup",a._onMouseUp=function(e){if(1===e.which&&(f=!1,null!==p)){var t=c(e),r=i.pick({canvasPos:t,pickSurface:!0});if(r&&r.uv){var o=a._cubeTextureCanvas.getArea(r.uv);if(o>=0&&(document.body.style.cursor="pointer",l>=0&&(a._cubeTextureCanvas.setAreaHighlighted(l,!1),a._repaint(),l=-1),o>=0)){if(a._cubeTextureCanvas.setAreaHighlighted(o,!0),l=o,a._repaint(),e.x<p-3||e.x>p+3||e.y<m-3||e.y>m+3)return;var s=a._cubeTextureCanvas.getAreaDir(o);if(s){var n=a._cubeTextureCanvas.getAreaUp(o);w(s,n,(function(){l>=0&&(a._cubeTextureCanvas.setAreaHighlighted(l,!1),a._repaint(),l=-1);var e=i.pick({canvasPos:t,pickSurface:!0});if(e&&e.uv){var r=a._cubeTextureCanvas.getArea(e.uv);void 0!==r&&(document.body.style.cursor="pointer",l>=0&&(a._cubeTextureCanvas.setAreaHighlighted(l,!1),a._repaint(),l=-1),r>=0&&(a._cubeTextureCanvas.setAreaHighlighted(r,!0),l=r,a._repaint()))}}))}}}}}),document.addEventListener("mousemove",a._onMouseMove=function(t){if(l>=0&&(a._cubeTextureCanvas.setAreaHighlighted(l,!1),a._repaint(),l=-1),1!==t.buttons||f){if(f){var r=t.clientX,o=t.clientY;return document.body.style.cursor="move",void function(t,i){var r=(t-h)*-x,o=(i-d)*-x;r,b-=o,void 0!==_&&b<_&&(b=_),void 0!==v&&b>v&&(b=v),e.camera.orbitYaw(r),e.camera.orbitPitch(-o),h=t,d=i}(r,o)}if(g){var s=c(t),n=i.pick({canvasPos:s,pickSurface:!0});if(n){if(n.uv){document.body.style.cursor="pointer";var u=a._cubeTextureCanvas.getArea(n.uv);if(u===l)return;l>=0&&a._cubeTextureCanvas.setAreaHighlighted(l,!1),u>=0&&(a._cubeTextureCanvas.setAreaHighlighted(u,!0),a._repaint(),l=u)}}else document.body.style.cursor="default",l>=0&&(a._cubeTextureCanvas.setAreaHighlighted(l,!1),a._repaint(),l=-1)}}});var y,w=(y=u.vec3(),function(t,i,r){var o=a._fitVisible?e.scene.getAABB(e.scene.visibleObjectIds):e.scene.aabb,s=u.getAABB3Diag(o);u.getAABB3Center(o,y);var n=Math.abs(s/Math.tan(27.5));e.cameraControl.pivotPos=y,a._cameraFly?e.cameraFlight.flyTo({look:y,eye:[y[0]-n*t[0],y[1]-n*t[1],y[2]-n*t[2]],up:i||[0,1,0],orthoScale:1.3*s,fitFOV:a._cameraFitFOV,duration:a._cameraFlyDuration},r):e.cameraFlight.jumpTo({look:y,eye:[y[0]-n*t[0],y[1]-n*t[1],y[2]-n*t[2]],up:i||[0,1,0],orthoScale:1.3*s,fitFOV:a._cameraFitFOV},r)});this.setVisible(t.visible),this.setCameraFitFOV(t.cameraFitFOV),this.setCameraFly(t.cameraFly),this.setCameraFlyDuration(t.cameraFlyDuration),this.setFitVisible(t.fitVisible),this.setSynchProjection(t.synchProjection)}send(e,t){switch(e){case"language":this._cubeTextureCanvas.clear(),this._repaint()}}_repaint(){const e=this._cubeTextureCanvas.getImage();this._cubeMesh.material.diffuseMap.image=e,this._cubeMesh.material.emissiveMap.image=e}setVisible(e=!0){this._navCubeCanvas&&(this._cubeMesh.visible=e,this._shadow.visible=e,this._navCubeCanvas.style.visibility=e?"visible":"hidden")}getVisible(){return!!this._navCubeCanvas&&this._cubeMesh.visible}setFitVisible(e=!1){this._fitVisible=e}getFitVisible(){return this._fitVisible}setCameraFly(e=!0){this._cameraFly=e}getCameraFly(){return this._cameraFly}setCameraFitFOV(e=45){this._cameraFitFOV=e}getCameraFitFOV(){return this._cameraFitFOV}setCameraFlyDuration(e=.5){this._cameraFlyDuration=e}getCameraFlyDuration(){return this._cameraFlyDuration}setSynchProjection(e=!1){this._synchProjection=e}getSynchProjection(){return this._synchProjection}destroy(){this._navCubeCanvas&&(this.viewer.camera.off(this._onCameraMatrix),this.viewer.camera.off(this._onCameraWorldAxis),this.viewer.camera.perspective.off(this._onCameraFOV),this.viewer.camera.off(this._onCameraProjection),this._navCubeCanvas.removeEventListener("mouseenter",this._onMouseEnter),this._navCubeCanvas.removeEventListener("mouseleave",this._onMouseLeave),this._navCubeCanvas.removeEventListener("mousedown",this._onMouseDown),document.removeEventListener("mousemove",this._onMouseMove),document.removeEventListener("mouseup",this._onMouseUp),this._navCubeCanvas=null,this._cubeTextureCanvas.destroy(),this._cubeTextureCanvas=null,this._onMouseEnter=null,this._onMouseLeave=null,this._onMouseDown=null,this._onMouseMove=null,this._onMouseUp=null),this._navCubeScene.destroy(),this._navCubeScene=null,this._cubeMesh=null,this._shadow=null,super.destroy()}}class bi extends a{constructor(e,t){if(super(e,t),!t.navCubeCanvasElement)throw"Missing config: navCubeCanvasElement";const i=t.navCubeCanvasElement;this._navCube=new gi(this.viewer,{canvasElement:i.get(0),fitVisible:!0}),this._navCube.setVisible(this._active),this.on("active",e=>{this._navCube.setVisible(e)})}destroy(){this._navCube.destroy(),super.destroy()}}const _i=new Uint16Array([0,0,0,0]);class vi{constructor(e,t,i,r,o=null,s=0){this.model=e,this.object=null,this.parent=null,this.id=t,this.pickId=this.model.scene._renderer.getPickID(this),this.aabb=u.AABB3(),this._layer=o,this._portionId=s,this._color=[i[0],i[1],i[2],r]}_initFlags(e){this._layer.initFlags(this._portionId,e)}_setVisible(e){this._layer.setVisible(this._portionId,e)}_setColor(e,t){_i[0]=Math.floor(this._color[0]/255*(e[0]/255)*255),_i[1]=Math.floor(this._color[1]/255*(e[1]/255)*255),_i[2]=Math.floor(this._color[2]/255*(e[2]/255)*255),_i[3]=Math.floor(this._color[3]/255*(e[3]/255)*255),this._layer.setColor(this._portionId,_i,t)}_setHighlighted(e){this._layer.setHighlighted(this._portionId,e)}_setXRayed(e){this._layer.setXRayed(this._portionId,e)}_setSelected(e){this._layer.setSelected(this._portionId,e)}_setEdges(e){this._layer.setEdges(this._portionId,e)}_setClippable(e){this._layer.setClippable(this._portionId,e)}_setCollidable(e){this._layer.setCollidable(this._portionId,e)}_setPickable(e){this._layer.setPickable(this._portionId,e)}canPickTriangle(){return!1}drawPickTriangles(e){}pickTriangleSurface(e){}canPickWorldPos(){return!0}drawPickDepths(e){this.model.drawPickDepths(e)}drawPickNormals(e){this.model.drawPickNormals(e)}delegatePickedEntity(){return this.parent}_destroy(){this.model.scene._renderer.putPickID(this.pickId)}}const xi={VISIBLE:1,CULLED:4,PICKABLE:8,CLIPPABLE:16,COLLIDABLE:32,CAST_SHADOW:64,RECEIVE_SHADOW:128,XRAYED:256,HIGHLIGHTED:512,SELECTED:1024,EDGES:2048,BACKFACES:4096},yi=new Float32Array([0,0,0]);class wi{constructor(e,t,i,r,o,s){this._isObject=t,this.model=e,this.meshes=r;for(var n=0,a=this.meshes.length;n<a;n++){this.meshes[n].parent=this}this.id=i,this._flags=o,this._colorize=new Uint8Array([255,255,255,255]),this._aabb=s,this._isObject&&e.scene._registerObject(this)}get isEntity(){return!0}get isModel(){return!1}get isObject(){return this._isObject}get aabb(){return this._aabb}set visible(e){if(!!(this._flags&xi.VISIBLE)!==e){this._flags=e?this._flags|xi.VISIBLE:this._flags&~xi.VISIBLE;for(var t=0,i=this.meshes.length;t<i;t++)this.meshes[t]._setVisible(this._flags);this._isObject&&this.model.scene._objectVisibilityUpdated(this),this.model.glRedraw()}}get visible(){return this._getFlag(xi.VISIBLE)}_getFlag(e){return!!(this._flags&e)}set highlighted(e){if(!!(this._flags&xi.HIGHLIGHTED)!==e){this._flags=e?this._flags|xi.HIGHLIGHTED:this._flags&~xi.HIGHLIGHTED;for(var t=0,i=this.meshes.length;t<i;t++)this.meshes[t]._setHighlighted(this._flags);this._isObject&&this.model.scene._objectHighlightedUpdated(this),this.model.glRedraw()}}get highlighted(){return this._getFlag(xi.HIGHLIGHTED)}set xrayed(e){if(!!(this._flags&xi.XRAYED)!==e){this._flags=e?this._flags|xi.XRAYED:this._flags&~xi.XRAYED;for(var t=0,i=this.meshes.length;t<i;t++)this.meshes[t]._setXRayed(this._flags);this._isObject&&this.model.scene._objectXRayedUpdated(this),this.model.glRedraw()}}get xrayed(){return this._getFlag(xi.XRAYED)}set selected(e){if(!!(this._flags&xi.SELECTED)!==e){this._flags=e?this._flags|xi.SELECTED:this._flags&~xi.SELECTED;for(var t=0,i=this.meshes.length;t<i;t++)this.meshes[t]._setSelected(this._flags);this._isObject&&this.model.scene._objectSelectedUpdated(this),this.model.glRedraw()}}get selected(){return this._getFlag(xi.SELECTED)}set edges(e){if(!!(this._flags&xi.EDGES)!==e){this._flags=e?this._flags|xi.EDGES:this._flags&~xi.EDGES;for(var t=0,i=this.meshes.length;t<i;t++)this.meshes[t]._setEdges(this._flags);this.model.glRedraw()}}get edges(){return this._getFlag(xi.EDGES)}set culled(e){}get culled(){return!1}set clippable(e){if(!!(this._flags&xi.CLIPPABLE)!==e){this._flags=e?this._flags|xi.CLIPPABLE:this._flags&~xi.CLIPPABLE;for(var t=0,i=this.meshes.length;t<i;t++)this.meshes[t]._setClippable(this._flags);this.model.glRedraw()}}get clippable(){return this._getFlag(xi.CLIPPABLE)}set collidable(e){if(!!(this._flags&xi.COLLIDABLE)!==e){this._flags=e?this._flags|xi.COLLIDABLE:this._flags&~xi.COLLIDABLE;for(var t=0,i=this.meshes.length;t<i;t++)this.meshes[t]._setCollidable(this._flags)}}get collidable(){return this._getFlag(xi.COLLIDABLE)}set pickable(e){if(!!(this._flags&xi.PICKABLE)!==e){this._flags=e?this._flags|xi.PICKABLE:this._flags&~xi.PICKABLE;for(var t=0,i=this.meshes.length;t<i;t++)this.meshes[t]._setPickable(this._flags)}}get pickable(){return this._getFlag(xi.PICKABLE)}set colorize(e){this._colorize[0]=Math.floor(255*e[0]),this._colorize[1]=Math.floor(255*e[1]),this._colorize[2]=Math.floor(255*e[2]);for(var t=0,i=this.meshes.length;t<i;t++)this.meshes[t]._setColor(this._colorize,!1);this.model.glRedraw()}get colorize(){return yi[0]=this._colorize[0]/255,yi[1]=this._colorize[1]/255,yi[2]=this._colorize[2]/255,yi}set opacity(e){if(e<0?e=0:e>1&&(e=1),e=Math.floor(255*e),this._colorize[3]===e)return;this._colorize[3]=e;for(var t=0,i=this.meshes.length;t<i;t++)this.meshes[t]._setColor(this._colorize,!0);this.model.glRedraw()}get opacity(){return this._colorize[3]/255}set castsShadow(e){}get castsShadow(){return!1}set receivesShadow(e){}get receivesShadow(){return!1}_finalize(){const e=this.model.scene;this._isObject&&(this.visible&&e._objectVisibilityUpdated(this),this.highlighted&&e._objectHighlightedUpdated(this),this.xrayed&&e._objectXRayedUpdated(this),this.selected&&e._objectSelectedUpdated(this));for(var t=0,i=this.meshes.length;t<i;t++)this.meshes[t]._initFlags(this._flags)}_destroy(){const e=this.model.scene;this._isObject&&(e._deregisterObject(this),this.visible&&e._objectVisibilityUpdated(this,!1),this.xrayed&&e._objectXRayedUpdated(this),this.selected&&e._objectSelectedUpdated(this),this.highlighted&&e._objectHighlightedUpdated(this));for(var t=0,i=this.meshes.length;t<i;t++)this.meshes[t]._destroy();e._aabbDirty=!0}}const Mi=q.SUPPORTED_EXTENSIONS.OES_element_index_uint,ki=!0,Pi=ki?Mi?5e6:65530:5e6;class Ei{constructor(){this.slicing=ki,this.maxVerts=Pi,this.positions=new Float32Array(3*Pi),this.colors=new Uint8Array(4*Pi),this.quantizedPositions=new Uint16Array(3*Pi),this.normals=new Int8Array(3*Pi),this.pickColors=new Uint8Array(4*Pi),this.flags=new Uint8Array(4*Pi),this.flags2=new Uint8Array(4*Pi),this.indices=Mi?new Uint32Array(6*Pi):new Uint16Array(6*Pi),this.edgeIndices=Mi?new Uint32Array(6*Pi):new Uint16Array(6*Pi),this.lenPositions=0,this.lenColors=0,this.lenNormals=0,this.lenPickColors=0,this.lenFlags=0,this.lenIndices=0,this.lenEdgeIndices=0}}const Ai=[];function Ci(e){Ai.push(e)}const Ti={NORMAL_OPAQUE:0,NORMAL_TRANSPARENT:1,NORMAL_EDGES:2,HIGHLIGHTED:3,HIGHLIGHTED_EDGES:4,XRAYED:5,XRAYED_EDGES:6,SELECTED:7,SELECTED_EDGES:8},Di=function(e){this.vertex=function(e){var t=e.model.scene;const i=t._sectionPlanesState,r=t._lightsState,o=i.sectionPlanes.length>0;let s,n,a;const l=[];for(l.push("// Batched geometry drawing vertex shader"),l.push("uniform int renderPass;"),l.push("attribute vec3 position;"),l.push("attribute vec3 normal;"),l.push("attribute vec4 color;"),l.push("attribute vec4 flags;"),l.push("attribute vec4 flags2;"),l.push("uniform mat4 viewMatrix;"),l.push("uniform mat4 projMatrix;"),l.push("uniform mat4 viewNormalMatrix;"),l.push("uniform mat4 positionsDecodeMatrix;"),l.push("uniform vec4 colorize;"),l.push("uniform vec4 lightAmbient;"),s=0,n=r.lights.length;s<n;s++)"ambient"!==(a=r.lights[s]).type&&(l.push("uniform vec4 lightColor"+s+";"),"dir"===a.type&&l.push("uniform vec3 lightDir"+s+";"),"point"===a.type&&l.push("uniform vec3 lightPos"+s+";"),"spot"===a.type&&(l.push("uniform vec3 lightPos"+s+";"),l.push("uniform vec3 lightDir"+s+";")));l.push("vec3 octDecode(vec2 oct) {"),l.push("    vec3 v = vec3(oct.xy, 1.0 - abs(oct.x) - abs(oct.y));"),l.push("    if (v.z < 0.0) {"),l.push("        v.xy = (1.0 - abs(v.yx)) * vec2(v.x >= 0.0 ? 1.0 : -1.0, v.y >= 0.0 ? 1.0 : -1.0);"),l.push("    }"),l.push("    return normalize(v);"),l.push("}"),o&&(l.push("varying vec4 vWorldPosition;"),l.push("varying vec4 vFlags2;"));for(l.push("varying vec4 vColor;"),l.push("void main(void) {"),l.push("bool visible      = (float(flags.x) > 0.0);"),l.push("bool xrayed       = (float(flags.y) > 0.0);"),l.push("bool highlighted  = (float(flags.z) > 0.0);"),l.push("bool selected     = (float(flags.w) > 0.0);"),l.push("bool transparent  = ((float(color.a) / 255.0) < 1.0);"),l.push(`if (\n    !visible ||  \n    (renderPass == ${Ti.NORMAL_OPAQUE} && (transparent || xrayed)) || \n    (renderPass == ${Ti.NORMAL_TRANSPARENT} && (!transparent || xrayed || highlighted || selected)) || \n    (renderPass == ${Ti.XRAYED} && (!xrayed || highlighted || selected)) || \n    (renderPass == ${Ti.HIGHLIGHTED} && !highlighted) ||\n    (renderPass == ${Ti.SELECTED} && !selected)) {`),l.push("   gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),l.push("} else {"),l.push("vec4 worldPosition = (positionsDecodeMatrix * vec4(position, 1.0)); "),l.push("vec4 viewPosition  = viewMatrix * worldPosition; "),l.push("vec4 worldNormal =  vec4(octDecode(normal.xy), 0.0); "),l.push("vec3 viewNormal = normalize((viewNormalMatrix * worldNormal).xyz);"),l.push("vec3 reflectedColor = vec3(0.0, 0.0, 0.0);"),l.push("vec3 viewLightDir = vec3(0.0, 0.0, -1.0);"),l.push("float lambertian = 1.0;"),s=0,n=r.lights.length;s<n;s++)if("ambient"!==(a=r.lights[s]).type){if("dir"===a.type)"view"===a.space?l.push("viewLightDir = normalize(lightDir"+s+");"):l.push("viewLightDir = normalize((viewMatrix * vec4(lightDir"+s+", 0.0)).xyz);");else if("point"===a.type)"view"===a.space?l.push("viewLightDir = normalize(lightPos"+s+" - viewPosition.xyz);"):l.push("viewLightDir = normalize((viewMatrix * vec4(lightPos"+s+", 0.0)).xyz);");else{if("spot"!==a.type)continue;"view"===a.space?l.push("viewLightDir = normalize(lightDir"+s+");"):l.push("viewLightDir = normalize((viewMatrix * vec4(lightDir"+s+", 0.0)).xyz);")}l.push("lambertian = max(dot(-viewNormal, viewLightDir), 0.0);"),l.push("reflectedColor += lambertian * (lightColor"+s+".rgb * lightColor"+s+".a);")}l.push("vColor = colorize *  vec4(reflectedColor * ((lightAmbient.rgb * lightAmbient.a) + vec3(float(color.r) / 255.0, float(color.g) / 255.0, float(color.b) / 255.0)), float(color.a) / 255.0);"),o&&(l.push("vWorldPosition = worldPosition;"),l.push("vFlags2 = flags2;"));return l.push("gl_Position = projMatrix * viewPosition;"),l.push("}"),l.push("}"),l}(e),this.fragment=function(e){const t=e.model.scene._sectionPlanesState;let i,r;const o=t.sectionPlanes.length>0,s=[];if(s.push("// Batched geometry drawing fragment shader"),s.push("precision mediump float;"),s.push("precision mediump int;"),o)for(s.push("varying vec4 vWorldPosition;"),s.push("varying vec4 vFlags2;"),i=0,r=t.sectionPlanes.length;i<r;i++)s.push("uniform bool sectionPlaneActive"+i+";"),s.push("uniform vec3 sectionPlanePos"+i+";"),s.push("uniform vec3 sectionPlaneDir"+i+";");if(s.push("varying vec4 vColor;"),s.push("void main(void) {"),o){for(s.push("  bool clippable = (float(vFlags2.x) > 0.0);"),s.push("  if (clippable) {"),s.push("  float dist = 0.0;"),i=0,r=t.sectionPlanes.length;i<r;i++)s.push("if (sectionPlaneActive"+i+") {"),s.push("   dist += clamp(dot(-sectionPlaneDir"+i+".xyz, vWorldPosition.xyz - sectionPlanePos"+i+".xyz), 0.0, 1000.0);"),s.push("}");s.push("  if (dist > 0.0) { discard; }"),s.push("}")}return s.push("gl_FragColor = vColor;"),s.push("}"),s}(e)};const Si=new n({}),Li=function(e,t){this.id=Si.addItem({}),this._hash=e,this._scene=t.model.scene,this._useCount=0,this._shaderSource=new Di(t),this._allocate(t)},Ri={},Ii=new Float32Array([1,1,1,1]);function Ni(e){return[e.canvas.canvas.id,"",e._lightsState.getHash(),e._sectionPlanesState.getHash()].join(";")}Li.get=function(e){const t=Ni(e.model.scene);let i=Ri[t];if(!i){if((i=new Li(t,e)).errors)return console.log(i.errors.join("\n")),null;Ri[t]=i,P.memory.programs++}return i._useCount++,i},Li.prototype.getValid=function(){return this._hash===Ni(this._scene)},Li.prototype.put=function(){0==--this._useCount&&(Si.removeItem(this.id),this._program&&this._program.destroy(),delete Ri[this._hash],P.memory.programs--)},Li.prototype.webglContextRestored=function(){this._program=null},Li.prototype.drawLayer=function(e,t,i){const r=t.model,o=r.scene,s=o.canvas.gl,n=t._state;if(this._program||this._allocate(t),e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e,t)),s.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),s.uniformMatrix4fv(this._uViewMatrix,!1,r.viewMatrix),s.uniformMatrix4fv(this._uViewNormalMatrix,!1,r.viewNormalMatrix),s.uniform1i(this._uRenderPass,i),this._aPosition.bindArrayBuffer(n.positionsBuf),e.bindArray++,this._aNormal&&(this._aNormal.bindArrayBuffer(n.normalsBuf),e.bindArray++),this._aColor&&(this._aColor.bindArrayBuffer(n.colorsBuf),e.bindArray++),this._aFlags&&(this._aFlags.bindArrayBuffer(n.flagsBuf),e.bindArray++),this._aFlags2&&(this._aFlags2.bindArrayBuffer(n.flags2Buf),e.bindArray++),n.indicesBuf.bind(),e.bindArray++,i===Ti.XRAYED){const e=o.xrayMaterial._state,t=e.fillColor,i=e.fillAlpha;s.uniform4f(this._uColorize,t[0],t[1],t[2],i)}else if(i===Ti.HIGHLIGHTED){const e=o.highlightMaterial._state,t=e.fillColor,i=e.fillAlpha;s.uniform4f(this._uColorize,t[0],t[1],t[2],i)}else s.uniform4fv(this._uColorize,Ii);s.drawElements(n.primitive,n.indicesBuf.numItems,n.indicesBuf.itemType,0),e.drawElements++},Li.prototype._allocate=function(e){var t=e.model.scene;const i=t.canvas.gl,r=t._lightsState,o=t._sectionPlanesState;if(this._program=new De(i,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const s=this._program;this._uRenderPass=s.getLocation("renderPass"),this._uPositionsDecodeMatrix=s.getLocation("positionsDecodeMatrix"),this._uViewMatrix=s.getLocation("viewMatrix"),this._uViewNormalMatrix=s.getLocation("viewNormalMatrix"),this._uProjMatrix=s.getLocation("projMatrix"),this._uColorize=s.getLocation("colorize"),this._uLightAmbient=[],this._uLightColor=[],this._uLightDir=[],this._uLightPos=[],this._uLightAttenuation=[];const n=r.lights;let a;for(let e=0,t=n.length;e<t;e++)switch((a=n[e]).type){case"ambient":this._uLightAmbient[e]=s.getLocation("lightAmbient");break;case"dir":this._uLightColor[e]=s.getLocation("lightColor"+e),this._uLightPos[e]=null,this._uLightDir[e]=s.getLocation("lightDir"+e);break;case"point":this._uLightColor[e]=s.getLocation("lightColor"+e),this._uLightPos[e]=s.getLocation("lightPos"+e),this._uLightDir[e]=null,this._uLightAttenuation[e]=s.getLocation("lightAttenuation"+e);break;case"spot":this._uLightColor[e]=s.getLocation("lightColor"+e),this._uLightPos[e]=s.getLocation("lightPos"+e),this._uLightDir[e]=s.getLocation("lightDir"+e),this._uLightAttenuation[e]=s.getLocation("lightAttenuation"+e)}this._uSectionPlanes=[];for(let e=0,t=o.sectionPlanes.length;e<t;e++)this._uSectionPlanes.push({active:s.getLocation("sectionPlaneActive"+e),pos:s.getLocation("sectionPlanePos"+e),dir:s.getLocation("sectionPlaneDir"+e)});this._aPosition=s.getAttribute("position"),this._aNormal=s.getAttribute("normal"),this._aColor=s.getAttribute("color"),this._aFlags=s.getAttribute("flags"),this._aFlags2=s.getAttribute("flags2")},Li.prototype._bindProgram=function(e,t){const i=this._scene,r=i.canvas.gl,o=this._program,s=i._lightsState,n=i._sectionPlanesState,a=s.lights;let l;o.bind(),e.useProgram++;const c=i.camera;r.uniformMatrix4fv(this._uProjMatrix,!1,c._project._state.matrix);for(var h=0,d=a.length;h<d;h++)l=a[h],this._uLightAmbient[h]?r.uniform4f(this._uLightAmbient[h],l.color[0],l.color[1],l.color[2],l.intensity):(this._uLightColor[h]&&r.uniform4f(this._uLightColor[h],l.color[0],l.color[1],l.color[2],l.intensity),this._uLightPos[h]&&(r.uniform3fv(this._uLightPos[h],l.pos),this._uLightAttenuation[h]&&r.uniform1f(this._uLightAttenuation[h],l.attenuation)),this._uLightDir[h]&&r.uniform3fv(this._uLightDir[h],l.dir));if(n.sectionPlanes.length>0){const e=i._sectionPlanesState.sectionPlanes;let t,o,s,n,a;for(h=0,d=this._uSectionPlanes.length;h<d;h++)o=(t=this._uSectionPlanes[h]).active,s=e[h],o&&r.uniform1i(o,s.active),(n=t.pos)&&r.uniform3fv(t.pos,s.pos),(a=t.dir)&&r.uniform3fv(t.dir,s.dir)}};const Fi=function(e){this.vertex=function(e){const t=e.model.scene,i=t._sectionPlanesState,r=(t._lightsState,i.sectionPlanes.length>0);const o=[];o.push("// Batched fill vertex shader"),o.push("precision mediump float;"),o.push("precision mediump int;"),o.push("uniform int renderPass;"),o.push("attribute vec3 position;"),o.push("attribute vec4 flags;"),o.push("attribute vec4 flags2;"),o.push("uniform mat4 viewMatrix;"),o.push("uniform mat4 projMatrix;"),o.push("uniform mat4 positionsDecodeMatrix;"),o.push("uniform vec4 color;"),r&&(o.push("varying vec4 vWorldPosition;"),o.push("varying vec4 vFlags2;"));o.push("void main(void) {"),o.push("bool visible      = (float(flags.x) > 0.0);"),o.push("bool xrayed       = (float(flags.y) > 0.0);"),o.push("bool highlighted  = (float(flags.z) > 0.0);"),o.push("bool selected     = (float(flags.w) > 0.0);"),o.push("bool clippable    = (float(flags2.x) > 0.0);"),o.push("bool transparent  = (color.a < 1.0);"),o.push(`if (\n    !visible || \n    (renderPass == ${Ti.NORMAL_OPAQUE} && (transparent || xrayed)) || \n    (renderPass == ${Ti.NORMAL_TRANSPARENT} && (!transparent || xrayed || highlighted || selected)) || \n    (renderPass == ${Ti.XRAYED} && (!xrayed || highlighted || selected)) || \n    (renderPass == ${Ti.HIGHLIGHTED} && !highlighted) ||\n    (renderPass == ${Ti.SELECTED} && !selected)) {`),o.push("   gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),o.push("} else {"),o.push("vec4 worldPosition = positionsDecodeMatrix * vec4(position, 1.0); "),o.push("vec4 viewPosition  = viewMatrix * worldPosition; "),r&&(o.push("vWorldPosition = worldPosition;"),o.push("vFlags2 = flags2;"));return o.push("gl_Position = projMatrix * viewPosition;"),o.push("}"),o.push("}"),o}(e),this.fragment=function(e){const t=e.model.scene._sectionPlanesState;let i,r;const o=t.sectionPlanes.length>0,s=[];if(s.push("// Batched fill fragment shader"),s.push("precision mediump float;"),s.push("precision mediump int;"),o)for(s.push("varying vec4 vWorldPosition;"),s.push("varying vec4 vFlags2;"),i=0,r=t.sectionPlanes.length;i<r;i++)s.push("uniform bool sectionPlaneActive"+i+";"),s.push("uniform vec3 sectionPlanePos"+i+";"),s.push("uniform vec3 sectionPlaneDir"+i+";");if(s.push("uniform vec4 color;"),s.push("void main(void) {"),o){for(s.push("  bool clippable = (float(vFlags2.x) > 0.0);"),s.push("  if (clippable) {"),s.push("  float dist = 0.0;"),i=0,r=t.sectionPlanes.length;i<r;i++)s.push("if (sectionPlaneActive"+i+") {"),s.push("   dist += clamp(dot(-sectionPlaneDir"+i+".xyz, vWorldPosition.xyz - sectionPlanePos"+i+".xyz), 0.0, 1000.0);"),s.push("}");s.push("  if (dist > 0.0) { discard; }"),s.push("}")}return s.push("gl_FragColor = color;"),s.push("}"),s}(e)};const Bi=new n({}),Oi=function(e,t){this.id=Bi.addItem({}),this._hash=e,this._scene=t.model.scene,this._useCount=0,this._shaderSource=new Fi(t),this._allocate(t)},ji={},zi=new Float32Array([1,1,1,1]);function Vi(e){return[e.canvas.canvas.id,"",e._sectionPlanesState.getHash()].join(";")}Oi.get=function(e){const t=Vi(e.model.scene);let i=ji[t];if(!i){if((i=new Oi(t,e)).errors)return console.log(i.errors.join("\n")),null;ji[t]=i,P.memory.programs++}return i._useCount++,i},Oi.prototype.getValid=function(){return this._hash===Vi(this._scene)},Oi.prototype.put=function(){0==--this._useCount&&(Bi.removeItem(this.id),this._program&&this._program.destroy(),delete ji[this._hash],P.memory.programs--)},Oi.prototype.webglContextRestored=function(){this._program=null},Oi.prototype.drawLayer=function(e,t,i){const r=t.model,o=r.scene,s=o.canvas.gl,n=t._state;if(this._program||(this._allocate(t),!this.errors)){if(e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e,t)),s.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),s.uniformMatrix4fv(this._uViewMatrix,!1,r.viewMatrix),s.uniformMatrix4fv(this._uViewNormalMatrix,!1,r.viewNormalMatrix),s.uniform1i(this._uRenderPass,i),s.uniformMatrix4fv(this._uModelMatrix,s.FALSE,r.worldMatrix),this._aPosition.bindArrayBuffer(n.positionsBuf),e.bindArray++,this._aFlags&&(this._aFlags.bindArrayBuffer(n.flagsBuf),e.bindArray++),this._aFlags2&&(this._aFlags2.bindArrayBuffer(n.flags2Buf),e.bindArray++),n.indicesBuf.bind(),e.bindArray++,i===Ti.XRAYED){const e=o.xrayMaterial._state,t=e.fillColor,i=e.fillAlpha;s.uniform4f(this._uColor,t[0],t[1],t[2],i)}else if(i===Ti.HIGHLIGHTED){const e=o.highlightMaterial._state,t=e.fillColor,i=e.fillAlpha;s.uniform4f(this._uColor,t[0],t[1],t[2],i)}else if(i===Ti.SELECTED){const e=o.selectedMaterial._state,t=e.fillColor,i=e.fillAlpha;s.uniform4f(this._uColor,t[0],t[1],t[2],i)}else s.uniform4fv(this._uColor,zi);s.drawElements(n.primitive,n.indicesBuf.numItems,n.indicesBuf.itemType,0),e.drawElements++}},Oi.prototype._allocate=function(e){const t=e.model.scene,i=t.canvas.gl,r=t._sectionPlanesState;if(this._program=new De(i,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const o=this._program;this._uRenderPass=o.getLocation("renderPass"),this._uPositionsDecodeMatrix=o.getLocation("positionsDecodeMatrix"),this._uModelMatrix=o.getLocation("modelMatrix"),this._uViewMatrix=o.getLocation("viewMatrix"),this._uProjMatrix=o.getLocation("projMatrix"),this._uColor=o.getLocation("color"),this._uSectionPlanes=[];for(var s=0,n=r.sectionPlanes.length;s<n;s++)this._uSectionPlanes.push({active:o.getLocation("sectionPlaneActive"+s),pos:o.getLocation("sectionPlanePos"+s),dir:o.getLocation("sectionPlaneDir"+s)});this._aPosition=o.getAttribute("position"),this._aFlags=o.getAttribute("flags"),this._aFlags2=o.getAttribute("flags2")},Oi.prototype._bindProgram=function(e,t){const i=this._scene,r=i.canvas.gl,o=this._program,s=i._sectionPlanesState;o.bind(),e.useProgram++;const n=i.camera;if(r.uniformMatrix4fv(this._uProjMatrix,!1,n._project._state.matrix),s.sectionPlanes.length>0){const e=i._sectionPlanesState.sectionPlanes;let t,o,s,n,c;for(var a=0,l=this._uSectionPlanes.length;a<l;a++)o=(t=this._uSectionPlanes[a]).active,s=e[a],o&&r.uniform1i(o,s.active),(n=t.pos)&&r.uniform3fv(t.pos,s.pos),(c=t.dir)&&r.uniform3fv(t.dir,s.dir)}};const Ui=function(e){this.vertex=function(e){const t=e.model.scene._sectionPlanesState.sectionPlanes.length>0,i=[];i.push("// Batched geometry edges drawing vertex shader"),i.push("precision mediump float;"),i.push("precision mediump int;"),i.push("uniform int renderPass;"),i.push("attribute vec3 position;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("uniform mat4 viewMatrix;"),i.push("uniform mat4 projMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;"));i.push("uniform vec4 color;"),i.push("void main(void) {"),i.push("bool visible      = (float(flags.x) > 0.0);"),i.push("bool xrayed       = (float(flags.y) > 0.0);"),i.push("bool highlighted  = (float(flags.z) > 0.0);"),i.push("bool selected     = false;"),i.push("bool edges        = (float(flags2.y) > 0.0);"),i.push("bool transparent  = (color.a < 1.0);"),i.push(`if (\n    !visible || !edges ||\n    (renderPass == ${Ti.NORMAL_OPAQUE} && (transparent || xrayed)) ||\n    (renderPass == ${Ti.NORMAL_TRANSPARENT} &&  (!transparent || xrayed || highlighted || selected)) ||\n    (renderPass == ${Ti.XRAYED} && (!xrayed || highlighted || selected)) ||\n    (renderPass == ${Ti.HIGHLIGHTED} && !highlighted) ||\n    (renderPass == ${Ti.SELECTED} && !selected)) {`),i.push("   gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("} else {"),i.push("  vec4 worldPosition = positionsDecodeMatrix * vec4(position, 1.0); "),i.push("  vec4 viewPosition  = viewMatrix * worldPosition; "),t&&(i.push("  vWorldPosition = worldPosition;"),i.push("  vFlags2 = flags2;"));return i.push("  gl_Position = projMatrix * viewPosition;"),i.push("}"),i.push("}"),i}(e),this.fragment=function(e){const t=e.model.scene._sectionPlanesState;let i,r;const o=t.sectionPlanes.length>0,s=[];if(s.push("// Batched geometry edges drawing fragment shader"),s.push("precision mediump float;"),s.push("precision mediump int;"),o)for(s.push("varying vec4 vWorldPosition;"),s.push("varying vec4 vFlags2;"),i=0,r=t.sectionPlanes.length;i<r;i++)s.push("uniform bool sectionPlaneActive"+i+";"),s.push("uniform vec3 sectionPlanePos"+i+";"),s.push("uniform vec3 sectionPlaneDir"+i+";");if(s.push("uniform vec4 color;"),s.push("void main(void) {"),o){for(s.push("  bool clippable = (float(vFlags2.x) > 0.0);"),s.push("  if (clippable) {"),s.push("  float dist = 0.0;"),i=0,r=t.sectionPlanes.length;i<r;i++)s.push("if (sectionPlaneActive"+i+") {"),s.push("   dist += clamp(dot(-sectionPlaneDir"+i+".xyz, vWorldPosition.xyz - sectionPlanePos"+i+".xyz), 0.0, 1000.0);"),s.push("}");s.push("  if (dist > 0.0) { discard; }"),s.push("}")}return s.push("gl_FragColor = color;"),s.push("}"),s}(e)};const Hi=new n({}),Gi=function(e,t){this.id=Hi.addItem({}),this._hash=e,this._scene=t.model.scene,this._useCount=0,this._shaderSource=new Ui(t),this._allocate(t)},Wi={};new Float32Array([1,1,1,1]);function qi(e){return[e.canvas.canvas.id,"",e._sectionPlanesState.getHash()].join(";")}Gi.get=function(e){const t=qi(e.model.scene);let i=Wi[t];if(!i){if((i=new Gi(t,e)).errors)return console.log(i.errors.join("\n")),null;Wi[t]=i,P.memory.programs++}return i._useCount++,i},Gi.prototype.getValid=function(){return this._hash===qi(this._scene)},Gi.prototype.put=function(){0==--this._useCount&&(Hi.removeItem(this.id),this._program&&this._program.destroy(),delete Wi[this._hash],P.memory.programs--)},Gi.prototype.webglContextRestored=function(){this._program=null},Gi.prototype.drawLayer=function(e,t,i){const r=t.model,o=r.scene,s=o.canvas.gl,n=t._state;if(this._program||(this._allocate(t),!this.errors)){if(e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e,t)),i===Ti.XRAYED){const e=o.xrayMaterial._state,t=e.edgeColor,i=e.edgeAlpha;s.uniform4f(this._uColor,t[0],t[1],t[2],i)}else if(i===Ti.HIGHLIGHTED){const e=o.highlightMaterial._state,t=e.edgeColor,i=e.edgeAlpha;s.uniform4f(this._uColor,t[0],t[1],t[2],i)}else if(i===Ti.SELECTED){const e=o.selectedMaterial._state,t=e.edgeColor,i=e.edgeAlpha;s.uniform4f(this._uColor,t[0],t[1],t[2],i)}else{const e=o.edgeMaterial._state,t=e.edgeColor,i=e.edgeAlpha;s.uniform4f(this._uColor,t[0],t[1],t[2],i)}s.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),s.uniformMatrix4fv(this._uViewMatrix,!1,r.viewMatrix),s.uniformMatrix4fv(this._uViewNormalMatrix,!1,r.viewNormalMatrix),s.uniform1i(this._uRenderPass,i),this._aPosition.bindArrayBuffer(n.positionsBuf),e.bindArray++,this._aFlags&&(this._aFlags.bindArrayBuffer(n.flagsBuf),e.bindArray++),this._aFlags2&&(this._aFlags2.bindArrayBuffer(n.flags2Buf),e.bindArray++),n.edgeIndicesBuf.bind(),e.bindArray++,s.drawElements(s.LINES,n.edgeIndicesBuf.numItems,n.edgeIndicesBuf.itemType,0),e.drawElements++}},Gi.prototype._allocate=function(e){var t=e.model.scene;const i=t.canvas.gl,r=t._sectionPlanesState;if(this._program=new De(i,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const o=this._program;this._uColor=o.getLocation("color"),this._uRenderPass=o.getLocation("renderPass"),this._uPositionsDecodeMatrix=o.getLocation("positionsDecodeMatrix"),this._uViewMatrix=o.getLocation("viewMatrix"),this._uProjMatrix=o.getLocation("projMatrix"),this._uSectionPlanes=[];for(var s=0,n=r.sectionPlanes.length;s<n;s++)this._uSectionPlanes.push({active:o.getLocation("sectionPlaneActive"+s),pos:o.getLocation("sectionPlanePos"+s),dir:o.getLocation("sectionPlaneDir"+s)});this._aPosition=o.getAttribute("position"),this._aFlags=o.getAttribute("flags"),this._aFlags2=o.getAttribute("flags2")},Gi.prototype._bindProgram=function(e,t){const i=this._scene,r=i.canvas.gl,o=this._program,s=i._sectionPlanesState;o.bind(),e.useProgram++;const n=i.camera;if(r.uniformMatrix4fv(this._uProjMatrix,!1,n._project._state.matrix),s.sectionPlanes.length>0){const e=i._sectionPlanesState.sectionPlanes;let t,o,s,n,c;for(var a=0,l=this._uSectionPlanes.length;a<l;a++)o=(t=this._uSectionPlanes[a]).active,s=e[a],o&&r.uniform1i(o,s.active),(n=t.pos)&&r.uniform3fv(t.pos,s.pos),(c=t.dir)&&r.uniform3fv(t.dir,s.dir)}};class Xi{constructor(e){this.vertex=function(e){const t=e.model.scene._sectionPlanesState.sectionPlanes.length>0,i=[];i.push("// Batched geometry picking vertex shader"),i.push("attribute vec3 position;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("attribute vec4 pickColor;"),i.push("uniform bool pickInvisible;"),i.push("uniform mat4 viewMatrix;"),i.push("uniform mat4 projMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;"));i.push("varying vec4 vPickColor;"),i.push("void main(void) {"),i.push("  bool visible   = (float(flags.x) > 0.0);"),i.push("  bool pickable  = (float(flags2.z) > 0.0);"),i.push("  if ((!pickInvisible && !visible) || !pickable) {"),i.push("      gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("  } else {"),i.push("      vec4 worldPosition = positionsDecodeMatrix * vec4(position, 1.0); "),i.push("      vec4 viewPosition  = viewMatrix * worldPosition; "),i.push("      vPickColor = vec4(float(pickColor.r) / 255.0, float(pickColor.g) / 255.0, float(pickColor.b) / 255.0, float(pickColor.a) / 255.0);"),t&&(i.push("      vWorldPosition = worldPosition;"),i.push("      vFlags2 = flags2;"));return i.push("      gl_Position = projMatrix * viewPosition;"),i.push("  }"),i.push("}"),i}(e),this.fragment=function(e){const t=e.model.scene._sectionPlanesState,i=t.sectionPlanes.length>0,r=[];if(r.push("// Batched geometry picking fragment shader"),r.push("precision mediump float;"),i){r.push("varying vec4 vWorldPosition;"),r.push("varying vec4 vFlags2;");for(var o=0;o<t.sectionPlanes.length;o++)r.push("uniform bool sectionPlaneActive"+o+";"),r.push("uniform vec3 sectionPlanePos"+o+";"),r.push("uniform vec3 sectionPlaneDir"+o+";")}if(r.push("varying vec4 vPickColor;"),r.push("void main(void) {"),i){r.push("  bool clippable = (float(vFlags2.x) > 0.0);"),r.push("  if (clippable) {"),r.push("      float dist = 0.0;");for(o=0;o<t.sectionPlanes.length;o++)r.push("      if (sectionPlaneActive"+o+") {"),r.push("          dist += clamp(dot(-sectionPlaneDir"+o+".xyz, vWorldPosition.xyz - sectionPlanePos"+o+".xyz), 0.0, 1000.0);"),r.push("      }");r.push("      if (dist > 0.0) { discard; }"),r.push("  }")}return r.push("   gl_FragColor = vPickColor; "),r.push("}"),r}(e)}}const Yi=new n({}),Ki=function(e,t){this.id=Yi.addItem({}),this._hash=e,this._scene=t.model.scene,this._useCount=0,this._shaderSource=new Xi(t),this._allocate(t)},$i={};function Qi(e){return[e.canvas.canvas.id,"",e._sectionPlanesState.getHash()].join(";")}Ki.get=function(e){const t=Qi(e.model.scene);let i=$i[t];if(!i){if((i=new Ki(t,e)).errors)return console.log(i.errors.join("\n")),null;$i[t]=i,P.memory.programs++}return i._useCount++,i},Ki.prototype.getValid=function(){return this._hash===Qi(this._scene)},Ki.prototype.put=function(){0==--this._useCount&&(Yi.removeItem(this.id),this._program&&this._program.destroy(),delete $i[this._hash],P.memory.programs--)},Ki.prototype.webglContextRestored=function(){this._program=null},Ki.prototype.drawLayer=function(e,t){const i=t.model,r=i.scene.canvas.gl,o=t._state;this._program||this._allocate(t),e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e,t)),r.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),r.uniformMatrix4fv(this._uViewMatrix,!1,e.pickViewMatrix?i.getPickViewMatrix(e.pickViewMatrix):i.viewMatrix),this._aPosition.bindArrayBuffer(o.positionsBuf),e.bindArray++,this._aFlags&&(this._aFlags.bindArrayBuffer(o.flagsBuf),e.bindArray++),this._aFlags2&&(this._aFlags2.bindArrayBuffer(o.flags2Buf),e.bindArray++),this._aPickColor&&(this._aPickColor.bindArrayBuffer(o.pickColorsBuf),e.bindArray++),o.indicesBuf.bind(),e.bindArray++,r.drawElements(o.primitive,o.indicesBuf.numItems,o.indicesBuf.itemType,0),e.drawElements++},Ki.prototype._allocate=function(e){var t=e.model.scene;const i=t.canvas.gl,r=t._sectionPlanesState;if(this._program=new De(i,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const o=this._program;this._uPickInvisible=o.getLocation("pickInvisible"),this._uPositionsDecodeMatrix=o.getLocation("positionsDecodeMatrix"),this._uViewMatrix=o.getLocation("viewMatrix"),this._uProjMatrix=o.getLocation("projMatrix"),this._uSectionPlanes=[];for(var s=0,n=r.sectionPlanes.length;s<n;s++)this._uSectionPlanes.push({active:o.getLocation("sectionPlaneActive"+s),pos:o.getLocation("sectionPlanePos"+s),dir:o.getLocation("sectionPlaneDir"+s)});this._aPosition=o.getAttribute("position"),this._aPickColor=o.getAttribute("pickColor"),this._aFlags=o.getAttribute("flags"),this._aFlags2=o.getAttribute("flags2")},Ki.prototype._bindProgram=function(e,t){const i=this._scene,r=i.canvas.gl,o=this._program,s=i._sectionPlanesState,n=i.camera;if(o.bind(),e.useProgram++,r.uniform1i(this._uPickInvisible,e.pickInvisible),r.uniformMatrix4fv(this._uProjMatrix,!1,e.pickProjMatrix||n.project._state.matrix),s.sectionPlanes.length>0){const e=i._sectionPlanesState.sectionPlanes;let t,o,s,n,c;for(var a=0,l=this._uSectionPlanes.length;a<l;a++)o=(t=this._uSectionPlanes[a]).active,s=e[a],o&&r.uniform1i(o,s.active),(n=t.pos)&&r.uniform3fv(t.pos,s.pos),(c=t.dir)&&r.uniform3fv(t.dir,s.dir)}};class Zi{constructor(e){this.vertex=function(e){const t=e.model.scene._sectionPlanesState.sectionPlanes.length>0,i=[];i.push("// Batched geometry depth vertex shader"),i.push("attribute vec3 position;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("uniform bool pickInvisible;"),i.push("uniform mat4 viewMatrix;"),i.push("uniform mat4 projMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;"));i.push("varying vec4 vViewPosition;"),i.push("void main(void) {"),i.push("  bool visible   = (float(flags.x) > 0.0);"),i.push("  bool pickable  = (float(flags2.z) > 0.0);"),i.push("  if ((!pickInvisible && !visible) || !pickable) {"),i.push("      gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("  } else {"),i.push("      vec4 worldPosition = positionsDecodeMatrix * vec4(position, 1.0); "),i.push("      vec4 viewPosition  = viewMatrix * worldPosition; "),t&&(i.push("      vWorldPosition = worldPosition;"),i.push("      vFlags2 = flags2;"));return i.push("      vViewPosition = viewPosition;"),i.push("      gl_Position = projMatrix * viewPosition;"),i.push("  }"),i.push("}"),i}(e),this.fragment=function(e){const t=e.model.scene._sectionPlanesState,i=t.sectionPlanes.length>0,r=[];if(r.push("// Batched geometry depth fragment shader"),r.push("precision highp float;"),r.push("uniform float zNear;"),r.push("uniform float zFar;"),i){r.push("varying vec4 vWorldPosition;"),r.push("varying vec4 vFlags2;");for(var o=0;o<t.sectionPlanes.length;o++)r.push("uniform bool sectionPlaneActive"+o+";"),r.push("uniform vec3 sectionPlanePos"+o+";"),r.push("uniform vec3 sectionPlaneDir"+o+";")}if(r.push("varying vec4 vViewPosition;"),r.push("vec4 packDepth(const in float depth) {"),r.push("  const vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);"),r.push("  const vec4 bitMask  = vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);"),r.push("  vec4 res = fract(depth * bitShift);"),r.push("  res -= res.xxyz * bitMask;"),r.push("  return res;"),r.push("}"),r.push("void main(void) {"),i){r.push("  bool clippable = (float(vFlags2.x) > 0.0);"),r.push("  if (clippable) {"),r.push("      float dist = 0.0;");for(o=0;o<t.sectionPlanes.length;o++)r.push("      if (sectionPlaneActive"+o+") {"),r.push("          dist += clamp(dot(-sectionPlaneDir"+o+".xyz, vWorldPosition.xyz - sectionPlanePos"+o+".xyz), 0.0, 1000.0);"),r.push("      }");r.push("      if (dist > 0.0) { discard; }"),r.push("  }")}return r.push("    float zNormalizedDepth = abs((zNear + vViewPosition.z) / (zFar - zNear));"),r.push("    gl_FragColor = packDepth(zNormalizedDepth); "),r.push("}"),r}(e)}}const Ji=new n({}),er=function(e,t){this.id=Ji.addItem({}),this._hash=e,this._scene=t.model.scene,this._useCount=0,this._shaderSource=new Zi(t),this._allocate(t)},tr={};function ir(e){return[e.canvas.canvas.id,"",e._sectionPlanesState.getHash()].join(";")}er.get=function(e){const t=ir(e.model.scene);let i=tr[t];if(!i){if((i=new er(t,e)).errors)return console.log(i.errors.join("\n")),null;tr[t]=i,P.memory.programs++}return i._useCount++,i},er.prototype.getValid=function(){return this._hash===ir(this._scene)},er.prototype.put=function(){0==--this._useCount&&(Ji.removeItem(this.id),this._program&&this._program.destroy(),delete tr[this._hash],P.memory.programs--)},er.prototype.webglContextRestored=function(){this._program=null},er.prototype.drawLayer=function(e,t){const i=t.model,r=i.scene,o=r.canvas.gl,s=t._state,n=r.camera.project._state;this._program||this._allocate(t),e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e,t)),o.uniform1i(this._uPickInvisible,e.pickInvisible),o.uniformMatrix4fv(this._uViewMatrix,!1,e.pickViewMatrix?i.getPickViewMatrix(e.pickViewMatrix):i.viewMatrix),o.uniformMatrix4fv(this._uProjMatrix,!1,e.pickProjMatrix),o.uniform1f(this._uZNear,n.near),o.uniform1f(this._uZFar,n.far),o.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),this._aPosition.bindArrayBuffer(s.positionsBuf),e.bindArray++,this._aFlags&&(this._aFlags.bindArrayBuffer(s.flagsBuf),e.bindArray++),this._aFlags2&&(this._aFlags2.bindArrayBuffer(s.flags2Buf),e.bindArray++),s.indicesBuf.bind(),e.bindArray++,o.drawElements(s.primitive,s.indicesBuf.numItems,s.indicesBuf.itemType,0),e.drawElements++},er.prototype._allocate=function(e){var t=e.model.scene;const i=t.canvas.gl,r=t._sectionPlanesState;if(this._program=new De(i,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const o=this._program;this._uPickInvisible=o.getLocation("pickInvisible"),this._uPositionsDecodeMatrix=o.getLocation("positionsDecodeMatrix"),this._uViewMatrix=o.getLocation("viewMatrix"),this._uProjMatrix=o.getLocation("projMatrix"),this._uSectionPlanes=[];for(var s=0,n=r.sectionPlanes.length;s<n;s++)this._uSectionPlanes.push({active:o.getLocation("sectionPlaneActive"+s),pos:o.getLocation("sectionPlanePos"+s),dir:o.getLocation("sectionPlaneDir"+s)});this._aPosition=o.getAttribute("position"),this._aFlags=o.getAttribute("flags"),this._aFlags2=o.getAttribute("flags2"),this._uZNear=o.getLocation("zNear"),this._uZFar=o.getLocation("zFar")},er.prototype._bindProgram=function(e){const t=this._scene,i=t.canvas.gl,r=this._program,o=t._sectionPlanesState;t.camera;if(r.bind(),e.useProgram++,o.sectionPlanes.length>0){const e=t._sectionPlanesState.sectionPlanes;let r,o,a,l,c;for(var s=0,n=this._uSectionPlanes.length;s<n;s++)o=(r=this._uSectionPlanes[s]).active,a=e[s],o&&i.uniform1i(o,a.active),(l=r.pos)&&i.uniform3fv(r.pos,a.pos),(c=r.dir)&&i.uniform3fv(r.dir,a.dir)}};class rr{constructor(e){this.vertex=function(e){const t=e.model.scene._sectionPlanesState.sectionPlanes.length>0,i=[];i.push("// Batched geometry normals vertex shader"),i.push("attribute vec3 position;"),i.push("attribute vec3 normal;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("uniform bool pickInvisible;"),i.push("uniform mat4 viewMatrix;"),i.push("uniform mat4 projMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),i.push("vec3 octDecode(vec2 oct) {"),i.push("    vec3 v = vec3(oct.xy, 1.0 - abs(oct.x) - abs(oct.y));"),i.push("    if (v.z < 0.0) {"),i.push("        v.xy = (1.0 - abs(v.yx)) * vec2(v.x >= 0.0 ? 1.0 : -1.0, v.y >= 0.0 ? 1.0 : -1.0);"),i.push("    }"),i.push("    return normalize(v);"),i.push("}"),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;"));i.push("varying vec3 vWorldNormal;"),i.push("void main(void) {"),i.push("  bool visible   = (float(flags.x) > 0.0);"),i.push("  bool pickable  = (float(flags2.z) > 0.0);"),i.push("  if ((!pickInvisible && !visible) || !pickable) {"),i.push("      gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("  } else {"),i.push("      vec4 worldPosition = positionsDecodeMatrix * vec4(position, 1.0); "),i.push("      vec4 viewPosition  = viewMatrix * worldPosition; "),i.push("      vec3 worldNormal =  octDecode(normal.xy); "),i.push("      vWorldNormal = worldNormal;"),t&&(i.push("      vWorldPosition = worldPosition;"),i.push("      vFlags2 = flags2;"));return i.push("      gl_Position = projMatrix * viewPosition;"),i.push("  }"),i.push("}"),i}(e),this.fragment=function(e){const t=e.model.scene._sectionPlanesState,i=t.sectionPlanes.length>0,r=[];if(r.push("// Batched geometry normals fragment shader"),r.push("precision highp float;"),i){r.push("varying vec4 vWorldPosition;"),r.push("varying vec4 vFlags2;");for(var o=0;o<t.sectionPlanes.length;o++)r.push("uniform bool sectionPlaneActive"+o+";"),r.push("uniform vec3 sectionPlanePos"+o+";"),r.push("uniform vec3 sectionPlaneDir"+o+";")}if(r.push("varying vec3 vWorldNormal;"),r.push("void main(void) {"),i){r.push("  bool clippable = (float(vFlags2.x) > 0.0);"),r.push("  if (clippable) {"),r.push("      float dist = 0.0;");for(o=0;o<t.sectionPlanes.length;o++)r.push("      if (sectionPlaneActive"+o+") {"),r.push("          dist += clamp(dot(-sectionPlaneDir"+o+".xyz, vWorldPosition.xyz - sectionPlanePos"+o+".xyz), 0.0, 1000.0);"),r.push("      }");r.push("      if (dist > 0.0) { discard; }"),r.push("  }")}return r.push("    gl_FragColor = vec4((vWorldNormal * 0.5) + 0.5, 1.0);"),r.push("}"),r}(e)}}const or=new n({}),sr=function(e,t){this.id=or.addItem({}),this._hash=e,this._scene=t.model.scene,this._useCount=0,this._shaderSource=new rr(t),this._allocate(t)},nr={};function ar(e){return[e.canvas.canvas.id,"",e._sectionPlanesState.getHash()].join(";")}sr.get=function(e){const t=ar(e.model.scene);let i=nr[t];if(!i){if((i=new sr(t,e)).errors)return console.log(i.errors.join("\n")),null;nr[t]=i,P.memory.programs++}return i._useCount++,i},sr.prototype.getValid=function(){return this._hash===ar(this._scene)},sr.prototype.put=function(){0==--this._useCount&&(or.removeItem(this.id),this._program&&this._program.destroy(),delete nr[this._hash],P.memory.programs--)},sr.prototype.webglContextRestored=function(){this._program=null},sr.prototype.drawLayer=function(e,t){const i=t.model,r=i.scene.canvas.gl,o=t._state;this._program||this._allocate(t),e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e,t)),r.uniform1i(this._uPickInvisible,e.pickInvisible),r.uniformMatrix4fv(this._uViewMatrix,!1,e.pickViewMatrix?i.getPickViewMatrix(e.pickViewMatrix):i.viewMatrix),r.uniformMatrix4fv(this._uProjMatrix,!1,e.pickProjMatrix),r.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),this._aPosition.bindArrayBuffer(o.positionsBuf),e.bindArray++,this._aNormal&&(this._aNormal.bindArrayBuffer(o.normalsBuf),e.bindArray++),this._aFlags&&(this._aFlags.bindArrayBuffer(o.flagsBuf),e.bindArray++),this._aFlags2&&(this._aFlags2.bindArrayBuffer(o.flags2Buf),e.bindArray++),o.indicesBuf.bind(),e.bindArray++,r.drawElements(o.primitive,o.indicesBuf.numItems,o.indicesBuf.itemType,0),e.drawElements++},sr.prototype._allocate=function(e){var t=e.model.scene;const i=t.canvas.gl,r=t._sectionPlanesState;if(this._program=new De(i,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const o=this._program;this._uPickInvisible=o.getLocation("pickInvisible"),this._uPositionsDecodeMatrix=o.getLocation("positionsDecodeMatrix"),this._uViewMatrix=o.getLocation("viewMatrix"),this._uProjMatrix=o.getLocation("projMatrix"),this._uSectionPlanes=[];for(var s=0,n=r.sectionPlanes.length;s<n;s++)this._uSectionPlanes.push({active:o.getLocation("sectionPlaneActive"+s),pos:o.getLocation("sectionPlanePos"+s),dir:o.getLocation("sectionPlaneDir"+s)});this._aPosition=o.getAttribute("position"),this._aNormal=o.getAttribute("normal"),this._aFlags=o.getAttribute("flags"),this._aFlags2=o.getAttribute("flags2")},sr.prototype._bindProgram=function(e,t){const i=this._scene,r=i.canvas.gl,o=this._program,s=i._sectionPlanesState;i.camera;if(o.bind(),e.useProgram++,s.sectionPlanes.length>0){const e=i._sectionPlanesState.sectionPlanes;let t,o,s,l,c;for(var n=0,a=this._uSectionPlanes.length;n<a;n++)o=(t=this._uSectionPlanes[n]).active,s=e[n],o&&r.uniform1i(o,s.active),(l=t.pos)&&r.uniform3fv(t.pos,s.pos),(c=t.dir)&&r.uniform3fv(t.dir,s.dir)}};class lr{constructor(e){this.vertex=function(e){const t=e.model.scene._sectionPlanesState.sectionPlanes.length>0,i=[];i.push("// Batched occlusion vertex shader"),i.push("attribute vec3 position;"),i.push("attribute vec4 color;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("uniform mat4 viewMatrix;"),i.push("uniform mat4 projMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;"));i.push("void main(void) {"),i.push("  bool visible   = (float(flags.x) > 0.0);"),i.push("  bool transparent  = ((float(color.a) / 255.0) < 1.0);"),i.push("  if (!visible || transparent) {"),i.push("      gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("  } else {"),i.push("      vec4 worldPosition = positionsDecodeMatrix * vec4(position, 1.0); "),i.push("      vec4 viewPosition  = viewMatrix * worldPosition; "),t&&(i.push("      vWorldPosition = worldPosition;"),i.push("      vFlags2 = flags2;"));return i.push("      gl_Position = projMatrix * viewPosition;"),i.push("  }"),i.push("}"),i}(e),this.fragment=function(e){const t=e.model.scene._sectionPlanesState,i=t.sectionPlanes.length>0,r=[];if(r.push("// Batched occlusion fragment shader"),r.push("precision mediump float;"),i){r.push("varying vec4 vWorldPosition;"),r.push("varying vec4 vFlags2;");for(var o=0;o<t.sectionPlanes.length;o++)r.push("uniform bool sectionPlaneActive"+o+";"),r.push("uniform vec3 sectionPlanePos"+o+";"),r.push("uniform vec3 sectionPlaneDir"+o+";")}if(r.push("void main(void) {"),i){r.push("  bool clippable = (float(vFlags2.x) > 0.0);"),r.push("  if (clippable) {"),r.push("      float dist = 0.0;");for(o=0;o<t.sectionPlanes.length;o++)r.push("      if (sectionPlaneActive"+o+") {"),r.push("          dist += clamp(dot(-sectionPlaneDir"+o+".xyz, vWorldPosition.xyz - sectionPlanePos"+o+".xyz), 0.0, 1000.0);"),r.push("      }");r.push("      if (dist > 0.0) { discard; }"),r.push("  }")}return r.push("   gl_FragColor = vec4(0.0, 0.0, 1.0, 1.0); "),r.push("}"),r}(e)}}const cr=new n({}),hr=function(e,t){this.id=cr.addItem({}),this._hash=e,this._scene=t.model.scene,this._useCount=0,this._shaderSource=new lr(t),this._allocate(t)},dr={};function ur(e){return[e.canvas.canvas.id,"",e._sectionPlanesState.getHash()].join(";")}hr.get=function(e){const t=ur(e.model.scene);let i=dr[t];if(!i){if((i=new hr(t,e)).errors)return console.log(i.errors.join("\n")),null;dr[t]=i,P.memory.programs++}return i._useCount++,i},hr.prototype.getValid=function(){return this._hash===ur(this._scene)},hr.prototype.put=function(){0==--this._useCount&&(cr.removeItem(this.id),this._program&&this._program.destroy(),delete dr[this._hash],P.memory.programs--)},hr.prototype.webglContextRestored=function(){this._program=null},hr.prototype.drawLayer=function(e,t){const i=t.model,r=i.scene,o=r.canvas.gl,s=t._state,n=r.camera;this._program||this._allocate(t),e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e,t)),o.uniformMatrix4fv(this._uViewMatrix,!1,i.viewMatrix),o.uniformMatrix4fv(this._uProjMatrix,!1,n._project._state.matrix),o.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),this._aPosition.bindArrayBuffer(s.positionsBuf),this._aColor&&this._aColor.bindArrayBuffer(s.colorsBuf),this._aFlags.bindArrayBuffer(s.flagsBuf),this._aFlags2&&this._aFlags2.bindArrayBuffer(s.flags2Buf),s.indicesBuf.bind(),e.bindArray+=5,o.drawElements(s.primitive,s.indicesBuf.numItems,s.indicesBuf.itemType,0),e.drawElements++},hr.prototype._allocate=function(e){var t=e.model.scene;const i=t.canvas.gl,r=t._sectionPlanesState;if(this._program=new De(i,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const o=this._program;this._uPositionsDecodeMatrix=o.getLocation("positionsDecodeMatrix"),this._uViewMatrix=o.getLocation("viewMatrix"),this._uProjMatrix=o.getLocation("projMatrix"),this._uSectionPlanes=[];for(var s=0,n=r.sectionPlanes.length;s<n;s++)this._uSectionPlanes.push({active:o.getLocation("sectionPlaneActive"+s),pos:o.getLocation("sectionPlanePos"+s),dir:o.getLocation("sectionPlaneDir"+s)});this._aPosition=o.getAttribute("position"),this._aColor=o.getAttribute("color"),this._aFlags=o.getAttribute("flags"),this._aFlags2=o.getAttribute("flags2")},hr.prototype._bindProgram=function(e){const t=this._scene,i=t.canvas.gl,r=this._program,o=t._sectionPlanesState;if(r.bind(),e.useProgram++,o.sectionPlanes.length>0){const e=t._sectionPlanesState.sectionPlanes;let r,o,a,l,c;for(var s=0,n=this._uSectionPlanes.length;s<n;s++)o=(r=this._uSectionPlanes[s]).active,a=e[s],o&&i.uniform1i(o,a.active),(l=r.pos)&&i.uniform3fv(r.pos,a.pos),(c=r.dir)&&i.uniform3fv(r.dir,a.dir)}};const pr=q.SUPPORTED_EXTENSIONS.OES_element_index_uint,mr=new Uint8Array(4*(pr?5e6:65530)),fr=u.mat4(),gr=u.mat4(),br=u.vec4([0,0,0,1]),_r=u.vec4([0,0,0,1]),vr=u.vec4([0,0,0,1]);var xr=u.OBB3();class yr{constructor(e,t){this.model=e,this._buffer=t.buffer;var i,r=t.primitive||"triangles";const o=e.scene.canvas.gl;switch(r){case"points":i=o.POINTS;break;case"lines":i=o.LINES;break;case"line-loop":i=o.LINE_LOOP;break;case"line-strip":i=o.LINE_STRIP;break;case"triangles":i=o.TRIANGLES;break;case"triangle-strip":i=o.TRIANGLE_STRIP;break;case"triangle-fan":i=o.TRIANGLE_FAN;break;default:throw`Unsupported value for 'primitive': '${r}' - supported values are 'points', 'lines', 'line-loop', 'line-strip', 'triangles', 'triangle-strip' and 'triangle-fan'. Defaulting to 'triangles'.`}this._state=new j({primitiveName:r,primitive:i,positionsBuf:null,normalsBuf:null,colorsbuf:null,flagsBuf:null,flags2Buf:null,indicesBuf:null,edgeIndicesBuf:null,positionsDecodeMatrix:u.mat4()}),this._numPortions=0,this._numVisibleLayerPortions=0,this._numTransparentLayerPortions=0,this._numXRayedLayerPortions=0,this._numSelectedLayerPortions=0,this._numHighlightedLayerPortions=0,this._numEdgesLayerPortions=0,this._numPickableLayerPortions=0,this._modelAABB=u.collapseAABB3(),this._portions=[],this._finalized=!1,this._preCompressed=!!t.preCompressed,this._positionsDecodeMatrix=t.positionsDecodeMatrix,this.compileShaders()}canCreatePortion(e){if(this._finalized)throw"Already finalized";return(!this._finalized&&this._buffer.lenPositions+e)<3*this._buffer.maxVerts}createPortion(e,t,i,r,o,s,n,a,l,c,h){if(this._finalized)throw"Already finalized";const d=this._buffer,p=d.lenPositions/3,m=e.length/3,f=e.length;if(this._preCompressed){d.positions.set(e,d.lenPositions),d.lenPositions+=f;const t=J.getPositionsBounds(e),i=J.decompressPosition(t.min,this._positionsDecodeMatrix,[]),r=J.decompressPosition(t.max,this._positionsDecodeMatrix,[]);c[0]=i[0],c[1]=i[1],c[2]=i[2],c[3]=r[0],c[4]=r[1],c[5]=r[2],l&&(u.AABB3ToOBB3(c,xr),u.transformOBB3(l,xr),u.OBB3ToAABB3(xr,c))}else{if(d.positions.set(e,d.lenPositions),a)for(let e=d.lenPositions,t=d.lenPositions+f;e<t;e+=3)br[0]=d.positions[e+0],br[1]=d.positions[e+1],br[2]=d.positions[e+2],u.transformPoint4(a,br,_r),d.positions[e+0]=_r[0],d.positions[e+1]=_r[1],d.positions[e+2]=_r[2],u.expandAABB3Point3(this._modelAABB,_r),l?(u.transformPoint4(l,_r,vr),u.expandAABB3Point3(c,vr)):u.expandAABB3Point3(c,_r);else for(let e=d.lenPositions,t=d.lenPositions+f;e<t;e+=3)br[0]=d.positions[e+0],br[1]=d.positions[e+1],br[2]=d.positions[e+2],u.expandAABB3Point3(this._modelAABB,br),l?(u.transformPoint4(l,br,_r),u.expandAABB3Point3(c,_r)):u.expandAABB3Point3(c,br);d.lenPositions+=f}if(t)if(this._preCompressed)d.normals.set(t,d.lenNormals),d.lenNormals+=t.length;else{var g=fr;a?u.inverseMat4(u.transposeMat4(a,gr),g):u.identityMat4(g,g),d.lenNormals=function(e,t,i,r,o){let s,n,a,l,c,h,d=new Float32Array([0,0,0,0]),p=new Float32Array([0,0,0,0]);for(h=0;h<i;h+=3)d[0]=t[h],d[1]=t[h+1],d[2]=t[h+2],u.transformVec3(e,d,p),u.normalizeVec3(p,p),a=s=Mr(p,"floor","floor"),n=kr(s),l=c=Pr(p,n),s=Mr(p,"ceil","floor"),n=kr(s),(l=Pr(p,n))>c&&(a=s,c=l),s=Mr(p,"floor","ceil"),n=kr(s),(l=Pr(p,n))>c&&(a=s,c=l),s=Mr(p,"ceil","ceil"),n=kr(s),(l=Pr(p,n))>c&&(a=s,c=l),r[o+h+0]=a[0],r[o+h+1]=a[1],r[o+h+2]=0;return o+=i}(g,t,t.length,d.normals,d.lenNormals)}if(void 0!==o){const e=4*m,t=o&xi.VISIBLE?255:0,i=o&xi.XRAYED?255:0,r=o&xi.HIGHLIGHTED?255:0,s=o&xi.SELECTED?255:0,n=o&xi.CLIPPABLE?255:0,a=o&xi.EDGES?255:0,l=o&xi.PICKABLE?255:0;for(var b=d.lenFlags,_=d.lenFlags+e;b<_;b+=4)d.flags[b+0]=t,d.flags[b+1]=i,d.flags[b+2]=r,d.flags[b+3]=s,d.flags2[b+0]=n,d.flags2[b+1]=a,d.flags2[b+2]=l;d.lenFlags+=e,t&&(this._numVisibleLayerPortions++,this.model.numVisibleLayerPortions++),i&&(this._numXRayedLayerPortions++,this.model.numXRayedLayerPortions++),r&&(this._numHighlightedLayerPortions++,this.model.numHighlightedLayerPortions++),s&&(this._numSelectedLayerPortions++,this.model.numSelectedLayerPortions++),a&&(this._numEdgesLayerPortions++,this.model.numEdgesLayerPortions++),l&&(this._numPickableLayerPortions++,this.model.numPickableLayerPortions++)}if(s){const e=4*m,t=s[0],i=s[1],r=s[2],o=n;for(b=d.lenColors,_=d.lenColors+e;b<_;b+=4)d.colors[b+0]=t,d.colors[b+1]=i,d.colors[b+2]=r,d.colors[b+3]=n;d.lenColors+=e,o<255&&(this._numTransparentLayerPortions++,this.model.numTransparentLayerPortions++)}if(i){for(b=0,_=i.length;b<_;b++)d.indices[d.lenIndices+b]=i[b]+p;d.lenIndices+=i.length}if(r){for(b=0,_=r.length;b<_;b++)d.edgeIndices[d.lenEdgeIndices+b]=r[b]+p;d.lenEdgeIndices+=r.length}{const e=4*m;for(b=d.lenPickColors,_=d.lenPickColors+e;b<_;b+=4)d.pickColors[b+0]=h[0],d.pickColors[b+1]=h[1],d.pickColors[b+2]=h[2],d.pickColors[b+3]=h[3];d.lenPickColors+=e}var v=this._portions.length/2;return this._portions.push(p),this._portions.push(m),this._numPortions++,this.model.numPortions++,v}finalize(){if(this._finalized)return void this.error("Already finalized");const e=this._state,t=this.model.scene.canvas.gl,i=this._buffer;if(this._preCompressed?(e.positionsDecodeMatrix=this._positionsDecodeMatrix,e.positionsBuf=new W(t,t.ARRAY_BUFFER,i.positions,i.lenPositions,3,t.STATIC_DRAW)):(wr(i.positions,i.lenPositions,this._modelAABB,i.quantizedPositions,e.positionsDecodeMatrix),i.lenPositions>0&&(e.positionsBuf=new W(t,t.ARRAY_BUFFER,i.quantizedPositions.slice(0,i.lenPositions),i.lenPositions,3,t.STATIC_DRAW))),i.lenNormals>0){let r=!0;e.normalsBuf=new W(t,t.ARRAY_BUFFER,i.normals.slice(0,i.lenNormals),i.lenNormals,3,t.STATIC_DRAW,r)}if(i.lenColors>0){let r=!1;e.colorsBuf=new W(t,t.ARRAY_BUFFER,i.colors.slice(0,i.lenColors),i.lenColors,4,t.DYNAMIC_DRAW,r)}if(i.lenFlags>0){let r=!0;e.flagsBuf=new W(t,t.ARRAY_BUFFER,i.flags.slice(0,i.lenFlags),i.lenFlags,4,t.DYNAMIC_DRAW,r),e.flags2Buf=new W(t,t.ARRAY_BUFFER,i.flags2.slice(0,i.lenFlags),i.lenFlags,4,t.DYNAMIC_DRAW,r)}if(i.lenPickColors>0){let r=!1;e.pickColorsBuf=new W(t,t.ARRAY_BUFFER,i.pickColors.slice(0,i.lenPickColors),i.lenPickColors,4,t.STATIC_DRAW,r)}i.lenIndices>0&&(e.indicesBuf=new W(t,t.ELEMENT_ARRAY_BUFFER,i.indices.slice(0,i.lenIndices),i.lenIndices,1,t.STATIC_DRAW)),i.lenEdgeIndices>0&&(e.edgeIndicesBuf=new W(t,t.ELEMENT_ARRAY_BUFFER,i.edgeIndices.slice(0,i.lenEdgeIndices),i.lenEdgeIndices,1,t.STATIC_DRAW)),i.lenPositions=0,i.lenColors=0,i.lenNormals=0,i.lenFlags=0,i.lenPickColors=0,i.lenIndices=0,i.lenEdgeIndices=0,this._buffer=null,this._finalized=!0}initFlags(e,t){t&xi.VISIBLE&&(this._numVisibleLayerPortions++,this.model.numVisibleLayerPortions++),t&xi.HIGHLIGHTED&&(this._numHighlightedLayerPortions++,this.model.numHighlightedLayerPortions++),t&xi.XRAYED&&(this._numXRayedLayerPortions++,this.model.numXRayedLayerPortions++),t&xi.SELECTED&&(this._numSelectedLayerPortions++,this.model.numSelectedLayerPortions++),t&xi.EDGES&&(this._numEdgesLayerPortions++,this.model.numEdgesLayerPortions++),t&xi.PICKABLE&&(this._numPickableLayerPortions++,this.model.numPickableLayerPortions++),this._setFlags(e,t),this._setFlags2(e,t)}setVisible(e,t){if(!this._finalized)throw"Not finalized";t&xi.VISIBLE?(this._numVisibleLayerPortions++,this.model.numVisibleLayerPortions++):(this._numVisibleLayerPortions--,this.model.numVisibleLayerPortions--),this._setFlags(e,t)}setHighlighted(e,t){if(!this._finalized)throw"Not finalized";t&xi.HIGHLIGHTED?(this._numHighlightedLayerPortions++,this.model.numHighlightedLayerPortions++):(this._numHighlightedLayerPortions--,this.model.numHighlightedLayerPortions--),this._setFlags(e,t)}setXRayed(e,t){if(!this._finalized)throw"Not finalized";t&xi.XRAYED?(this._numXRayedLayerPortions++,this.model.numXRayedLayerPortions++):(this._numXRayedLayerPortions--,this.model.numXRayedLayerPortions--),this._setFlags(e,t)}setSelected(e,t){if(!this._finalized)throw"Not finalized";t&xi.SELECTED?(this._numSelectedLayerPortions++,this.model.numSelectedLayerPortions++):(this._numSelectedLayerPortions--,this.model.numSelectedLayerPortions--),this._setFlags(e,t)}setEdges(e,t){if(!this._finalized)throw"Not finalized";t&xi.EDGES?(this._numEdgesLayerPortions++,this.model.numEdgesLayerPortions++):(this._numEdgesLayerPortions--,this.model.numEdgesLayerPortions--),this._setFlags2(e,t)}setClippable(e,t){if(!this._finalized)throw"Not finalized";this._setFlags2(e,t)}setCollidable(e,t){if(!this._finalized)throw"Not finalized"}setPickable(e,t){if(!this._finalized)throw"Not finalized";t&xi.PICKABLE?(this._numPickableLayerPortions++,this.model.numPickableLayerPortions++):(this._numPickableLayerPortions--,this.model.numPickableLayerPortions--),this._setFlags2(e,t)}setColor(e,t,i=!1){if(!this._finalized)throw"Not finalized";var r=2*e,o=4*this._portions[r],s=4*this._portions[r+1];const n=t[0],a=t[1],l=t[2],c=t[3];for(var h=0;h<s;h+=4)mr[h+0]=n,mr[h+1]=a,mr[h+2]=l,mr[h+3]=c;if(i){t[3]<255?(this._numTransparentLayerPortions++,this.model.numTransparentLayerPortions++):(this._numTransparentLayerPortions--,this.model.numTransparentLayerPortions--)}this._state.colorsBuf.setData(mr.slice(0,s),o,s)}_setFlags(e,t){if(!this._finalized)throw"Not finalized";for(var i=2*e,r=4*this._portions[i],o=4*this._portions[i+1],s=t&xi.VISIBLE?255:0,n=t&xi.XRAYED?255:0,a=t&xi.HIGHLIGHTED?255:0,l=t&xi.SELECTED?255:0,c=0;c<o;c+=4)mr[c+0]=s,mr[c+1]=n,mr[c+2]=a,mr[c+3]=l;this._state.flagsBuf.setData(mr.slice(0,o),r,o)}_setFlags2(e,t){if(!this._finalized)throw"Not finalized";for(var i=2*e,r=4*this._portions[i],o=4*this._portions[i+1],s=t&xi.CLIPPABLE?255:0,n=t&xi.EDGES?255:0,a=t&xi.PICKABLE?255:0,l=0;l<o;l+=4)mr[l+0]=s,mr[l+1]=n,mr[l+2]=a;this._state.flags2Buf.setData(mr.slice(0,o),r,o)}drawNormalFillOpaque(e){0!==this._numVisibleLayerPortions&&this._numTransparentLayerPortions!==this._numPortions&&this._numXRayedLayerPortions!==this._numPortions&&this._drawRenderer&&this._drawRenderer.drawLayer(e,this,Ti.NORMAL_OPAQUE)}drawNormalEdgesOpaque(e){0!==this._numVisibleLayerPortions&&0!==this._numEdgesLayerPortions&&this._edgesRenderer&&this._edgesRenderer.drawLayer(e,this,Ti.NORMAL_OPAQUE)}drawNormalFillTransparent(e){0!==this._numVisibleLayerPortions&&0!==this._numTransparentLayerPortions&&this._numXRayedLayerPortions!==this._numPortions&&this._drawRenderer&&this._drawRenderer.drawLayer(e,this,Ti.NORMAL_TRANSPARENT)}drawNormalTransparentEdges(e){0!==this._numVisibleLayerPortions&&0!==this._numEdgesLayerPortions&&0!==this._numTransparentLayerPortions&&this._edgesRenderer&&this._edgesRenderer.drawLayer(e,this,Ti.NORMAL_TRANSPARENT)}drawXRayedFillOpaque(e){0!==this._numVisibleLayerPortions&&0!==this._numXRayedLayerPortions&&this._fillRenderer&&this._fillRenderer.drawLayer(e,this,Ti.XRAYED)}drawXRayedEdgesOpaque(e){0!==this._numVisibleLayerPortions&&0!==this._numXRayedLayerPortions&&this._edgesRenderer&&this._edgesRenderer.drawLayer(e,this,Ti.XRAYED)}drawXRayedFillTransparent(e){0!==this._numVisibleLayerPortions&&0!==this._numXRayedLayerPortions&&this._fillRenderer&&this._fillRenderer.drawLayer(e,this,Ti.XRAYED)}drawXRayedEdgesTransparent(e){0!==this._numVisibleLayerPortions&&0!==this._numXRayedLayerPortions&&this._edgesRenderer&&this._edgesRenderer.drawLayer(e,this,Ti.XRAYED)}drawHighlightedFillOpaque(e){0!==this._numVisibleLayerPortions&&0!==this._numHighlightedLayerPortions&&this._fillRenderer&&this._fillRenderer.drawLayer(e,this,Ti.HIGHLIGHTED)}drawHighlightedEdgesOpaque(e){0!==this._numVisibleLayerPortions&&0!==this._numHighlightedLayerPortions&&this._edgesRenderer&&this._edgesRenderer.drawLayer(e,this,Ti.HIGHLIGHTED)}drawHighlightedFillTransparent(e){0!==this._numVisibleLayerPortions&&0!==this._numHighlightedLayerPortions&&this._fillRenderer&&this._fillRenderer.drawLayer(e,this,Ti.HIGHLIGHTED)}drawHighlightedEdgesTransparent(e){0!==this._numVisibleLayerPortions&&0!==this._numHighlightedLayerPortions&&this._edgesRenderer&&this._edgesRenderer.drawLayer(e,this,Ti.HIGHLIGHTED)}drawSelectedFillOpaque(e){0!==this._numVisibleLayerPortions&&0!==this._numSelectedLayerPortions&&this._fillRenderer&&this._fillRenderer.drawLayer(e,this,Ti.SELECTED)}drawSelectedEdgesOpaque(e){0!==this._numVisibleLayerPortions&&0!==this._numSelectedLayerPortions&&this._edgesRenderer&&this._edgesRenderer.drawLayer(e,this,Ti.SELECTED)}drawSelectedFillTransparent(e){0!==this._numVisibleLayerPortions&&0!==this._numSelectedLayerPortions&&this._fillRenderer&&this._fillRenderer.drawLayer(e,this,Ti.SELECTED)}drawSelectedEdgesTransparent(e){0!==this._numVisibleLayerPortions&&0!==this._numSelectedLayerPortions&&this._edgesRenderer&&this._edgesRenderer.drawLayer(e,this,Ti.SELECTED)}drawPickMesh(e){0!==this._numVisibleLayerPortions&&this._pickMeshRenderer&&this._pickMeshRenderer.drawLayer(e,this)}drawPickDepths(e){0!==this._numVisibleLayerPortions&&this._pickDepthRenderer&&this._pickDepthRenderer.drawLayer(e,this)}drawPickNormals(e){0!==this._numVisibleLayerPortions&&this._pickNormalsRenderer&&this._pickNormalsRenderer.drawLayer(e,this)}drawOcclusion(e){0!==this._numVisibleLayerPortions&&(this._occlusionRenderer||(this._occlusionRenderer=hr.get(this)),this._occlusionRenderer&&this._occlusionRenderer.drawLayer(e,this))}compileShaders(){this._drawRenderer&&!1===this._drawRenderer.getValid()&&(this._drawRenderer.put(),this._drawRenderer=null),this._fillRenderer&&!1===this._fillRenderer.getValid()&&(this._fillRenderer.put(),this._fillRenderer=null),this._edgesRenderer&&!1===this._edgesRenderer.getValid()&&(this._edgesRenderer.put(),this._edgesRenderer=null),this._pickMeshRenderer&&!1===this._pickMeshRenderer.getValid()&&(this._pickMeshRenderer.put(),this._pickMeshRenderer=null),this._pickDepthRenderer&&!1===this._pickDepthRenderer.getValid()&&(this._pickDepthRenderer.put(),this._pickDepthRenderer=null),this._pickNormalsRenderer&&!1===this._pickNormalsRenderer.getValid()&&(this._pickNormalsRenderer.put(),this._pickNormalsRenderer=null),this._occlusionRenderer&&!1===this._occlusionRenderer.getValid()&&(this._occlusionRenderer.put(),this._occlusionRenderer=null),this._drawRenderer||(this._drawRenderer=Li.get(this)),this._fillRenderer||(this._fillRenderer=Oi.get(this)),this._edgesRenderer||(this._edgesRenderer=Gi.get(this)),this._pickMeshRenderer||(this._pickMeshRenderer=Ki.get(this)),this._pickDepthRenderer||(this._pickDepthRenderer=er.get(this)),this._pickNormalsRenderer||(this._pickNormalsRenderer=sr.get(this))}destroy(){this._drawRenderer&&(this._drawRenderer.put(),this._drawRenderer=null),this._fillRenderer&&(this._fillRenderer.put(),this._fillRenderer=null),this._edgesRenderer&&(this._edgesRenderer.put(),this._edgesRenderer=null),this._pickMeshRenderer&&(this._pickMeshRenderer.put(),this._pickMeshRenderer=null),this._pickDepthRenderer&&(this._pickDepthRenderer.put(),this._pickDepthRenderer=null),this._pickNormalsRenderer&&(this._pickNormalsRenderer.put(),this._pickNormalsRenderer=null),this._occlusionRenderer&&(this._occlusionRenderer.put(),this._occlusionRenderer=null);const e=this._state;e.positionsBuf&&(e.positionsBuf.destroy(),e.positionsBuf=null),e.normalsBuf&&(e.normalsBuf.destroy(),e.normalsBuf=null),e.colorsBuf&&(e.colorsBuf.destroy(),e.colorsBuf=null),e.flagsBuf&&(e.flagsBuf.destroy(),e.flagsBuf=null),e.flags2Buf&&(e.flags2Buf.destroy(),e.flags2Buf=null),e.pickColorsBuf&&(e.pickColorsBuf.destroy(),e.pickColorsBuf=null),e.indicesBuf&&(e.indicesBuf.destroy(),e.indicessBuf=null),e.edgeIndicesBuf&&(e.edgeIndicesBuf.destroy(),e.edgeIndicessBuf=null),e.destroy()}}var wr=function(){const e=u.mat4(),t=u.mat4();return function(i,r,o,s,n){const a=o[0],l=o[1],c=o[2],h=o[3]-a,d=o[4]-l,p=o[5]-c,m=65525/h,f=65525/d,g=65525/p;let b;for(b=0;b<r;b+=3)s[b+0]=Math.floor((i[b+0]-a)*m),s[b+1]=Math.floor((i[b+1]-l)*f),s[b+2]=Math.floor((i[b+2]-c)*g);u.identityMat4(e),u.translationMat4v(o,e),u.identityMat4(t),u.scalingMat4v([h/65525,d/65525,p/65525],t),u.mulMat4(e,t,n)}}();function Mr(e,t,i){let r=e[0]/(Math.abs(e[0])+Math.abs(e[1])+Math.abs(e[2])),o=e[1]/(Math.abs(e[0])+Math.abs(e[1])+Math.abs(e[2]));if(e[2]<0){let e=r,t=o;e=(1-Math.abs(o))*(r>=0?1:-1),t=(1-Math.abs(r))*(o>=0?1:-1),r=e,o=t}return new Int8Array([Math[t](127.5*r+(r<0?-1:0)),Math[i](127.5*o+(o<0?-1:0))])}function kr(e){let t=e[0],i=e[1];t/=t<0?127:128,i/=i<0?127:128;const r=1-Math.abs(t)-Math.abs(i);r<0&&(t=(1-Math.abs(i))*(t>=0?1:-1),i=(1-Math.abs(t))*(i>=0?1:-1));const o=Math.sqrt(t*t+i*i+r*r);return[t/o,i/o,r/o]}function Pr(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}const Er=function(e){this.vertex=function(e){var t=e.model.scene;const i=t._sectionPlanesState,r=t._lightsState,o=i.sectionPlanes.length>0;let s,n,a;const l=[];for(l.push("// Instancing geometry drawing vertex shader"),l.push("uniform int renderPass;"),l.push("attribute vec3 position;"),l.push("attribute vec2 normal;"),l.push("attribute vec4 color;"),l.push("attribute vec4 flags;"),l.push("attribute vec4 flags2;"),l.push("attribute vec4 modelMatrixCol0;"),l.push("attribute vec4 modelMatrixCol1;"),l.push("attribute vec4 modelMatrixCol2;"),l.push("attribute vec4 modelNormalMatrixCol0;"),l.push("attribute vec4 modelNormalMatrixCol1;"),l.push("attribute vec4 modelNormalMatrixCol2;"),l.push("uniform mat4 viewMatrix;"),l.push("uniform mat4 projMatrix;"),l.push("uniform mat4 viewNormalMatrix;"),l.push("uniform mat4 positionsDecodeMatrix;"),l.push("uniform vec4 colorize;"),l.push("uniform vec4 lightAmbient;"),s=0,n=r.lights.length;s<n;s++)"ambient"!==(a=r.lights[s]).type&&(l.push("uniform vec4 lightColor"+s+";"),"dir"===a.type&&l.push("uniform vec3 lightDir"+s+";"),"point"===a.type&&l.push("uniform vec3 lightPos"+s+";"),"spot"===a.type&&(l.push("uniform vec3 lightPos"+s+";"),l.push("uniform vec3 lightDir"+s+";")));l.push("vec3 octDecode(vec2 oct) {"),l.push("    vec3 v = vec3(oct.xy, 1.0 - abs(oct.x) - abs(oct.y));"),l.push("    if (v.z < 0.0) {"),l.push("        v.xy = (1.0 - abs(v.yx)) * vec2(v.x >= 0.0 ? 1.0 : -1.0, v.y >= 0.0 ? 1.0 : -1.0);"),l.push("    }"),l.push("    return normalize(v);"),l.push("}"),o&&(l.push("varying vec4 vWorldPosition;"),l.push("varying vec4 vFlags2;"));for(l.push("varying vec4 vColor;"),l.push("void main(void) {"),l.push("bool visible      = (float(flags.x) > 0.0);"),l.push("bool xrayed       = (float(flags.y) > 0.0);"),l.push("bool highlighted  = (float(flags.z) > 0.0);"),l.push("bool selected     = (float(flags.w) > 0.0);"),l.push("bool transparent  = ((float(color.a) / 255.0) < 1.0);"),l.push(`if \n    (!visible || \n    (renderPass == ${Ti.NORMAL_OPAQUE} && (transparent || xrayed)) || \n    (renderPass == ${Ti.NORMAL_TRANSPARENT} && (!transparent || xrayed || highlighted || selected)) || \n    (renderPass == ${Ti.XRAYED} && (!xrayed || highlighted || selected)) || \n    (renderPass == ${Ti.HIGHLIGHTED} && !highlighted) ||\n    (renderPass == ${Ti.SELECTED} && !selected)) {`),l.push("   gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),l.push("} else {"),l.push("vec4 worldPosition = positionsDecodeMatrix * vec4(position, 1.0); "),l.push("worldPosition = vec4(dot(worldPosition, modelMatrixCol0), dot(worldPosition, modelMatrixCol1), dot(worldPosition, modelMatrixCol2), 1.0);"),l.push("vec4 viewPosition  = viewMatrix * worldPosition; "),l.push("vec4 modelNormal = vec4(octDecode(normal.xy), 0.0); "),l.push("vec4 worldNormal = vec4(dot(modelNormal, modelNormalMatrixCol0), dot(modelNormal, modelNormalMatrixCol1), dot(modelNormal, modelNormalMatrixCol2), 0.0);"),l.push("vec3 viewNormal = normalize(vec4(worldNormal * viewNormalMatrix).xyz);"),l.push("vec3 reflectedColor = vec3(0.0, 0.0, 0.0);"),l.push("vec3 viewLightDir = vec3(0.0, 0.0, -1.0);"),l.push("float lambertian = 1.0;"),s=0,n=r.lights.length;s<n;s++)if("ambient"!==(a=r.lights[s]).type){if("dir"===a.type)"view"===a.space?l.push("viewLightDir = normalize(lightDir"+s+");"):l.push("viewLightDir = normalize((viewMatrix * vec4(lightDir"+s+", 0.0)).xyz);");else if("point"===a.type)"view"===a.space?l.push("viewLightDir = normalize(lightPos"+s+" - viewPosition.xyz);"):l.push("viewLightDir = normalize((viewMatrix * vec4(lightPos"+s+", 0.0)).xyz);");else{if("spot"!==a.type)continue;"view"===a.space?l.push("viewLightDir = normalize(lightDir"+s+");"):l.push("viewLightDir = normalize((viewMatrix * vec4(lightDir"+s+", 0.0)).xyz);")}l.push("lambertian = max(dot(-viewNormal, viewLightDir), 0.0);"),l.push("reflectedColor += lambertian * (lightColor"+s+".rgb * lightColor"+s+".a);")}l.push("vColor = colorize *  vec4(reflectedColor * ((lightAmbient.rgb * lightAmbient.a) + vec3(float(color.r) / 255.0, float(color.g) / 255.0, float(color.b) / 255.0)), float(color.a) / 255.0);"),o&&(l.push("vWorldPosition = worldPosition;"),l.push("vFlags2 = flags2;"));return l.push("gl_Position = projMatrix * viewPosition;"),l.push("}"),l.push("}"),l}(e),this.fragment=function(e){const t=e.model.scene._sectionPlanesState;let i,r;const o=t.sectionPlanes.length>0,s=[];if(s.push("// Instancing geometry drawing fragment shader"),s.push("precision mediump float;"),s.push("precision mediump int;"),o)for(s.push("varying vec4 vWorldPosition;"),s.push("varying vec4 vFlags2;"),i=0,r=t.sectionPlanes.length;i<r;i++)s.push("uniform bool sectionPlaneActive"+i+";"),s.push("uniform vec3 sectionPlanePos"+i+";"),s.push("uniform vec3 sectionPlaneDir"+i+";");if(s.push("varying vec4 vColor;"),s.push("void main(void) {"),o){for(s.push("  bool clippable = (float(vFlags2.x) > 0.0);"),s.push("  if (clippable) {"),s.push("  float dist = 0.0;"),i=0,r=t.sectionPlanes.length;i<r;i++)s.push("if (sectionPlaneActive"+i+") {"),s.push("   dist += clamp(dot(-sectionPlaneDir"+i+".xyz, vWorldPosition.xyz - sectionPlanePos"+i+".xyz), 0.0, 1000.0);"),s.push("}");s.push("if (dist > 0.0) { discard; }"),s.push("}")}return s.push("gl_FragColor = vColor;"),s.push("}"),s}(e)};const Ar=new n({}),Cr=function(e,t){this.id=Ar.addItem({}),this._hash=e,this._scene=t.model.scene,this._useCount=0,this._shaderSource=new Er(t),this._allocate(t)},Tr={},Dr=new Float32Array([1,1,1,1]);function Sr(e){return[e.canvas.canvas.id,"",e._lightsState.getHash(),e._sectionPlanesState.getHash()].join(";")}Cr.get=function(e){const t=Sr(e.model.scene);let i=Tr[t];if(!i){if((i=new Cr(t,e)).errors)return console.log(i.errors.join("\n")),null;Tr[t]=i,P.memory.programs++}return i._useCount++,i},Cr.prototype.getValid=function(){return this._hash===Sr(this._scene)},Cr.prototype.put=function(){0==--this._useCount&&(Ar.removeItem(this.id),this._program&&this._program.destroy(),delete Tr[this._hash],P.memory.programs--)},Cr.prototype.webglContextRestored=function(){this._program=null},Cr.prototype.drawLayer=function(e,t,i){const r=t.model,o=r.scene,s=o.canvas.gl,n=t._state,a=this._instanceExt;if(this._program||(this._allocate(t),!this.errors)){if(e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e,t)),s.uniform1i(this._uRenderPass,i),s.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),s.uniformMatrix4fv(this._uViewMatrix,!1,r.viewMatrix),s.uniformMatrix4fv(this._uViewNormalMatrix,!1,r.viewNormalMatrix),this._aModelMatrixCol0.bindArrayBuffer(n.modelMatrixCol0Buf),this._aModelMatrixCol1.bindArrayBuffer(n.modelMatrixCol1Buf),this._aModelMatrixCol2.bindArrayBuffer(n.modelMatrixCol2Buf),a.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,1),a.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,1),a.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,1),e.bindArray+=3,this._aModelNormalMatrixCol0.bindArrayBuffer(n.modelNormalMatrixCol0Buf),this._aModelNormalMatrixCol1.bindArrayBuffer(n.modelNormalMatrixCol1Buf),this._aModelNormalMatrixCol2.bindArrayBuffer(n.modelNormalMatrixCol2Buf),a.vertexAttribDivisorANGLE(this._aModelNormalMatrixCol0.location,1),a.vertexAttribDivisorANGLE(this._aModelNormalMatrixCol1.location,1),a.vertexAttribDivisorANGLE(this._aModelNormalMatrixCol2.location,1),e.bindArray+=3,this._aPosition.bindArrayBuffer(n.positionsBuf),e.bindArray++,this._aNormal.bindArrayBuffer(n.normalsBuf),e.bindArray++,this._aColor.bindArrayBuffer(n.colorsBuf),a.vertexAttribDivisorANGLE(this._aColor.location,1),e.bindArray++,this._aFlags.bindArrayBuffer(n.flagsBuf),a.vertexAttribDivisorANGLE(this._aFlags.location,1),e.bindArray++,this._aFlags2&&(this._aFlags2.bindArrayBuffer(n.flags2Buf),a.vertexAttribDivisorANGLE(this._aFlags2.location,1),e.bindArray++),n.indicesBuf.bind(),e.bindArray++,i===Ti.XRAYED){const e=o.xrayMaterial._state,t=e.fillColor,i=e.fillAlpha;s.uniform4f(this._uColorize,t[0],t[1],t[2],i)}else if(i===Ti.HIGHLIGHTED){const e=o.highlightMaterial._state,t=e.fillColor,i=e.fillAlpha;s.uniform4f(this._uColorize,t[0],t[1],t[2],i)}else s.uniform4fv(this._uColorize,Dr);a.drawElementsInstancedANGLE(n.primitive,n.indicesBuf.numItems,n.indicesBuf.itemType,0,n.numInstances),a.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,0),a.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,0),a.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,0),a.vertexAttribDivisorANGLE(this._aModelNormalMatrixCol0.location,0),a.vertexAttribDivisorANGLE(this._aModelNormalMatrixCol1.location,0),a.vertexAttribDivisorANGLE(this._aModelNormalMatrixCol2.location,0),a.vertexAttribDivisorANGLE(this._aColor.location,0),a.vertexAttribDivisorANGLE(this._aFlags.location,0),this._aFlags2&&a.vertexAttribDivisorANGLE(this._aFlags2.location,0),e.drawElements++}},Cr.prototype._allocate=function(e){var t=e.model.scene;const i=t.canvas.gl,r=t._lightsState,o=t._sectionPlanesState;if(this._program=new De(i,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);this._instanceExt=i.getExtension("ANGLE_instanced_arrays");const s=this._program;this._uRenderPass=s.getLocation("renderPass"),this._uPositionsDecodeMatrix=s.getLocation("positionsDecodeMatrix"),this._uModelNormalMatrix=s.getLocation("modelNormalMatrix"),this._uViewMatrix=s.getLocation("viewMatrix"),this._uViewNormalMatrix=s.getLocation("viewNormalMatrix"),this._uProjMatrix=s.getLocation("projMatrix"),this._uColorize=s.getLocation("colorize"),this._uLightAmbient=[],this._uLightColor=[],this._uLightDir=[],this._uLightPos=[],this._uLightAttenuation=[];const n=r.lights;let a;for(var l=0,c=n.length;l<c;l++)switch((a=n[l]).type){case"ambient":this._uLightAmbient[l]=s.getLocation("lightAmbient");break;case"dir":this._uLightColor[l]=s.getLocation("lightColor"+l),this._uLightPos[l]=null,this._uLightDir[l]=s.getLocation("lightDir"+l);break;case"point":this._uLightColor[l]=s.getLocation("lightColor"+l),this._uLightPos[l]=s.getLocation("lightPos"+l),this._uLightDir[l]=null,this._uLightAttenuation[l]=s.getLocation("lightAttenuation"+l);break;case"spot":this._uLightColor[l]=s.getLocation("lightColor"+l),this._uLightPos[l]=s.getLocation("lightPos"+l),this._uLightDir[l]=s.getLocation("lightDir"+l),this._uLightAttenuation[l]=s.getLocation("lightAttenuation"+l)}this._uSectionPlanes=[];for(l=0,c=o.sectionPlanes.length;l<c;l++)this._uSectionPlanes.push({active:s.getLocation("sectionPlaneActive"+l),pos:s.getLocation("sectionPlanePos"+l),dir:s.getLocation("sectionPlaneDir"+l)});this._aPosition=s.getAttribute("position"),this._aNormal=s.getAttribute("normal"),this._aColor=s.getAttribute("color"),this._aFlags=s.getAttribute("flags"),this._aFlags2=s.getAttribute("flags2"),this._aModelMatrixCol0=s.getAttribute("modelMatrixCol0"),this._aModelMatrixCol1=s.getAttribute("modelMatrixCol1"),this._aModelMatrixCol2=s.getAttribute("modelMatrixCol2"),this._aModelNormalMatrixCol0=s.getAttribute("modelNormalMatrixCol0"),this._aModelNormalMatrixCol1=s.getAttribute("modelNormalMatrixCol1"),this._aModelNormalMatrixCol2=s.getAttribute("modelNormalMatrixCol2")},Cr.prototype._bindProgram=function(e,t){const i=this._scene,r=i.canvas.gl,o=this._program,s=i._lightsState,n=i._sectionPlanesState,a=s.lights;let l;o.bind(),e.useProgram++;const c=i.camera;c._state;r.uniformMatrix4fv(this._uProjMatrix,!1,c._project._state.matrix);for(var h=0,d=a.length;h<d;h++)l=a[h],this._uLightAmbient[h]?r.uniform4f(this._uLightAmbient[h],l.color[0],l.color[1],l.color[2],l.intensity):(this._uLightColor[h]&&r.uniform4f(this._uLightColor[h],l.color[0],l.color[1],l.color[2],l.intensity),this._uLightPos[h]&&(r.uniform3fv(this._uLightPos[h],l.pos),this._uLightAttenuation[h]&&r.uniform1f(this._uLightAttenuation[h],l.attenuation)),this._uLightDir[h]&&r.uniform3fv(this._uLightDir[h],l.dir));if(n.sectionPlanes.length>0){const e=i._sectionPlanesState.sectionPlanes;let t,o,s,n,a;for(h=0,d=this._uSectionPlanes.length;h<d;h++)o=(t=this._uSectionPlanes[h]).active,s=e[h],o&&r.uniform1i(o,s.active),(n=t.pos)&&r.uniform3fv(t.pos,s.pos),(a=t.dir)&&r.uniform3fv(t.dir,s.dir)}};const Lr=function(e){this.vertex=function(e){const t=e.model.scene._sectionPlanesState.sectionPlanes.length>0,i=[];i.push("// Instancing fill vertex shader"),i.push("precision mediump float;"),i.push("precision mediump int;"),i.push("uniform int renderPass;"),i.push("attribute vec3 position;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("attribute vec4 modelMatrixCol0;"),i.push("attribute vec4 modelMatrixCol1;"),i.push("attribute vec4 modelMatrixCol2;"),i.push("uniform mat4 viewMatrix;"),i.push("uniform mat4 projMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),i.push("uniform vec4 color;"),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;"));i.push("void main(void) {"),i.push("bool visible      = (float(flags.x) > 0.0);"),i.push("bool xrayed       = (float(flags.y) > 0.0);"),i.push("bool highlighted  = (float(flags.z) > 0.0);"),i.push("bool selected     = (float(flags.w) > 0.0);"),i.push("bool transparent  = (color.a < 1.0);"),i.push(`if\n    (!visible ||\n    (renderPass == ${Ti.NORMAL_OPAQUE} && (transparent || xrayed)) || \n    (renderPass == ${Ti.NORMAL_TRANSPARENT} && (!transparent || xrayed || highlighted || selected)) || \n    (renderPass == ${Ti.XRAYED} && (!xrayed || highlighted || selected)) || \n    (renderPass == ${Ti.HIGHLIGHTED} && !highlighted) ||\n    (renderPass == ${Ti.SELECTED} && !selected)) {`),i.push("   gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("} else {"),i.push("vec4 worldPosition = positionsDecodeMatrix * vec4(position, 1.0); "),i.push("worldPosition = vec4(dot(worldPosition, modelMatrixCol0), dot(worldPosition, modelMatrixCol1), dot(worldPosition, modelMatrixCol2), 1.0);"),i.push("vec4 viewPosition  = viewMatrix * worldPosition; "),t&&(i.push("vWorldPosition = worldPosition;"),i.push("vFlags2 = flags2;"));return i.push("gl_Position = projMatrix * viewPosition;"),i.push("}"),i.push("}"),i}(e),this.fragment=function(e){const t=e.model.scene._sectionPlanesState;let i,r;const o=t.sectionPlanes.length>0,s=[];if(s.push("// Instancing fill fragment shader"),s.push("precision mediump float;"),s.push("precision mediump int;"),o)for(s.push("varying vec4 vWorldPosition;"),s.push("varying vec4 vFlags2;"),i=0,r=t.sectionPlanes.length;i<r;i++)s.push("uniform bool sectionPlaneActive"+i+";"),s.push("uniform vec3 sectionPlanePos"+i+";"),s.push("uniform vec3 sectionPlaneDir"+i+";");if(s.push("uniform vec4 color;"),s.push("void main(void) {"),o){for(s.push("  bool clippable = (float(vFlags2.x) > 0.0);"),s.push("  if (clippable) {"),s.push("  float dist = 0.0;"),i=0,r=t.sectionPlanes.length;i<r;i++)s.push("if (sectionPlaneActive"+i+") {"),s.push("   dist += clamp(dot(-sectionPlaneDir"+i+".xyz, vWorldPosition.xyz - sectionPlanePos"+i+".xyz), 0.0, 1000.0);"),s.push("}");s.push("if (dist > 0.0) { discard; }"),s.push("}")}return s.push("gl_FragColor = color;"),s.push("}"),s}(e)};const Rr=new n({}),Ir=function(e,t){this.id=Rr.addItem({}),this._hash=e,this._scene=t.model.scene,this._useCount=0,this._shaderSource=new Lr(t),this._allocate(t)},Nr={},Fr=new Float32Array([1,1,1,1]);function Br(e){return[e.canvas.canvas.id,"",e._sectionPlanesState.getHash()].join(";")}Ir.get=function(e){const t=Br(e.model.scene);let i=Nr[t];if(!i){if((i=new Ir(t,e)).errors)return console.log(i.errors.join("\n")),null;Nr[t]=i,P.memory.programs++}return i._useCount++,i},Ir.prototype.getValid=function(){return this._hash===Br(this._scene)},Ir.prototype.put=function(){0==--this._useCount&&(Rr.removeItem(this.id),this._program&&this._program.destroy(),delete Nr[this._hash],P.memory.programs--)},Ir.prototype.webglContextRestored=function(){this._program=null},Ir.prototype.drawLayer=function(e,t,i){const r=t.model,o=r.scene,s=o.canvas.gl,n=t._state,a=this._instanceExt;if(this._program||(this._allocate(t),!this.errors)){if(e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e,t)),s.uniform1i(this._uRenderPass,i),s.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),s.uniformMatrix4fv(this._uViewMatrix,!1,r.viewMatrix),this._aModelMatrixCol0.bindArrayBuffer(n.modelMatrixCol0Buf),this._aModelMatrixCol1.bindArrayBuffer(n.modelMatrixCol1Buf),this._aModelMatrixCol2.bindArrayBuffer(n.modelMatrixCol2Buf),a.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,1),a.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,1),a.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,1),e.bindArray+=3,this._aPosition.bindArrayBuffer(n.positionsBuf),e.bindArray++,this._aFlags.bindArrayBuffer(n.flagsBuf,s.UNSIGNED_BYTE,!0),a.vertexAttribDivisorANGLE(this._aFlags.location,1),e.bindArray++,this._aFlags2&&(this._aFlags2.bindArrayBuffer(n.flags2Buf,s.UNSIGNED_BYTE,!0),a.vertexAttribDivisorANGLE(this._aFlags2.location,1),e.bindArray++),n.indicesBuf.bind(),e.bindArray++,i===Ti.XRAYED){const e=o.xrayMaterial._state,t=e.fillColor,i=e.fillAlpha;s.uniform4f(this._uColor,t[0],t[1],t[2],i)}else if(i===Ti.HIGHLIGHTED){const e=o.highlightMaterial._state,t=e.fillColor,i=e.fillAlpha;s.uniform4f(this._uColor,t[0],t[1],t[2],i)}else if(i===Ti.SELECTED){const e=o.selectedMaterial._state,t=e.fillColor,i=e.fillAlpha;s.uniform4f(this._uColor,t[0],t[1],t[2],i)}else s.uniform4fv(this._uColor,Fr);a.drawElementsInstancedANGLE(n.primitive,n.indicesBuf.numItems,n.indicesBuf.itemType,0,n.numInstances),a.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,0),a.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,0),a.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,0),a.vertexAttribDivisorANGLE(this._aFlags.location,0),this._aFlags2&&a.vertexAttribDivisorANGLE(this._aFlags2.location,0),e.drawElements++}},Ir.prototype._allocate=function(e){var t=e.model.scene;const i=t.canvas.gl,r=t._sectionPlanesState;if(this._program=new De(i,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);this._instanceExt=i.getExtension("ANGLE_instanced_arrays");const o=this._program;this._uRenderPass=o.getLocation("renderPass"),this._uPositionsDecodeMatrix=o.getLocation("positionsDecodeMatrix"),this._uViewMatrix=o.getLocation("viewMatrix"),this._uProjMatrix=o.getLocation("projMatrix"),this._uColor=o.getLocation("color"),this._uSectionPlanes=[];for(var s=0,n=r.sectionPlanes.length;s<n;s++)this._uSectionPlanes.push({active:o.getLocation("sectionPlaneActive"+s),pos:o.getLocation("sectionPlanePos"+s),dir:o.getLocation("sectionPlaneDir"+s)});this._aPosition=o.getAttribute("position"),this._aFlags=o.getAttribute("flags"),this._aFlags2=o.getAttribute("flags2"),this._aModelMatrixCol0=o.getAttribute("modelMatrixCol0"),this._aModelMatrixCol1=o.getAttribute("modelMatrixCol1"),this._aModelMatrixCol2=o.getAttribute("modelMatrixCol2")},Ir.prototype._bindProgram=function(e,t){const i=this._scene,r=i.canvas.gl,o=this._program,s=i._sectionPlanesState;o.bind(),e.useProgram++;const n=i.camera;n._state;if(r.uniformMatrix4fv(this._uProjMatrix,!1,n._project._state.matrix),s.sectionPlanes.length>0){const e=i._sectionPlanesState.sectionPlanes;let t,o,s,n,c;for(var a=0,l=this._uSectionPlanes.length;a<l;a++)o=(t=this._uSectionPlanes[a]).active,s=e[a],o&&r.uniform1i(o,s.active),(n=t.pos)&&r.uniform3fv(t.pos,s.pos),(c=t.dir)&&r.uniform3fv(t.dir,s.dir)}};const Or=function(e){this.vertex=function(e){const t=e.model.scene._sectionPlanesState.sectionPlanes.length>0,i=[];i.push("// Instancing edges vertex shader"),i.push("precision mediump float;"),i.push("precision mediump int;"),i.push("uniform int renderPass;"),i.push("attribute vec3 position;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("attribute vec4 modelMatrixCol0;"),i.push("attribute vec4 modelMatrixCol1;"),i.push("attribute vec4 modelMatrixCol2;"),i.push("uniform mat4 viewMatrix;"),i.push("uniform mat4 projMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;"));i.push("uniform vec4 color;"),i.push("void main(void) {"),i.push("bool visible      = (float(flags.x) > 0.0);"),i.push("bool xrayed       = (float(flags.y) > 0.0);"),i.push("bool highlighted  = (float(flags.z) > 0.0);"),i.push("bool selected     = (float(flags.w) > 0.0);"),i.push("bool edges        = (float(flags2.y) > 0.0);"),i.push("bool transparent  = (color.a < 1.0);"),i.push(`\n     if (!visible || !edges ||\n        (renderPass == ${Ti.NORMAL_OPAQUE} && (transparent || xrayed)) ||\n    (renderPass == ${Ti.NORMAL_TRANSPARENT} &&  (!transparent || xrayed || highlighted || selected)) ||\n    (renderPass == ${Ti.XRAYED} && (!xrayed || highlighted || selected)) ||\n    (renderPass == ${Ti.HIGHLIGHTED} && !highlighted) ||\n    (renderPass == ${Ti.SELECTED} && !selected)) {`),i.push("   gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("} else {"),i.push("vec4 worldPosition = positionsDecodeMatrix * vec4(position, 1.0); "),i.push("worldPosition = vec4(dot(worldPosition, modelMatrixCol0), dot(worldPosition, modelMatrixCol1), dot(worldPosition, modelMatrixCol2), 1.0);"),i.push("vec4 viewPosition  = viewMatrix * worldPosition; "),t&&(i.push("vWorldPosition = worldPosition;"),i.push("vFlags2 = flags2;"));return i.push("gl_Position = projMatrix * viewPosition;"),i.push("}"),i.push("}"),i}(e),this.fragment=function(e){const t=e.model.scene._sectionPlanesState,i=t.sectionPlanes.length>0;let r,o;const s=[];if(s.push("// Instancing edges fragment shader"),s.push("precision mediump float;"),s.push("precision mediump int;"),s.push("uniform vec4 color;"),i)for(s.push("varying vec4 vWorldPosition;"),s.push("varying vec4 vFlags2;"),r=0,o=t.sectionPlanes.length;r<o;r++)s.push("uniform bool sectionPlaneActive"+r+";"),s.push("uniform vec3 sectionPlanePos"+r+";"),s.push("uniform vec3 sectionPlaneDir"+r+";");if(s.push("void main(void) {"),i){for(s.push("  bool clippable = (float(vFlags2.x) > 0.0);"),s.push("  if (clippable) {"),s.push("  float dist = 0.0;"),r=0,o=t.sectionPlanes.length;r<o;r++)s.push("if (sectionPlaneActive"+r+") {"),s.push("   dist += clamp(dot(-sectionPlaneDir"+r+".xyz, vWorldPosition.xyz - sectionPlanePos"+r+".xyz), 0.0, 1000.0);"),s.push("}");s.push("if (dist > 0.0) { discard; }"),s.push("}")}return s.push("gl_FragColor = color;"),s.push("}"),s}(e)};const jr=new n({}),zr=function(e,t){this.id=jr.addItem({}),this._hash=e,this._scene=t.model.scene,this._useCount=0,this._shaderSource=new Or(t),this._allocate(t)},Vr={};function Ur(e){return[e.canvas.canvas.id,"",e._sectionPlanesState.getHash()].join(";")}zr.get=function(e){const t=Ur(e.model.scene);let i=Vr[t];if(!i){if((i=new zr(t,e)).errors)return console.log(i.errors.join("\n")),null;Vr[t]=i,P.memory.programs++}return i._useCount++,i},zr.prototype.getValid=function(){return this._hash===Ur(this._scene)},zr.prototype.put=function(){0==--this._useCount&&(jr.removeItem(this.id),this._program&&this._program.destroy(),delete Vr[this._hash],P.memory.programs--)},zr.prototype.webglContextRestored=function(){this._program=null},zr.prototype.drawLayer=function(e,t,i){const r=t.model,o=r.scene,s=o.canvas.gl,n=t._state,a=this._instanceExt;if(this._program||(this._allocate(t),!this.errors)){if(e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e,t)),i===Ti.XRAYED){const e=o.xrayMaterial._state,t=e.edgeColor,i=e.edgeAlpha;s.uniform4f(this._uColor,t[0],t[1],t[2],i)}else if(i===Ti.HIGHLIGHTED){const e=o.highlightMaterial._state,t=e.edgeColor,i=e.edgeAlpha;s.uniform4f(this._uColor,t[0],t[1],t[2],i)}else if(i===Ti.SELECTED){const e=o.selectedMaterial._state,t=e.edgeColor,i=e.edgeAlpha;s.uniform4f(this._uColor,t[0],t[1],t[2],i)}else{const e=o.edgeMaterial._state,t=e.edgeColor,i=e.edgeAlpha;s.uniform4f(this._uColor,t[0],t[1],t[2],i)}s.uniform1i(this._uRenderPass,i),s.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),s.uniformMatrix4fv(this._uViewMatrix,!1,r.viewMatrix),this._aModelMatrixCol0.bindArrayBuffer(n.modelMatrixCol0Buf),this._aModelMatrixCol1.bindArrayBuffer(n.modelMatrixCol1Buf),this._aModelMatrixCol2.bindArrayBuffer(n.modelMatrixCol2Buf),a.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,1),a.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,1),a.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,1),e.bindArray+=3,this._aPosition.bindArrayBuffer(n.positionsBuf),e.bindArray++,this._aFlags&&(this._aFlags.bindArrayBuffer(n.flagsBuf,s.UNSIGNED_BYTE,!0),a.vertexAttribDivisorANGLE(this._aFlags.location,1),e.bindArray++),this._aFlags2&&(this._aFlags2.bindArrayBuffer(n.flags2Buf,s.UNSIGNED_BYTE,!0),a.vertexAttribDivisorANGLE(this._aFlags2.location,1),e.bindArray++),n.edgeIndicesBuf.bind(),e.bindArray++,a.drawElementsInstancedANGLE(s.LINES,n.edgeIndicesBuf.numItems,n.edgeIndicesBuf.itemType,0,n.numInstances),a.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,0),a.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,0),a.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,0),this._aFlags&&a.vertexAttribDivisorANGLE(this._aFlags.location,0),this._aFlags2&&a.vertexAttribDivisorANGLE(this._aFlags2.location,0),e.drawElements++}},zr.prototype._allocate=function(e){var t=e.model.scene;const i=t.canvas.gl,r=t._sectionPlanesState;if(this._program=new De(i,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);this._instanceExt=i.getExtension("ANGLE_instanced_arrays");const o=this._program;this._uColor=o.getLocation("color"),this._uRenderPass=o.getLocation("renderPass"),this._uPositionsDecodeMatrix=o.getLocation("positionsDecodeMatrix"),this._uViewMatrix=o.getLocation("viewMatrix"),this._uProjMatrix=o.getLocation("projMatrix"),this._uSectionPlanes=[];for(var s=0,n=r.sectionPlanes.length;s<n;s++)this._uSectionPlanes.push({active:o.getLocation("sectionPlaneActive"+s),pos:o.getLocation("sectionPlanePos"+s),dir:o.getLocation("sectionPlaneDir"+s)});this._aPosition=o.getAttribute("position"),this._aFlags=o.getAttribute("flags"),this._aFlags2=o.getAttribute("flags2"),this._aModelMatrixCol0=o.getAttribute("modelMatrixCol0"),this._aModelMatrixCol1=o.getAttribute("modelMatrixCol1"),this._aModelMatrixCol2=o.getAttribute("modelMatrixCol2")},zr.prototype._bindProgram=function(e,t){const i=this._scene,r=i.canvas.gl;this._program.bind(),e.useProgram++;const o=i.camera;o._state;if(r.uniformMatrix4fv(this._uProjMatrix,!1,o._project._state.matrix),i._sectionPlanesState.sectionPlanes.length>0){const e=i._sectionPlanesState.sectionPlanes;let t,o,a,l,c;for(var s=0,n=this._uSectionPlanes.length;s<n;s++)o=(t=this._uSectionPlanes[s]).active,a=e[s],o&&r.uniform1i(o,a.active),(l=t.pos)&&r.uniform3fv(t.pos,a.pos),(c=t.dir)&&r.uniform3fv(t.dir,a.dir)}};const Hr=function(e){this.vertex=function(e){const t=e.model.scene._sectionPlanesState.sectionPlanes.length>0,i=[];i.push("// Instancing geometry picking vertex shader"),i.push("attribute vec3 position;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("attribute vec4 pickColor;"),i.push("attribute vec4 modelMatrixCol0;"),i.push("attribute vec4 modelMatrixCol1;"),i.push("attribute vec4 modelMatrixCol2;"),i.push("uniform bool pickInvisible;"),i.push("uniform mat4 viewMatrix;"),i.push("uniform mat4 projMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;"));i.push("varying vec4 vPickColor;"),i.push("void main(void) {"),i.push("bool visible   = (float(flags.x) > 0.0);"),i.push("bool pickable  = (float(flags2.z) > 0.0);"),i.push("if ((!pickInvisible && !visible) || !pickable) {"),i.push("   gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("} else {"),i.push("  vec4 worldPosition = positionsDecodeMatrix * vec4(position, 1.0); "),i.push("  worldPosition = vec4(dot(worldPosition, modelMatrixCol0), dot(worldPosition, modelMatrixCol1), dot(worldPosition, modelMatrixCol2), 1.0);"),i.push("  vec4 viewPosition  = viewMatrix * worldPosition; "),i.push("  vPickColor = vec4(float(pickColor.r) / 255.0, float(pickColor.g) / 255.0, float(pickColor.b) / 255.0, float(pickColor.a) / 255.0);"),t&&(i.push("  vWorldPosition = worldPosition;"),i.push("vFlags2 = flags2;"));return i.push("  gl_Position = projMatrix * viewPosition;"),i.push("}"),i.push("}"),i}(e),this.fragment=function(e){const t=e.model.scene._sectionPlanesState,i=t.sectionPlanes.length>0,r=[];if(r.push("// Batched geometry picking fragment shader"),r.push("precision mediump float;"),i){r.push("varying vec4 vWorldPosition;"),r.push("varying vec4 vFlags2;");for(var o=0;o<t.sectionPlanes.length;o++)r.push("uniform bool sectionPlaneActive"+o+";"),r.push("uniform vec3 sectionPlanePos"+o+";"),r.push("uniform vec3 sectionPlaneDir"+o+";")}if(r.push("varying vec4 vPickColor;"),r.push("void main(void) {"),i){r.push("  bool clippable = (float(vFlags2.x) > 0.0);"),r.push("  if (clippable) {"),r.push("  float dist = 0.0;");for(o=0;o<t.sectionPlanes.length;o++)r.push("if (sectionPlaneActive"+o+") {"),r.push("   dist += clamp(dot(-sectionPlaneDir"+o+".xyz, vWorldPosition.xyz - sectionPlanePos"+o+".xyz), 0.0, 1000.0);"),r.push("}");r.push("if (dist > 0.0) { discard; }"),r.push("}")}return r.push("gl_FragColor = vPickColor; "),r.push("}"),r}(e)};const Gr=new n({}),Wr=function(e,t){this.id=Gr.addItem({}),this._hash=e,this._scene=t.model.scene,this._useCount=0,this._shaderSource=new Hr(t),this._allocate(t)},qr={};function Xr(e){return[e.canvas.canvas.id,"",e._sectionPlanesState.getHash()].join(";")}Wr.get=function(e){const t=Xr(e.model.scene);let i=qr[t];if(!i){if((i=new Wr(t,e)).errors)return console.log(i.errors.join("\n")),null;qr[t]=i,P.memory.programs++}return i._useCount++,i},Wr.prototype.getValid=function(){return this._hash===Xr(this._scene)},Wr.prototype.put=function(){0==--this._useCount&&(Gr.removeItem(this.id),this._program&&this._program.destroy(),delete qr[this._hash],P.memory.programs--)},Wr.prototype.webglContextRestored=function(){this._program=null},Wr.prototype.drawLayer=function(e,t){const i=t.model,r=i.scene.canvas.gl,o=t._state,s=this._instanceExt;!this._program&&(this._allocate(t),this.errors)||(e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e,t)),r.uniformMatrix4fv(this._uViewMatrix,!1,e.pickViewMatrix?i.getPickViewMatrix(e.pickViewMatrix):i.viewMatrix),r.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),this._aModelMatrixCol0.bindArrayBuffer(o.modelMatrixCol0Buf),this._aModelMatrixCol1.bindArrayBuffer(o.modelMatrixCol1Buf),this._aModelMatrixCol2.bindArrayBuffer(o.modelMatrixCol2Buf),s.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,1),s.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,1),s.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,1),e.bindArray+=3,this._aPickColor.bindArrayBuffer(o.pickColorsBuf),s.vertexAttribDivisorANGLE(this._aPickColor.location,1),e.bindArray++,this._aPosition.bindArrayBuffer(o.positionsBuf),e.bindArray++,this._aFlags.bindArrayBuffer(o.flagsBuf),s.vertexAttribDivisorANGLE(this._aFlags.location,1),e.bindArray++,this._aFlags2&&(this._aFlags2.bindArrayBuffer(o.flags2Buf),s.vertexAttribDivisorANGLE(this._aFlags2.location,1),e.bindArray++),o.indicesBuf.bind(),e.bindArray++,s.drawElementsInstancedANGLE(o.primitive,o.indicesBuf.numItems,o.indicesBuf.itemType,0,o.numInstances),s.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,0),s.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,0),s.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,0),s.vertexAttribDivisorANGLE(this._aPickColor.location,0),s.vertexAttribDivisorANGLE(this._aFlags.location,0),this._aFlags2&&s.vertexAttribDivisorANGLE(this._aFlags2.location,0),e.drawElements++)},Wr.prototype._allocate=function(e){var t=e.model.scene;const i=t.canvas.gl,r=t._sectionPlanesState;if(this._program=new De(i,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);this._instanceExt=i.getExtension("ANGLE_instanced_arrays");const o=this._program;this._uPickInvisible=o.getLocation("pickInvisible"),this._uPositionsDecodeMatrix=o.getLocation("positionsDecodeMatrix"),this._uViewMatrix=o.getLocation("viewMatrix"),this._uProjMatrix=o.getLocation("projMatrix"),this._uSectionPlanes=[];for(var s=0,n=r.sectionPlanes.length;s<n;s++)this._uSectionPlanes.push({active:o.getLocation("sectionPlaneActive"+s),pos:o.getLocation("sectionPlanePos"+s),dir:o.getLocation("sectionPlaneDir"+s)});this._aPosition=o.getAttribute("position"),this._aPickColor=o.getAttribute("pickColor"),this._aFlags=o.getAttribute("flags"),this._aFlags2=o.getAttribute("flags2"),this._aModelMatrixCol0=o.getAttribute("modelMatrixCol0"),this._aModelMatrixCol1=o.getAttribute("modelMatrixCol1"),this._aModelMatrixCol2=o.getAttribute("modelMatrixCol2")},Wr.prototype._bindProgram=function(e,t){const i=this._scene,r=i.canvas.gl,o=this._program,s=(i._lightsState,i._sectionPlanesState);o.bind(),e.useProgram++;const n=i.camera;n._state;if(r.uniformMatrix4fv(this._uProjMatrix,!1,n._project._state.matrix),r.uniform1i(this._uPickInvisible,e.pickInvisible),s.sectionPlanes.length>0){const e=i._sectionPlanesState.sectionPlanes;let t,o,s,n,c;for(var a=0,l=this._uSectionPlanes.length;a<l;a++)o=(t=this._uSectionPlanes[a]).active,s=e[a],o&&r.uniform1i(o,s.active),(n=t.pos)&&r.uniform3fv(t.pos,s.pos),(c=t.dir)&&r.uniform3fv(t.dir,s.dir)}};const Yr=function(e){this.vertex=function(e){const t=e.model.scene._sectionPlanesState.sectionPlanes.length>0,i=[];i.push("// Instancing geometry depth vertex shader"),i.push("attribute vec3 position;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("attribute vec4 modelMatrixCol0;"),i.push("attribute vec4 modelMatrixCol1;"),i.push("attribute vec4 modelMatrixCol2;"),i.push("uniform bool pickInvisible;"),i.push("uniform mat4 viewMatrix;"),i.push("uniform mat4 projMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;"));i.push("varying vec4 vViewPosition;"),i.push("void main(void) {"),i.push("bool visible   = (float(flags.x) > 0.0);"),i.push("bool pickable  = (float(flags2.z) > 0.0);"),i.push("if ((!pickInvisible && !visible) || !pickable) {"),i.push("   gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("} else {"),i.push("  vec4 worldPosition = positionsDecodeMatrix * vec4(position, 1.0); "),i.push("  worldPosition = vec4(dot(worldPosition, modelMatrixCol0), dot(worldPosition, modelMatrixCol1), dot(worldPosition, modelMatrixCol2), 1.0);"),i.push("  vec4 viewPosition  = viewMatrix * worldPosition; "),t&&i.push("  vWorldPosition = worldPosition;");return i.push("  vViewPosition = viewPosition;"),i.push("  gl_Position = projMatrix * viewPosition;"),i.push("}"),i.push("}"),i}(e),this.fragment=function(e){const t=e.model.scene._sectionPlanesState,i=t.sectionPlanes.length>0,r=[];if(r.push("// Batched geometry depth fragment shader"),r.push("precision highp float;"),r.push("uniform float zNear;"),r.push("uniform float zFar;"),i){r.push("varying vec4 vWorldPosition;"),r.push("varying vec4 vFlags2;");for(var o=0;o<t.sectionPlanes.length;o++)r.push("uniform bool sectionPlaneActive"+o+";"),r.push("uniform vec3 sectionPlanePos"+o+";"),r.push("uniform vec3 sectionPlaneDir"+o+";")}if(r.push("varying vec4 vViewPosition;"),r.push("vec4 packDepth(const in float depth) {"),r.push("  const vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);"),r.push("  const vec4 bitMask  = vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);"),r.push("  vec4 res = fract(depth * bitShift);"),r.push("  res -= res.xxyz * bitMask;"),r.push("  return res;"),r.push("}"),r.push("void main(void) {"),i){r.push("  bool clippable = (float(vFlags2.x) > 0.0);"),r.push("  if (clippable) {"),r.push("  float dist = 0.0;");for(o=0;o<t.sectionPlanes.length;o++)r.push("if (sectionPlaneActive"+o+") {"),r.push("   dist += clamp(dot(-sectionPlaneDir"+o+".xyz, vWorldPosition.xyz - sectionPlanePos"+o+".xyz), 0.0, 1000.0);"),r.push("}");r.push("if (dist > 0.0) { discard; }"),r.push("}")}return r.push("    float zNormalizedDepth = abs((zNear + vViewPosition.z) / (zFar - zNear));"),r.push("    gl_FragColor = packDepth(zNormalizedDepth); "),r.push("}"),r}(e)};const Kr=new n({}),$r=function(e,t){this.id=Kr.addItem({}),this._hash=e,this._scene=t.model.scene,this._useCount=0,this._shaderSource=new Yr(t),this._allocate(t)},Qr={};function Zr(e){return[e.canvas.canvas.id,"",e._sectionPlanesState.getHash()].join(";")}$r.get=function(e){const t=Zr(e.model.scene);let i=Qr[t];if(!i){if((i=new $r(t,e)).errors)return console.log(i.errors.join("\n")),null;Qr[t]=i,P.memory.programs++}return i._useCount++,i},$r.prototype.getValid=function(){return this._hash===Zr(this._scene)},$r.prototype.put=function(){0==--this._useCount&&(Kr.removeItem(this.id),this._program&&this._program.destroy(),delete Qr[this._hash],P.memory.programs--)},$r.prototype.webglContextRestored=function(){this._program=null},$r.prototype.drawLayer=function(e,t){const i=t.model,r=i.scene,o=r.canvas.gl,s=t._state,n=this._instanceExt;if(!this._program&&(this._allocate(t),this.errors))return;e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e,t));const a=r.camera.project._state;o.uniform1i(this._uPickInvisible,e.pickInvisible),o.uniformMatrix4fv(this._uViewMatrix,!1,e.pickViewMatrix?i.getPickViewMatrix(e.pickViewMatrix):i.viewMatrix),o.uniformMatrix4fv(this._uProjMatrix,!1,e.pickProjMatrix),o.uniform1f(this._uZNear,a.near),o.uniform1f(this._uZFar,a.far),o.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),this._aModelMatrixCol0.bindArrayBuffer(s.modelMatrixCol0Buf),this._aModelMatrixCol1.bindArrayBuffer(s.modelMatrixCol1Buf),this._aModelMatrixCol2.bindArrayBuffer(s.modelMatrixCol2Buf),n.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,1),n.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,1),n.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,1),e.bindArray+=3,this._aPosition.bindArrayBuffer(s.positionsBuf),e.bindArray++,this._aFlags.bindArrayBuffer(s.flagsBuf),n.vertexAttribDivisorANGLE(this._aFlags.location,1),e.bindArray++,this._aFlags2&&(this._aFlags2.bindArrayBuffer(s.flags2Buf),n.vertexAttribDivisorANGLE(this._aFlags2.location,1),e.bindArray++),s.indicesBuf.bind(),e.bindArray++,n.drawElementsInstancedANGLE(s.primitive,s.indicesBuf.numItems,s.indicesBuf.itemType,0,s.numInstances),n.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,0),n.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,0),n.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,0),n.vertexAttribDivisorANGLE(this._aFlags.location,0),this._aFlags2&&n.vertexAttribDivisorANGLE(this._aFlags2.location,0),e.drawElements++},$r.prototype._allocate=function(e){var t=e.model.scene;const i=t.canvas.gl,r=t._sectionPlanesState;if(this._program=new De(i,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);this._instanceExt=i.getExtension("ANGLE_instanced_arrays");const o=this._program;this._uPickInvisible=o.getLocation("pickInvisible"),this._uPositionsDecodeMatrix=o.getLocation("positionsDecodeMatrix"),this._uViewMatrix=o.getLocation("viewMatrix"),this._uProjMatrix=o.getLocation("projMatrix"),this._uSectionPlanes=[];for(var s=0,n=r.sectionPlanes.length;s<n;s++)this._uSectionPlanes.push({active:o.getLocation("sectionPlaneActive"+s),pos:o.getLocation("sectionPlanePos"+s),dir:o.getLocation("sectionPlaneDir"+s)});this._aPosition=o.getAttribute("position"),this._aFlags=o.getAttribute("flags"),this._aFlags2=o.getAttribute("flags2"),this._aModelMatrixCol0=o.getAttribute("modelMatrixCol0"),this._aModelMatrixCol1=o.getAttribute("modelMatrixCol1"),this._aModelMatrixCol2=o.getAttribute("modelMatrixCol2"),this._uZNear=o.getLocation("zNear"),this._uZFar=o.getLocation("zFar")},$r.prototype._bindProgram=function(e,t){const i=this._scene,r=i.canvas.gl,o=this._program,s=i._sectionPlanesState;if(o.bind(),e.useProgram++,s.sectionPlanes.length>0){const e=i._sectionPlanesState.sectionPlanes;let t,o,s,l,c;for(var n=0,a=this._uSectionPlanes.length;n<a;n++)o=(t=this._uSectionPlanes[n]).active,s=e[n],o&&r.uniform1i(o,s.active),(l=t.pos)&&r.uniform3fv(t.pos,s.pos),(c=t.dir)&&r.uniform3fv(t.dir,s.dir)}};const Jr=function(e){this.vertex=function(e){const t=e.model.scene._sectionPlanesState.sectionPlanes.length>0,i=[];i.push("// Instancing geometry normals vertex shader"),i.push("attribute vec3 position;"),i.push("attribute vec2 normal;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("attribute vec4 modelMatrixCol0;"),i.push("attribute vec4 modelMatrixCol1;"),i.push("attribute vec4 modelMatrixCol2;"),i.push("attribute vec4 modelNormalMatrixCol0;"),i.push("attribute vec4 modelNormalMatrixCol1;"),i.push("attribute vec4 modelNormalMatrixCol2;"),i.push("uniform bool pickInvisible;"),i.push("uniform mat4 viewMatrix;"),i.push("uniform mat4 projMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),i.push("vec3 octDecode(vec2 oct) {"),i.push("    vec3 v = vec3(oct.xy, 1.0 - abs(oct.x) - abs(oct.y));"),i.push("    if (v.z < 0.0) {"),i.push("        v.xy = (1.0 - abs(v.yx)) * vec2(v.x >= 0.0 ? 1.0 : -1.0, v.y >= 0.0 ? 1.0 : -1.0);"),i.push("    }"),i.push("    return normalize(v);"),i.push("}"),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;"));i.push("varying vec3 vWorldNormal;"),i.push("void main(void) {"),i.push("bool visible   = (float(flags.x) > 0.0);"),i.push("bool pickable  = (float(flags2.z) > 0.0);"),i.push("  if ((!pickInvisible && !visible) || !pickable) {"),i.push("   gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("} else {"),i.push("  vec4 worldPosition = positionsDecodeMatrix * vec4(position, 1.0); "),i.push("  worldPosition = vec4(dot(worldPosition, modelMatrixCol0), dot(worldPosition, modelMatrixCol1), dot(worldPosition, modelMatrixCol2), 1.0);"),i.push("  vec4 viewPosition  = viewMatrix * worldPosition; "),i.push("  vec4 modelNormal = vec4(octDecode(normal.xy), 0.0); "),i.push("  vec3 worldNormal = vec3(dot(modelNormal, modelNormalMatrixCol0), dot(modelNormal, modelNormalMatrixCol1), dot(modelNormal, modelNormalMatrixCol2));"),i.push("  vWorldNormal = worldNormal;"),t&&i.push("  vWorldPosition = worldPosition;");return i.push("  gl_Position = projMatrix * viewPosition;"),i.push("}"),i.push("}"),i}(e),this.fragment=function(e){const t=e.model.scene._sectionPlanesState,i=t.sectionPlanes.length>0,r=[];if(r.push("// Batched geometry normals fragment shader"),r.push("precision highp float;"),i){r.push("varying vec4 vWorldPosition;"),r.push("varying vec4 vFlags2;");for(var o=0;o<t.sectionPlanes.length;o++)r.push("uniform bool sectionPlaneActive"+o+";"),r.push("uniform vec3 sectionPlanePos"+o+";"),r.push("uniform vec3 sectionPlaneDir"+o+";")}if(r.push("varying vec3 vWorldNormal;"),r.push("void main(void) {"),i){r.push("  bool clippable = (float(vFlags2.x) > 0.0);"),r.push("  if (clippable) {"),r.push("  float dist = 0.0;");for(o=0;o<t.sectionPlanes.length;o++)r.push("if (sectionPlaneActive"+o+") {"),r.push("   dist += clamp(dot(-sectionPlaneDir"+o+".xyz, vWorldPosition.xyz - sectionPlanePos"+o+".xyz), 0.0, 1000.0);"),r.push("}");r.push("if (dist > 0.0) { discard; }"),r.push("}")}return r.push("    gl_FragColor = vec4((vWorldNormal * 0.5) + 0.5, 1.0);"),r.push("}"),r}(e)};const eo=new n({}),to=function(e,t){this.id=eo.addItem({}),this._hash=e,this._scene=t.model.scene,this._useCount=0,this._shaderSource=new Jr(t),this._allocate(t)},io={};function ro(e){return[e.canvas.canvas.id,"",e._sectionPlanesState.getHash()].join(";")}to.get=function(e){const t=ro(e.model.scene);let i=io[t];if(!i){if((i=new to(t,e)).errors)return console.log(i.errors.join("\n")),null;io[t]=i,P.memory.programs++}return i._useCount++,i},to.prototype.getValid=function(){return this._hash===ro(this._scene)},to.prototype.put=function(){0==--this._useCount&&(eo.removeItem(this.id),this._program&&this._program.destroy(),delete io[this._hash],P.memory.programs--)},to.prototype.webglContextRestored=function(){this._program=null},to.prototype.drawLayer=function(e,t){const i=t.model,r=i.scene.canvas.gl,o=t._state,s=this._instanceExt;!this._program&&(this._allocate(t),this.errors)||(e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e,t)),r.uniform1i(this._uPickInvisible,e.pickInvisible),r.uniformMatrix4fv(this._uViewMatrix,!1,e.pickViewMatrix?i.getPickViewMatrix(e.pickViewMatrix):i.viewMatrix),r.uniformMatrix4fv(this._uProjMatrix,!1,e.pickProjMatrix),r.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),this._aModelMatrixCol0.bindArrayBuffer(o.modelMatrixCol0Buf),this._aModelMatrixCol1.bindArrayBuffer(o.modelMatrixCol1Buf),this._aModelMatrixCol2.bindArrayBuffer(o.modelMatrixCol2Buf),s.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,1),s.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,1),s.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,1),e.bindArray+=3,this._aModelNormalMatrixCol0.bindArrayBuffer(o.modelNormalMatrixCol0Buf),this._aModelNormalMatrixCol1.bindArrayBuffer(o.modelNormalMatrixCol1Buf),this._aModelNormalMatrixCol2.bindArrayBuffer(o.modelNormalMatrixCol2Buf),s.vertexAttribDivisorANGLE(this._aModelNormalMatrixCol0.location,1),s.vertexAttribDivisorANGLE(this._aModelNormalMatrixCol1.location,1),s.vertexAttribDivisorANGLE(this._aModelNormalMatrixCol2.location,1),e.bindArray+=3,this._aPosition.bindArrayBuffer(o.positionsBuf),e.bindArray++,this._aNormal.bindArrayBuffer(o.normalsBuf),e.bindArray++,this._aFlags.bindArrayBuffer(o.flagsBuf),s.vertexAttribDivisorANGLE(this._aFlags.location,1),e.bindArray++,this._aFlags2&&(this._aFlags2.bindArrayBuffer(o.flags2Buf),s.vertexAttribDivisorANGLE(this._aFlags2.location,1),e.bindArray++),o.indicesBuf.bind(),e.bindArray++,s.drawElementsInstancedANGLE(o.primitive,o.indicesBuf.numItems,o.indicesBuf.itemType,0,o.numInstances),s.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,0),s.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,0),s.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,0),s.vertexAttribDivisorANGLE(this._aModelNormalMatrixCol0.location,0),s.vertexAttribDivisorANGLE(this._aModelNormalMatrixCol1.location,0),s.vertexAttribDivisorANGLE(this._aModelNormalMatrixCol2.location,0),s.vertexAttribDivisorANGLE(this._aFlags.location,0),this._aFlags2&&s.vertexAttribDivisorANGLE(this._aFlags2.location,0),e.drawElements++)},to.prototype._allocate=function(e){var t=e.model.scene;const i=t.canvas.gl,r=t._sectionPlanesState;if(this._program=new De(i,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);this._instanceExt=i.getExtension("ANGLE_instanced_arrays");const o=this._program;this._uPickInvisible=o.getLocation("pickInvisible"),this._uPositionsDecodeMatrix=o.getLocation("positionsDecodeMatrix"),this._uViewMatrix=o.getLocation("viewMatrix"),this._uViewNormalMatrix=o.getLocation("viewNormalMatrix"),this._uProjMatrix=o.getLocation("projMatrix"),this._uSectionPlanes=[];for(var s=0,n=r.sectionPlanes.length;s<n;s++)this._uSectionPlanes.push({active:o.getLocation("sectionPlaneActive"+s),pos:o.getLocation("sectionPlanePos"+s),dir:o.getLocation("sectionPlaneDir"+s)});this._aPosition=o.getAttribute("position"),this._aNormal=o.getAttribute("normal"),this._aFlags=o.getAttribute("flags"),this._aFlags2=o.getAttribute("flags2"),this._aModelMatrixCol0=o.getAttribute("modelMatrixCol0"),this._aModelMatrixCol1=o.getAttribute("modelMatrixCol1"),this._aModelMatrixCol2=o.getAttribute("modelMatrixCol2"),this._aModelNormalMatrixCol0=o.getAttribute("modelNormalMatrixCol0"),this._aModelNormalMatrixCol1=o.getAttribute("modelNormalMatrixCol1"),this._aModelNormalMatrixCol2=o.getAttribute("modelNormalMatrixCol2")},to.prototype._bindProgram=function(e){const t=this._scene,i=t.canvas.gl,r=this._program,o=t._sectionPlanesState;if(r.bind(),e.useProgram++,o.sectionPlanes.length>0){const e=t._sectionPlanesState.sectionPlanes;let r,o,a,l,c;for(var s=0,n=this._uSectionPlanes.length;s<n;s++)o=(r=this._uSectionPlanes[s]).active,a=e[s],o&&i.uniform1i(o,a.active),(l=r.pos)&&i.uniform3fv(r.pos,a.pos),(c=r.dir)&&i.uniform3fv(r.dir,a.dir)}};const oo=function(e){this.vertex=function(e){const t=e.model.scene._sectionPlanesState.sectionPlanes.length>0,i=[];i.push("// Instancing occlusion vertex shader"),i.push("attribute vec3 position;"),i.push("attribute vec4 color;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("attribute vec4 modelMatrixCol0;"),i.push("attribute vec4 modelMatrixCol1;"),i.push("attribute vec4 modelMatrixCol2;"),i.push("uniform mat4 viewMatrix;"),i.push("uniform mat4 projMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;"));i.push("varying vec4 vViewPosition;"),i.push("void main(void) {"),i.push("bool visible   = (float(flags.x) > 0.0);"),i.push("bool transparent  = ((float(color.a) / 255.0) < 1.0);"),i.push("if (!visible || transparent) {"),i.push("   gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("} else {"),i.push("  vec4 worldPosition = positionsDecodeMatrix * vec4(position, 1.0); "),i.push("  worldPosition = vec4(dot(worldPosition, modelMatrixCol0), dot(worldPosition, modelMatrixCol1), dot(worldPosition, modelMatrixCol2), 1.0);"),i.push("  vec4 viewPosition  = viewMatrix * worldPosition; "),t&&i.push("  vWorldPosition = worldPosition;");return i.push("  vViewPosition = viewPosition;"),i.push("  gl_Position = projMatrix * viewPosition;"),i.push("}"),i.push("}"),i}(e),this.fragment=function(e){const t=e.model.scene._sectionPlanesState,i=t.sectionPlanes.length>0,r=[];if(r.push("// Batched occlusion fragment shader"),r.push("precision mediump float;"),i){r.push("varying vec4 vWorldPosition;"),r.push("varying vec4 vFlags2;");for(var o=0;o<t.sectionPlanes.length;o++)r.push("uniform bool sectionPlaneActive"+o+";"),r.push("uniform vec3 sectionPlanePos"+o+";"),r.push("uniform vec3 sectionPlaneDir"+o+";")}if(r.push("varying vec4 vViewPosition;"),r.push("void main(void) {"),i){r.push("  bool clippable = (float(vFlags2.x) > 0.0);"),r.push("  if (clippable) {"),r.push("  float dist = 0.0;");for(o=0;o<t.sectionPlanes.length;o++)r.push("if (sectionPlaneActive"+o+") {"),r.push("   dist += clamp(dot(-sectionPlaneDir"+o+".xyz, vWorldPosition.xyz - sectionPlanePos"+o+".xyz), 0.0, 1000.0);"),r.push("}");r.push("if (dist > 0.0) { discard; }"),r.push("}")}return r.push("   gl_FragColor = vec4(0.0, 0.0, 1.0, 1.0); "),r.push("}"),r}(e)};const so=new n({}),no=function(e,t){this.id=so.addItem({}),this._hash=e,this._scene=t.model.scene,this._useCount=0,this._shaderSource=new oo(t),this._allocate(t)},ao={};function lo(e){return[e.canvas.canvas.id,"",e._sectionPlanesState.getHash()].join(";")}no.get=function(e){const t=lo(e.model.scene);let i=ao[t];if(!i){if((i=new no(t,e)).errors)return console.log(i.errors.join("\n")),null;ao[t]=i,P.memory.programs++}return i._useCount++,i},no.prototype.getValid=function(){return this._hash===lo(this._scene)},no.prototype.put=function(){0==--this._useCount&&(so.removeItem(this.id),this._program&&this._program.destroy(),delete ao[this._hash],P.memory.programs--)},no.prototype.webglContextRestored=function(){this._program=null},no.prototype.drawLayer=function(e,t){const i=t.model,r=i.scene.canvas.gl,o=t._state,s=this._instanceExt;!this._program&&(this._allocate(t),this.errors)||(e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e,t)),r.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),r.uniformMatrix4fv(this._uViewMatrix,!1,i.viewMatrix),this._aModelMatrixCol0.bindArrayBuffer(o.modelMatrixCol0Buf),this._aModelMatrixCol1.bindArrayBuffer(o.modelMatrixCol1Buf),this._aModelMatrixCol2.bindArrayBuffer(o.modelMatrixCol2Buf),s.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,1),s.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,1),s.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,1),e.bindArray+=3,this._aColor&&(this._aColor.bindArrayBuffer(o.colorsBuf),s.vertexAttribDivisorANGLE(this._aColor.location,1),e.bindArray++),this._aPosition.bindArrayBuffer(o.positionsBuf),e.bindArray++,this._aFlags.bindArrayBuffer(o.flagsBuf),s.vertexAttribDivisorANGLE(this._aFlags.location,1),e.bindArray++,this._aFlags2&&(this._aFlags2.bindArrayBuffer(o.flags2Buf),s.vertexAttribDivisorANGLE(this._aFlags2.location,1),e.bindArray++),o.indicesBuf.bind(),e.bindArray++,s.drawElementsInstancedANGLE(o.primitive,o.indicesBuf.numItems,o.indicesBuf.itemType,0,o.numInstances),s.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,0),s.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,0),s.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,0),this._aColor&&s.vertexAttribDivisorANGLE(this._aColor.location,0),s.vertexAttribDivisorANGLE(this._aFlags.location,0),this._aFlags2&&s.vertexAttribDivisorANGLE(this._aFlags2.location,0),e.drawElements++)},no.prototype._allocate=function(e){var t=e.model.scene;const i=t.canvas.gl,r=t._sectionPlanesState;if(this._program=new De(i,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);this._instanceExt=i.getExtension("ANGLE_instanced_arrays");const o=this._program;this._uPositionsDecodeMatrix=o.getLocation("positionsDecodeMatrix"),this._uViewMatrix=o.getLocation("viewMatrix"),this._uProjMatrix=o.getLocation("projMatrix"),this._uSectionPlanes=[];for(var s=0,n=r.sectionPlanes.length;s<n;s++)this._uSectionPlanes.push({active:o.getLocation("sectionPlaneActive"+s),pos:o.getLocation("sectionPlanePos"+s),dir:o.getLocation("sectionPlaneDir"+s)});this._aPosition=o.getAttribute("position"),this._aColor=o.getAttribute("color"),this._aFlags=o.getAttribute("flags"),this._aFlags2=o.getAttribute("flags2"),this._aModelMatrixCol0=o.getAttribute("modelMatrixCol0"),this._aModelMatrixCol1=o.getAttribute("modelMatrixCol1"),this._aModelMatrixCol2=o.getAttribute("modelMatrixCol2")},no.prototype._bindProgram=function(e,t){const i=this._scene,r=i.canvas.gl,o=this._program,s=i._sectionPlanesState;o.bind(),e.useProgram++;const n=i.camera;n._state;if(r.uniformMatrix4fv(this._uProjMatrix,!1,n._project._state.matrix),s.sectionPlanes.length>0){const e=i._sectionPlanesState.sectionPlanes;let t,o,s,n,c;for(var a=0,l=this._uSectionPlanes.length;a<l;a++)o=(t=this._uSectionPlanes[a]).active,s=e[a],o&&r.uniform1i(o,s.active),(n=t.pos)&&r.uniform3fv(t.pos,s.pos),(c=t.dir)&&r.uniform3fv(t.dir,s.dir)}};const co=q.SUPPORTED_EXTENSIONS.OES_element_index_uint,ho=co?5e6:65530,uo=new Uint16Array(3*ho),po=new Int8Array(3*ho),mo=new Uint8Array(4),fo=u.vec4([0,0,0,1]),go=u.vec4([0,0,0,1]),bo=u.vec4([0,0,0,1]);class _o{constructor(e,t){this.model=e,this._aabb=u.collapseAABB3();var i,r=t.primitive||"triangles";const o=e.scene.canvas.gl;switch(r){case"points":i=o.POINTS;break;case"lines":i=o.LINES;break;case"line-loop":i=o.LINE_LOOP;break;case"line-strip":i=o.LINE_STRIP;break;case"triangles":i=o.TRIANGLES;break;case"triangle-strip":i=o.TRIANGLE_STRIP;break;case"triangle-fan":i=o.TRIANGLE_FAN;break;default:throw`Unsupported value for 'primitive': '${r}' - supported values are 'points', 'lines', 'line-loop', 'line-strip', 'triangles', 'triangle-strip' and 'triangle-fan'. Defaulting to 'triangles'.`}var s={primitiveName:r,primitive:i,positionsDecodeMatrix:u.mat4(),numInstances:0,obb:u.OBB3()};if(t.positions)if(t.preCompressed){let e=!1;s.positionsBuf=new W(o,o.ARRAY_BUFFER,t.positions,t.positions.length,3,o.STATIC_DRAW,e),s.positionsDecodeMatrix.set(t.positionsDecodeMatrix);let i=u.collapseAABB3();u.expandAABB3Points3(i,t.positions),J.decompressAABB(i,s.positionsDecodeMatrix),u.AABB3ToOBB3(i,s.obb)}else{let e=t.positions.length,i=u.collapseAABB3();u.expandAABB3Points3(i,t.positions),u.AABB3ToOBB3(i,s.obb),vo(t.positions,e,i,uo,s.positionsDecodeMatrix);let r=!1;s.positionsBuf=new W(o,o.ARRAY_BUFFER,uo,e,3,o.STATIC_DRAW,r)}if(t.normals)if(t.preCompressed){let e=!0;s.normalsBuf=new W(o,o.ARRAY_BUFFER,t.normals,t.normals.length,3,o.STATIC_DRAW,e)}else{var n=function(e,t,i,r){let o,s,n,a,l;for(let c=0;c<t;c+=3)n=o=xo(e,c,"floor","floor"),s=yo(o),a=l=wo(e,c,s),o=xo(e,c,"ceil","floor"),s=yo(o),(a=wo(e,c,s))>l&&(n=o,l=a),o=xo(e,c,"floor","ceil"),s=yo(o),(a=wo(e,c,s))>l&&(n=o,l=a),o=xo(e,c,"ceil","ceil"),s=yo(o),(a=wo(e,c,s))>l&&(n=o,l=a),i[r+c+0]=n[0],i[r+c+1]=n[1],i[r+c+2]=0;return r+=t}(t.normals,t.normals.length,po,0);let e=!0;s.normalsBuf=new W(o,o.ARRAY_BUFFER,po,n,3,o.STATIC_DRAW,e)}t.indices&&(s.indicesBuf=new W(o,o.ELEMENT_ARRAY_BUFFER,co?new Uint32Array(t.indices):new Uint16Array(t.indices),t.indices.length,1,o.STATIC_DRAW));var a=t.edgeIndices;a||(a=Y(t.positions,t.indices,null,10)),s.edgeIndicesBuf=new W(o,o.ELEMENT_ARRAY_BUFFER,co?new Uint32Array(a):new Uint16Array(a),a.length,1,o.STATIC_DRAW),this._state=new j(s),this._numPortions=0,this._numVisibleLayerPortions=0,this._numTransparentLayerPortions=0,this._numXRayedLayerPortions=0,this._numHighlightedLayerPortions=0,this._numSelectedLayerPortions=0,this._numEdgesLayerPortions=0,this._numPickableLayerPortions=0,this.numIndices=t.indices?t.indices.length/3:0,this._flags=[],this._flags2=[],this._colors=[],this._pickColors=[],this._modelMatrixCol0=[],this._modelMatrixCol1=[],this._modelMatrixCol2=[],this._modelNormalMatrixCol0=[],this._modelNormalMatrixCol1=[],this._modelNormalMatrixCol2=[],this._portions=[],this._finalized=!1,this._preCompressed=!!t.preCompressed,this.compileShaders()}createPortion(e,t,i,r,o,s,n){if(this._finalized)throw"Already finalized";var a=e&xi.VISIBLE?255:0,l=e&xi.XRAYED?255:0,c=e&xi.HIGHLIGHTED?255:0,h=e&xi.HIGHLIGHTED?255:0,d=e&xi.CLIPPABLE?255:0,p=e&xi.EDGES?255:0,m=e&xi.PICKABLE?255:0;this._flags.push(a),this._flags.push(l),this._flags.push(c),this._flags.push(h),this._flags2.push(d),this._flags2.push(p),this._flags2.push(m),this._flags2.push(0),a&&(this._numVisibleLayerPortions++,this.model.numVisibleLayerPortions++),l&&(this._numXRayedLayerPortions++,this.model.numXRayedLayerPortions++),c&&(this._numHighlightedLayerPortions++,this.model.numHighlightedLayerPortions++),h&&(this._numSelectedLayerPortions++,this.model.numSelectedLayerPortions++),p&&(this._numEdgesLayerPortions++,this.model.numEdgesLayerPortions++),m&&(this._numPickableLayerPortions++,this.model.numPickableLayerPortions++);const f=t[0],g=t[1],b=t[2];t[3];i<255&&(this._numTransparentLayerPortions++,this.model.numTransparentLayerPortions++),this._colors.push(f),this._colors.push(g),this._colors.push(b),this._colors.push(i),this._modelMatrixCol0.push(r[0]),this._modelMatrixCol0.push(r[4]),this._modelMatrixCol0.push(r[8]),this._modelMatrixCol0.push(r[12]),this._modelMatrixCol1.push(r[1]),this._modelMatrixCol1.push(r[5]),this._modelMatrixCol1.push(r[9]),this._modelMatrixCol1.push(r[13]),this._modelMatrixCol2.push(r[2]),this._modelMatrixCol2.push(r[6]),this._modelMatrixCol2.push(r[10]),this._modelMatrixCol2.push(r[14]);let _=u.transposeMat4(r,u.mat4()),v=u.inverseMat4(_);this._modelNormalMatrixCol0.push(v[0]),this._modelNormalMatrixCol0.push(v[4]),this._modelNormalMatrixCol0.push(v[8]),this._modelNormalMatrixCol0.push(v[12]),this._modelNormalMatrixCol1.push(v[1]),this._modelNormalMatrixCol1.push(v[5]),this._modelNormalMatrixCol1.push(v[9]),this._modelNormalMatrixCol1.push(v[13]),this._modelNormalMatrixCol2.push(v[2]),this._modelNormalMatrixCol2.push(v[6]),this._modelNormalMatrixCol2.push(v[10]),this._modelNormalMatrixCol2.push(v[14]),this._pickColors.push(n[0]),this._pickColors.push(n[1]),this._pickColors.push(n[2]),this._pickColors.push(n[3]),u.collapseAABB3(s);for(var x=this._state.obb,y=x.length,w=0;w<y;w+=4)fo[0]=x[w+0],fo[1]=x[w+1],fo[2]=x[w+2],u.transformPoint4(r,fo,go),o?(u.transformPoint4(o,go,bo),u.expandAABB3Point3(s,bo)):u.expandAABB3Point3(s,go);this._state.numInstances++;var M=this._portions.length;return this._portions.push({}),this._numPortions++,this.model.numPortions++,M}finalize(){if(this._finalized)throw"Already finalized";const e=this.model.scene.canvas.gl;if(this._colors.length>0){let t=!1;this._state.colorsBuf=new W(e,e.ARRAY_BUFFER,new Uint8Array(this._colors),this._colors.length,4,e.DYNAMIC_DRAW,t),this._colors=[]}if(this._flags.length>0){let t=!0;this._state.flagsBuf=new W(e,e.ARRAY_BUFFER,new Uint8Array(this._flags),this._flags.length,4,e.DYNAMIC_DRAW,t),this._state.flags2Buf=new W(e,e.ARRAY_BUFFER,new Uint8Array(this._flags2),this._flags2.length,4,e.DYNAMIC_DRAW,t),this._flags=[],this._flags2=[]}if(this._modelMatrixCol0.length>0){let t=!1;this._state.modelMatrixCol0Buf=new W(e,e.ARRAY_BUFFER,new Float32Array(this._modelMatrixCol0),this._modelMatrixCol0.length,4,e.STATIC_DRAW,t),this._state.modelMatrixCol1Buf=new W(e,e.ARRAY_BUFFER,new Float32Array(this._modelMatrixCol1),this._modelMatrixCol1.length,4,e.STATIC_DRAW,t),this._state.modelMatrixCol2Buf=new W(e,e.ARRAY_BUFFER,new Float32Array(this._modelMatrixCol2),this._modelMatrixCol2.length,4,e.STATIC_DRAW,t),this._modelMatrixCol0=[],this._modelMatrixCol1=[],this._modelMatrixCol2=[],this._state.modelNormalMatrixCol0Buf=new W(e,e.ARRAY_BUFFER,new Float32Array(this._modelNormalMatrixCol0),this._modelNormalMatrixCol0.length,4,e.STATIC_DRAW,t),this._state.modelNormalMatrixCol1Buf=new W(e,e.ARRAY_BUFFER,new Float32Array(this._modelNormalMatrixCol1),this._modelNormalMatrixCol1.length,4,e.STATIC_DRAW,t),this._state.modelNormalMatrixCol2Buf=new W(e,e.ARRAY_BUFFER,new Float32Array(this._modelNormalMatrixCol2),this._modelNormalMatrixCol2.length,4,e.STATIC_DRAW,t),this._modelNormalMatrixCol0=[],this._modelNormalMatrixCol1=[],this._modelNormalMatrixCol2=[]}if(this._pickColors.length>0){let t=!1;this._state.pickColorsBuf=new W(e,e.ARRAY_BUFFER,new Uint8Array(this._pickColors),this._pickColors.length,4,e.STATIC_DRAW,t),this._pickColors=[]}this._finalized=!0}initFlags(e,t){t&xi.VISIBLE&&(this._numVisibleLayerPortions++,this.model.numVisibleLayerPortions++),t&xi.HIGHLIGHTED&&(this._numHighlightedLayerPortions++,this.model.numHighlightedLayerPortions++),t&xi.XRAYED&&(this._numXRayedLayerPortions++,this.model.numXRayedLayerPortions++),t&xi.SELECTED&&(this._numSelectedLayerPortions++,this.model.numSelectedLayerPortions++),t&xi.EDGES&&(this._numEdgesLayerPortions++,this.model.numEdgesLayerPortions++),t&xi.PICKABLE&&(this._numPickableLayerPortions++,this.model.numPickableLayerPortions++),this._setFlags(e,t),this._setFlags2(e,t)}setVisible(e,t){if(!this._finalized)throw"Not finalized";t&xi.VISIBLE?(this._numVisibleLayerPortions++,this.model.numVisibleLayerPortions++):(this._numVisibleLayerPortions--,this.model.numVisibleLayerPortions--),this._setFlags(e,t)}setHighlighted(e,t){if(!this._finalized)throw"Not finalized";t&xi.HIGHLIGHTED?(this._numHighlightedLayerPortions++,this.model.numHighlightedLayerPortions++):(this._numHighlightedLayerPortions--,this.model.numHighlightedLayerPortions--),this._setFlags(e,t)}setXRayed(e,t){if(!this._finalized)throw"Not finalized";t&xi.XRAYED?(this._numXRayedLayerPortions++,this.model.numXRayedLayerPortions++):(this._numXRayedLayerPortions--,this.model.numXRayedLayerPortions--),this._setFlags(e,t)}setSelected(e,t){if(!this._finalized)throw"Not finalized";t&xi.SELECTED?(this._numSelectedLayerPortions++,this.model.numSelectedLayerPortions++):(this._numSelectedLayerPortions--,this.model.numSelectedLayerPortions--),this._setFlags(e,t)}setEdges(e,t){if(!this._finalized)throw"Not finalized";t&xi.EDGES?(this._numEdgesLayerPortions++,this.model.numEdgesLayerPortions++):(this._numEdgesLayerPortions--,this.model.numEdgesLayerPortions--),this._setFlags2(e,t)}setClippable(e,t){if(!this._finalized)throw"Not finalized";this._setFlags2(e,t)}setCollidable(e,t){if(!this._finalized)throw"Not finalized"}setPickable(e,t){if(!this._finalized)throw"Not finalized";t&xi.PICKABLE?(this._numPickableLayerPortions++,this.model.numPickableLayerPortions++):(this._numPickableLayerPortions--,this.model.numPickableLayerPortions--),this._setFlags2(e,t)}setColor(e,t,i=!1){if(!this._finalized)throw"Not finalized";if(mo[0]=t[0],mo[1]=t[1],mo[2]=t[2],mo[3]=t[3],i){t[3]<255?(this._numTransparentLayerPortions++,this.model.numTransparentLayerPortions++):(this._numTransparentLayerPortions--,this.model.numTransparentLayerPortions--)}this._state.colorsBuf.setData(mo,4*e,4)}_setFlags(e,t){if(!this._finalized)throw"Not finalized";var i=t&xi.VISIBLE?255:0,r=t&xi.XRAYED?255:0,o=t&xi.HIGHLIGHTED?255:0,s=t&xi.SELECTED?255:0;mo[0]=i,mo[1]=r,mo[2]=o,mo[3]=s,this._state.flagsBuf.setData(mo,4*e,4)}_setFlags2(e,t){if(!this._finalized)throw"Not finalized";var i=t&xi.CLIPPABLE?255:0,r=t&xi.EDGES?255:0,o=t&xi.PICKABLE?255:0;mo[0]=i,mo[1]=r,mo[2]=o,this._state.flags2Buf.setData(mo,4*e,4)}drawNormalFillOpaque(e){0!==this._numVisibleLayerPortions&&this._numTransparentLayerPortions!==this._numPortions&&this._numXRayedLayerPortions!==this._numPortions&&this._drawRenderer&&this._drawRenderer.drawLayer(e,this,Ti.NORMAL_OPAQUE)}drawNormalEdgesOpaque(e){0!==this._numVisibleLayerPortions&&0!==this._numEdgesLayerPortions&&this._edgesRenderer&&this._edgesRenderer.drawLayer(e,this,Ti.NORMAL_OPAQUE)}drawNormalFillTransparent(e){0!==this._numVisibleLayerPortions&&0!==this._numTransparentLayerPortions&&this._numXRayedLayerPortions!==this._numPortions&&this._drawRenderer&&this._drawRenderer.drawLayer(e,this,Ti.NORMAL_TRANSPARENT)}drawNormalTransparentEdges(e){0!==this._numVisibleLayerPortions&&0!==this._numEdgesLayerPortions&&0!==this._numTransparentLayerPortions&&this._edgesRenderer&&this._edgesRenderer.drawLayer(e,this,Ti.NORMAL_TRANSPARENT)}drawXRayedFillOpaque(e){0!==this._numVisibleLayerPortions&&0!==this._numXRayedLayerPortions&&this._fillRenderer&&this._fillRenderer.drawLayer(e,this,Ti.XRAYED)}drawXRayedEdgesOpaque(e){0!==this._numVisibleLayerPortions&&0!==this._numXRayedLayerPortions&&this._edgesRenderer&&this._edgesRenderer.drawLayer(e,this,Ti.XRAYED)}drawXRayedFillTransparent(e){0!==this._numVisibleLayerPortions&&0!==this._numXRayedLayerPortions&&this._fillRenderer&&this._fillRenderer.drawLayer(e,this,Ti.XRAYED)}drawXRayedEdgesTransparent(e){0!==this._numVisibleLayerPortions&&0!==this._numXRayedLayerPortions&&this._edgesRenderer&&this._edgesRenderer.drawLayer(e,this,Ti.XRAYED)}drawHighlightedFillOpaque(e){0!==this._numVisibleLayerPortions&&0!==this._numHighlightedLayerPortions&&this._fillRenderer&&this._fillRenderer.drawLayer(e,this,Ti.HIGHLIGHTED)}drawHighlightedEdgesOpaque(e){0!==this._numVisibleLayerPortions&&0!==this._numHighlightedLayerPortions&&this._edgesRenderer&&this._edgesRenderer.drawLayer(e,this,Ti.HIGHLIGHTED)}drawHighlightedFillTransparent(e){0!==this._numVisibleLayerPortions&&0!==this._numHighlightedLayerPortions&&this._fillRenderer&&this._fillRenderer.drawLayer(e,this,Ti.HIGHLIGHTED)}drawHighlightedEdgesTransparent(e){0!==this._numVisibleLayerPortions&&0!==this._numHighlightedLayerPortions&&this._edgesRenderer&&this._edgesRenderer.drawLayer(e,this,Ti.HIGHLIGHTED)}drawSelectedFillOpaque(e){0!==this._numVisibleLayerPortions&&0!==this._numSelectedLayerPortions&&this._fillRenderer&&this._fillRenderer.drawLayer(e,this,Ti.SELECTED)}drawSelectedEdgesOpaque(e){0!==this._numVisibleLayerPortions&&0!==this._numSelectedLayerPortions&&this._edgesRenderer&&this._edgesRenderer.drawLayer(e,this,Ti.SELECTED)}drawSelectedFillTransparent(e){0!==this._numVisibleLayerPortions&&0!==this._numSelectedLayerPortions&&this._fillRenderer&&this._fillRenderer.drawLayer(e,this,Ti.SELECTED)}drawSelectedEdgesTransparent(e){0!==this._numVisibleLayerPortions&&0!==this._numSelectedLayerPortions&&this._edgesRenderer&&this._edgesRenderer.drawLayer(e,this,Ti.SELECTED)}drawPickMesh(e){0!==this._numVisibleLayerPortions&&this._pickMeshRenderer&&this._pickMeshRenderer.drawLayer(e,this)}drawPickDepths(e){0!==this._numVisibleLayerPortions&&this._pickDepthRenderer&&this._pickDepthRenderer.drawLayer(e,this)}drawPickNormals(e){0!==this._numVisibleLayerPortions&&this._pickNormalsRenderer&&this._pickNormalsRenderer.drawLayer(e,this)}drawOcclusion(e){0!==this._numVisibleLayerPortions&&(this._occlusionRenderer||(this._occlusionRenderer=no.get(this)),this._occlusionRenderer&&this._occlusionRenderer.drawLayer(e,this))}compileShaders(){this._drawRenderer&&!1===this._drawRenderer.getValid()&&(this._drawRenderer.put(),this._drawRenderer=null),this._fillRenderer&&!1===this._fillRenderer.getValid()&&(this._fillRenderer.put(),this._fillRenderer=null),this._edgesRenderer&&!1===this._edgesRenderer.getValid()&&(this._edgesRenderer.put(),this._edgesRenderer=null),this._pickMeshRenderer&&!1===this._pickMeshRenderer.getValid()&&(this._pickMeshRenderer.put(),this._pickMeshRenderer=null),this._pickDepthRenderer&&!1===this._pickDepthRenderer.getValid()&&(this._pickDepthRenderer.put(),this._pickDepthRenderer=null),this._pickNormalsRenderer&&!1===this._pickNormalsRenderer.getValid()&&(this._pickNormalsRenderer.put(),this._pickNormalsRenderer=null),this._occlusionRenderer&&!1===this._occlusionRenderer.getValid()&&(this._occlusionRenderer.put(),this._occlusionRenderer=null),this._drawRenderer||(this._drawRenderer=Cr.get(this)),this._fillRenderer||(this._fillRenderer=Ir.get(this)),this._edgesRenderer||(this._edgesRenderer=zr.get(this)),this._pickMeshRenderer||(this._pickMeshRenderer=Wr.get(this)),this._pickDepthRenderer||(this._pickDepthRenderer=$r.get(this)),this._pickNormalsRenderer||(this._pickNormalsRenderer=to.get(this))}destroy(){this._drawRenderer&&(this._drawRenderer.put(),this._drawRenderer=null),this._fillRenderer&&(this._fillRenderer.put(),this._fillRenderer=null),this._edgesRenderer&&(this._edgesRenderer.put(),this._edgesRenderer=null),this._pickMeshRenderer&&(this._pickMeshRenderer.put(),this._pickMeshRenderer=null),this._pickDepthRenderer&&(this._pickDepthRenderer.put(),this._pickDepthRenderer=null),this._pickNormalsRenderer&&(this._pickNormalsRenderer.put(),this._pickNormalsRenderer=null),this._occlusionRenderer&&(this._occlusionRenderer.put(),this._occlusionRenderer=null);const e=this._state;e.positionsBuf&&(e.positionsBuf.destroy(),e.positionsBuf=null),e.normalsBuf&&(e.normalsBuf.destroy(),e.normalsBuf=null),e.colorsBuf&&(e.colorsBuf.destroy(),e.colorsBuf=null),e.flagsBuf&&(e.flagsBuf.destroy(),e.flagsBuf=null),e.flags2Buf&&(e.flags2Buf.destroy(),e.flags2Buf=null),e.modelMatrixCol0Buf&&(e.modelMatrixCol0Buf.destroy(),e.modelMatrixCol0Buf=null),e.modelMatrixCol1Buf&&(e.modelMatrixCol1Buf.destroy(),e.modelMatrixCol1Buf=null),e.modelMatrixCol2Buf&&(e.modelMatrixCol2Buf.destroy(),e.modelMatrixCol2Buf=null),e.modelNormalMatrixCol0Buf&&(e.modelNormalMatrixCol0Buf.destroy(),e.modelNormalMatrixCol0Buf=null),e.modelNormalMatrixCol1Buf&&(e.modelNormalMatrixCol1Buf.destroy(),e.modelNormalMatrixCol1Buf=null),e.modelNormalMatrixCol2Buf&&(e.modelNormalMatrixCol2Buf.destroy(),e.modelNormalMatrixCol2Buf=null),e.indicesBuf&&(e.indicesBuf.destroy(),e.indicessBuf=null),e.edgeIndicesBuf&&(e.edgeIndicesBuf.destroy(),e.edgeIndicessBuf=null),e.pickColorsBuf&&(e.pickColorsBuf.destroy(),e.pickColorsBuf=null),e.destroy()}}var vo=function(){const e=u.mat4(),t=u.mat4(),i=u.vec3();return function(r,o,s,n,a){const l=s[0],c=s[1],h=s[2],d=s[3],p=s[4],m=s[5],f=s[3]-l,g=s[4]-c,b=s[5]-h,_=d!==l?65535/(d-l):0,v=p!==c?65535/(p-c):0,x=m!==h?65535/(m-h):0;let y;for(y=0;y<o;y+=3)n[y+0]=Math.floor((r[y+0]-l)*_),n[y+1]=Math.floor((r[y+1]-c)*v),n[y+2]=Math.floor((r[y+2]-h)*x);u.identityMat4(e),u.translationMat4v(s,e),u.identityMat4(t),i[0]=f/65535,i[1]=g/65535,i[2]=b/65535,u.scalingMat4v(i,t),u.mulMat4(e,t,a)}}();function xo(e,t,i,r){let o=e[t]/(Math.abs(e[t])+Math.abs(e[t+1])+Math.abs(e[t+2])),s=e[t+1]/(Math.abs(e[t])+Math.abs(e[t+1])+Math.abs(e[t+2]));if(e[t+2]<0){let e=o,t=s;e=(1-Math.abs(s))*(o>=0?1:-1),t=(1-Math.abs(o))*(s>=0?1:-1),o=e,s=t}return new Int8Array([Math[i](127.5*o+(o<0?-1:0)),Math[r](127.5*s+(s<0?-1:0))])}function yo(e){let t=e[0],i=e[1];t/=t<0?127:128,i/=i<0?127:128;const r=1-Math.abs(t)-Math.abs(i);r<0&&(t=(1-Math.abs(i))*(t>=0?1:-1),i=(1-Math.abs(t))*(i>=0?1:-1));const o=Math.sqrt(t*t+i*i+r*r);return[t/o,i/o,r/o]}function wo(e,t,i){return e[t]*i[0]+e[t+1]*i[1]+e[t+2]*i[2]}const Mo=q.SUPPORTED_EXTENSIONS.ANGLE_instanced_arrays;var ko=u.mat4();const Po=u.vec3([1,1,1]),Eo=u.vec3([0,0,0]),Ao=u.vec3([0,0,0]),Co=u.identityQuaternion(),To="__default";class Do extends B{constructor(e,t={}){super(e,t),this._preCompressed=!!t.preCompressed,this._tiles={},this._aabb=u.collapseAABB3(),this._layers=[],this._nodes=[],this.numGeometries=0,this.numPortions=0,this.numVisibleLayerPortions=0,this.numTransparentLayerPortions=0,this.numXRayedLayerPortions=0,this.numHighlightedLayerPortions=0,this.numSelectedLayerPortions=0,this.numEdgesLayerPortions=0,this.numPickableLayerPortions=0,this.numEntities=0,this.numTriangles=0,this.visible=t.visible,this.culled=t.culled,this.pickable=t.pickable,this.clippable=t.clippable,this.collidable=t.collidable,this.castsShadow=t.castsShadow,this.receivesShadow=t.receivesShadow,this.xrayed=t.xrayed,this.highlighted=t.highlighted,this.selected=t.selected,this.edges=t.edges,this.colorize=t.colorize,this.opacity=t.opacity,this._position=new Float32Array(t.position||[0,0,0]),this._rotation=new Float32Array(t.rotation||[0,0,0]),this._quaternion=new Float32Array(t.quaternion||[0,0,0,1]),t.rotation&&u.eulerToQuaternion(this._rotation,"XYZ",this._quaternion),this._scale=new Float32Array(t.scale||[1,1,1]),this._worldMatrix=u.mat4(),u.composeMat4(this._position,this._quaternion,this._scale,this._worldMatrix),this._worldNormalMatrix=u.mat4(),(t.matrix||t.position||t.rotation||t.scale||t.quaternion)&&(this._viewMatrix=u.mat4(),this._viewNormalMatrix=u.mat4(),this._viewMatrixDirty=!0,this._worldMatrixNonIdentity=!0),this._opacity=1,this._colorize=[1,1,1],this._isModel=t.isModel,this._isModel&&this.scene._registerModel(this),this.createTile({id:To}),this._onCameraViewMatrix=this.scene.camera.on("matrix",()=>{this._viewMatrixDirty=!0})}get isPerformanceModel(){return!0}get position(){return this._position}get rotation(){return this._rotation}get quaternion(){return this._quaternion}get scale(){return this._scale}get matrix(){return this._worldMatrix}get worldMatrix(){return this._worldMatrix}get worldNormalMatrix(){return this._worldNormalMatrix}get viewMatrix(){return this._viewMatrix?(this._viewMatrixDirty&&(u.mulMat4(this.scene.camera.viewMatrix,this._worldMatrix,this._viewMatrix),u.inverseMat4(this._viewMatrix,this._viewNormalMatrix),u.transposeMat4(this._viewNormalMatrix),this._viewMatrixDirty=!1),this._viewMatrix):this.scene.camera.viewMatrix}getPickViewMatrix(e){return this._viewMatrix?this._viewMatrix:e}get viewNormalMatrix(){return this._viewNormalMatrix?(this._viewMatrixDirty&&(u.mulMat4(this.scene.camera.viewMatrix,this._worldMatrix,this._viewMatrix),u.inverseMat4(this._viewMatrix,this._viewNormalMatrix),u.transposeMat4(this._viewNormalMatrix),this._viewMatrixDirty=!1),this._viewNormalMatrix):this.scene.camera.viewNormalMatrix}createTile(e){if(this._tiles[e.id])return void this.warn("Tile already exists: "+e.id);const t={id:e.id,layers:[],instancingLayers:{},currentBatchingLayer:null,buffer:Ai.length>0?Ai.pop():new Ei,meshes:{},nodes:[]};this._tiles[e.id]=t}createGeometry(e){if(!Mo)return void this.error("WebGL instanced arrays not supported");const t=e.id;if(null==t)return void this.error("Config missing: id");const i=e.tileId||To;var r=this._tiles[i];if(r||(this.error("Tile not found: "+i+" - using default tile"),r=this._tiles[To]),r.instancingLayers[t])this.error("Geometry already created: "+t);else{e.preCompressed=this._preCompressed;var o=new _o(this,e);r.layers.push(o),r.instancingLayers[t]=o,this.numGeometries++,this.numTriangles+=e.indices?e.indices.length/3:0}}createMesh(e){var t=e.id;if(null==t)return void this.error("Config missing: id");this.scene.components[t]&&(this.error("Scene already has a Component with this ID: "+t+" - will assign random ID"),t=u.createUUID());const i=e.geometryId,r=void 0!==i,o=e.tileId||To;var s=this._tiles[o];if(s||(this.error("Tile not found: "+o+" - using default tile"),s=this._tiles[To]),r){if(!Mo)return void this.error("WebGL instanced arrays not supported");if(!s.instancingLayers[i])return void this.error("Geometry not found: "+i+" - ensure that you create it first with createGeometry()")}var n,a;const l=e.color?new Uint8Array([Math.floor(255*e.color[0]),Math.floor(255*e.color[1]),Math.floor(255*e.color[2])]):[255,255,255],c=void 0!==e.opacity&&null!==e.opacity?Math.floor(255*e.opacity):255;c<255&&this.numTransparentLayerPortions++;var h=new vi(this,t,l,c),d=h.pickId;const p=new Uint8Array([255&d,d>>8&255,d>>16&255,d>>24&255]),m=u.collapseAABB3();if(r){let t,r=this._worldMatrixNonIdentity?this._worldMatrix:null;if(e.matrix)t=e.matrix;else{const i=e.scale||Po,r=e.position||Eo,o=e.rotation||Ao;u.eulerToQuaternion(o,"XYZ",Co),t=u.composeMat4(r,Co,i,ko)}var f=s.instancingLayers[i];n=f,a=f.createPortion(0,l,c,t,r,m,p),u.expandAABB3(this._aabb,m),this.numTriangles+=f.numIndices.length/3}else{var g=e.primitive||"triangles";"points"!==g&&"lines"!==g&&"line-loop"!==g&&"line-strip"!==g&&"triangles"!==g&&"triangle-strip"!==g&&"triangle-fan"!==g&&(this.error(`Unsupported value for 'primitive': '${g}' - supported values are 'points', 'lines', 'line-loop', 'line-strip', 'triangles', 'triangle-strip' and 'triangle-fan'. Defaulting to 'triangles'.`),g="triangles");var b=e.indices,_=e.edgeIndices,v=e.positions;if(!v)return this.error("Config missing: positions (no meshIds provided, so expecting geometry arrays instead)"),null;var x=e.normals;if(!x)return this.error("Config missing: normals (no meshIds provided, so expecting geometry arrays instead)"),null;if(!_&&!b)return this.error("Config missing: must have one or both of indices and edgeIndices  (no meshIds provided, so expecting geometry arrays instead)"),null;let t;s.currentBatchingLayer&&(s.currentBatchingLayer.canCreatePortion(v.length)||(s.currentBatchingLayer.finalize(),s.currentBatchingLayer=null)),s.currentBatchingLayer||(s.currentBatchingLayer=new yr(this,{primitive:"triangles",buffer:s.buffer,preCompressed:this._preCompressed,positionsDecodeMatrix:e.positionsDecodeMatrix}),s.layers.push(s.currentBatchingLayer)),n=s.currentBatchingLayer,!_&&b&&(_=Y(v,b,null,10));let i=this._worldMatrixNonIdentity?this._worldMatrix:null;if(!this._preCompressed)if(e.matrix)t=e.matrix;else{const i=e.scale||Po,r=e.position||Eo,o=e.rotation||Ao;u.eulerToQuaternion(o,"XYZ",Co),t=u.composeMat4(r,Co,i,ko)}a=s.currentBatchingLayer.createPortion(v,x,b,_,0,l,c,t,i,m,p),u.expandAABB3(this._aabb,m),this.numGeometries++,this.numTriangles+=b.length/3}h.parent=null,h._layer=n,h._portionId=a,h.aabb=m,s.meshes[t]=h}createEntity(e){var t=e.id;void 0===t?t=u.createUUID():this.scene.components[t]&&(this.error("Scene already has a Component with this ID: "+t+" - will assign random ID"),t=u.createUUID());var i=e.meshIds;if(void 0===i)return void this.error("Config missing: meshIds");const r=e.tileId||To;var o,s,n,a,l=this._tiles[r];l||(this.error("Tile not found: "+r+" - using default tile"),l=this._tiles[To]);var c=[];for(o=0,s=i.length;o<s;o++)n=i[o],(a=l.meshes[n])?a.parent?this.error("Mesh with ID "+n+" already belongs to object with ID "+a.parent.id+" - ignoring this mesh"):(delete l.meshes[n],c.push(a)):this.error("Mesh with this ID not found: "+n+" - ignoring this mesh");var h,d=0;if(this._visible&&!1!==e.visible&&(d|=xi.VISIBLE),this._pickable&&!1!==e.pickable&&(d|=xi.PICKABLE),this._clippable&&!1!==e.clippable&&(d|=xi.CLIPPABLE),this._collidable&&!1!==e.collidable&&(d|=xi.COLLIDABLE),this._edges&&!1!==e.edges&&(d|=xi.EDGES),this._xrayed&&!1!==e.xrayed&&(d|=xi.XRAYED),this._highlighted&&!1!==e.highlighted&&(d|=xi.HIGHLIGHTED),this._selected&&!1!==e.selected&&(d|=xi.SELECTED),1===c.length)h=c[0].aabb;else for(h=u.collapseAABB3(),o=0,s=c.length;o<s;o++)u.expandAABB3(h,c[o].aabb);var p=new wi(this,e.isObject,t,c,d,h);return l.nodes.push(p),this.numEntities++,p}finalizeTile(e){const t=this._tiles[e];if(t){t.currentBatchingLayer&&(t.currentBatchingLayer.finalize(),t.currentBatchingLayer=null),t.buffer&&(Ci(t.buffer),t.buffer=null);for(const e in t.instancingLayers)t.instancingLayers.hasOwnProperty(e)&&t.instancingLayers[e].finalize();for(var i=0,r=t.nodes.length;i<r;i++){const e=t.nodes[i];e._finalize(),this._nodes.push(e)}for(i=0,r=t.layers.length;i<r;i++){const e=t.layers[i];e instanceof _o?this._layers.unshift(e):this._layers.push(e)}delete this._tiles[e],this.glRedraw(),this.scene._aabbDirty=!0}else this.warn("Tile not found: "+e)}finalize(){for(var e in this._tiles)this._tiles.hasOwnProperty(e)&&this.finalizeTile(e)}get isEntity(){return!0}get isModel(){return this._isModel}get isObject(){return!1}get aabb(){return this._aabb}set visible(e){e=!1!==e,this._visible=e;for(var t=0,i=this._nodes.length;t<i;t++)this._nodes[t].visible=e;this.glRedraw()}get visible(){return this.numVisibleLayerPortions>0}set xrayed(e){e=!!e,this._xrayed=e;for(var t=0,i=this._nodes.length;t<i;t++)this._nodes[t].xrayed=e;this.glRedraw()}get xrayed(){return this.numXRayedLayerPortions>0}set highlighted(e){e=!!e,this._highlighted=e;for(var t=0,i=this._nodes.length;t<i;t++)this._nodes[t].highlighted=e;this.glRedraw()}get highlighted(){return this.numHighlightedLayerPortions>0}set selected(e){e=!!e,this._selected=e;for(var t=0,i=this._nodes.length;t<i;t++)this._nodes[t].selected=e;this.glRedraw()}get selected(){return this.numSelectedLayerPortions>0}set edges(e){e=!!e,this._edges=e;for(var t=0,i=this._nodes.length;t<i;t++)this._nodes[t].edges=e;this.glRedraw()}get edges(){return this.numEdgesLayerPortions>0}set culled(e){e=!!e,this._culled=e,this.glRedraw()}get culled(){return this._culled}set clippable(e){e=!1!==e,this._clippable=e;for(var t=0,i=this._nodes.length;t<i;t++)this._nodes[t].clippable=e;this.glRedraw()}get clippable(){return this._clippable}set collidable(e){e=!1!==e,this._collidable=e;for(var t=0,i=this._nodes.length;t<i;t++)this._nodes[t].collidable=e}get collidable(){return this._collidable}set pickable(e){e=!1!==e,this._pickable=e;for(var t=0,i=this._nodes.length;t<i;t++)this._nodes[t].pickable=e}get pickable(){return this._pickable}set colorize(e){this._colorize=e;for(var t=0,i=this._nodes.length;t<i;t++)this._nodes[t].colorize=e}get colorize(){return this._colorize}set opacity(e){this._opacity=e;for(var t=0,i=this._nodes.length;t<i;t++)this._nodes[t].opacity=e}get opacity(){return this._opacity}set castsShadow(e){}get castsShadow(){return!1}set receivesShadow(e){}get receivesShadow(){return!1}get isDrawable(){return!0}get isStateSortable(){return!1}stateSortCompare(e,t){}getRenderFlags(e){if(e.reset(),0!==this.numVisibleLayerPortions){if(e.normalFillOpaque=!0,this.numXRayedLayerPortions>0){const t=this.scene.xrayMaterial._state;t.fill&&(t.fillAlpha<1?e.xrayedFillTransparent=!0:e.xrayedFillOpaque=!0),t.edges&&(t.edgeAlpha<1?e.xrayedEdgesTransparent=!0:e.xrayedEdgesOpaque=!0)}if(this.numEdgesLayerPortions>0){this.scene.edgeMaterial._state.alpha<1?e.normalEdgesTransparent=!0:e.normalEdgesOpaque=!0}if(this.numTransparentLayerPortions>0&&(e.normalFillTransparent=!0),this.numSelectedLayerPortions>0){const t=this.scene.selectedMaterial._state;t.fill&&(t.fillAlpha<1?e.selectedFillTransparent=!0:e.selectedFillOpaque=!0),t.edges&&(t.edgeAlpha<1?e.selectedEdgesTransparent=!0:e.selectedEdgesOpaque=!0)}if(this.numHighlightedLayerPortions>0){const t=this.scene.highlightMaterial._state;t.fill&&(t.fillAlpha<1?e.highlightedFillTransparent=!0:e.highlightedFillOpaque=!0),t.edges&&(t.edgeAlpha<1?e.highlightedEdgesTransparent=!0:e.highlightedEdgesOpaque=!0)}}}get xrayMaterial(){return this.scene.xrayMaterial}get highlightMaterial(){return this.scene.highlightMaterial}get selectedMaterial(){return this.scene.selectedMaterial}get edgeMaterial(){return this.scene.edgeMaterial}drawNormalFillOpaque(e){this.scene.canvas.gl.disable(this.scene.canvas.gl.CULL_FACE);for(var t=0,i=this._layers.length;t<i;t++)this._layers[t].drawNormalFillOpaque(e)}drawNormalEdgesOpaque(e){for(var t=0,i=this._layers.length;t<i;t++)this._layers[t].drawNormalEdgesOpaque(e)}drawNormalFillTransparent(e){for(var t=0,i=this._layers.length;t<i;t++)this._layers[t].drawNormalFillTransparent(e)}drawNormalEdgesTransparent(e){for(var t=0,i=this._layers.length;t<i;t++)this._layers[t].drawNormalEdgesTransparent(e)}drawXRayedFillOpaque(e){for(var t=0,i=this._layers.length;t<i;t++)this._layers[t].drawXRayedFillOpaque(e)}drawXRayedEdgesOpaque(e){for(var t=0,i=this._layers.length;t<i;t++)this._layers[t].drawXRayedEdgesOpaque(e)}drawXRayedFillTransparent(e){for(var t=0,i=this._layers.length;t<i;t++)this._layers[t].drawXRayedFillTransparent(e)}drawXRayedEdgesTransparent(e){for(var t=0,i=this._layers.length;t<i;t++)this._layers[t].drawXRayedEdgesTransparent(e)}drawHighlightedFillOpaque(e){for(var t=0,i=this._layers.length;t<i;t++)this._layers[t].drawHighlightedFillOpaque(e)}drawHighlightedEdgesOpaque(e){for(var t=0,i=this._layers.length;t<i;t++)this._layers[t].drawHighlightedEdgesOpaque(e)}drawHighlightedFillTransparent(e){for(var t=0,i=this._layers.length;t<i;t++)this._layers[t].drawHighlightedFillTransparent(e)}drawHighlightedEdgesTransparent(e){for(var t=0,i=this._layers.length;t<i;t++)this._layers[t].drawHighlightedEdgesTransparent(e)}drawSelectedFillOpaque(e){for(var t=0,i=this._layers.length;t<i;t++)this._layers[t].drawSelectedFillOpaque(e)}drawSelectedEdgesOpaque(e){for(var t=0,i=this._layers.length;t<i;t++)this._layers[t].drawSelectedEdgesOpaque(e)}drawSelectedFillTransparent(e){for(var t=0,i=this._layers.length;t<i;t++)this._layers[t].drawSelectedFillTransparent(e)}drawSelectedEdgesTransparent(e){for(var t=0,i=this._layers.length;t<i;t++)this._layers[t].drawSelectedEdgesTransparent(e)}drawPickMesh(e){if(0!==this.numVisibleLayerPortions)for(var t=0,i=this._layers.length;t<i;t++)this._layers[t].drawPickMesh(e)}drawPickDepths(e){if(0!==this.numVisibleLayerPortions)for(var t=0,i=this._layers.length;t<i;t++)this._layers[t].drawPickDepths(e)}drawPickNormals(e){if(0!==this.numVisibleLayerPortions)for(var t=0,i=this._layers.length;t<i;t++)this._layers[t].drawPickNormals(e)}drawOcclusion(e){if(0!==this.numVisibleLayerPortions)for(var t=0,i=this._layers.length;t<i;t++)this._layers[t].drawOcclusion(e)}compile(){for(var e=0,t=this._layers.length;e<t;e++)this._layers[e].compileShaders()}destroy(){for(var e in this._tiles)if(this._tiles.hasOwnProperty(e)){const r=this._tiles[e];var t=0;for(r.nodes.length;t<i;t++){r.nodes[t]._destroy()}Ci(r.buffer)}this.scene.camera.off(this._onCameraViewMatrix),super.destroy();t=0;for(var i=this._layers.length;t<i;t++)this._layers[t].destroy();for(t=0,i=this._nodes.length;t<i;t++)this._nodes[t]._destroy();this.scene._aabbDirty=!0,this._isModel&&this.scene._deregisterModel(this)}}class So{constructor(){}getMetaModel(e,t,i){s.loadJSON(e,e=>{t(e)},(function(e){i(e)}))}getXKT(e,t,i){var r=()=>{};t=t||r,i=i||r;const o=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(o){const e=!!o[2];var s=o[3];s=window.decodeURIComponent(s),e&&(s=window.atob(s));try{const e=new ArrayBuffer(s.length),i=new Uint8Array(e);for(var n=0;n<s.length;n++)i[n]=s.charCodeAt(n);t(e)}catch(e){i(e)}}else{const r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onreadystatechange=function(){4===r.readyState&&(200===r.status?t(r.response):i("getXKT error : "+r.response))},r.send(null)}}}const Lo={IfcRoof:{colorize:[.837255,.203922,.270588],priority:0},IfcSlab:{colorize:[.637255,.603922,.670588],priority:0},IfcWall:{colorize:[.537255,.337255,.237255],priority:0},IfcWallStandardCase:{colorize:[.537255,.337255,.237255],priority:0},IfcCovering:{colorize:[.8470588235,.427450980392,0],priority:0},IfcDoor:{colorize:[.637255,.603922,.670588],priority:1},IfcStair:{colorize:[.637255,.603922,.670588],priority:2},IfcStairFlight:{colorize:[.637255,.603922,.670588],priority:2},IfcProxy:{colorize:[.137255,.403922,.870588],priority:2},IfcRamp:{colorize:[.8470588235,.427450980392,0],priority:2},IfcColumn:{colorize:[.137255,.403922,.870588],priority:3},IfcBeam:{colorize:[.137255,.403922,.870588],priority:3},IfcCurtainWall:{colorize:[.137255,.403922,.870588],priority:3},IfcPlate:{colorize:[.8470588235,.427450980392,0,.5],opacity:.5,priority:3},IfcTransportElement:{colorize:[.8470588235,.427450980392,0],priority:3},IfcFooting:{colorize:[.8470588235,.427450980392,0],priority:3},IfcRailing:{colorize:[.137255,.403922,.870588],priority:4},IfcFurnishingElement:{colorize:[.137255,.403922,.870588],priority:4},IfcFurniture:{colorize:[.8470588235,.427450980392,0],priority:4},IfcSystemFurnitureElement:{colorize:[.8470588235,.427450980392,0],priority:4},IfcFlowSegment:{colorize:[.137255,.403922,.870588],priority:5},IfcFlowitting:{colorize:[.137255,.403922,.870588],priority:5},IfcFlowTerminal:{colorize:[.137255,.403922,.870588],priority:5},IfcFlowController:{colorize:[.8470588235,.427450980392,0],priority:5},IfcFlowFitting:{colorize:[.8470588235,.427450980392,0],priority:5},IfcDuctSegment:{colorize:[.8470588235,.427450980392,0],priority:5},IfcDistributionFlowElement:{colorize:[.8470588235,.427450980392,0],priority:5},IfcDuctFitting:{colorize:[.8470588235,.427450980392,0],priority:5},IfcLightFixture:{colorize:[.8470588235,.8470588235,.870588],priority:5},IfcAirTerminal:{colorize:[.8470588235,.427450980392,0],priority:6},IfcOpeningElement:{colorize:[.137255,.403922,.870588],pickable:!1,visible:!1,priority:6},IfcSpace:{colorize:[.137255,.403922,.870588],pickable:!1,visible:!1,opacity:.5,priority:6},IfcWindow:{colorize:[.137255,.403922,.870588],pickable:!1,opacity:.4,priority:6},IfcBuildingElementProxy:{colorize:[.5,.5,.5]},IfcSite:{colorize:[.137255,.403922,.870588]},IfcMember:{colorize:[.8470588235,.427450980392,0]},DEFAULT:{colorize:[.5,.5,.5],priority:10}};var Ro=i(0);let Io=window.pako||Ro;Io.inflate||(Io=Io.default);const No=2,Fo=function(){const e=new Float32Array(3);return function(t){return e[0]=t[0]/255,e[1]=t[1]/255,e[2]=t[2]/255,e}}();class Bo extends k{constructor(e,t={}){super("XKTLoader",e,t),this.dataSource=t.dataSource,this.objectDefaults=t.objectDefaults,this.includeTypes=t.includeTypes,this.excludeTypes=t.excludeTypes}static get XKTVersion(){return No}set dataSource(e){this._dataSource=e||new So}get dataSource(){return this._dataSource}set objectDefaults(e){this._objectDefaults=e||Lo}get objectDefaults(){return this._objectDefaults}set includeTypes(e){this._includeTypes=e}get includeTypes(){return this._includeTypes}set excludeTypes(e){this._excludeTypes=e}get excludeTypes(){return this._excludeTypes}load(e={}){e.id&&this.viewer.scene.components[e.id]&&(this.error("Component with this ID already exists in viewer: "+e.id+" - will autogenerate this ID"),delete e.id);const t=new Do(this.viewer.scene,s.apply(e,{isModel:!0,preCompressed:!0})),i=t.id;if(!e.src&&!e.xkt)return this.error("load() param expected: src or xkt"),t;const r={};if(e.metaModelSrc||e.metaModelData){const o=e.includeTypes||this._includeTypes,s=e.excludeTypes||this._excludeTypes,n=e.objectDefaults||this._objectDefaults;if(o){r.includeTypesMap={};for(let e=0,t=o.length;e<t;e++)r.includeTypesMap[o[e]]=!0}if(s){r.excludeTypesMap={};for(let e=0,t=s.length;e<t;e++)r.excludeTypesMap[s[e]]=!0}n&&(r.objectDefaults=n);const a=n=>{this.viewer.metaScene.createMetaModel(i,n,{includeTypes:o,excludeTypes:s}),this.viewer.scene.canvas.spinner.processes--,e.src?this._loadModel(e.src,e,r,t):this._parseModel(e.xkt,e,r,t)};if(e.metaModelSrc){const t=e.metaModelSrc;this.viewer.scene.canvas.spinner.processes++,this._dataSource.getMetaModel(t,e=>{this.viewer.scene.canvas.spinner.processes--,a(e)},e=>{this.error(`load(): Failed to load model metadata for model '${i} from  '${t}' - ${e}`),this.viewer.scene.canvas.spinner.processes--})}else e.metaModelData&&a(e.metaModelData)}else e.src?this._loadModel(e.src,e,r,t):this._parseModel(e.xkt,e,r,t);return t.once("destroyed",()=>{this.viewer.metaScene.destroyMetaModel(i)}),t}_loadModel(e,t,i,r){const o=this.viewer.scene.canvas.spinner;o.processes++,this._dataSource.getXKT(t.src,e=>{this._parseModel(e,t,i,r),o.processes--},e=>{o.processes--,this.error(e),r.fire("error",e)})}_parseModel(e,t,i,r){const o=this._extractData(e);if(!o)return;const s=this._inflateData(o);this._loadDataIntoModel(s,i,r)}_extractData(e){const t=new DataView(e),i=new Uint8Array(e),r=t.getUint32(0,!0);if(r>No)return void this.error("Incompatible .XKT file version; this XKTLoaderPlugin supports versions <= V"+No);const o=t.getUint32(4,!0),s=[];let n=4*(o+2);for(let e=0;e<o;e++){const r=t.getUint32(4*(e+2),!0);s.push(i.subarray(n,n+r)),n+=r}return r>=2?{xktVersion:r,positions:s[0],normals:s[1],indices:s[2],edgeIndices:s[3],meshPositions:s[4],meshIndices:s[5],meshEdgesIndices:s[6],meshColors:s[7],entityIDs:s[8],entityMeshes:s[9],entityIsObjects:s[10],positionsDecodeMatrix:s[11],entityMeshIds:s[12],entityMatrices:s[13],entityUsesInstancing:s[14]}:{xktVersion:r,positions:s[0],normals:s[1],indices:s[2],edgeIndices:s[3],meshPositions:s[4],meshIndices:s[5],meshEdgesIndices:s[6],meshColors:s[7],entityIDs:s[8],entityMeshes:s[9],entityIsObjects:s[10],positionsDecodeMatrix:s[11]}}_inflateData(e){return e.xktVersion>=2?{xktVersion:e.xktVersion,positions:new Uint16Array(Io.inflate(e.positions).buffer),normals:new Int8Array(Io.inflate(e.normals).buffer),indices:new Uint32Array(Io.inflate(e.indices).buffer),edgeIndices:new Uint32Array(Io.inflate(e.edgeIndices).buffer),meshPositions:new Uint32Array(Io.inflate(e.meshPositions).buffer),meshIndices:new Uint32Array(Io.inflate(e.meshIndices).buffer),meshEdgesIndices:new Uint32Array(Io.inflate(e.meshEdgesIndices).buffer),meshColors:new Uint8Array(Io.inflate(e.meshColors).buffer),entityIDs:Io.inflate(e.entityIDs,{to:"string"}),entityMeshes:new Uint32Array(Io.inflate(e.entityMeshes).buffer),entityIsObjects:new Uint8Array(Io.inflate(e.entityIsObjects).buffer),positionsDecodeMatrix:new Float32Array(Io.inflate(e.positionsDecodeMatrix).buffer),entityMeshIds:new Uint32Array(Io.inflate(e.entityMeshIds).buffer),entityMatrices:new Float32Array(Io.inflate(e.entityMatrices).buffer),entityUsesInstancing:new Uint8Array(Io.inflate(e.entityUsesInstancing).buffer)}:{xktVersion:e.xktVersion,positions:new Uint16Array(Io.inflate(e.positions).buffer),normals:new Int8Array(Io.inflate(e.normals).buffer),indices:new Uint32Array(Io.inflate(e.indices).buffer),edgeIndices:new Uint32Array(Io.inflate(e.edgeIndices).buffer),meshPositions:new Uint32Array(Io.inflate(e.meshPositions).buffer),meshIndices:new Uint32Array(Io.inflate(e.meshIndices).buffer),meshEdgesIndices:new Uint32Array(Io.inflate(e.meshEdgesIndices).buffer),meshColors:new Uint8Array(Io.inflate(e.meshColors).buffer),entityIDs:Io.inflate(e.entityIDs,{to:"string"}),entityMeshes:new Uint32Array(Io.inflate(e.entityMeshes).buffer),entityIsObjects:new Uint8Array(Io.inflate(e.entityIsObjects).buffer),positionsDecodeMatrix:new Float32Array(Io.inflate(e.positionsDecodeMatrix).buffer)}}_loadDataIntoModel(e,t,i){if(e.xktVersion>=2){const h=e.positions,d=e.normals,u=e.indices,p=e.edgeIndices,m=e.meshPositions,f=e.meshIndices,g=e.meshEdgesIndices,b=e.meshColors,_=JSON.parse(e.entityIDs),v=e.entityMeshes,x=e.entityIsObjects,y=e.entityMeshIds,w=e.entityMatrices,M=e.entityUsesInstancing,k=m.length,P=v.length,E={};for(let A=0;A<P;A++){const C=_[A],T=this.viewer.metaScene.metaObjects[C],D={},S={},L=w.subarray(16*A,16*A+16);if(T){if(t.excludeTypesMap&&T.type&&t.excludeTypesMap[T.type])continue;if(t.includeTypesMap&&T.type&&!t.includeTypesMap[T.type])continue;const e=t.objectDefaults?t.objectDefaults[T.type||"DEFAULT"]:null;e&&(!1===e.visible&&(D.visible=!1),!1===e.pickable&&(D.pickable=!1),e.colorize&&(S.color=e.colorize),void 0!==e.opacity&&null!==e.opacity&&(S.opacity=e.opacity))}const R=A===P-1,I=[];for(let t=v[A],_=R?y.length:v[A+1];t<_;t++){var r=y[t];const _=r===k-1,v=C+".mesh."+r,x=Fo(b.subarray(4*r,4*r+3)),w=b[4*r+3]/255;var o=h.subarray(m[r],_?h.length:m[r+1]),n=d.subarray(m[r],_?h.length:m[r+1]),a=u.subarray(f[r],_?u.length:f[r+1]),l=p.subarray(g[r],_?p.length:g[r+1]);if(1===M[A]){var c="geometry."+r;c in E||(i.createGeometry({id:c,positions:o,normals:n,indices:a,edgeIndices:l,primitive:"triangles",positionsDecodeMatrix:e.positionsDecodeMatrix}),E[c]=!0),i.createMesh(s.apply(S,{id:v,color:x,opacity:w,matrix:L,geometryId:c})),I.push(v)}else i.createMesh(s.apply(S,{id:v,primitive:"triangles",positions:o,normals:n,indices:a,edgeIndices:l,positionsDecodeMatrix:e.positionsDecodeMatrix,color:x,opacity:w})),I.push(v)}I.length&&i.createEntity(s.apply(D,{id:C,isObject:1===x[A],meshIds:I}))}}else{const r=e.positions,o=e.normals,n=e.indices,a=e.edgeIndices,l=e.meshPositions,c=e.meshIndices,h=e.meshEdgesIndices,d=e.meshColors,u=JSON.parse(e.entityIDs),p=e.entityMeshes,m=e.entityIsObjects,f=l.length,g=p.length;for(let b=0;b<g;b++){const _=u[b],v=this.viewer.metaScene.metaObjects[_],x={},y={};if(v){if(t.excludeTypesMap&&v.type&&t.excludeTypesMap[v.type])continue;if(t.includeTypesMap&&v.type&&!t.includeTypesMap[v.type])continue;const e=t.objectDefaults?t.objectDefaults[v.type||"DEFAULT"]:null;e&&(!1===e.visible&&(x.visible=!1),!1===e.pickable&&(x.pickable=!1),e.colorize&&(y.color=e.colorize),void 0!==e.opacity&&null!==e.opacity&&(y.opacity=e.opacity))}const w=b===g-1,M=[];for(let t=p[b],u=w?p.length:p[b+1];t<u;t++){const u=t===f-1,p=_+".mesh."+t,m=Fo(d.subarray(4*t,4*t+3)),g=d[4*t+3]/255;i.createMesh(s.apply(y,{id:p,primitive:"triangles",positions:r.subarray(l[t],u?r.length:l[t+1]),normals:o.subarray(l[t],u?r.length:l[t+1]),indices:n.subarray(c[t],u?n.length:c[t+1]),edgeIndices:a.subarray(h[t],u?a.length:h[t+1]),positionsDecodeMatrix:e.positionsDecodeMatrix,color:m,opacity:g})),M.push(p)}i.createEntity(s.apply(x,{id:_,isObject:1===m[b],meshIds:M}))}}i.finalize(),i.scene.once("tick",()=>{i.scene.fire("modelLoaded",i.id),i.fire("loaded",!0,!0)})}}const Oo=u.vec3();class jo extends a{constructor(e,t){if(super(e,t),!t.modelsTabElement)throw"Missing config: modelsTabElement";if(!t.unloadModelsButtonElement)throw"Missing config: unloadModelsButtonElement";if(!t.modelsElement)throw"Missing config: modelsElement";this._modelsTabElement=t.modelsTabElement,this._unloadModelsButtonElement=t.unloadModelsButtonElement,this._modelsElement=t.modelsElement,this._xktLoader=new Bo(this.viewer),this._modelsInfo={},this._numModelsLoaded=0,this._projectId=null}_loadProject(e){this.server.getProject(e,t=>{this._projectId=e;var i="";const r=t.models||[];this._modelsInfo={};for(var o=0,s=r.length;o<s;o++){const e=r[o];this._modelsInfo[e.id]=e,i+="<div class='form-check'>",i+="<label class='form-check-label'>",i+="<input id='"+e.id+"' type='checkbox' class='form-check-input' value=''>"+e.name,i+="</label>",i+="</div>"}this._modelsElement.html(i);for(o=0,s=r.length;o<s;o++){const e=r[o],t=e.id,i=$("#"+t);i.on("click",()=>{i.prop("checked")?this._loadModel(t):this._unloadModel(e.id)})}},e=>{this.error(e)})}_loadModel(e){const t=this._modelsInfo[e];t&&(this.viewerUI.busyDialog.show("Loading model '"+t.name+"'"),this.server.getMetadata(this._projectId,e,t=>{this.server.getGeometry(this._projectId,e,i=>{this._xktLoader.load({id:e,metaModelData:t,xkt:i,edges:!0}).on("loaded",()=>{const t=this.viewer.scene,i=t.getAABB(t.visibleObjectIds);this._numModelsLoaded++,1===this._numModelsLoaded?(this.viewer.cameraFlight.jumpTo({aabb:i}),this.viewer.cameraControl.pivotPos=u.getAABB3Center(i,Oo),this.fire("modelLoaded",e),this.viewerUI.busyDialog.hide()):this.viewer.cameraFlight.flyTo({aabb:i},()=>{this.viewer.cameraControl.pivotPos=u.getAABB3Center(i,Oo),this.fire("modelLoaded",e),this.viewerUI.busyDialog.hide()})})},e=>{this.error(e),this.viewerUI.busyDialog.hide()})},e=>{this.error(e),this.viewerUI.busyDialog.hide()}))}_unloadModel(e){const t=this.viewer.scene.models[e];if(!t)return void this.error("Model not loaded: "+e);t.destroy();const i=this.viewer.scene,r=i.getAABB(i.visibleObjectIds);$("#"+e).prop("checked",!1),this._numModelsLoaded--,this.viewer.cameraFlight.flyTo({aabb:r},()=>{this.viewer.cameraControl.pivotPos=u.getAABB3Center(r,Oo),this.fire("modelUnloaded",e)})}_unloadModels(){const e=this.viewer.scene.models,t=Object.keys(e);for(var i=0,r=t.length;i<r;i++){const e=t[i];this._unloadModel(e)}}getNumModelsLoaded(){return this._numModelsLoaded}setEnabled(e){e?this._unloadModelsButtonElement.removeClass("disabled"):this._unloadModelsButtonElement.addClass("disabled")}destroy(){super.destroy(),this._xktLoader.destroy()}}class zo extends a{constructor(e,t={}){if(super(e),!t.objectsTabElement)throw"Missing config: objectsTabElement";if(!t.showAllObjectsButtonElement)throw"Missing config: showAllObjectsButtonElement";if(!t.hideAllObjectsButtonElement)throw"Missing config: hideAllObjectsButtonElement";if(!t.objectsElement)throw"Missing config: objectsElement";this._objectsTabElement=t.objectsTabElement,this._showAllObjectsButtonElement=t.showAllObjectsButtonElement,this._hideAllObjectsButtonElement=t.hideAllObjectsButtonElement;const i=t.objectsElement;this._modelNodeIDs={},this._muteTreeEvents=!1,this._muteEntityEvents=!1,this._tree=new InspireTree({selection:{autoSelectChildren:!0,autoDeselect:!0,mode:"checkbox"},checkbox:{autoCheckChildren:!0},data:[]}),new InspireTreeDOM(this._tree,{target:i.get(0)}),this._tree.on("model.loaded",()=>{this._tree.on("node.selected",(e,t)=>{if(this._muteTreeEvents)return;const i=e.id,r=this.viewer.scene.objects[i];r&&(this._muteEntityEvents=!0,r.visible=!0,this._muteEntityEvents=!1)}),this._tree.on("node.deselected",(e,t)=>{if(this._muteTreeEvents)return;const i=e.id,r=this.viewer.scene.objects[i];r&&(this._muteEntityEvents=!0,r.visible=!1,this._muteEntityEvents=!1)}),this.viewer.scene.on("objectVisibility",e=>{})})}_addModel(e){const t=[],i=this.viewer.metaScene.metaModels[e];this._visit(!0,t,i.rootMetaObject);const r=[];for(var o=0,s=t.length;o<s;o++)r.push(t[o].id);this._modelNodeIDs[e]=r,this._tree.addNodes(t),this._synchTreeFromScene(e)}_removeModel(e){const t=this._modelNodeIDs[e];for(var i=0,r=t.length;i<r;i++){const e=t[i],r=this._tree.node(e);r&&r.remove(!0)}}_visit(e,t,i){if(!i)return;const r={id:i.id,text:i.name||"("+i.type+")"};t.push(r);const o=i.children;if(o){r.children=[];for(var s=0,n=o.length;s<n;s++)this._visit(!0,r.children,o[s])}}_synchTreeFromScene(e){this._muteTreeEvents=!0;const t=this.viewer.metaScene.metaModels[e];if(!t)return;const i=t.rootMetaObject;i&&(this._muteTreeEvents=!0,this._setObjectVisibilities(i),this._muteTreeEvents=!1)}_setObjectVisibilities(e){if(!e)return;const t=e.id,i=this.viewer.scene.objects[t];if(i){const e=this._tree.node(t);if(e){const t=e.checked();i.visible?t||e.check(!1):t&&e.uncheck(!1)}}const r=e.children;if(r)for(var o=0,s=r.length;o<s;o++)this._visit(r[o])}setEnabled(e){e?(this._objectsTabElement.removeClass("disabled"),this._showAllObjectsButtonElement.removeClass("disabled"),this._hideAllObjectsButtonElement.removeClass("disabled")):(this._objectsTabElement.addClass("disabled"),this._showAllObjectsButtonElement.addClass("disabled"),this._hideAllObjectsButtonElement.addClass("disabled"))}muteEvents(){this._muteTreeEvents=!0,this._muteEntityEvents=!0}unmuteEvents(){this._muteTreeEvents=!1,this._muteEntityEvents=!1}selectAll(){}deselectAll(){}destroy(){super.destroy()}}class Vo extends a{constructor(e,t={}){if(super(e),!t.classesTabElement)throw"Missing config: classesTabElement";if(!t.showAllClassesButtonElement)throw"Missing config: showAllClassesButtonElement";if(!t.hideAllClassesButtonElement)throw"Missing config: hideAllClassesButtonElement";if(!t.classesElement)throw"Missing config: classesElement";this._classesTabElement=t.classesTabElement,this._showAllClassesButtonElement=t.showAllClassesButtonElement,this._hideAllClassesButtonElement=t.hideAllClassesButtonElement,this._classesElement=t.classesElement,this._muteCheckBoxEvents=!1,this._muteEntityEvents=!1,this._data={},this.viewer.scene.on("objectVisibility",e=>{if(this._muteEntityEvents)return;const t=this.viewer.metaScene.metaObjects[e.id];if(!t)return;const i=t.type,r=this._data[i];r&&(this._muteCheckBoxEvents=!0,e.visible?(r.numObjectsVisible++,1===r.numObjectsVisible&&$("#"+i).prop("checked",!0)):(r.numObjectsVisible--,0===r.numObjectsVisible&&$("#"+i).prop("checked",!1)),this._muteCheckBoxEvents=!1)})}_addModel(e){this._rebuild()}_removeModel(e){this._rebuild()}_rebuild(e){this._createData(),this._repaint()}_createData(){performance.now();this._data={};const e=this.viewer.scene.objectIds,t=this.viewer.metaScene.metaObjects,i=this.viewer.scene.objects;for(var r=0,o=e.length;r<o;r++){const o=e[r],n=t[o];if(n){const e=n.type,t=i[o];var s=this._data[e];s||(s={numObjectsVisible:0,numObjects:0},this._data[e]=s),t.visible&&s.numObjectsVisible++,s.numObjects++}}performance.now()}_repaint(){const e=[];for(var t in this._data){const i=this._data[t];e.push("<div class='form-check'>"),e.push("<label class='form-check-label'>"),e.push("<input id='"),e.push(t),e.push("' type='checkbox' class='form-check-input' value=''"),i.numObjectsVisible>0&&e.push(" checked "),e.push(">"),e.push(t),e.push("</label>"),e.push("</div>")}for(var t in this._classesElement.html(e.join("")),this._data){const e=this._data[t],i=$("#"+t),r=this.viewer.metaScene.getObjectIDsByType(t);i.on("click",()=>{if(this._muteCheckBoxEvents)return;const t=i.prop("checked");this._muteEntityEvents=!0,this.viewer.scene.setObjectsVisible(r,t),t?e.numObjectsVisible+=r.length:e.numObjectsVisible-=r.length,this._muteEntityEvents=!1})}}setEnabled(e){e?(this._classesTabElement.removeClass("disabled"),this._showAllClassesButtonElement.removeClass("disabled"),this._hideAllClassesButtonElement.removeClass("disabled")):(this._classesTabElement.addClass("disabled"),this._showAllClassesButtonElement.addClass("disabled"),this._hideAllClassesButtonElement.addClass("disabled"))}muteEvents(){this._muteCheckBoxEvents=!0,this._muteEntityEvents=!0}unmuteEvents(){this._muteCheckBoxEvents=!1,this._muteEntityEvents=!1}selectAll(){for(var e in this._data){const t=this._data[e];t.numObjectsVisible=t.numObjects,$("#"+e).prop("checked",!0)}}deselectAll(){for(var e in this._data){this._data[e].numObjectsVisible=0,$("#"+e).prop("checked",!1)}}destroy(){super.destroy()}}const Uo=u.vec3(),Ho=u.vec3(),Go=u.vec3(),Wo=u.vec3(),qo=u.vec3();class Xo extends B{get type(){return"CameraFlightAnimation"}constructor(e,t={}){super(e,t),this._look1=u.vec3(),this._eye1=u.vec3(),this._up1=u.vec3(),this._look2=u.vec3(),this._eye2=u.vec3(),this._up2=u.vec3(),this._orthoScale1=1,this._orthoScale2=1,this._flying=!1,this._flyEyeLookUp=!1,this._flyingEye=!1,this._flyingLook=!1,this._callback=null,this._callbackScope=null,this._time1=null,this._time2=null,this.easing=!1!==t.easing,this.duration=t.duration,this.fit=t.fit,this.fitFOV=t.fitFOV,this.trail=t.trail}flyTo(e,t,i){e=e||this.scene,this._flying&&this.stop(),this._flying=!1,this._flyingEye=!1,this._flyingLook=!1,this._flyingEyeLookUp=!1,this._callback=t,this._callbackScope=i;const r=this.scene.camera,o=!!e.projection&&e.projection!==r.projection;let n,a,l,c,h;if(this._eye1[0]=r.eye[0],this._eye1[1]=r.eye[1],this._eye1[2]=r.eye[2],this._look1[0]=r.look[0],this._look1[1]=r.look[1],this._look1[2]=r.look[2],this._up1[0]=r.up[0],this._up1[1]=r.up[1],this._up1[2]=r.up[2],this._orthoScale1=r.ortho.scale,this._orthoScale2=e.orthoScale||this._orthoScale1,e.aabb)n=e.aabb;else if(6===e.length)n=e;else if(e.eye&&e.look||e.up)a=e.eye,l=e.look,c=e.up;else if(e.eye)a=e.eye;else if(e.look)l=e.look;else{let r=e;if((s.isNumeric(r)||s.isString(r))&&(h=r,!(r=this.scene.components[h])))return this.error("Component not found: "+s.inQuotes(h)),void(t&&(i?t.call(i):t()));o||(n=r.aabb||this.scene.aabb)}const d=e.poi;if(n){if(n[3]<n[0]||n[4]<n[1]||n[5]<n[2])return;if(n[3]===n[0]&&n[4]===n[1]&&n[5]===n[2])return;n=n.slice();const t=u.getAABB3Center(n);this._look2=d||t;const i=u.subVec3(this._eye1,this._look1,Uo),r=u.normalizeVec3(i),o=d?u.getAABB3DiagPoint(n,d):u.getAABB3Diag(n),s=e.fitFOV||this._fitFOV,a=Math.abs(o/Math.tan(s*u.DEGTORAD));this._orthoScale2=1.1*o,this._eye2[0]=this._look2[0]+r[0]*a,this._eye2[1]=this._look2[1]+r[1]*a,this._eye2[2]=this._look2[2]+r[2]*a,this._up2[0]=this._up1[0],this._up2[1]=this._up1[1],this._up2[2]=this._up1[2],this._flyingEyeLookUp=!0}else(a||l||c)&&(this._flyingEyeLookUp=!!a&&!!l&&!!c,this._flyingEye=!!a&&!l,this._flyingLook=!!l&&!a,a&&(this._eye2[0]=a[0],this._eye2[1]=a[1],this._eye2[2]=a[2]),l&&(this._look2[0]=l[0],this._look2[1]=l[1],this._look2[2]=l[2]),c&&(this._up2[0]=c[0],this._up2[1]=c[1],this._up2[2]=c[2]));o&&("ortho"===e.projection&&"ortho"!==r.projection&&(this._projection2="ortho",this._projMatrix1=r.projMatrix.slice(),r.ortho.scale=this._orthoScale2,this._projMatrix2=r.ortho.matrix.slice(),r.projection="customProjection"),"perspective"===e.projection&&"perspective"!==r.projection&&(this._projection2="perspective",this._projMatrix1=r.projMatrix.slice(),this._projMatrix2=r.perspective.matrix.slice(),r.projection="customProjection")),this.fire("started",e,!0),this._time1=Date.now(),this._time2=this._time1+(e.duration?1e3*e.duration:this._duration),this._flying=!0,N.scheduleTask(this._update,this)}jumpTo(e){this._jumpTo(e)}_jumpTo(e){this._flying&&this.stop();const t=this.scene.camera;var i,r,o,n,a;if(e.aabb)i=e.aabb;else if(6===e.length)i=e;else if(e.eye||e.look||e.up)o=e.eye,n=e.look,a=e.up;else{let t=e;if((s.isNumeric(t)||s.isString(t))&&(r=t,!(t=this.scene.components[r])))return void this.error("Component not found: "+s.inQuotes(r));i=t.aabb||this.scene.aabb}const l=e.poi;if(i){if(i[3]<=i[0]||i[4]<=i[1]||i[5]<=i[2])return;var c=l?u.getAABB3DiagPoint(i,l):u.getAABB3Diag(i);let r;n=l||u.getAABB3Center(i,n),this._trail?u.subVec3(t.look,n,qo):u.subVec3(t.eye,t.look,qo),u.normalizeVec3(qo),r=(void 0!==e.fit?e.fit:this._fit)?Math.abs(c/Math.tan((e.fitFOV||this._fitFOV)*u.DEGTORAD)):u.lenVec3(u.subVec3(t.eye,t.look,Uo)),u.mulVec3Scalar(qo,r),t.eye=u.addVec3(n,qo,Uo),t.look=n,this.scene.camera.ortho.scale=1.1*c}else(o||n||a)&&(o&&(t.eye=o),n&&(t.look=n),a&&(t.up=a));e.projection&&(t.projection=e.projection)}_update(){if(!this._flying)return;let e=(Date.now()-this._time1)/(this._time2-this._time1);const t=e>=1;e>1&&(e=1);const i=this.easing?Xo._ease(e,0,1,1):e,r=this.scene.camera;if(this._flyingEye||this._flyingLook?this._flyingEye?(u.subVec3(r.eye,r.look,qo),r.eye=u.lerpVec3(i,0,1,this._eye1,this._eye2,Go),r.look=u.subVec3(Go,qo,Ho)):this._flyingLook&&(r.look=u.lerpVec3(i,0,1,this._look1,this._look2,Ho),r.up=u.lerpVec3(i,0,1,this._up1,this._up2,Wo)):this._flyingEyeLookUp&&(r.eye=u.lerpVec3(i,0,1,this._eye1,this._eye2,Go),r.look=u.lerpVec3(i,0,1,this._look1,this._look2,Ho),r.up=u.lerpVec3(i,0,1,this._up1,this._up2,Wo)),this._projection2){const t="ortho"===this._projection2?Xo._easeOutExpo(e,0,1,1):Xo._easeInCubic(e,0,1,1);r.customProjection.matrix=u.lerpMat4(t,0,1,this._projMatrix1,this._projMatrix2)}else r.ortho.scale=this._orthoScale1+e*(this._orthoScale2-this._orthoScale1);t?this.stop():N.scheduleTask(this._update,this)}static _ease(e,t,i,r){return-i*(e/=r)*(e-2)+t}static _easeInCubic(e,t,i,r){return i*(e/=r)*e*e+t}static _easeOutExpo(e,t,i,r){return i*(1-Math.pow(2,-10*e/r))+t}stop(){if(!this._flying)return;this._flying=!1,this._time1=null,this._time2=null,this._projection2&&(this.scene.camera.projection=this._projection2);const e=this._callback;e&&(this._callback=null,this._callbackScope?e.call(this._callbackScope):e()),this.fire("stopped",!0,!0)}cancel(){this._flying&&(this._flying=!1,this._time1=null,this._time2=null,this._callback&&(this._callback=null),this.fire("canceled",!0,!0))}set duration(e){this._duration=e?1e3*e:500,this.stop()}get duration(){return this._duration/1e3}set fit(e){this._fit=!1!==e}get fit(){return this._fit}set fitFOV(e){this._fitFOV=e||45}get fitFOV(){return this._fitFOV}set trail(e){this._trail=!!e}get trail(){return this._trail}}class Yo extends B{get type(){return"CameraControl"}constructor(e,t={}){super(e,t);const i=this;this._pivoter=new function(){const e=i.scene,t=e.camera,r=e.canvas,o=new Float32Array(3);let s,n=0,a=0,l=0,c=!1;const h=document.createElement("div");h.innerText=" ",h.style.color="#ffffff",h.style.position="absolute",h.style.width="25px",h.style.height="25px",h.style.left="0px",h.style.top="0px",h.style["border-radius"]="15px",h.style.border="2px solid #ffffff",h.style.background="black",h.style.visibility="hidden",h.style["box-shadow"]="5px 5px 15px 1px #000000",h.style["z-index"]=0,h.style["pointer-events"]="none",document.body.appendChild(h),function(){const i=u.vec4(),s=u.vec4(),n=u.vec2();let a=!0;t.on("viewMatrix",(function(){a=!0})),t.on("projMatrix",(function(){a=!0})),e.on("tick",(function(){if(c&&a){u.transformPoint3(t.viewMatrix,o,i),i[3]=1,u.transformPoint4(t.projMatrix,i,s);const e=r.boundary;n[0]=Math.floor((1+s[0]/s[3])*e[2]/2),n[1]=Math.floor((1-s[1]/s[3])*e[3]/2);const l=r.canvas.getBoundingClientRect();h.style.left=Math.floor(l.left+n[0])-12+"px",h.style.top=Math.floor(l.top+n[1])-12+"px",h.style.visibility="visible",a=!1}}))}(),this.startPivot=function(e){e&&o.set(e);let i=u.lookAtMat4v(t.eye,t.look,t.worldUp);(s=u.transformPoint3(i,o))[2]+=u.distVec3(t.eye,o),i=u.inverseMat4(i);const r=u.transformVec3(i,s),h=u.vec3();if(u.subVec3(t.eye,o,h),u.addVec3(h,r),1===t.worldUp[2]){const e=h[1];h[1]=h[2],h[2]=e}l=u.lenVec3(h),a=Math.acos(h[1]/l),n=Math.atan2(h[0],h[2]),c=!0},this.getPivoting=function(){return c},this.setPivotPos=function(e){o.set(e)},this.getPivotPos=function(){return o},this.continuePivot=function(e,i){if(!c)return;if(0===e&&0===i)return;1===t.worldUp[2]&&(r=-r);var r=-e;n+=.01*-r,a+=.01*-i,a=u.clamp(a,.001,Math.PI-.001);const d=[l*Math.sin(a)*Math.sin(n),l*Math.cos(a),l*Math.sin(a)*Math.cos(n)];if(1===t.worldUp[2]){const e=d[1];d[1]=d[2],d[2]=e}const p=u.lenVec3(u.subVec3(t.look,t.eye,u.vec3()));u.addVec3(d,o);let m=u.lookAtMat4v(d,o,t.worldUp);m=u.inverseMat4(m);const f=u.transformVec3(m,s);m[12]-=f[0],m[13]-=f[1],m[14]-=f[2];const g=[m[8],m[9],m[10]];t.eye=[m[12],m[13],m[14]],u.subVec3(t.eye,u.mulVec3Scalar(g,p),t.look),t.up=[m[4],m[5],m[6]],h.style.visibility="visible"},this.hidePivot=function(){h.style.visibility="hidden"},this.endPivot=function(){c=!1}},this._cameraFlight=new Xo(this,{duration:.5}),this.planView=t.planView,this.firstPerson=t.firstPerson,this.walking=t.walking,this.keyboardLayout=t.keyboardLayout,this.doublePickFlyTo=t.doublePickFlyTo,this.panRightClick=t.panRightClick,this.active=t.active,this.pivoting=t.pivoting,this.panToPointer=t.panToPointer,this.panToPivot=t.panToPivot,this.inertia=t.inertia,this.pointerEnabled=!0,this._initEvents()}set active(e){this._active=!1!==e}get active(){return this._active}set pivoting(e){this._pivoting=!!e}get pivoting(){return this._pivoting}set pivotPos(e){this._pivoter.setPivotPos(e)}get pivotPos(){return this._pivoter.getPivotPos()}set panToPointer(e){this._panToPointer=!!e,this._panToPointer&&(this._panToPivot=!1)}get panToPointer(){return this._panToPointer}set panToPivot(e){this._panToPivot=!!e,this._panToPivot&&(this._panToPointer=!1)}get panToPivot(){return this._panToPivot}set planView(e){this._planView=!!e}get planView(){return this._planView}set firstPerson(e){this._firstPerson=!!e,this._firstPerson&&(this._pivoter.hidePivot(),this._pivoter.endPivot())}get firstPerson(){return this._firstPerson}set walking(e){this._walking=!!e}get walking(){return this._walking}set doublePickFlyTo(e){this._doublePickFlyTo=!1!==e}get doublePickFlyTo(){return this._doublePickFlyTo}set panRightClick(e){this._panRightClick=!1!==e}get panRightClick(){return this._panRightClick}set inertia(e){this._inertia=void 0===e?.5:e}get inertia(){return this._inertia}set pointerEnabled(e){this._pointerEnabled=!!e}get pointerEnabled(){return this._pointerEnabled}set keyboardLayout(e){this._keyboardLayout=e||"qwerty"}get keyboardLayout(){return this._keyboardLayout}_initEvents(){const e=this,t=this.scene,i=t.input,r=t.camera,o=this.scene.canvas.canvas;let s=!1;o.oncontextmenu=function(e){e.preventDefault()};const n=function(e,t){if(e){let i=e.target,r=0,o=0;for(;i.offsetParent;)r+=i.offsetLeft,o+=i.offsetTop,i=i.offsetParent;t[0]=e.pageX-r,t[1]=e.pageY-o}else e=window.event,t[0]=e.x,t[1]=e.y;return t},a=[0,0];let l,c,h=!1,d=!1,p=!1,m=!1;function f(){if(e._pointerEnabled&&(h||d)){if(p=!1,m=!1,c=d||e.hasSubs("hoverSurface")?t.pick({pickSurface:!0,canvasPos:a}):t.pick({canvasPos:a})){p=!0;const i=c.entity.id;l!==i&&(void 0!==l&&e.fire("hoverOut",{entity:t.objects[l]},!0),e.fire("hoverEnter",c,!0),l=i),e.fire("hover",c,!0),c.worldPos&&(m=!0,e.fire("hoverSurface",c,!0))}else void 0!==l&&(e.fire("hoverOut",{entity:t.objects[l]},!0),l=void 0),e.fire("hoverOff",{canvasPos:a},!0);h=!1,d=!1}}t.on("tick",f),function(){let a=0,l=0,h=0,p=0,g=0,b=0;const _=u.vec2();let v=!1,x=!1,y=!1,w=!1;const M={},k=function(){const e=new Float32Array(3);return function(){return u.lenVec3(u.subVec3(r.look,r.eye,e))}}(),P=function(){let e=!0;r.on("projMatrix",(function(){e=!0}));const t=u.mat4();return function(){return e&&u.inverseMat4(r.projMatrix,t),t}}(),E=function(){let e=!0;r.on("projMatrix",(function(){e=!0}));const t=u.mat4();return function(){return e&&u.transposeMat4(r.projMatrix,t),t}}(),A=function(){let e=!0;r.on("viewMatrix",(function(){e=!0}));const t=u.mat4();return function(){return e&&u.inverseMat4(r.viewMatrix,t),t}}(),C=function(){let e=!0,i=1;return t.on("boundary",(function(){e=!0})),function(){return e&&(i=u.getAABB3Diag(t.aabb)),i}}(),T=function(){const e=u.vec4(),i=u.vec4(),o=u.vec4(),s=u.vec3();return function(n,a){const l=P(),c=A(),h=E(),d=h.subarray(8,12),p=h.subarray(12),m=[0,0,-C(),1];!function(i,r,o,s,n,a){const l=t.canvas.canvas,c=l.offsetWidth/2,h=l.offsetHeight/2;e[0]=(o[0]-c)/c,e[1]=(o[1]-h)/h,e[2]=s,e[3]=1,u.mulMat4v4(i,e,n),u.mulVec3Scalar(n,1/n[3]),n[3]=1,n[1]*=-1,u.mulMat4v4(r,n,a)}(l,c,n,u.dotVec4(m,d)/u.dotVec4(m,p),i,o),u.subVec3(o,r.eye,s),u.normalizeVec3(s);const f=s[0]*a,g=s[1]*a,b=s[2]*a,_=r.eye,v=r.look;r.eye=[_[0]+f,_[1]+g,_[2]+b],r.look=[v[0]+f,v[1]+g,v[2]+b]}}(),D=function(){const e=u.vec3();return function(t,i){u.subVec3(t,r.eye,e),u.normalizeVec3(e);const o=e[0]*i,s=e[1]*i,n=e[2]*i,a=r.eye,l=r.look;r.eye=[a[0]+o,a[1]+s,a[2]+n],r.look=[l[0]+o,l[1]+s,l[2]+n]}}();function S(){const e=t.aabb,i=e[3]-e[0],r=e[4]-e[1],o=e[5]-e[2];let s=i>r?i:r;return(s=o>s?o:s)/30}t.on("tick",(function(){const t=e._inertia;if(Math.abs(a)<.001&&(a=0),Math.abs(l)<.001&&(l=0),0!==l||0!==a?(e._pivoter.getPivoting()?e._pivoter.continuePivot(l,a):(0!==a&&(e._firstPerson?r.pitch(-a):r.orbitPitch(a)),0!==l&&(e._firstPerson?r.yaw(l):r.orbitYaw(l))),a*=t,l*=t):e._pivoter.hidePivot(),Math.abs(h)<.001&&(h=0),Math.abs(p)<.001&&(p=0),Math.abs(g)<.001&&(g=0),0!==h||0!==p||0!==g){const t=k()/80;if(e._walking){let e=r.eye[1];r.pan([h*t,p*t,g*t]);let i=r.eye;i[1]=e,r.eye=i}else r.pan([h*t,p*t,g*t])}if(h*=t,p*=t,g*=t,Math.abs(b)<.001&&(b=0),0!==b){if(e._firstPerson){let t;if(e._walking&&(t=r.eye[1]),v?T(_,2*-b):r.pan([0,0,b]),e._walking){let e=r.eye;e[1]=t,r.eye=e}}else e._panToPointer?(f(),m&&c.worldPos?D(c.worldPos,-b):r.zoom(b)):e._panToPivot?D(e._pivoter.getPivotPos(),-b):r.zoom(b),r.ortho.scale=r.ortho.scale+b;b*=t}})),document.addEventListener("keydown",(function(t){e._active&&"INPUT"!==t.target.tagName&&"TEXTAREA"!==t.target.tagName&&(x=t.ctrlKey||17===t.keyCode||t.metaKey,y=t.altKey||18===t.keyCode,w=16===t.keyCode,M[t.keyCode]=!0)}),!0),document.addEventListener("keyup",(function(t){e._active&&"INPUT"!==t.target.tagName&&"TEXTAREA"!==t.target.tagName&&((t.ctrlKey||17===t.keyCode)&&(x=!1),(t.altKey||18===t.keyCode)&&(y=!1),16===t.keyCode&&(w=!1),M[t.keyCode]=!1)})),function(){let r,c,u,m,f,x=0,y=0,M=!1;o.addEventListener("mousedown",(function(t){if(e._active&&e._pointerEnabled)switch(s=!0,t.which){case 1:u=!0,e.scene.canvas.canvas.style.cursor="move",M=!0,x=0,y=0,n(t,_),r=_[0],c=_[1];break;case 2:e.scene.canvas.canvas.style.cursor="move",m=!0;break;case 3:e.scene.canvas.canvas.style.cursor="move",f=!0,M=!0,x=0,y=0,n(t,_),r=_[0],c=_[1]}})),o.addEventListener("mouseup",(function(t){if(e._active&&e._pointerEnabled){switch(t.which){case 1:u=!1;break;case 2:m=!1;break;case 3:f=!1}e.scene.canvas.canvas.style.cursor="default",M=!1,x=0,y=0}})),document.addEventListener("mouseup",(function(t){if(e._active&&e._pointerEnabled){switch(t.which){case 1:u=!1;break;case 2:m=!1;break;case 3:f=!1}M=!1,x=0,y=0}})),o.addEventListener("mouseenter",(function(){e._active&&e._pointerEnabled&&(s=!0,x=0,y=0)})),o.addEventListener("mouseleave",(function(){e._active&&e._pointerEnabled&&(s=!1,x=0,y=0)})),o.addEventListener("mousemove",(function(t){if(!e._active||!e._pointerEnabled)return;if(!s)return;if(n(t,_),v=!0,!M)return;const i=_[0],o=_[1];x+=.4*(i-r),y+=.4*(o-c),r=i,c=o})),t.on("tick",(function(){if(!e._active||!e._pointerEnabled)return;if(0===Math.abs(x)&&0===Math.abs(y))return;w||f?(w||e.panRightClick&&f)&&(h=.4*x,p=.4*y):e._planView||(l=.4*-x,a=.4*y),x=0,y=0})),o.addEventListener("wheel",(function(t){if(!e._active||!e._pointerEnabled)return;e._panToPointer&&(d=!0);const i=Math.max(-1,Math.min(1,40*-t.deltaY));if(0===i)return;const r=i/Math.abs(i);b=-r*S()*.8,t.preventDefault()})),t.on("tick",(function(t){if(!e._active||!e._pointerEnabled)return;if(!s)return;const r=t.deltaTime;if(!e.ctrlDown&&!e.altDown){const e=i.keyDown[i.KEY_ADD],t=i.keyDown[i.KEY_SUBTRACT];(e||t)&&(t?b=r*S()*.02:e&&(b=-r*S()*.02))}})),t.on("tick",(function(t){if(!e._active||!e._pointerEnabled)return;if(!s)return;const r=t.deltaTime;let o,n,a,l,c,d;"azerty"===e._keyboardLayout?(o=i.keyDown[i.KEY_Z],n=i.keyDown[i.KEY_S],a=i.keyDown[i.KEY_Q],l=i.keyDown[i.KEY_D],c=i.keyDown[i.KEY_W],d=i.keyDown[i.KEY_X]):(o=i.keyDown[i.KEY_W],n=i.keyDown[i.KEY_S],a=i.keyDown[i.KEY_A],l=i.keyDown[i.KEY_D],c=i.keyDown[i.KEY_Z],d=i.keyDown[i.KEY_X]),(o||n||a||l||c||d)&&(d?p+=.02*r:c&&(p+=.02*-r),l?h+=.02*-r:a&&(h+=.02*r),n?g=.02*r:o&&(g=.02*-r))}))}(),function(){let t;const i=new Float32Array(2);let r=-1;const s=[];let n=0;const c=new Float32Array(2),d=new Float32Array(2),m=50,f=0;let g=f,_=Date.now();function v(e){const t=Date.now();return g===f?(g=e,!0):g===e?t-_>m:(g=e,_=t,!1)}o.addEventListener("touchstart",(function(o){if(!e._active||!e._pointerEnabled)return;const a=o.touches,l=o.changedTouches;for(t=Date.now(),1===a.length&&1===l.length?(r=t,i[0]=a[0].pageX,i[1]=a[0].pageY):r=-1;s.length<a.length;)s.push(new Float32Array(2));for(let e=0,t=a.length;e<t;++e)s[e][0]=a[e].pageX,s[e][1]=a[e].pageY;g=f,n=a.length,o.stopPropagation()}),{passive:!0}),o.addEventListener("touchmove",(function(t){if(!e._active||!e._pointerEnabled)return;const i=t.touches;if(1===n){var r=i[0];if(v(1)){const e=r.pageX-s[0][0],t=r.pageY-s[0][1];a+=.3*t,l+=-(.3*e)}}else if(2===n){r=i[0];const e=i[1];u.subVec2([r.pageX,r.pageY],s[0],c),u.subVec2([e.pageX,e.pageY],s[1],d);const t=u.dotVec2(c,d)>0;if(t&&v(2)&&(u.subVec2([r.pageX,r.pageY],s[0],c),h+=.2*c[0],p+=.2*c[1]),!t&&v(4)){const t=u.distVec2([r.pageX,r.pageY],[e.pageX,e.pageY]),i=u.distVec2(s[0],s[1]);b=(i-t)*S()*.05}}for(let e=0;e<n;++e)s[e][0]=i[e].pageX,s[e][1]=i[e].pageY;t.stopPropagation()}),{passive:!0})}(),t.on("tick",(function(t){if(!e._active||!e._pointerEnabled)return;if(!s)return;if(e._planView)return;const r=t.deltaTime,o=i.keyDown[i.KEY_LEFT_ARROW],n=i.keyDown[i.KEY_RIGHT_ARROW],c=i.keyDown[i.KEY_UP_ARROW],h=i.keyDown[i.KEY_DOWN_ARROW];(o||n||c||h)&&(n?l+=.02*-r:o&&(l+=.02*r),h?a+=.02*r:c&&(a+=.02*-r))})),t.on("tick",(function(t){if(!e._active||!e._pointerEnabled)return;if(!s)return;const r=t.deltaTime;let o,n;"azerty"===e._keyboardLayout?(o=i.keyDown[i.KEY_A],n=i.keyDown[i.KEY_E]):(o=i.keyDown[i.KEY_Q],n=i.keyDown[i.KEY_E]),(n||o)&&(o?l+=.02*r:n&&(l+=.02*-r))}))}(),function(){let t,i,r,s;o.addEventListener("mousemove",(function(t){e._active&&e._pointerEnabled&&(n(t,a),(e.hasSubs("hover")||e.hasSubs("hoverOut")||e.hasSubs("hoverOff")||e.hasSubs("hoverSurface"))&&(h=!0))})),o.addEventListener("mousedown",(function(o){e._active&&e._pointerEnabled&&(t=o.clientX,i=o.clientY,r=a[0],s=a[1],d=e._pivoting,f(),e._pivoting&&(c?e._pivoter.startPivot(c.worldPos):e._pivoter.startPivot()))})),o.addEventListener("mouseup",function(o){let n,l=0;return function(o){if(e._active&&e._pointerEnabled&&(e._pivoter.hidePivot(),!(Math.abs(o.clientX-t)>3||Math.abs(o.clientY-i)>3))){if(!(e._doublePickFlyTo||e.hasSubs("doublePicked")||e.hasSubs("doublePickedSurface")||e.hasSubs("doublePickedNothing")))return d=!!e.hasSubs("pickedSurface"),f(),void(c?(e.fire("picked",c,!0),m&&e.fire("pickedSurface",c,!0)):e.fire("pickedNothing",{},!0));1==++l?n=setTimeout((function(){h=e._doublePickFlyTo,d=h||!!e.hasSubs("pickedSurface"),a[0]=r,a[1]=s,f(),c?(e.fire("picked",c,!0),m&&e.fire("pickedSurface",c,!0)):e.fire("pickedNothing",{},!0),l=0}),250):(clearTimeout(n),h=e._doublePickFlyTo,d=h&&!!e.hasSubs("doublePickedSurface"),f(),c?(e.fire("doublePicked",c,!0),m&&e.fire("doublePickedSurface",c,!0),e._doublePickFlyTo&&e._flyTo(c)):(e.fire("doublePickedNothing",!0),e._doublePickFlyTo&&e._flyTo()),l=0)}}}(),!1)}(),function(){let t;const i=[],r=new Float32Array(2);let s=-1,n=-1;o.addEventListener("touchstart",(function(o){if(!e._active||!e._pointerEnabled)return;const n=o.touches,a=o.changedTouches;for(t=Date.now(),1===n.length&&1===a.length?(s=t,r[0]=n[0].pageX,r[1]=n[0].pageY):s=-1;i.length<n.length;)i.push(new Float32Array(2));for(let e=0,t=n.length;e<t;++e)i[e][0]=n[e].pageX,i[e][1]=n[e].pageY;i.length=n.length,o.stopPropagation()}),{passive:!0}),o.addEventListener("touchend",(function(t){if(!e._active||!e._pointerEnabled)return;const o=Date.now(),l=t.touches,p=t.changedTouches;0===l.length&&1===p.length&&s>-1&&o-s<150&&(n>-1&&s-n<325?(a[0]=Math.round(p[0].clientX),a[1]=Math.round(p[0].clientY),h=!0,d=!!e.hasSubs("pickedSurface"),f(),c?(e.fire("doublePicked",c,!0),m&&e.fire("doublePickedSurface",c,!0),e._doublePickFlyTo&&e._flyTo(c)):(e.fire("doublePickedNothing",!0),e._doublePickFlyTo&&e._flyTo()),n=-1):u.distVec2(i[0],r)<4&&(a[0]=Math.round(p[0].clientX),a[1]=Math.round(p[0].clientY),h=!0,d=!!e.hasSubs("pickedSurface"),f(),c?(e.fire("picked",c,!0),m&&e.fire("pickedSurface",c,!0)):e.fire("pickedNothing",{},!0),n=o),s=-1),i.length=l.length;for(let e=0,t=l.length;e<t;++e)i[e][0]=l[e].pageX,i[e][1]=l[e].pageY;t.stopPropagation()}),{passive:!0})}(),function(){const i=u.vec3(),o=u.vec3(),n=u.vec3(),a=u.vec3(),l={eye:new Float32Array(3),look:new Float32Array(3),up:new Float32Array(3)};document.addEventListener("keydown",(function(c){if(!e._active||!e._pointerEnabled)return;if(!s)return;const h=c.keyCode;if(49!==h&&50!==h&&51!==h&&52!==h&&53!==h&&54!==h)return;const d=t.aabb,p=u.getAABB3Diag(d);i[0]=d[0]+d[3]/2,i[1]=d[1]+d[4]/2,i[2]=d[2]+d[5]/2;const m=Math.abs(p/Math.tan(e._cameraFlight.fitFOV/2));switch(h){case 49:l.eye.set(u.mulVec3Scalar(r.worldRight,m,o)),l.look.set(i),l.up.set(r.worldUp);break;case 50:l.eye.set(u.mulVec3Scalar(r.worldForward,m,o)),l.look.set(i),l.up.set(r.worldUp);break;case 51:l.eye.set(u.mulVec3Scalar(r.worldRight,-m,o)),l.look.set(i),l.up.set(r.worldUp);break;case 52:l.eye.set(u.mulVec3Scalar(r.worldForward,-m,o)),l.look.set(i),l.up.set(r.worldUp);break;case 53:l.eye.set(u.mulVec3Scalar(r.worldUp,m,o)),l.look.set(i),l.up.set(u.normalizeVec3(u.mulVec3Scalar(r.worldForward,1,n),a));break;case 54:l.eye.set(u.mulVec3Scalar(r.worldUp,-m,o)),l.look.set(i),l.up.set(u.normalizeVec3(u.mulVec3Scalar(r.worldForward,-1,n)));break;default:return}e._cameraFlight.duration>0?e._cameraFlight.flyTo(l):e._cameraFlight.jumpTo(l)}))}()}_flyTo(e){let t;e&&e.worldPos&&(t=e.worldPos);const i=e?e.entity.aabb:this.scene.aabb;if(t){const e=this.scene.camera;u.subVec3(e.eye,e.look,[]);this._cameraFlight.flyTo({aabb:i})}else this._cameraFlight.flyTo({aabb:i})}destroy(){this.active=!1,super.destroy()}}class Ko{constructor(e,t,i,r,o){this.id=t,this.projectId=i,this.revisionId=r,this.metaScene=e,this.rootMetaObject=o}getJSON(){var e=[];return function t(i){var r={id:i.id,extId:i.extId,type:i.type,name:i.name};i.parent&&(r.parent=i.parent.id),e.push(r);var o=i.children;if(o)for(var s=0,n=o.length;s<n;s++)t(o[s])}(this.rootMetaObject),{id:this.id,projectId:this.projectId,revisionId:this.revisionId,metaObjects:e}}}class $o{constructor(e,t,i,r,o,s,n,a){this.metaModel=e,this.id=t,this.name=i,this.type=r,o&&(this.properties=o),null!=s&&(this.parent=s),null!=n&&(this.children=n),null!=a&&(this.external=a)}getObjectIDsInSubtree(){const e=[];return function t(i){if(!i)return;e.push(i.id);const r=i.children;if(r)for(var o=0,s=r.length;o<s;o++)t(r[o])}(this),e}getObjectIDsInSubtreeByType(e){const t={};for(var i=0,r=e.length;i<r;i++)t[e[i]]=e[i];const o=[];return function e(i){if(!i)return;t[i.type]&&o.push(i.id);const r=i.children;if(r)for(var s=0,n=r.length;s<n;s++)e(r[s])}(this),o}getJSON(){var e={id:this.id,type:this.type,name:this.name};return this.parent&&(e.parent=this.parent.id),e}}class Qo{constructor(e,t){this.viewer=e,this.scene=t,this.metaModels={},this.metaObjects={},this.metaObjectsByType={},this._typeCounts={},this._eventSubs={}}on(e,t){let i=this._eventSubs[e];i||(i=[],this._eventSubs[e]=i),i.push(t)}fire(e,t){const i=this._eventSubs[e];if(i)for(let e=0,r=i.length;e<r;e++)i[e](t)}off(e){}createMetaModel(e,t,i={}){const r=t.projectId||"none",o=t.revisionId||"none",s=t.metaObjects;const n=new Ko(this,e,r,o,null);this.metaModels[e]=n;for(let e=0,t=s.length;e<t;e++){const t=s[e],i=t.type;void 0;const r=t.id,o=t.name,a=t.properties,l=null,c=null,h=t.external,d=new $o(n,r,o,i,a,l,c,h);this.metaObjects[r]=d,(this.metaObjectsByType[i]||(this.metaObjectsByType[i]={}))[r]=d,void 0===this._typeCounts[i]?this._typeCounts[i]=1:this._typeCounts[i]++}for(let e=0,t=s.length;e<t;e++){const t=s[e],i=t.id,r=this.metaObjects[i];if(r)if(void 0===t.parent||null===t.parent)n.rootMetaObject=r;else if(t.parent){let e=this.metaObjects[t.parent];e&&(r.parent=e,e.children=e.children||[],e.children.push(r))}}return this.fire("metaModelCreated",e),n}destroyMetaModel(e){const t=this.metaModels[e];if(!t)return;const i=this.metaObjects,r=this.metaObjectsByType;let o=e=>{delete i[e.id];const t=r[e.type];t&&t[e.id]&&(delete t[e.id],0==--this._typeCounts[e.type]&&(delete this._typeCounts[e.type],delete r[e.type]));const s=e.children;if(s)for(let e=0,t=s.length;e<t;e++){const t=s[e];o(t)}};o(t.rootMetaObject),delete this.metaModels[e],this.fire("metaModelDestroyed",e)}getObjectIDsByType(e){const t=this.metaObjectsByType[e];return t?Object.keys(t):[]}getObjectIDsInSubtree(e){const t=[];return function e(i){if(!i)return;t.push(i.id);const r=i.children;if(r)for(var o=0,s=r.length;o<s;o++)e(r[o])}(this.metaObjects[e]),t}}class Zo{constructor(e){this.language="en",this.scene=new ei({viewer:this,canvasId:e.canvasId,canvasElement:e.canvasElement,webgl2:!1,contextAttr:{preserveDrawingBuffer:!1!==e.preserveDrawingBuffer},spinnerElementId:e.spinnerElementId,transparent:!1!==e.transparent,gammaInput:!0,gammaOutput:!0,clearColorAmbient:e.clearColorAmbient,ticksPerRender:1,ticksPerOcclusionTest:20,units:e.units,scale:e.scale,origin:e.origin}),this.metaScene=new Qo(this,this.scene),this.id=e.id||this.scene.id,this.camera=this.scene.camera,this.cameraFlight=new Xo(this.scene,{duration:.5}),this.cameraControl=new Yo(this.scene,{doublePickFlyTo:!0}),this.plugins={},this._eventSubs={}}on(e,t){let i=this._eventSubs[e];i||(i=[],this._eventSubs[e]=i),i.push(t)}fire(e,t){const i=this._eventSubs[e];if(i)for(let e=0,r=i.length;e<r;e++)i[e](t)}off(e){}log(e){console.log(`[xeokit viewer ${this.id}]: ${e}`)}error(e){console.error(`[xeokit viewer ${this.id}]: ${e}`)}addPlugin(e){this.plugins[e.id]&&this.error(`Plugin with this ID already installed: ${e.id}`),this.plugins[e.id]=e,this.log(`Installed plugin: ${e.id}`)}removePlugin(e){const t=this.plugins[e.id];t?t===e?(t.clear&&t.clear(),delete this.plugins[e.id],this.log(`Removed plugin: ${e.id}`)):this.error(`Can't remove plugin - a different plugin is installed with this ID: ${e.id}`):this.error(`Can't remove plugin - no plugin with this ID is installed: ${e.id}`)}sendToPlugins(e,t){const i=this.plugins;for(const r in i)i.hasOwnProperty(r)&&i[r].send(e,t)}clear(){this.sendToPlugins("clear")}resetView(){this.sendToPlugins("resetView")}getSnapshot(e={}){this.sendToPlugins("snapshotStarting");const t=void 0!==e.width&&void 0!==e.height,i=this.scene.canvas.canvas,r=i.clientWidth,o=i.clientHeight,s=i.style.width,n=i.style.height,a=e.width?Math.floor(e.width):i.width,l=e.height?Math.floor(e.height):i.height;t&&(i.style.width=a+"px",i.style.height=l+"px"),this.scene.render(!0);const c=this.scene.canvas._getSnapshot(e);return t&&(i.style.width=s,i.style.height=n,i.width=r,i.height=o,this.scene.glRedraw()),this.sendToPlugins("snapshotFinished"),c}destroy(){for(let e in this.plugins)this.plugins.hasOwnProperty(e)&&this.plugins[e].destroy();this.scene.destroy()}}const Jo='<div class="sidebar-header" style="height:100%;">\n<ul class="nav nav-tabs" role="tablist">\n    \x3c!-- Models tab --\x3e\n    <li class="nav-item">\n        <a class="xeokit-modelsTab nav-link active" id="{{models}}-tab" data-toggle="tab" href="#{{models}}" role="tab">Models</a>\n    </li>\n    \x3c!-- Objects tab --\x3e\n    <li class=" nav-item">\n        <a class="xeokit-objectsTab nav-link disabled" id="{{objects}}-tab" data-toggle="tab" href="#{{objects}}" role="tab">Objects</a>\n    </li>\n    \x3c!-- Classes tab --\x3e\n    <li class="nav-item">\n        <a class="xeokit-classesTab nav-link disabled" id="{{classes}}-tab" data-toggle="tab" href="#{{classes}}" role="tab">Classes</a>\n    </li>\n</ul>\n<div class="tab-content" style="height:100%;">\n    \x3c!-- Models tree --\x3e\n    <div class="tab-pane fade show active" id="{{models}}" role="tabpanel" style="padding:5px;">\n        <div class="explorer-toolbar btn-toolbar" role="toolbar">\n            <button type="button" class="xeokit-unloadAllModels btn btn-outline-light disabled">Unload all</button>\n        </div>\n        <div class="xeokit-models" style="overflow-y:scroll;"></div>\n    </div>\n    \x3c!-- Objects tree --\x3e\n    <div class="tab-pane fade" id="{{objects}}" role="tabpanel" style="padding:5px;">\n        <div class="explorer-toolbar btn-toolbar" role="toolbar">\n            <button type="button" class="xeokit-showAllObjects btn btn-outline-light disabled">Show all</button>\n            <button type="button" class="xeokit-hideAllObjects btn btn-outline-light disabled">Hide all</button>\n        </div>\n        <div class="xeokit-objects tree-panel" style="overflow-y:scroll;"></div>\n    </div>\n    \x3c!-- Classes tree --\x3e\n    <div class="tab-pane fade" id="{{classes}}" role="tabpanel" style="padding:5px;">\n        <div class="explorer-toolbar btn-toolbar" role="toolbar">\n            <button type="button" class="xeokit-showAllClasses btn btn-outline-light disabled">Show all</button>\n            <button type="button" class="xeokit-hideAllClasses btn btn-outline-light disabled">Hide all</button>\n        </div>\n        <div class="xeokit-classes tree-panel" style="overflow-y:scroll;"></div>\n    </div>\n</div>\n</div>',es='<div class="xeokit-toolbar btn-toolbar" style="background: rgba(0,0,0,0);" role="toolbar">\n    \x3c!-- Reset button --\x3e\n    <div class="btn-group mr-2" role="group">\n        <button type="button" class="xeokit-reset btn btn-outline-primary fa fa-home fa-2x disabled" data-toggle="tooltip" data-placement="top" title="Reset"></button>\n    </div>\n    \x3c!-- Fit button --\x3e\n    <div class="btn-group mr-2" role="group">\n        <button type="button" class="xeokit-fit btn btn-outline-primary fa fa-crop fa-2x disabled" data-toggle="tooltip" data-placement="top" title="Fit view"></button>\n    </div>\n    \x3c!-- First Person mode button --\x3e\n    <div class="btn-group mr-2" role="group">\n        <button type="button" class="xeokit-firstPerson btn btn-outline-primary fa fa-male  fa-2x disabled" data-toggle="tooltip" data-placement="top" title="First person mode"></button>\n    </div>\n    \x3c!-- Ortho mode button --\x3e\n    <div class="btn-group mr-2" role="group">\n        <button type="button" class="xeokit-ortho btn btn-outline-primary fa fa-cube  fa-2x disabled" data-toggle="tooltip" data-placement="top" title="Orthographic mode"></button>\n    </div>\n    \x3c!-- Tools button group --\x3e\n    <div class="btn-group mr-2" role="group">\n        \x3c!-- Hide tool button --\x3e\n        <button type="button" class="xeokit-hide btn btn-outline-primary fa fa-eraser fa-2x disabled" data-toggle="tooltip" data-placement="top" title="Hide object tool"></button>\n        \x3c!-- Select tool button --\x3e\n        <button type="button" class="xeokit-select btn btn-outline-primary fa fa-mouse-pointer fa-2x disabled" data-toggle="tooltip" data-placement="top" title="Select object tool"></button>\n        \x3c!-- Slice tool button --\x3e\n        <button type="button" class="xeokit-section btn btn-outline-primary fa fa-cut fa-2x disabled" data-toggle="tooltip" data-placement="top" title="Slice tool"></button>\n        \x3c!-- Query tool button --\x3e\n        <button type="button" class="xeokit-query btn btn-outline-primary fa fa-info-circle fa-2x disabled" data-toggle="tooltip" data-placement="top" title="Query object tool"></button>\n    </div>\n</div>';i(1),i(5);const ts=new class extends a{constructor(e,t={}){if(!t.canvasElement)throw"Config expected: canvasElement";if(!t.explorerElement)throw"Config expected: explorerElement";if(!t.toolbarElement)throw"Config expected: toolbarElement";if(!t.navCubeCanvasElement)throw"Config expected: navCubeCanvasElement";if(!t.sectionPlanesOverviewCanvasElement)throw"Config expected: sectionPlanesOverviewCanvasElement";if(!t.queryInfoPanelElement)throw"Config expected: queryInfoPanelElement";const i=t.canvasElement,r=t.explorerElement,o=t.toolbarElement,s=t.navCubeCanvasElement,n=t.sectionPlanesOverviewCanvasElement,a=t.queryInfoPanelElement;super(null,t,e,new Zo({canvasElement:i.get(0),transparent:!0})),this._customizeViewer(),r.html(Jo.replace(/{{objects}}/g,"objects"+this.viewer.id).replace(/{{models}}/g,"models"+this.viewer.id).replace(/{{classes}}/g,"classes"+this.viewer.id)),o.html(es),this.busyDialog=new l(this),this.models=new jo(this,{modelsTabElement:r.find(".xeokit-modelsTab"),unloadModelsButtonElement:r.find(".xeokit-unloadAllModels"),modelsElement:r.find(".xeokit-models")}),this.objects=new zo(this,{objectsTabElement:r.find(".xeokit-objectsTab"),showAllObjectsButtonElement:r.find(".xeokit-showAllObjects"),hideAllObjectsButtonElement:r.find(".xeokit-hideAllObjects"),objectsElement:r.find(".xeokit-objects")}),this.classes=new Vo(this,{classesTabElement:r.find(".xeokit-classesTab"),showAllClassesButtonElement:r.find(".xeokit-showAllClasses"),hideAllClassesButtonElement:r.find(".xeokit-hideAllClasses"),classesElement:r.find(".xeokit-classes")}),this.reset=new g(this,{buttonElement:o.find(".xeokit-reset"),active:!1}),this.fit=new _(this,{buttonElement:o.find(".xeokit-fit"),active:!1}),this.firstPerson=new v(this,{buttonElement:o.find(".xeokit-firstPerson"),active:!1}),this.ortho=new x(this,{buttonElement:o.find(".xeokit-ortho"),active:!1}),this.hide=new y(this,{buttonElement:o.find(".xeokit-hide"),active:!1}),this.select=new w(this,{buttonElement:o.find(".xeokit-select"),active:!1}),this.query=new M(this,{buttonElement:o.find(".xeokit-query"),queryInfoPanelElement:a,active:!1}),this.section=new ni(this,{buttonElement:o.find(".xeokit-section"),sectionPlanesOverviewCanvasElement:n,active:!1}),this.navCube=new bi(this,{navCubeCanvasElement:s,active:!0}),this._mutexActivation([this.query,this.hide,this.select,this.section]),this.firstPerson.setActive(!1),this.ortho.setActive(!1),this.navCube.setActive(!0),r.find(".xeokit-showAllObjects").on("click",e=>{this._showAllObjects(),e.preventDefault()}),r.find(".xeokit-hideAllObjects").on("click",e=>{this._hideAllObjects(),e.preventDefault()}),r.find(".xeokit-showAllClasses").on("click",e=>{this._showAllObjects(),e.preventDefault()}),r.find(".xeokit-hideAllClasses").on("click",e=>{this._hideAllObjects(),e.preventDefault()}),r.find(".xeokit-unloadAllModels").on("click",e=>{this._enableControls(!1),this.models._unloadModels(),e.preventDefault()}),this.models.on("modelLoaded",e=>{this.objects._addModel(e),this.classes._addModel(e),1===this.models.getNumModelsLoaded()&&this._enableControls(!0),this.fire("modelLoaded",e)}),this.models.on("modelUnloaded",e=>{this.objects._removeModel(e),this.classes._removeModel(e),0===this.models.getNumModelsLoaded()&&this._enableControls(!1),this.fire("modelUnloaded",e)}),this.query.on("queryPicked",e=>{const t={};t.entity=this.viewer.scene.objects[e],t.metaObject=this.viewer.metaScene.metaObjects[e],this.fire("queryPicked",t)}),this.query.on("queryNotPicked",()=>{this.fire("queryNotPicked",!0)}),this.reset.on("reset",()=>{this.fire("reset",!0)})}_customizeViewer(){const e=this.viewer.scene;e.highlightMaterial.edges=!0,e.highlightMaterial.edgeColor=[.5,.5,0],e.highlightMaterial.edgeAlpha=1,e.highlightMaterial.fill=!0,e.highlightMaterial.fillAlpha=.1,e.highlightMaterial.fillColor=[1,1,0],e.clearLights(),new Yt(e,{color:[.3,.3,.3],intensity:1}),new Xt(e,{dir:[.8,-.6,-.8],color:[1,1,1],intensity:1,space:"world"}),new Xt(e,{dir:[-.8,-.4,.4],color:[1,1,1],intensity:1,space:"world"}),new Xt(e,{dir:[.2,-.8,.8],color:[.6,.6,.6],intensity:1,space:"world"})}loadProject(e){this.models._loadProject(e)}saveBCFViewpoint(){}loadBCFViewpoint(){}_showAllObjects(){this.objects.muteEvents(),this.classes.muteEvents(),this.viewer.scene.setObjectsVisible(this.viewer.scene.objectIds,!0),this.objects.selectAll(),this.classes.selectAll(),this.objects.unmuteEvents(),this.classes.unmuteEvents()}_hideAllObjects(){this.objects.muteEvents(),this.classes.muteEvents(),this.viewer.scene.setObjectsVisible(this.viewer.scene.visibleObjectIds,!1),this.objects.deselectAll(),this.classes.deselectAll(),this.objects.unmuteEvents(),this.classes.unmuteEvents()}_enableControls(e){this.models.setEnabled(e),this.objects.setEnabled(e),this.classes.setEnabled(e),this.reset.setEnabled(e),this.fit.setEnabled(e),this.firstPerson.setEnabled(e),this.ortho.setEnabled(e),this.query.setEnabled(e),this.hide.setEnabled(e),this.select.setEnabled(e),this.section.setEnabled(e)}}(new class{constructor(e={}){this._dataDir=e.dataDir||""}getProjects(e,t){const i=this._dataDir+"/projects/index.json";console.log("Loading database manifest: "+i),s.loadJSON(i,e,t)}getProject(e,t,i){const r=this._dataDir+"/projects/"+e+"/index.json";console.log("Loading project manifest: "+r),s.loadJSON(r,t,i)}getMetadata(e,t,i,r){const o=this._dataDir+"/projects/"+e+"/models/"+t+"/metadata.json";console.log("Loading model metadata: "+o),s.loadJSON(o,i,r)}getGeometry(e,t,i,r){const o=this._dataDir+"/projects/"+e+"/models/"+t+"/geometry.xkt";console.log("Loading model geometry: "+o),s.loadArraybuffer(o,i,r)}}({dataDir:"./data/"}),{canvasElement:$("#myCanvas"),explorerElement:$("#myExplorer"),toolbarElement:$("#myToolbar"),navCubeCanvasElement:$("#myNavCubeCanvas"),sectionPlanesOverviewCanvasElement:$("#mySectionPlanesOverviewCanvas"),queryInfoPanelElement:$("#myQueryInfoPanel")});ts.on("queryPicked",e=>{const t=e.entity,i=e.metaObject;alert(`Query result:\n\nObject ID = ${t.id}\nIFC type = "${i.type}"`)}),ts.loadProject("WestRiversideHospital")}]);